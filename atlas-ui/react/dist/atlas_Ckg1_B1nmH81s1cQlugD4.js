import{r as u,j as e,a as Ze,U as Ke,c as Le,R as Me}from"./atlas_BGo7KNTC_D9rNHeIOnwpB.js";import{R as Je,L as Qe,g as et,a as ge,m as tt,F as st,H as nt,S as at}from"./atlas_D9k-ehviEOO-g-nj2ZRC5.js";import{W as Re}from"./atlas_CNuRMyx4gH271S-qfMS5_.js";import{I as De,C as Ie,J as Te,G as Ge,m as Be,cy as _e,s as $e,cz as Ae,cA as fe,b as Z,u as K,M as J,V as re,B as Pe,cB as Ye,L as Xe,Y as Fe,X as He,r as We,cC as Oe,cD as Ve}from"./atlas_CqUMNY_RyRklhCsbOI68T.js";import{R as ot,S as rt,M as it,a as Ee,b as ke}from"./atlas_DvGeqwMQiuTIPTgKb4JGF.js";import{V as lt}from"./atlas_BC--f3teBajIZvYzpPvMJ.js";import"./atlas_5StMBQg7EZ_DcUhMgqODi.js";const ct=({coordinates:t,galaxyName:r})=>{const i=u.useRef(null),l=u.useRef(null),o=u.useRef(null),p=u.useRef(null);return u.useEffect(()=>{if(!i.current)return;const d=i.current,c=d.clientWidth,R=d.clientHeight,g=new De;g.background=new Ie(657930),l.current=g;const b=new Te(45,c/R,.1,1e3);b.position.set(20,15,20),b.lookAt(0,0,0);const h=new Re({antialias:!0,alpha:!0});h.setSize(c,R),h.setClearColor(0,.2),o.current=h,d.appendChild(h.domElement);const s=0,x=1e7,f=5e6,[L,m,S]=t,a=((L-s)/(x-s)-.5)*16,v=((m-s)/(x-s)-.5)*16,T=((S-s)/(x-s)-.5)*16,w=new Ge;g.add(w);const G=new Be(16,16,16),z=new _e(G),B=new $e({color:16777215,opacity:.4,transparent:!0,linewidth:2}),N=new Ae(z,B);w.add(N);const I=new fe(16,16,16777215,16777215);I.material.opacity=.1,I.material.transparent=!0,I.position.y=-8,w.add(I);const _=new fe(16,16,16777215,16777215);_.material.opacity=.05,_.material.transparent=!0,_.rotation.z=Math.PI/2,_.position.x=-8,w.add(_);const P=new fe(16,16,16777215,16777215);P.material.opacity=.05,P.material.transparent=!0,P.rotation.x=Math.PI/2,P.position.z=-8,w.add(P);const Q=new Z(.5,32,32),be=new K({color:16777215,transparent:!0,opacity:.9}),ee=new J(Q,be);ee.position.set(0,0,0),w.add(ee);const ve=new J(new Z(.8,32,32),new K({color:16777215,transparent:!0,opacity:.2}));ee.add(ve);const M=new Z(.4,32,32),we=new K({color:6605055,transparent:!0,opacity:1}),te=new J(M,we);te.position.set(a,v,T),w.add(te);const ye=new J(new Z(.7,32,32),new K({color:6605055,transparent:!0,opacity:.3}));if(te.add(ye),Math.sqrt(Math.pow(L-f,2)+Math.pow(m-f,2)+Math.pow(S-f,2))<2e6){const n=[new re(0,0,0),new re(a,v,T)],C=new Pe().setFromPoints(n),j=new Ye({color:16762980,dashSize:.6,gapSize:.6,opacity:.4,transparent:!0,linewidth:2}),D=new Xe(C,j);D.computeLineDistances(),w.add(D)}const ie=new Fe(4210752,.6);g.add(ie);const V=new He(16777215,.8);V.position.set(10,10,10),g.add(V);const F=(n,C)=>{const j=document.createElement("canvas"),D=j.getContext("2d");if(!D)return null;j.width=64,j.height=64,D.fillStyle=`#${C.toString(16).padStart(6,"0")}`,D.font="bold 48px Arial",D.textAlign="center",D.textBaseline="middle",D.fillText(n,32,32);const k=new We(j),oe=new Oe({map:k,transparent:!0,opacity:.8}),U=new Ve(oe);return U.scale.set(1.6,1.6,1),U},le=F("X",16739179);le&&(le.position.set(8.4,-7.6,-7.6),w.add(le));const ce=F("Y",7077739);ce&&(ce.position.set(-7.6,8.4,-7.6),w.add(ce));const q=F("Z",7039999);q&&(q.position.set(-7.6,-7.6,8.4),w.add(q));let Y=!1,H=0,W=0,X=!0,se=0;const Ne=n=>{Y=!0,X=!1,H=n.clientX,W=n.clientY},je=n=>{if(!Y)return;const C=n.clientX-H,j=n.clientY-W;w.rotation.y+=C*.01,w.rotation.x+=j*.01,H=n.clientX,W=n.clientY},ne=()=>{Y=!1,setTimeout(()=>{Y||(X=!0)},3e3)},de=n=>{n.preventDefault();const C=.1,j=b.position.distanceTo(new re(0,0,0));n.deltaY>0&&j<50?b.position.multiplyScalar(1+C):n.deltaY<0&&j>10&&b.position.multiplyScalar(1-C)},me=n=>{n.key==="Escape"&&document.dispatchEvent(new CustomEvent("universe-close-fullscreen"))},ue=n=>{if(n.preventDefault(),n.touches.length===1)Y=!0,X=!1,H=n.touches[0].clientX,W=n.touches[0].clientY;else if(n.touches.length===2){const C=n.touches[0].clientX-n.touches[1].clientX,j=n.touches[0].clientY-n.touches[1].clientY;se=Math.sqrt(C*C+j*j)}},xe=n=>{if(n.preventDefault(),n.touches.length===1&&Y){const C=n.touches[0].clientX-H,j=n.touches[0].clientY-W;w.rotation.y+=C*.01,w.rotation.x+=j*.01,H=n.touches[0].clientX,W=n.touches[0].clientY}else if(n.touches.length===2){const C=n.touches[0].clientX-n.touches[1].clientX,j=n.touches[0].clientY-n.touches[1].clientY,D=Math.sqrt(C*C+j*j);if(se>0){const oe=D/se,U=b.position.distanceTo(new re(0,0,0));oe>1&&U>10?b.position.multiplyScalar(1-.01):oe<1&&U<50&&b.position.multiplyScalar(1+.01)}se=D}},ae=n=>{n.preventDefault(),Y=!1,se=0,setTimeout(()=>{Y||(X=!0)},3e3)},y=h.domElement;y.style.cursor="grab",y.addEventListener("mousedown",n=>{y.style.cursor="grabbing",Ne(n)}),y.addEventListener("mousemove",je),y.addEventListener("mouseup",()=>{y.style.cursor="grab",ne()}),y.addEventListener("mouseleave",()=>{y.style.cursor="grab",ne()}),y.addEventListener("wheel",de),y.addEventListener("touchstart",ue,{passive:!1}),y.addEventListener("touchmove",xe,{passive:!1}),y.addEventListener("touchend",ae,{passive:!1}),document.addEventListener("keydown",me);const he=()=>{p.current=requestAnimationFrame(he),X&&(w.rotation.y+=.002,w.rotation.x+=.001);const n=Date.now()*.005;ee.scale.setScalar(1+Math.sin(n)*.1),te.rotation.y+=.01,h.render(g,b)};he();const pe=()=>{const n=d.clientWidth,C=d.clientHeight;b.aspect=n/C,b.updateProjectionMatrix(),h.setSize(n,C)};return window.addEventListener("resize",pe),()=>{window.removeEventListener("resize",pe),document.removeEventListener("keydown",me),y.removeEventListener("mousedown",Ne),y.removeEventListener("mousemove",je),y.removeEventListener("mouseup",ne),y.removeEventListener("mouseleave",ne),y.removeEventListener("wheel",de),y.removeEventListener("touchstart",ue),y.removeEventListener("touchmove",xe),y.removeEventListener("touchend",ae),p.current&&cancelAnimationFrame(p.current),d&&h.domElement&&d.removeChild(h.domElement),h.dispose(),G.dispose(),z.dispose(),B.dispose(),Q.dispose(),be.dispose(),M.dispose(),we.dispose()}},[t,r]),e.jsx("div",{ref:i,className:"w-full h-full"})},dt=({coordinates:t,galaxyName:r})=>{const i=u.useRef(null),l=u.useRef(null),o=u.useRef(null),p=u.useRef(null),[d,c]=u.useState(!1),[R,g]=u.useState(!1),[b,h]=u.useState(!1),s=()=>{g(!0),setTimeout(()=>{c(!1),g(!1)},300)};u.useEffect(()=>{const a=v=>{v.key==="Escape"&&d&&s()};return document.addEventListener("universe-close-fullscreen",s),document.addEventListener("keydown",a),()=>{document.removeEventListener("universe-close-fullscreen",s),document.removeEventListener("keydown",a)}},[d]),u.useEffect(()=>{if(d&&b){const a=setTimeout(()=>{h(!1)},50);return()=>clearTimeout(a)}},[d,b]),u.useEffect(()=>{if(!i.current)return;const a=i.current,v=a.clientWidth,T=v<640,w=new De;w.background=new Ie(657930),l.current=w;const G=new Te(30,v/120,.1,1e3);G.position.set(12,8,12),G.lookAt(0,0,0);const z=new Re({antialias:!0,alpha:!0});z.setSize(v,120),z.setClearColor(0,.2),o.current=z,a.appendChild(z.domElement);const B=0,N=1e7,I=5e6,[_,P,Q]=t,be=((_-B)/(N-B)-.5)*8,ee=((P-B)/(N-B)-.5)*8,ve=((Q-B)/(N-B)-.5)*8,M=new Ge;w.add(M);const we=new Be(8,8,8),te=new _e(we),ye=new $e({color:16777215,opacity:.4,transparent:!0}),Se=new Ae(te,ye);M.add(Se);const ie=new fe(8,8,16777215,16777215);ie.material.opacity=.1,ie.material.transparent=!0,ie.position.y=-4,M.add(ie);const V=new fe(8,8,16777215,16777215);V.material.opacity=.05,V.material.transparent=!0,V.rotation.z=Math.PI/2,V.position.x=-4,M.add(V);const F=new fe(8,8,16777215,16777215);F.material.opacity=.05,F.material.transparent=!0,F.rotation.x=Math.PI/2,F.position.z=-4,M.add(F);const le=new Z(.25,16,16),ce=new K({color:16777215,transparent:!0,opacity:.9}),q=new J(le,ce);q.position.set(0,0,0),M.add(q);const Y=new J(new Z(.45,16,16),new K({color:16777215,transparent:!0,opacity:.2}));q.add(Y);const H=new Z(.2,16,16),W=new K({color:6605055,transparent:!0,opacity:1}),X=new J(H,W);X.position.set(be,ee,ve),M.add(X);const se=new J(new Z(.35,16,16),new K({color:6605055,transparent:!0,opacity:.3}));if(X.add(se),Math.sqrt(Math.pow(_-I,2)+Math.pow(P-I,2)+Math.pow(Q-I,2))<2e6){const E=[new re(0,0,0),new re(be,ee,ve)],$=new Pe().setFromPoints(E),A=new Ye({color:16762980,dashSize:.3,gapSize:.3,opacity:.4,transparent:!0}),O=new Xe($,A);O.computeLineDistances(),M.add(O)}const je=new Fe(4210752,.6);w.add(je);const ne=new He(16777215,.8);ne.position.set(5,5,5),w.add(ne);const de=(E,$)=>{const A=document.createElement("canvas"),O=A.getContext("2d");if(!O)return null;A.width=32,A.height=32,O.fillStyle=`#${$.toString(16).padStart(6,"0")}`,O.font="bold 24px Arial",O.textAlign="center",O.textBaseline="middle",O.fillText(E,16,16);const qe=new We(A),Ue=new Oe({map:qe,transparent:!0,opacity:.8}),Ce=new Ve(Ue);return Ce.scale.set(.8,.8,1),Ce},me=de("X",16739179);me&&(me.position.set(4.2,-3.8,-3.8),M.add(me));const ue=de("Y",7077739);ue&&(ue.position.set(-3.8,4.2,-3.8),M.add(ue));const xe=de("Z",7039999);xe&&(xe.position.set(-3.8,-3.8,4.2),M.add(xe));let ae=!1,y=0,he=0,pe=!0;const n=E=>{ae=!0,pe=!1,y=E.clientX,he=E.clientY},C=E=>{if(!ae)return;const $=E.clientX-y,A=E.clientY-he;M.rotation.y+=$*.01,M.rotation.x+=A*.01,y=E.clientX,he=E.clientY},j=()=>{ae=!1,setTimeout(()=>{ae||(pe=!0)},3e3)},D=E=>{E.preventDefault();const $=.1,A=G.position.distanceTo(new re(0,0,0));E.deltaY>0&&A<25?G.position.multiplyScalar(1+$):E.deltaY<0&&A>5&&G.position.multiplyScalar(1-$)},k=z.domElement;k.style.cursor="grab",k.style.borderRadius="8px",k.addEventListener("mousedown",E=>{k.style.cursor="grabbing",n(E)}),k.addEventListener("mousemove",C),k.addEventListener("mouseup",()=>{k.style.cursor="grab",j()}),k.addEventListener("mouseleave",()=>{k.style.cursor="grab",j()}),k.addEventListener("wheel",D);const oe=()=>{p.current=requestAnimationFrame(oe),pe&&(M.rotation.y+=.002,M.rotation.x+=.001);const E=Date.now()*.005;q.scale.setScalar(1+Math.sin(E)*.1),X.rotation.y+=.01,z.render(w,G)};oe();const U=()=>{const E=a.clientWidth,$=E<640?150:160;G.aspect=E/$,G.updateProjectionMatrix(),z.setSize(E,$)};return window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U),k.removeEventListener("mousedown",n),k.removeEventListener("mousemove",C),k.removeEventListener("mouseup",j),k.removeEventListener("mouseleave",j),k.removeEventListener("wheel",D),p.current&&cancelAnimationFrame(p.current),a&&z.domElement&&a.removeChild(z.domElement),z.dispose(),we.dispose(),te.dispose(),ye.dispose(),le.dispose(),ce.dispose(),H.dispose(),W.dispose()}},[t,r]);const x=a=>a.replace(/_/g," "),f=a=>a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toString(),[L,m,S]=t;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Galaxy Location"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:i,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsxs("button",{onClick:()=>{c(!0),h(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 flex items-center gap-1 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:[e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),e.jsx("span",{className:"text-xs text-white hidden sm:inline",children:"Expand"})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-[10px]",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:x(r)})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[f(L),", ",f(m),", ",f(S)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Drag: Rotate View"})]})]}),d&&Ze.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${R||b?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${R||b?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:x(r)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[x(r)," - Galaxy Location"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Galaxy"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[f(L),", ",f(m),", ",f(S)]})]})]}),e.jsx("button",{onClick:s,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(ct,{coordinates:t,galaxyName:r})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},mt=({galaxy:t})=>{const[r,i]=u.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});u.useEffect(()=>{let o;const p=()=>{const g=Ee.generateLocationId("galaxy",t.coordinates.join(","),void 0,void 0),b=Ee.canCollectFromLocation(g),h=Ee.getTimeUntilNextCollection(g),s=t.coordinates,x=ke.generateGalaxyUrl(s,ke.getCurrentPage()),L=Qe.getLocations().some(m=>m.stargateUrl===x);i(m=>({isOnCooldown:!b&&h>0,isSaved:L,isCollecting:m.isCollecting,timeUntilNext:h}))},d=()=>{i(g=>({...g,isCollecting:!0})),o=setTimeout(()=>{i(g=>({...g,isCollecting:!1}))},1e3)};p();const c=setInterval(p,1e3),R=Je.subscribe("mining_completed",d);return()=>{clearInterval(c),o&&clearTimeout(o),R()}},[t.name,t.coordinates]);const l=o=>o.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(ot,{locationType:"galaxy",locationId:t.name,coordinates:t.coordinates.join(","),className:"text-xs"}),e.jsx(rt,{type:"galaxy",name:t.name,coordinates:t.coordinates.join(","),className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(it,{isOnCooldown:r.isOnCooldown,isSaved:r.isSaved,isCollecting:r.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300",children:t.galaxy_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Solar Systems"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:t.num_systems.toLocaleString()})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-2",children:e.jsx(dt,{coordinates:t.coordinates,galaxyName:t.name})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-gray-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Cosmic Objects"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-pink-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Black Holes"}),e.jsx("div",{className:"text-xs font-bold text-pink-300",children:t.black_holes.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Pulsars"}),e.jsx("div",{className:"text-xs font-bold text-cyan-300",children:t.pulsars.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-indigo-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Quasars"}),e.jsx("div",{className:"text-xs font-bold text-indigo-300",children:t.quasars.toLocaleString()})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:l(t.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:t.coordinates.join(", ")})]})]})]})]})},ut=({galaxyUrl:t,imageUrl:r})=>{const i=u.useRef(null),l=u.useRef(null),[o,p]=u.useState("Aligning Stargate..."),[d,c]=u.useState(!1),[R,g]=u.useState(!1),[b,h]=u.useState(!1);return u.useEffect(()=>{const s=i.current;if(!s)return;const x=s.getContext("2d");if(!x)return;let f=[];const L=800;let m,S;const a=800;let v,T=.5;function w(){const N=s?.parentElement;if(!N||!s)return;const I=N.clientWidth,_=N.clientHeight;s.width=Math.min(I,a),s.height=Math.min(_,a),m=s.width/2,S=s.height/2}function G(){w(),f=[];for(let N=0;N<L;N++)f.push({x:Math.random()*(s?.width||800),y:Math.random()*(s?.height||800),z:Math.random()*(s?.width||800),o:Math.random()});z()}function z(){!s||!x||(x.clearRect(0,0,s.width,s.height),f.forEach(N=>{N.z-=T,N.z<=0&&(N.z=s.width,N.x=Math.random()*s.width,N.y=Math.random()*s.height,N.o=Math.random());const I=s.width/N.z,_=(N.x-m)*I+m,P=(N.y-S)*I+S,Q=2*I;x.beginPath(),x.fillStyle=`rgba(255, 255, 255, ${N.o})`,x.arc(_,P,Q,0,2*Math.PI),x.fill()}),T<60&&(T+=1),v=requestAnimationFrame(z))}G();const B=()=>w();return window.addEventListener("resize",B),()=>{window.removeEventListener("resize",B),v&&cancelAnimationFrame(v)}},[]),u.useEffect(()=>{if(r){const s=new Image;s.onload=()=>{l.current&&(l.current.src=r,g(!0),h(!0))},s.onerror=()=>{console.error("Failed to load galaxy image:",r),setTimeout(()=>{g(!0),h(!0)},1500)},s.src=r}else setTimeout(()=>{g(!0),h(!0)},1500)},[r]),u.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){p("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),c(!0);const x=(a,v)=>Array.from({length:v},()=>a[Math.floor(Math.random()*a.length)]).join(""),f=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:30},{chars:"0123456789ABCDEF",duration:20,iterations:40},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:'\",.<>?/`~",duration:10,iterations:100}];let L=0,m=0;const S=()=>{if(L>=f.length){const v="Stargate system aligned";let T=0;p("");const w=()=>{T<v.length?(p(v.substring(0,T+1)),T++,setTimeout(w,30)):c(!1)};w();return}const a=f[L];p(x(a.chars,32)),m++,m>=a.iterations&&(L++,m=0),setTimeout(S,a.duration)};S()},[]),u.useEffect(()=>{const s=document.createElement("style");return s.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(s),()=>{document.head.removeChild(s)}},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white mb-3",children:"Galaxy Visualization"}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx("canvas",{ref:i,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${b?"opacity-0":"opacity-100"}`,style:{filter:b?"blur(50px)":"none"}}),e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${R?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:R&&r?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ke,{zoomMargin:20,classDialog:"backdrop-blur-3xl",children:e.jsx("img",{ref:l,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl shadow-blue-500/20",src:r,alt:"Galaxy visualization",style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"transparent"}})})}):e.jsx("img",{ref:l,className:"w-full h-full object-cover",src:"/static/images/placeholder-min.jpg",alt:"Galaxy visualization"})})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:t,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${d?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),o]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},xt=({systems:t,coordinates:r})=>{const[i,l]=u.useState(new Map);return u.useEffect(()=>{(()=>{try{const p=new Map;t.forEach(d=>{const c=et(r,d.index,d.num_planets||1);p.set(d.index,c)}),l(p)}catch(p){console.error("Error loading historical data:",p)}})()},[r,t]),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:t.map(o=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[(()=>{const p=i.get(o.index)||"none";return p==="complete"?e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}):p==="partial"?e.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500/20 border border-yellow-500/50 text-yellow-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"PARTIAL"}):null})(),e.jsxs("button",{onClick:()=>window.location.href=`/system/${o.index}`,className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["#",o.number]}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:o.name})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},o.index))}),t.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No systems found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This galaxy appears to be empty"})]})]})},ht=({currentGalaxy:t})=>{const[r,i]=u.useState(!1),[l,o]=u.useState(!1),[p,d]=u.useState(!0),c=1e7;u.useEffect(()=>{const[s,x,f]=t.coordinates,L=!(s===0&&x===0&&f===0),m=!(s===c&&x===c&&f===c);i(L),o(m),d(!1)},[t.coordinates]);const R=()=>{const[s,x,f]=t.coordinates;return f>0?[s,x,f-1]:x>0?[s,x-1,c]:s>0?[s-1,c,c]:[0,0,0]},g=()=>{const[s,x,f]=t.coordinates;return f<c?[s,x,f+1]:x<c?[s,x+1,0]:s<c?[s+1,0,0]:[c,c,c]},b=()=>{if(r){if(!ge.canAffordTravel("galaxy",1)){ge.executeTravel("galaxy",1);return}if(!ge.executeTravel("galaxy",1))return;const[x,f,L]=R(),m=document.createElement("form");m.method="POST",m.action="/navigate";const S=document.createElement("input");S.type="hidden",S.name="x",S.value=x.toString();const a=document.createElement("input");a.type="hidden",a.name="y",a.value=f.toString();const v=document.createElement("input");v.type="hidden",v.name="z",v.value=L.toString(),m.appendChild(S),m.appendChild(a),m.appendChild(v),document.body.appendChild(m),m.submit()}},h=()=>{if(l){if(!ge.canAffordTravel("galaxy",1)){ge.executeTravel("galaxy",1);return}if(!ge.executeTravel("galaxy",1))return;const[x,f,L]=g(),m=document.createElement("form");m.method="POST",m.action="/navigate";const S=document.createElement("input");S.type="hidden",S.name="x",S.value=x.toString();const a=document.createElement("input");a.type="hidden",a.name="y",a.value=f.toString();const v=document.createElement("input");v.type="hidden",v.name="z",v.value=L.toString(),m.appendChild(S),m.appendChild(a),m.appendChild(v),document.body.appendChild(m),m.submit()}};return p?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:b,disabled:!r,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${r?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:h,disabled:!l,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${l?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},pt=({page:t,prevPage:r,nextPage:i,finish:l})=>{const o="px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",p="bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg",d="bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white border border-white/20";return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 sm:gap-4 flex-wrap",children:[t!==1&&e.jsxs("button",{onClick:()=>window.location.href="/galaxy/1",className:`${o} ${d}`,title:"First page",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),r&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${r}`,className:`${o} ${d}`,title:"Previous page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),(()=>{const c=[],g=Math.max(1,t-2),b=Math.min(l,t+2);g>1&&(c.push(e.jsx("button",{onClick:()=>window.location.href="/galaxy/1",className:`${o} ${d}`,children:"1"},1)),g>2&&c.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"start-ellipsis")));for(let h=g;h<=b;h++)h===t?c.push(e.jsx("span",{className:`${o} ${p} cursor-default`,children:h},h)):c.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${h}`,className:`${o} ${d} cursor-pointer`,children:h},h));return b<l&&(b<l-1&&c.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"end-ellipsis")),c.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${l}`,className:`${o} ${d}`,children:l},l))),c})(),i&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${i}`,className:`${o} ${d}`,title:"Next page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),t!==l&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${l}`,className:`${o} ${d}`,title:"Last page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]}),e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-400",children:["Page ",t," of ",l]})]})},ze=({galaxy:t,systems:r,galaxy_url:i,version:l,page:o,prev_page:p,next_page:d,finish:c,image_url:R})=>{const[g]=u.useState(t.coordinates.join(","));u.useEffect(()=>{document.body.setAttribute("data-coordinates",g),tt(g)},[g]);const b=h=>h.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(st,{}),e.jsxs("div",{className:"relative z-10 pt-1",children:[e.jsx(nt,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["Galaxy '",b(t.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Coordinates ",t.coordinates.join(", ")]})]}),e.jsx(ht,{currentGalaxy:t}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(ut,{galaxyUrl:i,imageUrl:R})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(mt,{galaxy:t})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Systems in '",b(t.name),"'"]}),e.jsx(xt,{systems:r,coordinates:g})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsx("span",{className:"text-base sm:text-lg",children:"← Go Back to Planetary Index"})})}),e.jsx(pt,{page:o,prevPage:p,nextPage:d,finish:c})]}),e.jsx(lt,{version:l})]}),e.jsx(at,{currentLocation:{type:"galaxy",name:t.name,coordinates:t.coordinates.join(",")}})]})};document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("atlas-react-root");if(!t){console.error("Could not find atlas-react-root element");return}const r=i=>{const l=document.getElementById(i);if(!l||!l.textContent)return null;try{return JSON.parse(l.textContent.trim())}catch(o){return console.error(`Error parsing data from script ${i}:`,o),null}};try{const i=r("data-galaxy")||{},l=r("data-systems")||[],o=r("data-navigation")||{},p=r("data-common")||{},d={galaxy:{name:i.name||"Unknown Galaxy",coordinates:i.coordinates||[0,0,0],galaxy_type:i.galaxy_type||"Unknown",num_systems:i.num_systems||0,black_holes:i.black_holes||0,pulsars:i.pulsars||0,quasars:i.quasars||0},systems:l,galaxy_url:o.galaxy_url||"#",version:p.version||"1.0.0",page:o.page||1,prev_page:o.prev_page,next_page:o.next_page,finish:o.finish||1,image_url:p.image_url||""};Le.createRoot(t).render(Me.createElement(ze,d))}catch(i){console.error("Error parsing galaxy data:",i);const l={galaxy:{name:"Unknown Galaxy",coordinates:[0,0,0],galaxy_type:"Unknown",num_systems:0,black_holes:0,pulsars:0,quasars:0},systems:[],galaxy_url:"#",version:"1.0.0",page:1,finish:1,image_url:""};Le.createRoot(t).render(Me.createElement(ze,l))}});
