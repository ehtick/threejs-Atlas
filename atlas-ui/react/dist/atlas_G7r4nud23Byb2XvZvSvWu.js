import{r as v,j as e,V as Kt,c as $t,R as qt}from"./atlas_bDOTfl6YifhEgi64OZoGp.js";import{H as Qt}from"./atlas_DAPSgiEQDbHKEp53GoVrV.js";import{S as Jt,U as te,m as tt,c as jt,a as ee}from"./atlas_Ep8Z7FyBoZ31__UNPvjgh.js";import{m as se,V as L,n as Q,T as q,Q as Ct,l as At,o as z,R as ie,p as oe,q as ae,r as Ft,C as Ot,e as ct,s as bt,N as ne,t as re,L as _t,g as yt,S as le,P as ce,W as de,c as Rt,u as he,d as Tt,M as me,A as ue,k as Dt}from"./atlas_0u4puQilmEK-9IoYPrt7x.js";const kt={type:"change"},Pt={type:"start"},zt={type:"end"},dt=new ie,Lt=new oe,pe=Math.cos(70*ae.DEG2RAD),E=new L,T=2*Math.PI,x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},wt=1e-6;class fe extends se{constructor(t,s=null){super(t,s),this.state=x.NONE,this.target=new L,this.cursor=new L,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Q.ROTATE,MIDDLE:Q.DOLLY,RIGHT:Q.PAN},this.touches={ONE:q.ROTATE,TWO:q.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new L,this._lastQuaternion=new Ct,this._lastTargetPosition=new L,this._quat=new Ct().setFromUnitVectors(t.up,new L(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new At,this._sphericalDelta=new At,this._scale=1,this._panOffset=new L,this._rotateStart=new z,this._rotateEnd=new z,this._rotateDelta=new z,this._panStart=new z,this._panEnd=new z,this._panDelta=new z,this._dollyStart=new z,this._dollyEnd=new z,this._dollyDelta=new z,this._dollyDirection=new L,this._mouse=new z,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=xe.bind(this),this._onPointerDown=ge.bind(this),this._onPointerUp=be.bind(this),this._onContextMenu=Ne.bind(this),this._onMouseWheel=we.bind(this),this._onKeyDown=ve.bind(this),this._onTouchStart=je.bind(this),this._onTouchMove=Pe.bind(this),this._onMouseDown=_e.bind(this),this._onMouseMove=ye.bind(this),this._interceptControlDown=Ee.bind(this),this._interceptControlUp=Me.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(kt),this.update(),this.state=x.NONE}update(t=null){const s=this.object.position;E.copy(s).sub(this.target),E.applyQuaternion(this._quat),this._spherical.setFromVector3(E),this.autoRotate&&this.state===x.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let o=this.minAzimuthAngle,a=this.maxAzimuthAngle;isFinite(o)&&isFinite(a)&&(o<-Math.PI?o+=T:o>Math.PI&&(o-=T),a<-Math.PI?a+=T:a>Math.PI&&(a-=T),o<=a?this._spherical.theta=Math.max(o,Math.min(a,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(o+a)/2?Math.max(o,this._spherical.theta):Math.min(a,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let d=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const l=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),d=l!=this._spherical.radius}if(E.setFromSpherical(this._spherical),E.applyQuaternion(this._quatInverse),s.copy(this.target).add(E),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let l=null;if(this.object.isPerspectiveCamera){const c=E.length();l=this._clampDistance(c*this._scale);const u=c-l;this.object.position.addScaledVector(this._dollyDirection,u),this.object.updateMatrixWorld(),d=!!u}else if(this.object.isOrthographicCamera){const c=new L(this._mouse.x,this._mouse.y,0);c.unproject(this.object);const u=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),d=u!==this.object.zoom;const f=new L(this._mouse.x,this._mouse.y,0);f.unproject(this.object),this.object.position.sub(f).add(c),this.object.updateMatrixWorld(),l=E.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;l!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(l).add(this.object.position):(dt.origin.copy(this.object.position),dt.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(dt.direction))<pe?this.object.lookAt(this.target):(Lt.setFromNormalAndCoplanarPoint(this.object.up,this.target),dt.intersectPlane(Lt,this.target))))}else if(this.object.isOrthographicCamera){const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),l!==this.object.zoom&&(this.object.updateProjectionMatrix(),d=!0)}return this._scale=1,this._performCursorZoom=!1,d||this._lastPosition.distanceToSquared(this.object.position)>wt||8*(1-this._lastQuaternion.dot(this.object.quaternion))>wt||this._lastTargetPosition.distanceToSquared(this.target)>wt?(this.dispatchEvent(kt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?T/60*this.autoRotateSpeed*t:T/60/60*this.autoRotateSpeed}_getZoomScale(t){const s=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,s){E.setFromMatrixColumn(s,0),E.multiplyScalar(-t),this._panOffset.add(E)}_panUp(t,s){this.screenSpacePanning===!0?E.setFromMatrixColumn(s,1):(E.setFromMatrixColumn(s,0),E.crossVectors(this.object.up,E)),E.multiplyScalar(t),this._panOffset.add(E)}_pan(t,s){const o=this.domElement;if(this.object.isPerspectiveCamera){const a=this.object.position;E.copy(a).sub(this.target);let d=E.length();d*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*d/o.clientHeight,this.object.matrix),this._panUp(2*s*d/o.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/o.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/o.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const o=this.domElement.getBoundingClientRect(),a=t-o.left,d=s-o.top,l=o.width,c=o.height;this._mouse.x=a/l*2-1,this._mouse.y=-(d/c)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(T*this._rotateDelta.x/s.clientHeight),this._rotateUp(T*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let s=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(T*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-T*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(T*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-T*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),o=.5*(t.pageX+s.x),a=.5*(t.pageY+s.y);this._rotateStart.set(o,a)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),o=.5*(t.pageX+s.x),a=.5*(t.pageY+s.y);this._panStart.set(o,a)}}_handleTouchStartDolly(t){const s=this._getSecondPointerPosition(t),o=t.pageX-s.x,a=t.pageY-s.y,d=Math.sqrt(o*o+a*a);this._dollyStart.set(0,d)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const o=this._getSecondPointerPosition(t),a=.5*(t.pageX+o.x),d=.5*(t.pageY+o.y);this._rotateEnd.set(a,d)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(T*this._rotateDelta.x/s.clientHeight),this._rotateUp(T*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const s=this._getSecondPointerPosition(t),o=.5*(t.pageX+s.x),a=.5*(t.pageY+s.y);this._panEnd.set(o,a)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const s=this._getSecondPointerPosition(t),o=t.pageX-s.x,a=t.pageY-s.y,d=Math.sqrt(o*o+a*a);this._dollyEnd.set(0,d),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const l=(t.pageX+s.x)*.5,c=(t.pageY+s.y)*.5;this._updateZoomParameters(l,c)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(t){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==t.pointerId)return!0;return!1}_trackPointer(t){let s=this._pointerPositions[t.pointerId];s===void 0&&(s=new z,this._pointerPositions[t.pointerId]=s),s.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const s=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(t){const s=t.deltaMode,o={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(s){case 1:o.deltaY*=16;break;case 2:o.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(o.deltaY*=10),o}}function ge(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function xe(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function be(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(zt),this.state=x.NONE;break;case 1:const t=this._pointers[0],s=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:s.x,pageY:s.y});break}}function _e(i){let t;switch(i.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Q.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=x.DOLLY;break;case Q.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=x.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=x.ROTATE}break;case Q.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=x.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=x.PAN}break;default:this.state=x.NONE}this.state!==x.NONE&&this.dispatchEvent(Pt)}function ye(i){switch(this.state){case x.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case x.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case x.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function we(i){this.enabled===!1||this.enableZoom===!1||this.state!==x.NONE||(i.preventDefault(),this.dispatchEvent(Pt),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(zt))}function ve(i){this.enabled!==!1&&this._handleKeyDown(i)}function je(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case q.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=x.TOUCH_ROTATE;break;case q.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=x.TOUCH_PAN;break;default:this.state=x.NONE}break;case 2:switch(this.touches.TWO){case q.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=x.TOUCH_DOLLY_PAN;break;case q.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=x.TOUCH_DOLLY_ROTATE;break;default:this.state=x.NONE}break;default:this.state=x.NONE}this.state!==x.NONE&&this.dispatchEvent(Pt)}function Pe(i){switch(this._trackPointer(i),this.state){case x.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case x.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case x.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case x.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=x.NONE}}function Ne(i){this.enabled!==!1&&i.preventDefault()}function Ee(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Me(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}class Se{seed;constructor(t){this.seed=t%2147483647,this.seed<=0&&(this.seed+=2147483646)}random(){return this.seed=this.seed*16807%2147483647,(this.seed-1)/2147483646}randint(t,s){return Math.floor(this.random()*(s-t+1))+t}uniform(t,s){return this.random()*(s-t)+t}}function Ce(i){let t=0;for(let s=0;s<i.length;s++){const o=i.charCodeAt(s);t=(t<<5)-t+o,t=t&t}return Math.abs(t)}const Ae=`
  varying vec3 vPosition;
  varying vec3 vNormal;
  varying vec2 vUv;
  
  void main() {
    vPosition = position;
    vNormal = normal;
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,Re=`
  uniform float time;
  uniform float seed;
  uniform vec3 planetColor;
  uniform float numBands;
  uniform float rotationAngle;
  uniform float bandPositions[20]; // Máximo 20 bandas como en Pillow
  uniform float bandWidths[20];
  varying vec3 vPosition;
  varying vec3 vNormal;
  varying vec2 vUv;
  
  // Hash function to generate pseudo-random numbers
  float hash(float n) {
    return fract(sin(n + seed) * 43758.5453123);
  }
  
  // Simple noise function
  float noise(vec3 p) {
    vec3 i = floor(p);
    vec3 f = fract(p);
    f = f * f * (3.0 - 2.0 * f);
    
    float n = i.x + i.y * 57.0 + 113.0 * i.z;
    return mix(
      mix(mix(hash(n + 0.0), hash(n + 1.0), f.x),
          mix(hash(n + 57.0), hash(n + 58.0), f.x), f.y),
      mix(mix(hash(n + 113.0), hash(n + 114.0), f.x),
          mix(hash(n + 170.0), hash(n + 171.0), f.x), f.y), f.z);
  }
  
  // Recreate generate_cloud_bands EXACTLY as in Pillow
  float createCloudBands(vec3 pos) {
    float bands = 0.0;
    
    // Bands are HORIZONTAL (constant latitude) from north pole to south pole
    // pos.y is already normalized from -1 (south pole) to +1 (north pole)
    float currentY = pos.y;
    float currentX = pos.x; // For rotation
    
    // Apply rotation EXACTLY as in Pillow
    float cosAngle = cos(rotationAngle);
    float sinAngle = sin(rotationAngle);
    
    // Rotation in normalized coordinates
    float rotatedY = sinAngle * currentX + cosAngle * currentY;
    
    // Check if we are inside any horizontal band
    for(int i = 0; i < 20; i++) {
      if(float(i) >= numBands) break;
      
      float bandPosY = bandPositions[i]; // Already normalized between -1 and 1
      float bandWidth = bandWidths[i];   // Already normalized
      
      // Check if rotatedY is inside this band
      float distToBand = abs(rotatedY - bandPosY);
      if(distToBand < bandWidth / 2.0) {
        // Smooth band edges
        float bandIntensity = 1.0 - (distToBand / (bandWidth / 2.0));
        bands += bandIntensity * 0.6; // A bit more intense
      }
    }
    
    return bands;
  }
  
  // Function to create concentric rings like draw_planet_rings
  float createRings(vec3 pos) {
    float distance = length(pos);
    float rings = 0.0;
    
    // Create multiple concentric rings
    for(int i = 0; i < 30; i++) {
      float ringRadius = 0.5 + float(i) * 0.015;
      float ringWidth = 0.01;
      float opacity = pow((30.0 - float(i)) / 30.0, 4.0) * 0.3;
      
      float ringDist = abs(distance - ringRadius);
      if(ringDist < ringWidth) {
        rings += opacity * (1.0 - ringDist / ringWidth);
      }
    }
    
    return rings;
  }
  
  // Function to create cloud formations
  float createClouds(vec3 pos) {
    float clouds = 0.0;
    
    // Use noise to create irregular cloud patterns
    clouds += 0.5 * noise(pos * 8.0);
    clouds += 0.25 * noise(pos * 16.0);
    clouds += 0.125 * noise(pos * 32.0);
    
    // Add subtle temporal variation
    clouds += 0.1 * sin(time * 0.1 + length(pos) * 10.0);
    
    return smoothstep(0.3, 0.7, clouds);
  }
  
  void main() {
    vec3 pos = normalize(vPosition);
    
    // Base color of gas giant (orange)
    vec3 baseColor = vec3(1.0, 0.647, 0.0); // #FFA500 orange
    
    // Create cloud bands EXACTLY as in Pillow
    float bands = createCloudBands(pos);
    
    // Create surface rings
    float rings = createRings(pos);
    
    // Create cloud formations
    float clouds = createClouds(pos);
    
    // Combine all elements
    vec3 finalColor = baseColor;
    
    // Apply orange bands EXACTLY as in Pillow (255, 165, 0, 1)
    vec3 bandColor = vec3(1.0, 0.647, 0.0); // #FFA500 original orange
    finalColor = mix(finalColor, bandColor * 1.2, bands * 0.8); // More opacity for better visibility
    
    // Apply rings (darken)
    finalColor *= (1.0 - rings * 0.5);
    
    // Apply clouds (lighter tone)
    finalColor += clouds * vec3(0.3, 0.2, 0.1);
    
    // Add storm variation (red) in certain zones
    float stormZone = smoothstep(0.7, 1.0, noise(pos * 4.0 + vec3(seed * 0.1)));
    finalColor = mix(finalColor, vec3(0.545, 0.0, 0.0), stormZone * 0.6); // dark red
    
    // Apply basic lighting
    float lighting = dot(vNormal, normalize(vec3(1.0, 1.0, 1.0))) * 0.5 + 0.5;
    finalColor *= lighting;
    
    gl_FragColor = vec4(finalColor, 1.0);
  }
`,Te={async create(i){const{planetMesh:t,planetName:s,planetData:o}=i,a=s.replace(/_/g," "),l=await crypto.subtle.digest("SHA-256",new TextEncoder().encode("1.618033988749895")),c=Array.from(new Uint8Array(l)).map(R=>R.toString(16).padStart(2,"0")).join(""),u=BigInt("0x"+c),f=o.diameter||1e3,j=o.density||5.5,m=o.gravity||9.8,n=`${u.toString()}-${a}-Gas Giant-${f}-${j}-${m}-_safe_shaper`,b=Ce(n),N=new Se(b),r=N.randint(3,20),h=N.uniform(-15,15)*Math.PI/180,p=[],g=[],M=100,P=200;for(let R=0;R<r;R++){const w=N.randint(2,4),Z=1-2*(N.randint(P-M,P+M)-100)/200;p.push(Z),g.push(w/M)}for(;p.length<20;)p.push(0),g.push(0);const y=new Ft({vertexShader:Ae,fragmentShader:Re,uniforms:{time:{value:0},seed:{value:b*.001},planetColor:{value:new Ot(1,.647,0)},numBands:{value:r},rotationAngle:{value:h},bandPositions:{value:p},bandWidths:{value:g}}});t.material=y;const C=o.rotation_period_seconds||86400,D=o.cosmicOriginTime||Date.now()/1e3,A=o.initialAngleRotation||0,I=()=>{const w=Date.now()/1e3-D,k=2*Math.PI/C;return(A+w*k)%(2*Math.PI)},F=()=>{y.uniforms.time.value+=.01,t.rotation.y=I(),requestAnimationFrame(F)};F()}};class vt{seed;constructor(t){this.seed=t}next(){return this.seed=this.seed*16807%2147483647,(this.seed-1)/2147483646}uniform(t,s){return t+(s-t)*this.next()}choice(t){return t[Math.floor(this.next()*t.length)]}}function De(i,t,s,o,a){const{full_ring:d,ontop_ring:l,ring_inner_radius:c,ring_outer_radius:u,tilt_factor:f}=a,j=[...d.particles,...l.particles],m=j.length,n=new vt(a.shape_seed),b=new ct,N=new Float32Array(m*3),r=new Float32Array(m*3),h=new Float32Array(m),p=[{baseGray:.18,variation:.04,name:"dark"},{baseGray:.25,variation:.06,name:"medium"},{baseGray:.32,variation:.06,name:"light"},{baseGray:.25,variation:.08,name:"mixed"}],g=n.choice(p),M=s/a.planet_radius;let P=0;for(let _=0;_<m;_++){const S=j[_];P+=S.distance*M}const y=P/m,C=new vt(a.shape_seed+9999),D=2,A=[],I=256;for(let _=0;_<=I;_++){const S=C.uniform(.5,2.5),Y=D*S;A.push(Y)}for(let _=0;_<m;_++){const S=j[_],Y=s/a.planet_radius,et=a.shape_seed+_,O=new vt(et),U=S.distance*Y,pt=S.angle,st=(u-c)*Y*.4,G=(pt%(2*Math.PI)+2*Math.PI)%(2*Math.PI),B=Math.floor(G/(2*Math.PI)*I),H=A[B],V=U-st*.5,J=U+st*.5,$=O.uniform(V,J),W=pt+O.uniform(-.08,.08),ft=$*Math.cos(W),it=$*Math.sin(W),X=Math.asin(f),K=it*Math.sin(X),ot=it*Math.cos(X),at=K-H,nt=K+H,rt=O.uniform(at,nt),lt=O.uniform(-H*.3,H*.3);N[_*3]=ft,N[_*3+1]=rt,N[_*3+2]=ot+lt,S.color[0]/255;const It=(S.distance-c)/(u-c),Yt=g.baseGray,Mt=g.variation,Gt=O.uniform(-Mt,Mt),Ht=Math.max(.12,Math.min(.45,Yt+Gt)),Zt=.8+It*.4,Ut=O.uniform(.85,1.15),St=O.uniform(0,1),Bt=St<.03?O.uniform(1.1,1.3):1,Vt=Ht*Zt*Ut*Bt,xt=Math.max(.1,Math.min(.55,Vt));r[_*3]=xt,r[_*3+1]=xt,r[_*3+2]=xt;const Wt=O.uniform(1,1.8),Xt=St<.1?O.uniform(1.2,2):1;h[_]=S.size*Wt*Xt}b.setAttribute("position",new bt(N,3)),b.setAttribute("color",new bt(r,3)),b.setAttribute("size",new bt(h,1));const F=new Ft({uniforms:{brightness:{value:2.2}},vertexShader:`
      attribute float size;
      varying vec3 vColor;
      varying float vDistance;
      
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        vDistance = -mvPosition.z;
        
        // Dynamic size based on distance for better depth perception
        gl_PointSize = size * (300.0 / vDistance);
        gl_Position = projectionMatrix * mvPosition;
      }
    `,fragmentShader:`
      uniform float brightness;
      varying vec3 vColor;
      varying float vDistance;
      
      void main() {
        vec2 center = gl_PointCoord - vec2(0.5);
        float distance = length(center);
        
        if (distance > 0.5) discard;
        
        // Create soft circular particle with gentle falloff
        float alpha = (1.0 - distance * 2.0);
        alpha = smoothstep(0.0, 1.0, alpha);
        
        // Add subtle glow effect
        float glow = 1.0 - distance;
        glow = pow(glow, 1.5);
        
        // No sparkle animation - colors should be static
        // Final color with brightness and glow (no time-based changes)
        vec3 finalColor = vColor * brightness * glow;
        
        // Distance-based alpha fade for depth
        float depthAlpha = clamp(200.0 / vDistance, 0.3, 1.0);
        
        gl_FragColor = vec4(finalColor, alpha * depthAlpha);
      }
    `,transparent:!0,vertexColors:!0,depthWrite:!1,blending:ne}),R=new re(b,F);R.position.set(0,0,0),R.renderOrder=1,i.add(R);const k=(()=>{const S=[],Y=f?Math.asin(f):0;for(let G=0;G<=256;G++){const B=G/256*Math.PI*2,H=y*Math.cos(B),V=y*Math.sin(B),J=V*Math.sin(Y),$=V*Math.cos(Y);S.push(new L(H,J,$))}const et=new ct().setFromPoints(S),O=new _t({color:65280,linewidth:3}),U=new yt(et,O);U.position.set(0,0,0),U.renderOrder=1e3,i.add(U);const st=(()=>{const G=[],B=[],H=[],V=f?Math.asin(f):0;for(let K=0;K<=256;K++){const ot=K/256*Math.PI*2,at=A[K],nt=y*Math.cos(ot),rt=y*Math.sin(ot),lt=rt*Math.sin(V),gt=rt*Math.cos(V);B.push(new L(nt,lt+at,gt)),H.push(new L(nt,lt-at,gt))}const J=new ct().setFromPoints(B),$=new _t({color:16711680,linewidth:5}),W=new yt(J,$);W.position.set(0,0,0),W.renderOrder=999,i.add(W),G.push(W);const ft=new ct().setFromPoints(H),it=new _t({color:16711680,linewidth:5}),X=new yt(ft,it);return X.position.set(0,0,0),X.renderOrder=999,i.add(X),G.push(X),G})();return{greenRing:U,redRectangle:st}})(),Z=o.rotation_period_seconds||86400,ht=o.cosmicOriginTime||Date.now()/1e3,mt=o.initialAngleRotation||0,Nt=()=>{const S=Date.now()/1e3-ht,Y=2*Math.PI/Z;return(mt+S*Y)%(2*Math.PI)},ut=Nt();R.rotation.y=ut,k.greenRing.rotation.y=ut,k.redRectangle.forEach(_=>{_.rotation.y=ut});const Et=()=>{const _=Nt();R.rotation.y=_,k.greenRing.rotation.y=_,k.redRectangle.forEach(S=>{S.rotation.y=_}),requestAnimationFrame(Et)};Et()}const ke={async create(i){const{scene:t,planetMesh:s,planetRadius:o,planetData:a,planetName:d}=i;try{const l=await fetch(`/api/planet/${d}/location-data`);if(!l.ok)throw new Error(`API request failed: ${l.status}`);const c=await l.json();if(!c.success)throw new Error(`API error: ${c.error}`);const{universe:u,galaxy:f,system:j,planet:m,rings:n}=c;if(!m.has_rings||!n)return;const b={diameter:m.diameter,density:m.density,gravity:m.gravity,mass:m.mass,orbital_radius_m:m.orbital_radius_m,rotation_period_seconds:m.rotation_period_seconds,surface_temperature:m.surface_temperature,axial_tilt:m.axial_tilt,cosmicOriginTime:u.cosmic_origin_time,initialAngleRotation:m.initial_angle_rotation};De(t,s,o,b,n)}catch{}}},Le=({planetType:i="Rocky",planetName:t="Planet",planetData:s,cosmicOriginTime:o,initialAngleRotation:a,system:d,galaxy:l})=>{const c=v.useRef(null),u=v.useRef(null);return v.useEffect(()=>{if(!c.current)return;const f=c.current,j=300,m=300,n=new le;n.background=new Ot(17);const b={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},N=75,r=new ce(50,j/m,.1,1e3);r.position.set(0,0,250),r.lookAt(0,0,0);const h=new de({antialias:!0,alpha:!0});h.setSize(j,m),h.setClearColor(17,1),f.appendChild(h.domElement);const p=new fe(r,h.domElement);p.enableDamping=!0,p.dampingFactor=.05,p.enableZoom=!0,p.minDistance=100,p.maxDistance=500,p.enablePan=!1;const g=new Rt(N,32,32),M=b[i]||"#808080",P=new he({color:M,transparent:!0,opacity:.9}),y=new Tt(g,P);n.add(y);const C=new Tt(new Rt(N*1.2,32,32),new me({color:M,transparent:!0,opacity:.1}));y.add(C),i==="Gas Giant"&&s&&Te.create({scene:n,planetMesh:y,planetRadius:N,planetData:{diameter:s.diameter||1e3,density:s.density||5.5,gravity:s.gravity||9.8,mass:s.mass||5972e21,orbital_radius_m:(s.orbital_radius||1)*1496e8,rotation_period_seconds:s.rotation_period_seconds||86400,surface_temperature:s.surface_temperature||273,axial_tilt:s.axial_tilt||0,seed:s.seed||0,cosmicOriginTime:o,initialAngleRotation:a},planetName:t}).catch(F=>{}),s&&s.mass&&s.orbital_radius&&s.rotation_period_seconds&&s.surface_temperature&&s.axial_tilt!==void 0&&ke.create({scene:n,planetMesh:y,planetRadius:N,planetData:{diameter:s.diameter||1e3,density:s.density||5.5,gravity:s.gravity||9.8,mass:s.mass,orbital_radius_m:s.orbital_radius*1496e8,rotation_period_seconds:s.rotation_period_seconds,surface_temperature:s.surface_temperature,axial_tilt:s.axial_tilt,seed:s.seed||0,cosmicOriginTime:o,initialAngleRotation:a},planetName:t,system:d,galaxy:l}).catch(F=>{});const D=new ue(8421504,1.5);n.add(D);const A=new Dt(16777215,2,1e3);if(A.position.set(100,100,100),n.add(A),i==="Gas Giant"){const F=new Dt(16777215,1.2,1e3);F.position.set(-100,-100,100),n.add(F)}const I=()=>{u.current=requestAnimationFrame(I),p.update(),h.render(n,r)};return I(),()=>{u.current&&cancelAnimationFrame(u.current),f&&h.domElement&&f.removeChild(h.domElement),h.dispose(),g.dispose(),P.dispose()}},[i,t]),e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Planet Preview"}),e.jsx("div",{ref:c,className:"border border-white/20 rounded bg-black/20",style:{width:"300px",height:"300px"}}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 text-center",children:[e.jsxs("div",{className:"text-[10px] text-gray-500",children:[t," - ",i]}),e.jsx("div",{className:"text-[9px] text-gray-600 mt-1",children:"Drag to rotate • Scroll to zoom"})]})]})},Fe=({planet:i,system:t,galaxy:s,cosmicOriginTime:o,initialAngleRotation:a})=>{const[d,l]=v.useState(!1),c=n=>n.replace(/_/g," "),u=n=>{const b=n/86400;return b<30?`${b.toFixed(2)} days`:b<365?`${(b/30).toFixed(2)} months`:`${(b/365).toFixed(2)} years`},f=n=>{const b=n*9/5+32;return`${n.toFixed(1)}°C (${b.toFixed(1)}°F)`},j=n=>`${n.toExponential(2)} kg`,m=n=>n>=1e3?`${(n/1e3).toFixed(2)} km`:`${n.toFixed(2)} m`;return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}),e.jsxs("div",{className:"flex items-center justify-between mb-3 pr-16",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Planet Information"}),e.jsx(Jt,{type:"planet",name:i.name,coordinates:s.coordinates.join(","),systemIndex:t.index,planetName:i.name,className:"text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300 capitalize",children:i.planet_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Atmosphere"}),e.jsx("div",{className:"text-sm font-bold text-purple-300 capitalize",children:i.atmosphere})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-green-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Life Forms"}),e.jsx("div",{className:"text-sm font-bold text-green-300 capitalize",children:i.life_forms})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-2",children:e.jsx(Le,{planetType:i.planet_type,planetName:i.name,planetData:{diameter:i.diameter,density:i.density,gravity:i.gravity,mass:i.mass,orbital_radius:i.orbital_radius,rotation_period_seconds:i.rotation_period_seconds,surface_temperature:i.surface_temperature,axial_tilt:i.axial_tilt,seed:t.index},cosmicOriginTime:o,initialAngleRotation:a,system:{index:t.index,name:t.name},galaxy:{coordinates:s.coordinates,name:s.name}})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-orange-500/30 mb-3",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Physical Properties"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-orange-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Mass"}),e.jsx("div",{className:"text-xs font-bold text-orange-300",children:j(i.mass)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-orange-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Diameter"}),e.jsx("div",{className:"text-xs font-bold text-orange-300",children:m(i.diameter)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-orange-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Density"}),e.jsxs("div",{className:"text-xs font-bold text-orange-300",children:[i.density.toFixed(2)," kg/m³"]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-orange-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Gravity"}),e.jsxs("div",{className:"text-xs font-bold text-orange-300",children:[i.gravity.toFixed(2)," m/s²"]})]})]})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-cyan-500/30 mb-3",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Orbital Properties"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Radius"}),e.jsxs("div",{className:"text-xs font-bold text-cyan-300",children:[i.orbital_radius.toFixed(2)," AU"]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Period"}),e.jsx("div",{className:"text-xs font-bold text-cyan-300",children:u(i.orbital_period_seconds)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Speed"}),e.jsxs("div",{className:"text-xs font-bold text-cyan-300",children:[i.orbital_speed.toFixed(2)," m/s"]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Tilt"}),e.jsxs("div",{className:"text-xs font-bold text-cyan-300",children:[i.axial_tilt.toFixed(2),"°"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-red-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Surface Conditions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-red-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Temperature"}),e.jsx("div",{className:"text-xs font-bold text-red-300",children:f(i.surface_temperature)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-red-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Rotation"}),e.jsx("div",{className:"text-xs font-bold text-red-300",children:u(i.rotation_period_seconds)})]})]})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"text-xs text-gray-200",children:["Elements (",i.elements.length,")"]}),i.elements.length>4&&e.jsx("button",{onClick:()=>l(!d),className:"text-xs text-yellow-400 hover:text-yellow-300 transition-colors duration-300",children:d?"▲ Less":"▼ All"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(d?i.elements:i.elements.slice(0,4)).map((n,b)=>e.jsx("span",{className:"text-xs bg-yellow-500/20 text-yellow-300 px-1.5 py-0.5 rounded border border-yellow-500/30",children:n},b))})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Planet:"}),e.jsx("div",{className:"text-white truncate font-medium",children:c(i.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"System:"}),e.jsx("div",{className:"text-white truncate font-medium",children:c(t.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"System ID:"}),e.jsxs("div",{className:"text-white font-medium",children:["#",t.index+1]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:c(s.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:s.coordinates.join(", ")})]})]})]})]})},Oe=({planetUrl:i,imageUrl:t,planet:s,cosmicOriginTime:o,initialAngleRotation:a})=>{const d=v.useRef(null),l=v.useRef(null),[c,u]=v.useState("Aligning Stargate..."),[f,j]=v.useState(!1),[m,n]=v.useState(!1),[b,N]=v.useState(!1);return v.useEffect(()=>{const r=document.createElement("style");return r.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(r),()=>{document.head.removeChild(r)}},[]),v.useEffect(()=>{const r=d.current;if(!r)return;const h=r.getContext("2d");if(!h)return;let p=[];const g=800;let M,P;const y=800;let C,D=.5;function A(){const w=r?.parentElement;if(!w||!r)return;const k=w.clientWidth,Z=w.clientHeight;r.width=Math.min(k,y),r.height=Math.min(Z,y),M=r.width/2,P=r.height/2}function I(){A(),p=[];for(let w=0;w<g;w++)p.push({x:Math.random()*(r?.width||800),y:Math.random()*(r?.height||800),z:Math.random()*(r?.width||800),o:Math.random()});F()}function F(){!r||!h||(h.clearRect(0,0,r.width,r.height),p.forEach(w=>{w.z-=D,w.z<=0&&(w.z=r.width,w.x=Math.random()*r.width,w.y=Math.random()*r.height,w.o=Math.random());const k=r.width/w.z,Z=(w.x-M)*k+M,ht=(w.y-P)*k+P,mt=2*k;h.beginPath(),h.fillStyle=`rgba(255, 255, 255, ${w.o})`,h.arc(Z,ht,mt,0,2*Math.PI),h.fill()}),D<60&&(D+=1),C=requestAnimationFrame(F))}I();const R=()=>A();return window.addEventListener("resize",R),()=>{window.removeEventListener("resize",R),C&&cancelAnimationFrame(C)}},[]),v.useEffect(()=>{if(t){console.log("Loading planet image:",t);const r=new Image;r.onload=()=>{console.log("Planet image loaded successfully"),l.current&&(l.current.src=t,n(!0),N(!0))},r.onerror=()=>{console.error("Failed to load planet image:",t),setTimeout(()=>{n(!0),N(!0)},1500)},r.src=t}else console.log("No imageUrl provided, using placeholder"),setTimeout(()=>{n(!0),N(!0)},1500)},[t]),v.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){u("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),j(!0);const h=(y,C)=>Array.from({length:C},()=>y[Math.floor(Math.random()*y.length)]).join(""),p=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:30},{chars:"0123456789ABCDEF",duration:20,iterations:40},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:\\'\",.<>?/`~",duration:10,iterations:100}];let g=0,M=0;const P=()=>{if(g>=p.length){const C="Stargate system aligned";let D=0;u("");const A=()=>{D<C.length?(u(C.substring(0,D+1)),D++,setTimeout(A,30)):j(!1)};A();return}const y=p[g];u(h(y.chars,32)),M++,M>=y.iterations&&(g++,M=0),setTimeout(P,y.duration)};P()},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white mb-3",children:"Planet Visualization"}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx("canvas",{ref:d,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${b?"opacity-0":"opacity-100"}`,style:{filter:b?"blur(50px)":"none"}}),e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${m?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:m&&t?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(te,{zoomMargin:20,classDialog:"backdrop-blur-3xl",children:e.jsx("img",{ref:l,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl shadow-blue-500/20",src:t,alt:"Planet visualization",style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"transparent"}})})}):e.jsx("img",{ref:l,className:"w-full h-full object-cover",src:"/static/images/placeholder-min.jpg",alt:"Planet visualization"})})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:i,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${f?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),c]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},ze=({currentPlanet:i,system:t,galaxy:s,systemPlanets:o})=>{const[a,d]=v.useState(null),[l,c]=v.useState(null),[u,f]=v.useState(!1),[j,m]=v.useState(!1),[n,b]=v.useState(!0);v.useEffect(()=>{if(o&&o.length>0){const h=o.findIndex(p=>p.name.toLowerCase()===i.toLowerCase());h!==-1?(h>0?(d(o[h-1].name.toLowerCase()),f(!0)):t.index>0?(d("__prev_system__"),f(!0)):f(!1),h<o.length-1?(c(o[h+1].name.toLowerCase()),m(!0)):(c("__next_system__"),m(!0))):(f(!1),m(!1))}else f(!1),m(!1);b(!1)},[i,t.index,o]);const N=async()=>{const h=s.coordinates.join(",");if(a==="__prev_system__")try{const p=await fetch(`/system/${t.index-1}`,{headers:{Accept:"application/json"}});if(p.ok){const g=await p.json();if(g.system&&g.system.planets&&g.system.planets.length>0){const P=g.system.planets[g.system.planets.length-1].name.toLowerCase();tt(h,t.index-1,P,g.system.planets),jt(h,t.index-1),window.location.href=`/planet/${P}`;return}}window.location.href=`/system/${t.index-1}`}catch{window.location.href=`/system/${t.index-1}`}else a&&(tt(h,t.index,a,o),window.location.href=`/planet/${a}`)},r=async()=>{const h=s.coordinates.join(",");if(l==="__next_system__")try{const p=await fetch(`/system/${t.index+1}`,{headers:{Accept:"application/json"}});if(p.ok){const g=await p.json();if(g.system&&g.system.planets&&g.system.planets.length>0){const P=g.system.planets[0].name.toLowerCase();tt(h,t.index+1,P,g.system.planets),jt(h,t.index+1),window.location.href=`/planet/${P}`;return}}window.location.href=`/system/${t.index+1}`}catch{window.location.href=`/system/${t.index+1}`}else l&&(tt(h,t.index,l,o),window.location.href=`/planet/${l}`)};return n?null:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:N,disabled:!u,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${u?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:r,disabled:!j,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${j?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},Ie=({planet:i,system:t,galaxy:s,planet_url:o,version:a,image_url:d,cosmic_origin_time:l,initial_angle_rotation:c})=>{const[u]=v.useState(s.coordinates.join(","));v.useEffect(()=>{document.body.setAttribute("data-coordinates",u),document.body.setAttribute("data-system-index",t.index.toString()),document.body.setAttribute("data-planet-name",i.name.toLowerCase()),tt(u,t.index,i.name,t.planets||[]),jt(u,t.index)},[u,t.index,i.name]);const f=n=>n.replace(/_/g," "),j=n=>n.replace(/_/g," "),m=n=>n.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Qt,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["Planet '",f(i.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["in System '",j(t.name),"' - Galaxy '",m(s.name),"'"]}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-400",children:["Coordinates ",s.coordinates.join(", ")]})]}),e.jsx(ze,{currentPlanet:i.name,system:t,galaxy:s,systemPlanets:t.planets||[]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(Oe,{planetUrl:o,imageUrl:d,planet:i,cosmicOriginTime:l,initialAngleRotation:c})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(Fe,{planet:i,system:t,galaxy:s,cosmicOriginTime:l,initialAngleRotation:c})})]})}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href=`/system/${t.index}`,className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsxs("span",{className:"text-base sm:text-lg",children:["← Back to System '",j(t.name),"'"]})})})]}),e.jsx(Kt,{version:a})]}),e.jsx(ee,{currentLocation:{type:"planet",name:i.name,coordinates:s.coordinates.join(","),systemIndex:t.index,planetName:i.name}})]})};console.log("Atlas Planet React script loading...");document.addEventListener("DOMContentLoaded",async()=>{console.log("DOM loaded, starting Planet React app...");try{const i=document.getElementById("planet-data"),t=document.getElementById("system-data"),s=document.getElementById("galaxy-data"),o=document.getElementById("meta-data");if(!i||!t||!s||!o){console.error("Missing required data elements");return}const a=JSON.parse(i.textContent||"{}"),d=JSON.parse(t.textContent||"{}"),l=JSON.parse(s.textContent||"{}"),c=JSON.parse(o.textContent||"{}"),u={planet:a,system:d,galaxy:l,planet_url:c.planet_url,version:c.version,image_url:c.image_url,cosmic_origin_time:c.cosmic_origin_time,initial_angle_rotation:c.initial_angle_rotation},f=document.getElementById("atlas-react-root");f&&($t.createRoot(f).render(qt.createElement(Ie,u)),console.log("Planet React app rendered successfully!"))}catch(i){console.error("Error initializing Planet React app:",i)}});
