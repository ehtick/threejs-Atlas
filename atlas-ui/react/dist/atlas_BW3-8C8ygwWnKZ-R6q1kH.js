import{r,j as e,H as Ve,V as Xe,c as He,R as We}from"./atlas_DVrnBBsgS-kH5xseABxRO.js";import{r as Be,U as $e}from"./atlas_7DKRiMQPznKsckyU1SAMW.js";import{S as Me,C as Ce,P as Re,W as ke,G as Le,c as re,M as oe,d as ie,V as fe,e as De,L as Ae,g as ze,A as Pe,k as Te,h as Ie,i as _e,j as Ge,l as Ee}from"./atlas_JzQmrLPlfVl9nkKnI5Ba8.js";const qe=({planets:o,stars:a,systemName:y,cosmicOriginTime:R,currentTime:k,onTimeOffsetChange:p})=>{const T=r.useRef(null),b=r.useRef(null),w=r.useRef(null),h=r.useRef(null),I=r.useRef([]),_=r.useRef([]),n=r.useRef([]),L=r.useRef(0),H=(F,Y="#ffffff")=>{const S=document.createElement("canvas"),i=S.getContext("2d");if(!i)return null;S.width=768,S.height=192,i.fillStyle="rgba(0, 0, 0, 0.8)",i.fillRect(0,0,S.width,S.height),i.strokeStyle="#ffffff",i.lineWidth=3,i.strokeRect(3,3,S.width-6,S.height-6),i.fillStyle=Y,i.font="bold 48px Arial",i.textAlign="center",i.textBaseline="middle",i.fillText(F,384,96);const l=new Ie(S),v=new _e({map:l,transparent:!0,alphaTest:.1}),D=new Ge(v);return D.scale.set(30,7.5,1),D};return L.current=k,r.useEffect(()=>{if(!T.current)return;const F=T.current,Y=F.clientWidth,S=F.clientHeight,i=new Me;i.background=new Ce(17),b.current=i;const l=new Re(60,Y/S,.1,1e4);l.position.set(0,120,180),l.lookAt(0,0,0);const v=new ke({antialias:!0,alpha:!0});v.setSize(Y,S),v.setClearColor(17,1),w.current=v,F.appendChild(v.domElement);const D={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},ee={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},te=new Le;a.forEach((t,x)=>{const m=parseFloat(t.Size)*4,u=new re(m,32,32),W=ee[t.Color]||"#FFFF44",f=new oe({color:W,transparent:!0,opacity:.9}),A=new ie(u,f);a.length===1?A.position.set(0,0,0):a.length===2?A.position.set(x===0?-m*2:m*2,0,0):x===0?A.position.set(-m*2,0,0):x===1?A.position.set(m*2,0,0):A.position.set(0,m*2,0);const B=new re(m*1.5,32,32),s=new oe({color:W,transparent:!0,opacity:.3}),g=new ie(B,s);A.add(g),te.add(A)}),i.add(te);const K=Math.max(...o.map(t=>t.orbital_radius)),E=150;o.forEach((t,x)=>{const u=30+t.orbital_radius/K*E,W=t.eccentricity_factor,f=u,A=f*Math.sqrt(1-W*W),B=360,s=2,g=4;for(let ae=0;ae<B;ae+=s+g){const xe=[];for(let ne=ae;ne<Math.min(ae+s,B-1);ne++){const me=ne/B*2*Math.PI,X=f*Math.cos(me),Ne=A*Math.sin(me);xe.push(new fe(X,0,Ne))}if(xe.length>1){const ne=new De().setFromPoints(xe),me=new Ae({color:7372944,transparent:!0,opacity:.8,linewidth:2}),X=new ze(ne,me);i.add(X),_.current.push(X)}}const C=t.diameter/8e3,z=Math.max(Math.min(C,8),2.5),U=new re(z,32,32),q=D[t.planet_type]||"#FFFFFF",V=new oe({color:q,transparent:!0,opacity:.9}),P=new ie(U,V),se=new ie(new re(z*1.5,32,32),new oe({color:q,transparent:!0,opacity:.2}));P.add(se),i.add(P),I.current.push(P),P.planetData=t,P.orbitRadius=u,P.semiMajorAxis=f,P.semiMinorAxis=A;const le=t.name.replace(/_/g," "),J=H(le,"#ffffff");J&&(J.position.copy(P.position),J.position.y+=z+10,J.planetData=t,i.add(J),n.current.push(J))});const $=new Pe(4210752,.4);i.add($);const Z=new Te(16777215,1,2e3);Z.position.set(0,0,0),i.add(Z);let c=!1,M=0,N=0,d=0;const G=t=>{c=!0,M=t.clientX,N=t.clientY},O=t=>{if(!c)return;const x=t.clientX-M,m=t.clientY-N,u=new Ee;u.setFromVector3(l.position),u.theta-=x*.01,u.phi+=m*.01,u.phi=Math.max(.1,Math.min(Math.PI-.1,u.phi)),l.position.setFromSpherical(u),l.lookAt(0,0,0),M=t.clientX,N=t.clientY},Q=()=>{c=!1,setTimeout(()=>{},3e3)},ge=t=>{if(t.ctrlKey)t.preventDefault(),t.deltaY>0?p(604800):p(-604800);else{t.preventDefault();const x=.1,m=l.position.distanceTo(new fe(0,0,0));t.deltaY>0&&m<800?l.position.multiplyScalar(1+x):t.deltaY<0&&m>50&&l.position.multiplyScalar(1-x)}},he=t=>{t.key==="Escape"&&document.dispatchEvent(new CustomEvent("solar-system-close-fullscreen"))},be=t=>{if(t.preventDefault(),t.touches.length===1)c=!0,M=t.touches[0].clientX,N=t.touches[0].clientY;else if(t.touches.length===2){const x=t.touches[0].clientX-t.touches[1].clientX,m=t.touches[0].clientY-t.touches[1].clientY;d=Math.sqrt(x*x+m*m)}},we=t=>{if(t.preventDefault(),t.touches.length===1&&c){const x=t.touches[0].clientX-M,m=t.touches[0].clientY-N,u=new Ee;u.setFromVector3(l.position),u.theta-=x*.01,u.phi+=m*.01,u.phi=Math.max(.1,Math.min(Math.PI-.1,u.phi)),l.position.setFromSpherical(u),l.lookAt(0,0,0),M=t.touches[0].clientX,N=t.touches[0].clientY}else if(t.touches.length===2){const x=t.touches[0].clientX-t.touches[1].clientX,m=t.touches[0].clientY-t.touches[1].clientY,u=Math.sqrt(x*x+m*m);if(d>0){const f=u/d,A=l.position.distanceTo(new fe(0,0,0));f>1&&A>50?l.position.multiplyScalar(1-.01):f<1&&A<800&&l.position.multiplyScalar(1+.01)}d=u}},ye=t=>{t.preventDefault(),c=!1,d=0,setTimeout(()=>{},3e3)},j=v.domElement;j.style.cursor="grab",j.addEventListener("mousedown",t=>{j.style.cursor="grabbing",G(t)}),j.addEventListener("mousemove",O),j.addEventListener("mouseup",()=>{j.style.cursor="grab",Q()}),j.addEventListener("mouseleave",()=>{j.style.cursor="grab",Q()}),j.addEventListener("wheel",ge),j.addEventListener("touchstart",be,{passive:!1}),j.addEventListener("touchmove",we,{passive:!1}),j.addEventListener("touchend",ye,{passive:!1}),document.addEventListener("keydown",he);const ce=()=>{h.current=requestAnimationFrame(ce),I.current.forEach((t,x)=>{const m=t.planetData,u=t.semiMajorAxis,W=t.semiMinorAxis,f=m.orbital_period_seconds,A=2*Math.PI/f,B=(m.initial_orbital_angle+L.current*A)%(2*Math.PI);t.position.x=u*Math.cos(B),t.position.z=W*Math.sin(B),t.position.y=0;const s=m.rotation_period_seconds,g=2*Math.PI/s;if(t.rotation.y=L.current*g%(2*Math.PI),n.current[x]){const C=t.geometry.parameters?.radius||2;n.current[x].position.copy(t.position),n.current[x].position.y+=C+10}}),v.render(i,l)};ce();const de=()=>{const t=F.clientWidth,x=F.clientHeight;l.aspect=t/x,l.updateProjectionMatrix(),v.setSize(t,x)};return window.addEventListener("resize",de),()=>{window.removeEventListener("resize",de),document.removeEventListener("keydown",he),j.removeEventListener("mousedown",G),j.removeEventListener("mousemove",O),j.removeEventListener("mouseup",Q),j.removeEventListener("mouseleave",Q),j.removeEventListener("wheel",ge),j.removeEventListener("touchstart",be),j.removeEventListener("touchmove",we),j.removeEventListener("touchend",ye),h.current&&cancelAnimationFrame(h.current),F&&v.domElement&&F.removeChild(v.domElement),v.dispose(),I.current=[],_.current=[],n.current=[]}},[o,a,R]),e.jsx("div",{ref:T,className:"w-full h-full"})},Je=({planets:o,stars:a,systemName:y,cosmicOriginTime:R})=>{const k=r.useRef(null),p=r.useRef(null),T=r.useRef(null),b=r.useRef(null),w=r.useRef([]),h=r.useRef([]),I=r.useRef([]),_=r.useRef(0),n=Math.floor(Date.now()/1e3),[L,H]=r.useState(0),[F,Y]=r.useState(!1),[S,i]=r.useState(!1),[l,v]=r.useState(!1),[D,ee]=r.useState(0),te=n-R+L;_.current=te;const K=()=>{i(!0),setTimeout(()=>{Y(!1),i(!1)},300)},E=(c,M="#ffffff")=>{const N=document.createElement("canvas"),d=N.getContext("2d");if(!d)return null;N.width=512,N.height=128,d.fillStyle="rgba(0, 0, 0, 0.7)",d.fillRect(0,0,N.width,N.height),d.strokeStyle="#ffffff",d.lineWidth=2,d.strokeRect(2,2,N.width-4,N.height-4),d.fillStyle=M,d.font="bold 32px Arial",d.textAlign="center",d.textBaseline="middle",d.fillText(c,256,64);const G=new Ie(N),O=new _e({map:G,transparent:!0,alphaTest:.1}),Q=new Ge(O);return Q.scale.set(20,5,1),Q};r.useEffect(()=>{const c=M=>{M.key==="Escape"&&F&&K()};return F&&ee(L),document.addEventListener("solar-system-close-fullscreen",K),document.addEventListener("keydown",c),()=>{document.removeEventListener("solar-system-close-fullscreen",K),document.removeEventListener("keydown",c)}},[F,L]),r.useEffect(()=>{if(F&&l){const c=setTimeout(()=>{v(!1)},50);return()=>clearTimeout(c)}},[F,l]),r.useEffect(()=>{if(!k.current)return;const c=k.current,M=c.clientWidth,N=M<640,d=new Me;d.background=new Ce(17),p.current=d;const G=new Re(45,M/(N?120:140),.1,1e4);G.position.set(0,80,120),G.lookAt(0,0,0);const O=new ke({antialias:!0,alpha:!0});O.setSize(M,N?120:140),O.setClearColor(17,1),T.current=O,c.appendChild(O.domElement);const Q={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},ge={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},he=new Le;a.forEach((s,g)=>{const C=parseFloat(s.Size)*3,z=new re(C,16,16),U=ge[s.Color]||"#FFFF44",q=new oe({color:U,transparent:!0,opacity:.9}),V=new ie(z,q);a.length===1?V.position.set(0,0,0):a.length===2?V.position.set(g===0?-C*2:C*2,0,0):g===0?V.position.set(-C*2,0,0):g===1?V.position.set(C*2,0,0):V.position.set(0,C*2,0);const P=new re(C*1.5,16,16),se=new oe({color:U,transparent:!0,opacity:.3}),le=new ie(P,se);V.add(le),he.add(V)}),d.add(he);const be=Math.max(...o.map(s=>s.orbital_radius)),we=80;o.forEach((s,g)=>{const z=20+s.orbital_radius/be*we,U=s.eccentricity_factor,q=z,V=q*Math.sqrt(1-U*U),P=360,se=2,le=4;for(let ve=0;ve<P;ve+=se+le){const Se=[];for(let pe=ve;pe<Math.min(ve+se,P-1);pe++){const je=pe/P*2*Math.PI,Fe=q*Math.cos(je),Oe=V*Math.sin(je);Se.push(new fe(Fe,0,Oe))}if(Se.length>1){const pe=new De().setFromPoints(Se),je=new Ae({color:7372944,transparent:!0,opacity:.8,linewidth:2}),Fe=new ze(pe,je);d.add(Fe),h.current.push(Fe)}}const J=s.diameter/15e3,ae=Math.max(Math.min(J,4),1.5),xe=new re(ae,16,16),ne=Q[s.planet_type]||"#FFFFFF",me=new oe({color:ne,transparent:!0,opacity:.9}),X=new ie(xe,me),Ne=new ie(new re(ae*1.5,16,16),new oe({color:ne,transparent:!0,opacity:.2}));X.add(Ne),d.add(X),w.current.push(X),X.planetData=s,X.orbitRadius=z,X.semiMajorAxis=q,X.semiMinorAxis=V;const Ye=s.name.replace(/_/g," "),ue=E(Ye,"#ffffff");ue&&(ue.position.copy(X.position),ue.position.y+=ae+6,ue.planetData=s,d.add(ue),I.current.push(ue))});const ye=new Pe(4210752,.4);d.add(ye);const j=new Te(16777215,1,1e3);j.position.set(0,0,0),d.add(j);let ce=!1,de=0,t=0;const x=s=>{ce=!0,de=s.clientX,t=s.clientY},m=s=>{if(!ce)return;const g=s.clientX-de,C=s.clientY-t,z=new Ee;z.setFromVector3(G.position),z.theta-=g*.01,z.phi+=C*.01,z.phi=Math.max(.1,Math.min(Math.PI-.1,z.phi)),G.position.setFromSpherical(z),G.lookAt(0,0,0),de=s.clientX,t=s.clientY},u=()=>{ce=!1,setTimeout(()=>{},3e3)},W=s=>{if(s.ctrlKey)s.preventDefault(),s.deltaY>0?H(g=>g+604800):H(g=>g-604800);else{s.preventDefault();const g=.1,C=G.position.distanceTo(new fe(0,0,0));s.deltaY>0&&C<500?G.position.multiplyScalar(1+g):s.deltaY<0&&C>20&&G.position.multiplyScalar(1-g)}},f=O.domElement;f.style.cursor="grab",f.style.borderRadius="8px",f.addEventListener("mousedown",s=>{f.style.cursor="grabbing",x(s)}),f.addEventListener("mousemove",m),f.addEventListener("mouseup",()=>{f.style.cursor="grab",u()}),f.addEventListener("mouseleave",()=>{f.style.cursor="grab",u()}),f.addEventListener("wheel",W);const A=()=>{b.current=requestAnimationFrame(A),w.current.forEach((s,g)=>{const C=s.planetData,z=s.semiMajorAxis,U=s.semiMinorAxis,q=C.orbital_period_seconds,V=2*Math.PI/q,P=(C.initial_orbital_angle+_.current*V)%(2*Math.PI);s.position.x=z*Math.cos(P),s.position.z=U*Math.sin(P),s.position.y=0;const se=C.rotation_period_seconds,le=2*Math.PI/se;if(s.rotation.y=_.current*le%(2*Math.PI),I.current[g]){const J=s.geometry.parameters?.radius||2;I.current[g].position.copy(s.position),I.current[g].position.y+=J+6}}),O.render(d,G)};A();const B=()=>{const s=c.clientWidth,g=s<640?120:140;G.aspect=s/g,G.updateProjectionMatrix(),O.setSize(s,g)};return window.addEventListener("resize",B),()=>{window.removeEventListener("resize",B),f.removeEventListener("mousedown",x),f.removeEventListener("mousemove",m),f.removeEventListener("mouseup",u),f.removeEventListener("mouseleave",u),f.removeEventListener("wheel",W),b.current&&cancelAnimationFrame(b.current),c&&O.domElement&&c.removeChild(O.domElement),O.dispose(),w.current=[],h.current=[],I.current=[]}},[o,a,R]);const $=c=>{const M=Math.floor(c/31557600),N=Math.floor(c%(365.25*24*3600)/(24*3600)),d=Math.floor(c%(24*3600)/3600);return M>0?`${M}y ${N}d ${d}h`:N>0?`${N}d ${d}h`:`${d}h`},Z=c=>c.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Solar System Simulation"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:k,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsxs("button",{onClick:()=>{Y(!0),v(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 flex items-center gap-1 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:[e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),e.jsx("span",{className:"text-xs text-white hidden sm:inline",children:"Expand"})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-[10px]",children:[o.length," Planets"]})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Time: ",$(te)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View"})]})]}),F&&Be.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${S||l?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${S||l?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"sm:hidden flex-1 min-w-0",children:e.jsx("h2",{className:"text-sm font-bold text-white truncate",children:Z(y)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 md:gap-4 min-w-0 flex-1",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white truncate",children:Z(y)}),e.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[o.length," Planets"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Time: ",$(n-R+D)]})]})]}),e.jsx("button",{onClick:K,className:"p-1 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300 flex-shrink-0",title:"Close (ESC)",children:e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2 sm:mb-4 px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"-15y"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"range",min:-15*365.25*24*3600,max:15*365.25*24*3600,step:604800,value:D,onChange:c=>ee(Number(c.target.value)),className:`w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer 
                               [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 
                               [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-400 
                               [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-600
                               [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg`}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-2 bg-yellow-400 rounded"})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"+15y"}),e.jsx("button",{onClick:()=>ee(0),className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors duration-200",title:"Reset to current time",children:"Now"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-1",children:["Time Travel: ",D===0?"Present":D>0?`+${Math.abs(D/(365.25*24*3600)).toFixed(1)} years`:`-${Math.abs(D/(365.25*24*3600)).toFixed(1)} years`," • Range: 30 years"]})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(qe,{planets:o,stars:a,systemName:y,cosmicOriginTime:R,currentTime:n-R+D,onTimeOffsetChange:c=>ee(M=>M+c)})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},Ke=({system:o,galaxy:a,systemIndex:y,cosmicOriginTime:R})=>{const k=p=>p.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white mb-3",children:"System Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"System Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300 capitalize",children:o.star_system_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Planets"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:o.num_planets})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-orange-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Stars"}),e.jsx("div",{className:"text-sm font-bold text-orange-300",children:o.stars.length})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-3",children:e.jsx(Je,{planets:o.planets,stars:o.stars,systemName:o.name,cosmicOriginTime:R})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-yellow-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Stellar Composition"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1",children:o.stars.map((p,T)=>e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-yellow-500/20",children:[e.jsxs("div",{className:"text-xs text-gray-300",children:["Star ",T+1]}),e.jsx("div",{className:"text-xs font-bold text-yellow-300",children:p.Type}),e.jsxs("div",{className:"text-xs text-gray-300",children:[p.Color," • ",p.Size]})]},T))})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"System:"}),e.jsx("div",{className:"text-white truncate font-medium",children:k(o.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"System ID:"}),e.jsxs("div",{className:"text-white font-medium",children:["#",y+1]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:k(a.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:a.coordinates.join(", ")})]})]})]})]})},Ze=({systemUrl:o,imageUrl:a})=>{const y=r.useRef(null),R=r.useRef(null),[k,p]=r.useState("Aligning Stargate..."),[T,b]=r.useState(!1),[w,h]=r.useState(!1),[I,_]=r.useState(!1);return r.useEffect(()=>{const n=document.createElement("style");return n.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(n),()=>{document.head.removeChild(n)}},[]),r.useEffect(()=>{const n=y.current;if(!n)return;const L=n.getContext("2d");if(!L)return;let H=[];const F=800;let Y,S;const i=800;let l,v=.5;function D(){const E=n?.parentElement;if(!E||!n)return;const $=E.clientWidth,Z=E.clientHeight;n.width=Math.min($,i),n.height=Math.min(Z,i),Y=n.width/2,S=n.height/2}function ee(){D(),H=[];for(let E=0;E<F;E++)H.push({x:Math.random()*(n?.width||800),y:Math.random()*(n?.height||800),z:Math.random()*(n?.width||800),o:Math.random()});te()}function te(){!n||!L||(L.clearRect(0,0,n.width,n.height),H.forEach(E=>{E.z-=v,E.z<=0&&(E.z=n.width,E.x=Math.random()*n.width,E.y=Math.random()*n.height,E.o=Math.random());const $=n.width/E.z,Z=(E.x-Y)*$+Y,c=(E.y-S)*$+S,M=2*$;L.beginPath(),L.fillStyle=`rgba(255, 255, 255, ${E.o})`,L.arc(Z,c,M,0,2*Math.PI),L.fill()}),v<60&&(v+=1),l=requestAnimationFrame(te))}ee();const K=()=>D();return window.addEventListener("resize",K),()=>{window.removeEventListener("resize",K),l&&cancelAnimationFrame(l)}},[]),r.useEffect(()=>{if(a){console.log("Loading system image:",a);const n=new Image;n.onload=()=>{console.log("System image loaded successfully"),R.current&&(R.current.src=a,h(!0),_(!0))},n.onerror=()=>{console.error("Failed to load system image:",a),setTimeout(()=>{h(!0),_(!0)},1500)},n.src=a}else console.log("No imageUrl provided, using placeholder"),setTimeout(()=>{h(!0),_(!0)},1500)},[a]),r.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){p("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),b(!0);const L=(i,l)=>Array.from({length:l},()=>i[Math.floor(Math.random()*i.length)]).join(""),H=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:30},{chars:"0123456789ABCDEF",duration:20,iterations:40},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:\\'\",.<>?/`~",duration:10,iterations:100}];let F=0,Y=0;const S=()=>{if(F>=H.length){const l="Stargate system aligned";let v=0;p("");const D=()=>{v<l.length?(p(l.substring(0,v+1)),v++,setTimeout(D,30)):b(!1)};D();return}const i=H[F];p(L(i.chars,32)),Y++,Y>=i.iterations&&(F++,Y=0),setTimeout(S,i.duration)};S()},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white mb-3",children:"System Visualization"}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx("canvas",{ref:y,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${I?"opacity-0":"opacity-100"}`,style:{filter:I?"blur(50px)":"none"}}),e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${w?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:w&&a?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx($e,{zoomMargin:20,classDialog:"backdrop-blur-3xl",children:e.jsx("img",{ref:R,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl shadow-blue-500/20",src:a,alt:"System visualization",style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"transparent"}})})}):e.jsx("img",{ref:R,className:"w-full h-full object-cover",src:"/static/images/placeholder-min.jpg",alt:"System visualization"})})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:o,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${T?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),k]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},Qe=({planets:o,coordinates:a,systemIndex:y})=>{const[R,k]=r.useState(new Set);r.useEffect(()=>{(()=>{try{const _=(JSON.parse(localStorage.getItem("atlasHistoricalData")||"{}")[a]||{})[y.toString()]||[],n=new Set;_.forEach(L=>{n.add(L.toLowerCase())}),k(n)}catch(h){console.error("Error loading historical data:",h)}})(),(()=>{try{let h=JSON.parse(localStorage.getItem("atlasHistoricalData")||"{}");h[a]||(h[a]={}),h[a][y.toString()]||(h[a][y.toString()]=[]),localStorage.setItem("atlasHistoricalData",JSON.stringify(h))}catch(h){console.error("Error saving historical data:",h)}})()},[a,y]);const p=b=>b.replace(/_/g," "),T=b=>{try{let w=JSON.parse(localStorage.getItem("atlasHistoricalData")||"{}");w[a]||(w[a]={}),w[a][y.toString()]||(w[a][y.toString()]=[]);const h=b.toLowerCase();w[a][y.toString()].includes(h)||(w[a][y.toString()].push(h),localStorage.setItem("atlasHistoricalData",JSON.stringify(w)))}catch(w){console.error("Error marking planet as visited:",w)}window.location.href=`/planet/${b.toLowerCase()}`};return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:o.map(b=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[R.has(b.name.toLowerCase())&&e.jsx("div",{className:"absolute left-0 top-0 w-1 h-full bg-cyan-400 rounded-l-lg opacity-100 transition-opacity duration-300",style:{background:"linear-gradient(180deg, #00d4ff 0%, #00a0ff 100%)"}}),e.jsxs("button",{onClick:()=>T(b.name),className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Planet"}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:p(b.name)})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},b.name))}),o.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No planets found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This system appears to be empty"})]})]})},Ue=({system:o,galaxy:a,system_url:y,version:R,system_index:k,image_url:p,page:T,cosmic_origin_time:b})=>{const[w]=r.useState(a.coordinates.join(","));r.useEffect(()=>{document.body.setAttribute("data-coordinates",w),document.body.setAttribute("data-system-index",k.toString())},[w,k]);const h=_=>_.replace(/_/g," "),I=_=>_.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Ve,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["System '",h(o.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Galaxy '",I(a.name),"' - Coordinates ",a.coordinates.join(", ")]})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(Ze,{systemUrl:y,imageUrl:p})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(Ke,{system:o,galaxy:a,systemIndex:k,cosmicOriginTime:b})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Planets in '",h(o.name),"'"]}),e.jsx(Qe,{planets:o.planets,coordinates:w,systemIndex:k})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${T}`,className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsxs("span",{className:"text-base sm:text-lg",children:["← Back to Galaxy '",I(a.name),"'"]})})})]}),e.jsx(Xe,{version:R})]})]})};console.log("Atlas System React script loading...");document.addEventListener("DOMContentLoaded",async()=>{console.log("DOM loaded, starting System React app...");try{const o=document.getElementById("system-data"),a=document.getElementById("galaxy-data"),y=document.getElementById("meta-data");if(!o||!a||!y){console.error("Missing required data elements");return}const R=JSON.parse(o.textContent||"{}"),k=JSON.parse(a.textContent||"{}"),p=JSON.parse(y.textContent||"{}"),T={system:R,galaxy:k,system_url:p.system_url,version:p.version,system_index:p.system_index,image_url:p.image_url,page:p.page||1,cosmic_origin_time:p.cosmic_origin_time},b=document.getElementById("atlas-react-root");b&&(He.createRoot(b).render(We.createElement(Ue,T)),console.log("System React app rendered successfully!"))}catch(o){console.error("Error initializing System React app:",o)}});
