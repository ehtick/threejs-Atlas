import{r as u,j as e,a as ht,c as dt,R as ut}from"./atlas_BG-O7ORrd1CIuvq6sOIEu.js";import{R as pt,L as ft,g as It,m as Dt,M as At,F as Tt,H as _t,a as Ht}from"./atlas_CTIl86YfmY-J9XHmNj0yu.js";import{W as nt}from"./atlas_DpO-yiEKcG7KgC12H7eV0.js";import{a5 as st,C as Fe,a6 as ot,G as Te,r as xt,cJ as gt,a2 as Je,cK as qe,cL as Ze,b as Re,z as Ge,M as B,V as Ye,B as Ue,cP as vt,o as wt,cM as it,aa as bt,v as yt,cN as Mt,cO as jt,S as Ve,c as St,A as Le,g as ze,x as Qe,D as Ke,H as zt,t as et,m as He,P as tt,Y as Rt,y as Nt}from"./atlas_DUxdE5_5iPCKlmI6uaLFO.js";import{R as Ft,S as Bt,M as Vt,a as rt,D as qt,b as Ut,c as $t}from"./atlas_iDmFNBTphqROmvv0T0wIL.js";import{S as at,a as Wt,b as Yt,E as Ot}from"./atlas_Bs7j-hYuj9bjrJxgurN-A.js";import{O as Ct}from"./atlas_efhr8mvI8-JsNPBr6yH7D.js";import{E as Xt}from"./atlas_Blh4PZGKT2N-5eolC0Mfc.js";import{S as Xe,C as Zt}from"./atlas_DDSSoj9E92tLj4_Dflp4V.js";import{V as Kt}from"./atlas_CMDVgZFw_5MpHeUQOkkoo.js";import{T as Jt,D as Qt}from"./atlas_CsAG_V80tn6Yx5bLipkLB.js";import"./atlas_DTMHG0KBmlmtp0V4aoQDq.js";import"./atlas_DW5pjI1Gho2bvOSJCUCvJ.js";import"./atlas_3UsC9TRh4BQw36DWQTQvf.js";import"./atlas_Ddx12EM2NlAGieodC4Mbs.js";import"./atlas_CXe69HDW-Q8b_kGwXRltZ.js";import"./atlas_BcQIxzMTXA5H4XI7wQTea.js";import"./atlas_B6JdfMn9dk3O0V_iCdH-H.js";import"./atlas_BvkZgjUy2eTYQJUxJafKh.js";import"./atlas_DwuwFN11FKkW9W-qSbC4b.js";import"./atlas_DXxbM-7aAB7VnuJIDA6JJ.js";import"./atlas_xsHv0vB7coQMccOZd3s3R.js";import"./atlas_COXHuPH6U4RqdFNS6ZnQH.js";import"./atlas_CFt29da3TDtSD-67FLQon.js";import"./atlas_DAr9OkH8Nl0YcnQiKXRAN.js";import"./atlas_DeOJ7d4JekybWqg5mI1vR.js";import"./atlas_CQO8D_vmQG9g3x-h0Xcdn.js";import"./atlas_GT-l48vKMnLmWgrB6ilt1.js";import"./atlas_DPTTRueNPjNdMXDyfP3Yj.js";import"./atlas_CUSc1YG4dBjZGLn6nz05g.js";import"./atlas_LFKk3RC0MPyFpMvSQkOzK.js";import"./atlas_DdF2h1HxCC3S7dJ9_pdLh.js";import"./atlas_CgmkPhVfEbaauZkXzZMvI.js";import"./atlas_BFavfWgaQLghCEfrtf4sy.js";import"./atlas_DcZ_AjyXKPio09IorCeCA.js";import"./atlas_Co6-6cgVGMjy8h5buxY_D.js";import"./atlas_YW1g4617flFdT-N4yCgay.js";import"./atlas_DCaj7lYCmFr9SH5gIpM9v.js";import"./atlas_CAVog8sP31bVi0eNU3YSh.js";import"./atlas_2gsiIeHVqLdQ7nCzKZtaN.js";import"./atlas_C27JSAi1L4eGToqA6okz5.js";import"./atlas_BstfOH6iKzwEgrDCcU3Lb.js";import"./atlas_CHoj_io0unDsdItZc4Rhl.js";import"./atlas_Dup6RusAJEW8tHD_-AZIr.js";import"./atlas_Da7CoTH3e6CZJhOdR-tSi.js";import"./atlas_gFn1B_NfbR5WGl359p8Z-.js";import"./atlas_CIyWjbd2RmUXlLJhHEDi-.js";import"./atlas_DgsvWixrwYASKB10Q_9I1.js";import"./atlas_BTe1eU3NiaK1Wqkn_MdCW.js";import"./atlas_DEMD4ZBhmNLJQWQEcEMdc.js";import"./atlas_m9bUE8FKaUj_0GE9fkpus.js";import"./atlas_Dm0Vk96GL4GsDhFt4bwEL.js";import"./atlas_Da_unaAI3MV3oWhwuwwiw.js";import"./atlas_DJIKDqlOHkBZzuGSXWxfm.js";import"./atlas_Bs1gClHIueDo8l7hzH4ZY.js";import"./atlas_BwFYgd6Xmh6T5fpECZPU8.js";import"./atlas_DkFjYze8QTN1Pm0TpaXGA.js";import"./atlas_BxrrkHaZqTkKCnZ7iZerm.js";import"./atlas_DkT3T0GIozVFsBodgrf1C.js";import"./atlas_BqXtcNxNkNqSeDaEsLLdi.js";import"./atlas_BwxSxQZka5uryG3lY0qLJ.js";import"./atlas_wDTLgLc4G6CWhO37jOxnj.js";import"./atlas_DzUyPTXTqDzhnz2wTxk_-.js";import"./atlas_DG1F-dkmy70Ud9YOxN9Af.js";import"./atlas_CAoCde4-uAOnb2oSJcDWO.js";import"./atlas_3ElUoMOkVD0zPg7l7aBvI.js";import"./atlas_bFvvjsZ1hxE0whXXO4Bj9.js";import"./atlas_CntGewpi1NWhKdxg4EDl-.js";import"./atlas_DaoVGBY9LOtoye_b4JYlg.js";const en=({coordinates:a,galaxyName:M})=>{const F=u.useRef(null),D=u.useRef(null),T=u.useRef(null),G=u.useRef(null);return u.useEffect(()=>{if(!F.current)return;const J=F.current,A=J.clientWidth,Se=J.clientHeight,O=new st;O.background=new Fe(657930),D.current=O;const V=new ot(45,A/Se,.1,1e3);V.position.set(20,15,20),V.lookAt(0,0,0);const $=new nt({antialias:!0,alpha:!0});$.setSize(A,Se),$.setClearColor(0,.2),T.current=$,J.appendChild($.domElement);const b=0,L=1e7,N=5e6,[ee,j,ce]=a,_=((ee-b)/(L-b)-.5)*16,Z=((j-b)/(L-b)-.5)*16,Ne=((ce-b)/(L-b)-.5)*16,q=new Te;O.add(q);const oe=new xt(16,16,16),de=new gt(oe),ge=new Je({color:16777215,opacity:.4,transparent:!0,linewidth:2}),fe=new qe(de,ge);q.add(fe);const me=new Ze(16,16,16777215,16777215);me.material.opacity=.1,me.material.transparent=!0,me.position.y=-8,q.add(me);const ie=new Ze(16,16,16777215,16777215);ie.material.opacity=.05,ie.material.transparent=!0,ie.rotation.z=Math.PI/2,ie.position.x=-8,q.add(ie);const C=new Ze(16,16,16777215,16777215);C.material.opacity=.05,C.material.transparent=!0,C.rotation.x=Math.PI/2,C.position.z=-8,q.add(C);const _e=new Re(.5,32,32),Ce=new Ge({color:16777215,transparent:!0,opacity:.9}),xe=new B(_e,Ce);xe.position.set(0,0,0),q.add(xe);const he=new B(new Re(.8,32,32),new Ge({color:16777215,transparent:!0,opacity:.2}));xe.add(he);const v=new Re(.4,32,32),w=new Ge({color:6605055,transparent:!0,opacity:1}),X=new B(v,w);X.position.set(_,Z,Ne),q.add(X);const Me=new B(new Re(.7,32,32),new Ge({color:6605055,transparent:!0,opacity:.3}));if(X.add(Me),Math.sqrt(Math.pow(ee-N,2)+Math.pow(j-N,2)+Math.pow(ce-N,2))<2e6){const r=[new Ye(0,0,0),new Ye(_,Z,Ne)],S=new Ue().setFromPoints(r),h=new vt({color:16762980,dashSize:.6,gapSize:.6,opacity:.4,transparent:!0,linewidth:2}),H=new wt(S,h);H.computeLineDistances(),q.add(H)}const pe=new it(4210752,.6);O.add(pe);const se=new bt(16777215,.8);se.position.set(10,10,10),O.add(se);const te=(r,S)=>{const h=document.createElement("canvas"),H=h.getContext("2d");if(!H)return null;h.width=64,h.height=64,H.fillStyle=`#${S.toString(16).padStart(6,"0")}`,H.font="bold 48px Arial",H.textAlign="center",H.textBaseline="middle",H.fillText(r,32,32);const k=new yt(h),R=new Mt({map:k,transparent:!0,opacity:.8}),K=new jt(R);return K.scale.set(1.6,1.6,1),K},W=te("X",16739179);W&&(W.position.set(8.4,-7.6,-7.6),q.add(W));const p=te("Y",7077739);p&&(p.position.set(-7.6,8.4,-7.6),q.add(p));const l=te("Z",7039999);l&&(l.position.set(-7.6,-7.6,8.4),q.add(l));let n=!1,s=0,i=0,x=!0,m=0;const y=r=>{n=!0,x=!1,s=r.clientX,i=r.clientY},Q=r=>{if(!n)return;const S=r.clientX-s,h=r.clientY-i;q.rotation.y+=S*.01,q.rotation.x+=h*.01,s=r.clientX,i=r.clientY},Y=()=>{n=!1,setTimeout(()=>{n||(x=!0)},3e3)},E=r=>{r.preventDefault();const S=.1,h=V.position.distanceTo(new Ye(0,0,0));r.deltaY>0&&h<50?V.position.multiplyScalar(1+S):r.deltaY<0&&h>10&&V.position.multiplyScalar(1-S)},re=r=>{r.key==="Escape"&&document.dispatchEvent(new CustomEvent("universe-close-fullscreen"))},U=r=>{if(r.preventDefault(),r.touches.length===1)n=!0,x=!1,s=r.touches[0].clientX,i=r.touches[0].clientY;else if(r.touches.length===2){const S=r.touches[0].clientX-r.touches[1].clientX,h=r.touches[0].clientY-r.touches[1].clientY;m=Math.sqrt(S*S+h*h)}},ne=r=>{if(r.preventDefault(),r.touches.length===1&&n){const S=r.touches[0].clientX-s,h=r.touches[0].clientY-i;q.rotation.y+=S*.01,q.rotation.x+=h*.01,s=r.touches[0].clientX,i=r.touches[0].clientY}else if(r.touches.length===2){const S=r.touches[0].clientX-r.touches[1].clientX,h=r.touches[0].clientY-r.touches[1].clientY,H=Math.sqrt(S*S+h*h);if(m>0){const R=H/m,K=V.position.distanceTo(new Ye(0,0,0));R>1&&K>10?V.position.multiplyScalar(1-.01):R<1&&K<50&&V.position.multiplyScalar(1+.01)}m=H}},c=r=>{r.preventDefault(),n=!1,m=0,setTimeout(()=>{n||(x=!0)},3e3)},t=$.domElement;t.style.cursor="grab",t.addEventListener("mousedown",r=>{t.style.cursor="grabbing",y(r)}),t.addEventListener("mousemove",Q),t.addEventListener("mouseup",()=>{t.style.cursor="grab",Y()}),t.addEventListener("mouseleave",()=>{t.style.cursor="grab",Y()}),t.addEventListener("wheel",E),t.addEventListener("touchstart",U,{passive:!1}),t.addEventListener("touchmove",ne,{passive:!1}),t.addEventListener("touchend",c,{passive:!1}),document.addEventListener("keydown",re);const o=()=>{G.current=requestAnimationFrame(o),x&&(q.rotation.y+=.002,q.rotation.x+=.001);const r=Date.now()*.005;xe.scale.setScalar(1+Math.sin(r)*.1),X.rotation.y+=.01,$.render(O,V)};o();const g=()=>{const r=J.clientWidth,S=J.clientHeight;V.aspect=r/S,V.updateProjectionMatrix(),$.setSize(r,S)};return window.addEventListener("resize",g),()=>{window.removeEventListener("resize",g),document.removeEventListener("keydown",re),t.removeEventListener("mousedown",y),t.removeEventListener("mousemove",Q),t.removeEventListener("mouseup",Y),t.removeEventListener("mouseleave",Y),t.removeEventListener("wheel",E),t.removeEventListener("touchstart",U),t.removeEventListener("touchmove",ne),t.removeEventListener("touchend",c),G.current&&cancelAnimationFrame(G.current),J&&$.domElement&&J.removeChild($.domElement),$.dispose(),oe.dispose(),de.dispose(),ge.dispose(),_e.dispose(),Ce.dispose(),v.dispose(),w.dispose()}},[a,M]),e.jsx("div",{ref:F,className:"w-full h-full"})},tn=({coordinates:a,galaxyName:M})=>{const F=u.useRef(null),D=u.useRef(null),T=u.useRef(null),G=u.useRef(null),[J,A]=u.useState(!1),[Se,O]=u.useState(!1),[V,$]=u.useState(!1),b=()=>{O(!0),setTimeout(()=>{A(!1),O(!1)},300)};u.useEffect(()=>{const _=Z=>{Z.key==="Escape"&&J&&b()};return document.addEventListener("universe-close-fullscreen",b),document.addEventListener("keydown",_),()=>{document.removeEventListener("universe-close-fullscreen",b),document.removeEventListener("keydown",_)}},[J]),u.useEffect(()=>{if(J&&V){const _=setTimeout(()=>{$(!1)},50);return()=>clearTimeout(_)}},[J,V]),u.useEffect(()=>{if(!F.current)return;const _=F.current,Z=_.clientWidth,Ne=Z<640,q=new st;q.background=new Fe(657930),D.current=q;const oe=new ot(30,Z/120,.1,1e3);oe.position.set(12,8,12),oe.lookAt(0,0,0);const de=new nt({antialias:!0,alpha:!0});de.setSize(Z,120),de.setClearColor(0,.2),T.current=de,_.appendChild(de.domElement);const ge=0,fe=1e7,me=5e6,[ie,C,_e]=a,Ce=((ie-ge)/(fe-ge)-.5)*8,xe=((C-ge)/(fe-ge)-.5)*8,he=((_e-ge)/(fe-ge)-.5)*8,v=new Te;q.add(v);const w=new xt(8,8,8),X=new gt(w),Me=new Je({color:16777215,opacity:.4,transparent:!0}),ve=new qe(X,Me);v.add(ve);const pe=new Ze(8,8,16777215,16777215);pe.material.opacity=.1,pe.material.transparent=!0,pe.position.y=-4,v.add(pe);const se=new Ze(8,8,16777215,16777215);se.material.opacity=.05,se.material.transparent=!0,se.rotation.z=Math.PI/2,se.position.x=-4,v.add(se);const te=new Ze(8,8,16777215,16777215);te.material.opacity=.05,te.material.transparent=!0,te.rotation.x=Math.PI/2,te.position.z=-4,v.add(te);const W=new Re(.25,16,16),p=new Ge({color:16777215,transparent:!0,opacity:.9}),l=new B(W,p);l.position.set(0,0,0),v.add(l);const n=new B(new Re(.45,16,16),new Ge({color:16777215,transparent:!0,opacity:.2}));l.add(n);const s=new Re(.2,16,16),i=new Ge({color:6605055,transparent:!0,opacity:1}),x=new B(s,i);x.position.set(Ce,xe,he),v.add(x);const m=new B(new Re(.35,16,16),new Ge({color:6605055,transparent:!0,opacity:.3}));if(x.add(m),Math.sqrt(Math.pow(ie-me,2)+Math.pow(C-me,2)+Math.pow(_e-me,2))<2e6){const d=[new Ye(0,0,0),new Ye(Ce,xe,he)],z=new Ue().setFromPoints(d),f=new vt({color:16762980,dashSize:.3,gapSize:.3,opacity:.4,transparent:!0}),P=new wt(z,f);P.computeLineDistances(),v.add(P)}const Q=new it(4210752,.6);q.add(Q);const Y=new bt(16777215,.8);Y.position.set(5,5,5),q.add(Y);const E=(d,z)=>{const f=document.createElement("canvas"),P=f.getContext("2d");if(!P)return null;f.width=32,f.height=32,P.fillStyle=`#${z.toString(16).padStart(6,"0")}`,P.font="bold 24px Arial",P.textAlign="center",P.textBaseline="middle",P.fillText(d,16,16);const I=new yt(f),ae=new Mt({map:I,transparent:!0,opacity:.8}),ue=new jt(ae);return ue.scale.set(.8,.8,1),ue},re=E("X",16739179);re&&(re.position.set(4.2,-3.8,-3.8),v.add(re));const U=E("Y",7077739);U&&(U.position.set(-3.8,4.2,-3.8),v.add(U));const ne=E("Z",7039999);ne&&(ne.position.set(-3.8,-3.8,4.2),v.add(ne));let c=!1,t=0,o=0,g=!0;const r=d=>{c=!0,g=!1,t=d.clientX,o=d.clientY},S=d=>{if(!c)return;const z=d.clientX-t,f=d.clientY-o;v.rotation.y+=z*.01,v.rotation.x+=f*.01,t=d.clientX,o=d.clientY},h=()=>{c=!1,setTimeout(()=>{c||(g=!0)},3e3)},H=d=>{d.preventDefault();const z=.1,f=oe.position.distanceTo(new Ye(0,0,0));d.deltaY>0&&f<25?oe.position.multiplyScalar(1+z):d.deltaY<0&&f>5&&oe.position.multiplyScalar(1-z)},k=de.domElement;k.style.cursor="grab",k.style.borderRadius="8px",k.addEventListener("mousedown",d=>{k.style.cursor="grabbing",r(d)}),k.addEventListener("mousemove",S),k.addEventListener("mouseup",()=>{k.style.cursor="grab",h()}),k.addEventListener("mouseleave",()=>{k.style.cursor="grab",h()}),k.addEventListener("wheel",H);const R=()=>{G.current=requestAnimationFrame(R),g&&(v.rotation.y+=.002,v.rotation.x+=.001);const d=Date.now()*.005;l.scale.setScalar(1+Math.sin(d)*.1),x.rotation.y+=.01,de.render(q,oe)};R();const K=()=>{const d=_.clientWidth,z=d<640?150:160;oe.aspect=d/z,oe.updateProjectionMatrix(),de.setSize(d,z)};return window.addEventListener("resize",K),()=>{window.removeEventListener("resize",K),k.removeEventListener("mousedown",r),k.removeEventListener("mousemove",S),k.removeEventListener("mouseup",h),k.removeEventListener("mouseleave",h),k.removeEventListener("wheel",H),G.current&&cancelAnimationFrame(G.current),_&&de.domElement&&_.removeChild(de.domElement),de.dispose(),w.dispose(),X.dispose(),Me.dispose(),W.dispose(),p.dispose(),s.dispose(),i.dispose()}},[a,M]);const L=_=>_.replace(/_/g," "),N=_=>_>=1e6?`${(_/1e6).toFixed(1)}M`:_>=1e3?`${(_/1e3).toFixed(1)}K`:_.toString(),[ee,j,ce]=a;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Galaxy Location"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:F,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsx("button",{onClick:()=>{A(!0),$(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-[10px]",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:L(M)})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[N(ee),", ",N(j),", ",N(ce)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Drag: Rotate View"})]})]}),J&&ht.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${Se||V?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${Se||V?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:L(M)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[L(M)," - Galaxy Location"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Galaxy"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[N(ee),", ",N(j),", ",N(ce)]})]})]}),e.jsx("button",{onClick:b,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(en,{coordinates:a,galaxyName:M})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},nn=({galaxy:a})=>{const[M,F]=u.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});u.useEffect(()=>{let T;const G=()=>{const O=rt.generateLocationId("galaxy",a.coordinates.join(","),void 0,void 0),V=rt.canCollectFromLocation(O),$=rt.getTimeUntilNextCollection(O),b=a.coordinates,L=at.generateGalaxyUrl(b,at.getCurrentPage()),ee=ft.getLocations().some(j=>j.stargateUrl===L);F(j=>({isOnCooldown:!V&&$>0,isSaved:ee,isCollecting:j.isCollecting,timeUntilNext:$}))},J=()=>{F(O=>({...O,isCollecting:!0})),T=setTimeout(()=>{F(O=>({...O,isCollecting:!1}))},1e3)};G();const A=setInterval(G,1e3),Se=pt.subscribe("mining_completed",J);return()=>{clearInterval(A),T&&clearTimeout(T),Se()}},[a.name,a.coordinates]);const D=T=>T.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(Ft,{locationType:"galaxy",locationId:a.name,coordinates:a.coordinates.join(","),className:"text-xs"}),e.jsx(Bt,{type:"galaxy",name:a.name,coordinates:a.coordinates.join(","),className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Vt,{isOnCooldown:M.isOnCooldown,isSaved:M.isSaved,isCollecting:M.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300",children:a.galaxy_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Solar Systems"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:a.num_systems.toLocaleString()})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-2",children:e.jsx(tn,{coordinates:a.coordinates,galaxyName:a.name})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-gray-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Cosmic Objects"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-pink-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Black Holes"}),e.jsx("div",{className:"text-xs font-bold text-pink-300",children:a.black_holes.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Pulsars"}),e.jsx("div",{className:"text-xs font-bold text-cyan-300",children:a.pulsars.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-indigo-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Quasars"}),e.jsx("div",{className:"text-xs font-bold text-indigo-300",children:a.quasars.toLocaleString()})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:D(a.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:a.coordinates.join(", ")})]})]})]})]})},Et=u.forwardRef(({galaxyType:a,numSystems:M,blackHoles:F,pulsars:D,quasars:T,seed:G=12345,onExpandClick:J,galaxyName:A,galaxyUrl:Se},O)=>{const V=u.useRef(null),$=u.useRef(null),b=u.useRef(null),L=u.useRef(null),N=u.useRef(null),ee=u.useRef(null),j=u.useRef(null),ce=u.useRef(!1),[_,Z]=u.useState(!1),[Ne,q]=u.useState(!1),[oe,de]=u.useState(!1),ge=u.useRef(null),fe=u.useRef(null),me=u.useRef(.002),ie=u.useRef(.002),C=u.useRef(!1),_e=u.useRef(0),Ce=u.useRef(!1);u.useImperativeHandle(O,()=>({captureScreenshot:he,isGeneratingImage:oe}));class xe{seed;constructor(w){this.seed=w}random(){const w=Math.sin(this.seed++)*1e4;return w-Math.floor(w)}uniform(w,X){return w+this.random()*(X-w)}gauss(w,X){let Me=0,ve=0;for(;Me===0;)Me=this.random();for(;ve===0;)ve=this.random();const pe=Math.sqrt(-2*Math.log(Me))*Math.cos(2*Math.PI*ve);return w+X*pe}randint(w,X){return Math.floor(this.uniform(w,X+1))}}u.useEffect(()=>{const v=j.current;if(!v)return;const w=v.getContext("2d");if(!w)return;let X=[];const Me=800;let ve,pe;const se=800;let te,W=.5;function p(){const i=v?.parentElement;if(!i||!v)return;const x=i.clientWidth,m=i.clientHeight;v.width=Math.min(x,se),v.height=Math.min(m,se),ve=v.width/2,pe=v.height/2}function l(){p(),X=[];for(let i=0;i<Me;i++)X.push({x:Math.random()*(v?.width||800),y:Math.random()*(v?.height||800),z:Math.random()*(v?.width||800),o:Math.random()});n()}function n(){!v||!w||(w.clearRect(0,0,v.width,v.height),X.forEach(i=>{i.z-=W,i.z<=0&&(i.z=v.width,i.x=Math.random()*v.width,i.y=Math.random()*v.height,i.o=Math.random());const x=v.width/i.z,m=(i.x-ve)*x+ve,y=(i.y-pe)*x+pe,Q=2*x;w.beginPath(),w.fillStyle=`rgba(255, 255, 255, ${i.o})`,w.arc(m,y,Q,0,2*Math.PI),w.fill()}),!ce.current&&W<60&&(W+=1),ce.current&&W>2&&(W-=2),te=requestAnimationFrame(n))}l();const s=()=>p();return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),te&&cancelAnimationFrame(te)}},[]),u.useEffect(()=>{if(!V.current)return;const v=V.current,w=v.clientWidth,X=v.clientHeight,Me=Math.min(w,X),ve=new st;ve.background=new Fe(17),$.current=ve;const pe=new ot(45,1,.1,1e4);pe.position.set(0,200,400),pe.lookAt(0,0,0),ge.current=pe;const se=new nt({antialias:!0,alpha:!0});se.setSize(Me,Me),se.setClearColor(17,1),b.current=se,se.domElement.className="",v.appendChild(se.domElement);const te=new Ct(pe,se.domElement);te.enableDamping=!0,te.dampingFactor=.05,te.minDistance=50,te.maxDistance=800,te.autoRotate=!1,te.enablePan=!0,te.enableZoom=!0,te.target.set(0,0,0),N.current=te,te.addEventListener("start",()=>{fe.current&&clearTimeout(fe.current),Ce.current=!0,me.current=0,C.current=!1}),te.addEventListener("end",()=>{Ce.current=!1,fe.current=setTimeout(()=>{C.current=!0,_e.current=performance.now(),me.current=0},3e3)});const W=new Te;ee.current=W,ve.add(W);const p=new xe(G),l=p.uniform(0,2*Math.PI),n=new Ue,s=[],i=[],x=[],m=200;let y=M;if(a==="Spiral"){y=Math.min(M,5e4);const c=4,t=2*Math.PI/c,o=.15,g=.5,r=.1;for(let S=0;S<y*r;S++){const h=p.uniform(0,2*Math.PI),H=p.gauss(m*.1,m*.05),k=p.gauss(0,5),R=H*Math.cos(h),K=H*Math.sin(h);s.push(R,k,K),i.push(1,1,1);const d=G+S*1337,z=new xe(d),f=z.gauss(1,.3),P=z.random()<.05,I=z.random()<.3;let ae=Math.max(.3,f);P&&(ae*=3+z.uniform(0,2)),I&&(ae*=.5+z.uniform(0,.3)),H<m*.2&&(ae*=1.8+z.uniform(0,.7),i[i.length-3]=1.2,i[i.length-2]=1.1,i[i.length-1]=.9),x.push(Math.min(ae*1.5,12))}for(let S=0;S<y;S++){const h=g*Math.sqrt(S/y)*2*Math.PI,H=S%c*t,k=m*Math.sqrt(S/y),R=k*Math.cos(h+H+l)+p.uniform(-o*k,o*k),K=k*Math.sin(h+H+l)+p.uniform(-o*k,o*k),d=p.gauss(0,3);s.push(R,d,K),i.push(1,1,.8);const z=G+S*1337,f=new xe(z),P=f.gauss(.8,.25),I=f.random()<.03,ae=f.random()<.4;let ue=Math.max(.2,P);I&&(ue*=2.5+f.uniform(0,1.5)),ae&&(ue*=.4+f.uniform(0,.2)),k>m*.7&&(ue*=.8),x.push(Math.min(ue*1.3,8))}}else if(a==="Elliptical"){y=Math.min(M,1e5);for(let c=0;c<y;c++){const t=p.uniform(0,2*Math.PI),o=p.uniform(-1,1),g=Math.sqrt(1-o*o),r=p.random(),S=Math.pow(r,.6),h=-Math.log(1-S*.98)*m*.35,H=h*g*Math.cos(t),k=h*o*.6,R=h*g*Math.sin(t);s.push(H,k,R),i.push(1,.9,.7);const K=G+c*1337,d=new xe(K),z=d.gauss(.6,.2),f=d.random()<.08,P=d.random()<.25;let I=Math.max(.2,z);f&&(I*=2+d.uniform(0,1)),P&&(I*=.6+d.uniform(0,.2)),Math.sqrt(H*H+k*k+R*R)<m*.3&&(I*=1.5+d.uniform(0,.5)),x.push(Math.min(I*1.4,7))}}else if(a==="Dwarf"){let c;M<=1500?c=1:M<=5e3?c=1+(M-1500)/3500*9:M<=15e3?c=10+(M-5e3)/1e4*40:c=50+Math.min((M-15e3)/35e3,1)*50,y=Math.min(Math.floor(M/c),1e4);for(let t=0;t<y;t++){const o=p.uniform(0,2*Math.PI),g=p.uniform(0,Math.PI),r=p.gauss(m/3,m*.3),S=r*Math.sin(g)*Math.cos(o),h=r*Math.cos(g)*.5,H=r*Math.sin(g)*Math.sin(o);s.push(S,h,H),i.push(.8,.8,1);const k=G+t*1337,R=new xe(k),K=R.gauss(.7,.3),d=R.random()<.02,z=R.random()<.6;let f=Math.max(.3,K);d&&(f*=2.5+R.uniform(0,1)),z&&(f*=.5+R.uniform(0,.3)),x.push(Math.min(f*1.2,5))}}else if(a==="Singularity Void"){y=1e4;for(let be=0;be<y;be++){const je=be/y,ye=je*30*Math.PI,Pe=m*(1-je*.8)+p.uniform(-10,10),Ee=(je-.5)*300+Math.sin(ye*.5)*20,De=Pe*Math.cos(ye)+Math.sin(je*20)*10,Ae=Pe*Math.sin(ye)+Math.cos(je*20)*10;s.push(De,Ee,Ae);const Ie=(je+Math.sin(ye*.1))%1,ke=new Fe;ke.setHSL(Ie,1,.5+Math.sin(je*10)*.3),i.push(ke.r,ke.g,ke.b),x.push(p.uniform(.3,2)*(1+Math.sin(je*50)*.5))}const c=(be,je,ye=1)=>{const Pe=new Re(be,64,64),Ee=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,De=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;

          void main() {
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);

            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;

            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;

            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x +
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);

            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;

            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);

            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;

            gl_FragColor = vec4(color, ${je});
          }
        `,Ae=new Ve({uniforms:{time:{value:0},speed:{value:ye}},vertexShader:Ee,fragmentShader:De,transparent:!0,blending:Le,side:Ke,depthWrite:!1}),Ie=new B(Pe,Ae);return Ie.isSingularityShader=!0,Ie.shaderSpeed=ye,Ie},t=c(250,.3,1);W.add(t);const o=c(180,.4,-.7);W.add(o);const g=c(120,.5,1.5);W.add(g);const r=c(300,.2,.5);r.scale.set(-1,1,1),W.add(r);const S=new Re(350,32,32),h=new Ve({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);


            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;

            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;

          void main() {

            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;

            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;

            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Le,side:St,depthWrite:!1}),H=new B(S,h);H.isSingularityShader=!0,H.shaderSpeed=.3,W.add(H);const k=new Ue,R=[],K=[];for(let be=0;be<1e3;be++){const je=p.uniform(-m,m),ye=p.uniform(-m/2,m/2),Pe=p.uniform(-m,m),Ee=p.uniform(-50,50),De=p.uniform(-30,30),Ae=p.uniform(-50,50);R.push(je,ye,Pe),R.push(je+Ee,ye+De,Pe+Ae);const Ie=p.random(),ke=new Fe;ke.setHSL(Ie,1,.6),K.push(ke.r,ke.g,ke.b),K.push(ke.r*.5,ke.g*.5,ke.b*.5)}k.setAttribute("position",new ze(R,3)),k.setAttribute("color",new ze(K,3));const d=new Je({vertexColors:!0,transparent:!0,opacity:.4,blending:Le}),z=new qe(k,d);z.isGlitchLines=!0,W.add(z);const f=new Te,P=new Re(20,32,32),I=new Ge({color:0,transparent:!0,opacity:.95}),ae=new B(P,I);f.add(ae);const ue=new Qe(25,80,64),we=new Ve({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;

          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);


            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;


            vec3 hotColor = vec3(1.0, 0.5, 0.0);
            vec3 coldColor = vec3(0.0, 0.3, 1.0);
            vec3 color = mix(coldColor, hotColor, intensity);


            color *= (0.7 + swirl * 0.3);


            float alpha = intensity * 0.8;

            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Le,side:Ke}),le=new B(ue,we);le.rotation.x=Math.PI/2,le.isAccretionDisk=!0,f.add(le);for(let be=0;be<8;be++){const je=30+be*20,ye=new zt(je,1+be*.5,8,64),Pe=new Ge({color:new Fe().setHSL((.7+be*.05)%1,1,.5),transparent:!0,opacity:.3-be*.03,wireframe:!0}),Ee=new B(ye,Pe);Ee.rotation.x=p.uniform(0,Math.PI),Ee.rotation.y=p.uniform(0,Math.PI),Ee.isDistortionRing=!0,Ee.rotationSpeed=p.uniform(.001,.005)*(be%2===0?1:-1),f.add(Ee)}W.add(f);const Oe=new et(5,100,8),$e=new He({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:Le}),We=new B(Oe,$e);We.position.y=50,W.add(We);const Be=new B(Oe,$e);Be.position.y=-50,Be.rotation.z=Math.PI,W.add(Be)}const Q=[],Y=new xe(G+999);for(let c=0;c<F;c++){const t=Y.uniform(-50,50),o=Y.uniform(-20,20),g=Y.uniform(-50,50),r=Y.uniform(.5,1);Q.push({x:t,y:o,z:g,sizeMultiplier:r})}if(a!=="Singularity Void"){const c=[],t=[],o=[],g=[],r=[];for(let R=0;R<s.length;R+=3){const K=s[R],d=s[R+1],z=s[R+2];let f=1/0,P=null;for(const I of Q){const ae=Math.sqrt(Math.pow(K-I.x,2)+Math.pow(d-I.y,2)+Math.pow(z-I.z,2));ae<f&&(f=ae,P=I)}if(!(f<.4))if(f<10&&P){const I=1-(f-.4)/9.6;P.x-K,P.y-d,P.z-z;const ae=Math.atan2(z-P.z,K-P.x),ue=I*.8,we=8;for(let ye=0;ye<we-1;ye++){const Pe=ye/(we-1),Ee=(ye+1)/(we-1),De=f*(1-Pe*ue*.7),Ae=ae+Pe*ue*1.5,Ie=P.x+De*Math.cos(Ae),ke=d+(P.y-d)*Pe*.3,kt=P.z+De*Math.sin(Ae),ct=f*(1-Ee*ue*.7),lt=ae+Ee*ue*1.5,Pt=P.x+ct*Math.cos(lt),Lt=d+(P.y-d)*Ee*.3,Gt=P.z+ct*Math.sin(lt);g.push(Ie,ke,kt),g.push(Pt,Lt,Gt)}const le=I*1.5,Oe=i[R],$e=i[R+1],We=i[R+2],Be=Math.min(Oe+le,2),be=Math.max($e*(1-le*.6),.1),je=Math.max(We*(1-le*.8),.1);for(let ye=0;ye<we-1;ye++){const Pe=ye/(we-1),Ee=(ye+1)/(we-1),De=1-Pe*I*.6,Ae=1-Ee*I*.6,Ie=le*(.5+Pe*.5),ke=le*(.5+Ee*.5);r.push(Math.min(Be+Ie*.3,2)*De,Math.max(be*(1-Ie*.2),.1)*De,Math.max(je*(1-Ie*.4),.1)*De),r.push(Math.min(Be+ke*.3,2)*Ae,Math.max(be*(1-ke*.2),.1)*Ae,Math.max(je*(1-ke*.4),.1)*Ae)}c.push(K,d,z),t.push(Be,be,je),o.push(Math.max(x[R/3]*(1-I*.5),.3))}else c.push(K,d,z),t.push(i[R],i[R+1],i[R+2]),o.push(x[R/3])}n.setAttribute("position",new ze(c,3)),n.setAttribute("color",new ze(t,3)),n.setAttribute("size",new ze(o,1));const H=new Ve({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (400.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {

            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);

            if (distanceFromCenter > 0.5) {
              discard;
            }


            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);

            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:Le,vertexColors:!0,depthWrite:!1}),k=new tt(n,H);if(W.add(k),g.length>0){const R=new Ue;R.setAttribute("position",new ze(g,3)),R.setAttribute("color",new ze(r,3));const K=new Je({vertexColors:!0,transparent:!0,opacity:.8,linewidth:2,blending:Le}),d=new qe(R,K);W.add(d)}}else{n.setAttribute("position",new ze(s,3)),n.setAttribute("color",new ze(i,3)),n.setAttribute("size",new ze(x,1));const c=new Rt({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:Le,sizeAttenuation:!0}),t=new tt(n,c);W.add(t)}for(let c=0;c<F;c++){const t=new Te,o=a!=="Singularity Void"&&c<Q.length?Q[c]:{x:p.uniform(-50,50),y:p.uniform(-20,20),z:p.uniform(-50,50),sizeMultiplier:p.uniform(.5,1)},{x:g,y:r,z:S,sizeMultiplier:h}=o,H=new Re(.8*h,16,16),k=new Ge({color:0,transparent:!0,opacity:.9}),R=new B(H,k);t.add(R),[{innerRadius:1.2*h,outerRadius:1.5*h,color:16777215,opacity:.8,emissive:16777164},{innerRadius:1.5*h,outerRadius:1.8*h,color:16755200,opacity:.7,emissive:16746496},{innerRadius:1.8*h,outerRadius:2.2*h,color:16729088,opacity:.6,emissive:16720384},{innerRadius:2.2*h,outerRadius:2.8*h,color:11141120,opacity:.5,emissive:6684672},{innerRadius:2.8*h,outerRadius:3.5*h,color:4456448,opacity:.3,emissive:2228224}].forEach((d,z)=>{const f=new Qe(d.innerRadius,d.outerRadius,32),P=new He({color:d.color,transparent:!0,opacity:d.opacity,emissive:d.emissive,emissiveIntensity:.3,side:Ke}),I=new B(f,P);I.rotation.x=Math.PI/2,I.rotation.z=p.uniform(0,Math.PI*2),I.isAccretionRing=!0,I.rotationSpeed=.002+z*5e-4,t.add(I)}),t.position.set(g,r,S),W.add(t)}for(let c=0;c<D;c++){const t=p.uniform(.6,1),o=new Re(t,8,8),g=new He({color:16776960,emissive:16776960,emissiveIntensity:1}),r=new B(o,g);r.position.set(p.uniform(-m,m),p.uniform(-m/4,m/4),p.uniform(-m,m)),r.isPulsar=!0,r.pulseSpeed=p.uniform(1,3),W.add(r)}for(let c=0;c<T;c++){const t=new Te,o=p.uniform(.8,1.3),g=new Re(o,16,16),r=new He({color:16777215,emissive:16777215,emissiveIntensity:2}),S=new B(g,r);t.add(S);const h=new et(.5*o,12*o,8),H=new He({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),k=new B(h,H);k.position.y=6*o,t.add(k);const R=new B(h,H);R.position.y=-6*o,R.rotation.z=Math.PI,t.add(R),t.position.set(p.uniform(-m,m),p.uniform(-m/4,m/4),p.uniform(-m,m)),W.add(t)}const E=new it(4210752,.5);ve.add(E);const re=new Nt(16777215,.5,1e3);re.position.set(0,100,0),ve.add(re);const U=()=>{L.current=requestAnimationFrame(U);const c=performance.now()/1e3;if(ee.current&&!Ce.current){if(C.current){const o=performance.now()-_e.current,g=3e3;if(o<g){const r=o/g,S=r*r*r;me.current=ie.current*S}else me.current=ie.current,C.current=!1}ee.current.rotation.y+=me.current}W.children.forEach(t=>{if(t.isPulsar){const o=t.pulseSpeed||1;t.scale.setScalar(1+Math.sin(Date.now()*.001*o)*.3)}if(t.isSingularityShader&&t instanceof B){const o=t.material;o.uniforms&&o.uniforms.time&&(o.uniforms.time.value=c);const g=t.shaderSpeed||1;t.rotation.y+=.001*g,t.rotation.x+=5e-4*g}if(t.isAccretionDisk&&t instanceof B){const o=t.material;o.uniforms&&o.uniforms.time&&(o.uniforms.time.value=c),t.rotation.z+=.002}if(t.isDistortionRing){const o=t.rotationSpeed||.001;t.rotation.x+=o,t.rotation.y+=o*.7,t.scale.setScalar(1+Math.sin(c*2)*.1)}if(t.isGlitchLines&&t instanceof qe){const o=t.material;o.opacity=.2+Math.sin(c*3)*.2,t.rotation.z+=5e-4}t instanceof Te&&t.children.forEach(o=>{if(o.isAccretionDisk&&o instanceof B){const g=o.material;g.uniforms&&g.uniforms.time&&(g.uniforms.time.value=c),o.rotation.z+=.002}if(o.isAccretionRing&&o instanceof B){const g=o.rotationSpeed||.002;o.rotation.z+=g}if(o.isDistortionRing){const g=o.rotationSpeed||.001;o.rotation.x+=g,o.rotation.y+=g*.7,o.scale.setScalar(1+Math.sin(c*2)*.1)}})}),N.current&&N.current.update(),se.render(ve,pe)};U(),setTimeout(()=>{Z(!0),q(!0),ce.current=!0},800);const ne=()=>{if(!V.current||!se)return;const c=V.current,t=Math.min(c.clientWidth,c.clientHeight);se.setSize(t,t),pe.aspect=1,pe.updateProjectionMatrix()};return window.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),fe.current&&clearTimeout(fe.current),N.current&&N.current.dispose(),L.current&&cancelAnimationFrame(L.current),v&&se.domElement&&v.removeChild(se.domElement),se.dispose()}},[a,M,F,D,T,G]);const he=()=>{if(!b.current||!$.current||!ge.current||oe)return;de(!0),N.current&&(N.current.enabled=!1);const v=b.current,w=$.current,X=ge.current,Me=v.domElement.width,ve=v.domElement.height,pe=3840/Me,se=[];w.traverse(p=>{if(p.isPoints&&p.material){const l=p.material;if(l.size!==void 0&&(se.push({material:l,originalSize:l.size}),l.size=l.size*pe*1),l.uniforms&&l.uniforms.scale&&(se.push({material:l,originalScale:l.uniforms.scale.value}),l.uniforms.scale.value=l.uniforms.scale.value*pe*1),p.geometry&&p.geometry.attributes.size){const n=p.geometry.attributes.size,s=n.array.slice();se.push({geometry:p.geometry,originalSizeArray:s});for(let i=0;i<n.array.length;i++)n.array[i]*=pe*1;n.needsUpdate=!0}}});const te=3840,W=3840;v.setSize(te,W),X.aspect=1,X.updateProjectionMatrix(),v.render(w,X),v.domElement.toBlob(p=>{if(p){const l=document.createElement("canvas"),n=l.getContext("2d");if(l.width=te,l.height=W,n){const s=new Image;s.onload=async()=>{n.drawImage(s,0,0),Wt(n,{imageWidth:te,imageHeight:W}),Se&&await Yt(n,te,W,{type:"galaxy",stargateUrl:Se}),l.toBlob(x=>{if(x){const m=URL.createObjectURL(x),y=document.createElement("a");y.href=m,y.download=`galaxy_${A||a}_${Date.now()}.jpg`,y.click(),URL.revokeObjectURL(m)}},"image/jpeg",1)};const i=URL.createObjectURL(p);s.src=i}}se.forEach(({material:l,originalSize:n,originalScale:s,geometry:i,originalSizeArray:x})=>{if(n!==void 0&&(l.size=n),s!==void 0&&(l.uniforms.scale.value=s),i&&x){const m=i.attributes.size;for(let y=0;y<x.length;y++)m.array[y]=x[y];m.needsUpdate=!0}}),v.setSize(Me,ve),X.aspect=1,X.updateProjectionMatrix(),N.current&&(N.current.enabled=!0),de(!1)},"image/jpeg",1)};return e.jsxs("div",{className:"relative w-full h-full bg-black rounded",children:[e.jsx("canvas",{ref:j,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${Ne?"opacity-0":"opacity-100"}`,style:{filter:Ne?"blur(50px)":"none"}}),e.jsxs("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${_?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:[e.jsx("div",{ref:V,className:"w-full h-full border border-white/20 rounded bg-black/20"}),e.jsx(Ot,{isVisible:oe}),_&&A&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:A})}),_&&e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 z-10",children:[e.jsx("button",{onClick:he,disabled:oe,className:`p-2 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg ${oe?"bg-black/40 cursor-not-allowed opacity-50":"bg-black/60 hover:bg-black/80"}`,title:oe?"Generating image...":"Download 4K screenshot",children:oe?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(qt,{className:"w-4 h-4 text-white"})}),J&&e.jsx("button",{onClick:J,disabled:oe,className:`p-2 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg ${oe?"bg-black/40 cursor-not-allowed opacity-50":"bg-black/60 hover:bg-black/80"}`,title:oe?"Please wait...":"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]})]})]})});Et.displayName="Galaxy3DViewer";const sn=({galaxyType:a,numSystems:M,blackHoles:F,pulsars:D,quasars:T,seed:G=12345,galaxyName:J})=>{const A=u.useRef(null),Se=u.useRef(null),O=u.useRef(null),V=u.useRef(null),$=u.useRef(null),b=u.useRef(null),L=u.useRef(null),N=u.useRef(.002),ee=u.useRef(.002),j=u.useRef(!1),ce=u.useRef(0),_=u.useRef(!1);class Z{seed;constructor(q){this.seed=q}random(){const q=Math.sin(this.seed++)*1e4;return q-Math.floor(q)}uniform(q,oe){return q+this.random()*(oe-q)}gauss(q,oe){let de=0,ge=0;for(;de===0;)de=this.random();for(;ge===0;)ge=this.random();const fe=Math.sqrt(-2*Math.log(de))*Math.cos(2*Math.PI*ge);return q+oe*fe}randint(q,oe){return Math.floor(this.uniform(q,oe+1))}}return u.useEffect(()=>{if(!A.current)return;const Ne=A.current,q=Ne.clientWidth,oe=Ne.clientHeight,de=new st;de.background=new Fe(17),Se.current=de;const ge=new ot(45,q/oe,.1,1e4);ge.position.set(0,200,400),ge.lookAt(0,0,0);const fe=new nt({antialias:!0,alpha:!0});fe.setSize(q,oe),fe.setClearColor(17,1),O.current=fe,Ne.appendChild(fe.domElement);const me=new Ct(ge,fe.domElement);me.enableDamping=!0,me.dampingFactor=.05,me.minDistance=50,me.maxDistance=1200,me.autoRotate=!1,me.enablePan=!0,me.enableZoom=!0,me.target.set(0,0,0),$.current=me,me.addEventListener("start",()=>{L.current&&clearTimeout(L.current),_.current=!0,N.current=0,j.current=!1}),me.addEventListener("end",()=>{_.current=!1,L.current=setTimeout(()=>{j.current=!0,ce.current=performance.now(),N.current=0},3e3)});const ie=new Te;b.current=ie,de.add(ie);const C=new Z(G),_e=C.uniform(0,2*Math.PI),Ce=new Ue,xe=[],he=[],v=[],w=200;let X=M;if(a==="Spiral"){X=Math.min(M,5e4);const l=4,n=2*Math.PI/l,s=.15,i=.5,x=.1;for(let m=0;m<X*x;m++){const y=C.uniform(0,2*Math.PI),Q=C.gauss(w*.1,w*.05),Y=C.gauss(0,5),E=Q*Math.cos(y),re=Q*Math.sin(y);xe.push(E,Y,re),he.push(1,1,1);const U=G+m*1337,ne=new Z(U),c=ne.gauss(1,.3),t=ne.random()<.05,o=ne.random()<.3;let g=Math.max(.3,c);t&&(g*=3+ne.uniform(0,2)),o&&(g*=.5+ne.uniform(0,.3)),Q<w*.2&&(g*=1.8+ne.uniform(0,.7),he[he.length-3]=1.2,he[he.length-2]=1.1,he[he.length-1]=.9),v.push(Math.min(g*1.5,12))}for(let m=0;m<X;m++){const y=i*Math.sqrt(m/X)*2*Math.PI,Q=m%l*n,Y=w*Math.sqrt(m/X),E=Y*Math.cos(y+Q+_e)+C.uniform(-s*Y,s*Y),re=Y*Math.sin(y+Q+_e)+C.uniform(-s*Y,s*Y),U=C.gauss(0,3);xe.push(E,U,re),he.push(1,1,.8);const ne=G+m*1337,c=new Z(ne),t=c.gauss(.8,.25),o=c.random()<.03,g=c.random()<.4;let r=Math.max(.2,t);o&&(r*=2.5+c.uniform(0,1.5)),g&&(r*=.4+c.uniform(0,.2)),Y>w*.7&&(r*=.8),v.push(Math.min(r*1.3,8))}}else if(a==="Elliptical"){X=Math.min(M,1e5);for(let l=0;l<X;l++){const n=C.uniform(0,2*Math.PI),s=C.uniform(-1,1),i=Math.sqrt(1-s*s),x=C.random(),m=Math.pow(x,.6),y=-Math.log(1-m*.98)*w*.35,Q=y*i*Math.cos(n),Y=y*s*.6,E=y*i*Math.sin(n);xe.push(Q,Y,E),he.push(1,.9,.7);const re=G+l*1337,U=new Z(re),ne=U.gauss(.6,.2),c=U.random()<.08,t=U.random()<.25;let o=Math.max(.2,ne);c&&(o*=2+U.uniform(0,1)),t&&(o*=.6+U.uniform(0,.2)),Math.sqrt(Q*Q+Y*Y+E*E)<w*.3&&(o*=1.5+U.uniform(0,.5)),v.push(Math.min(o*1.4,7))}}else if(a==="Dwarf"){let l;M<=1500?l=1:M<=5e3?l=1+(M-1500)/3500*9:M<=15e3?l=10+(M-5e3)/1e4*40:l=50+Math.min((M-15e3)/35e3,1)*50,X=Math.min(Math.floor(M/l),1e4);for(let n=0;n<X;n++){const s=C.uniform(0,2*Math.PI),i=C.uniform(0,Math.PI),x=C.gauss(w/3,w*.3),m=x*Math.sin(i)*Math.cos(s),y=x*Math.cos(i)*.5,Q=x*Math.sin(i)*Math.sin(s);xe.push(m,y,Q),he.push(.8,.8,1);const Y=G+n*1337,E=new Z(Y),re=E.gauss(.7,.3),U=E.random()<.02,ne=E.random()<.6;let c=Math.max(.3,re);U&&(c*=2.5+E.uniform(0,1)),ne&&(c*=.5+E.uniform(0,.3)),v.push(Math.min(c*1.2,5))}}else if(a==="Singularity Void"){X=1e4;for(let d=0;d<X;d++){const z=d/X,f=z*30*Math.PI,P=w*(1-z*.8)+C.uniform(-10,10),I=(z-.5)*300+Math.sin(f*.5)*20,ae=P*Math.cos(f)+Math.sin(z*20)*10,ue=P*Math.sin(f)+Math.cos(z*20)*10;xe.push(ae,I,ue);const we=(z+Math.sin(f*.1))%1,le=new Fe;le.setHSL(we,1,.5+Math.sin(z*10)*.3),he.push(le.r,le.g,le.b),v.push(C.uniform(.3,2)*(1+Math.sin(z*50)*.5))}const l=(d,z,f=1)=>{const P=new Re(d,64,64),I=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,ae=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;
          
          void main() {
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);
            
            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;
            
            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;
            
            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x + 
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);
            
            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;
            
            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);
            
            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;
            
            gl_FragColor = vec4(color, ${z});
          }
        `,ue=new Ve({uniforms:{time:{value:0},speed:{value:f}},vertexShader:I,fragmentShader:ae,transparent:!0,blending:Le,side:Ke,depthWrite:!1}),we=new B(P,ue);return we.isSingularityShader=!0,we.shaderSpeed=f,we},n=l(250,.3,1);ie.add(n);const s=l(180,.4,-.7);ie.add(s);const i=l(120,.5,1.5);ie.add(i);const x=l(300,.2,.5);x.scale.set(-1,1,1),ie.add(x);const m=new Re(350,32,32),y=new Ve({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            
            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          
          void main() {
            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;
            
            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Le,side:St,depthWrite:!1}),Q=new B(m,y);Q.isSingularityShader=!0,Q.shaderSpeed=.3,ie.add(Q);const Y=new Ue,E=[],re=[];for(let d=0;d<1e3;d++){const z=C.uniform(-w,w),f=C.uniform(-w/2,w/2),P=C.uniform(-w,w),I=C.uniform(-50,50),ae=C.uniform(-30,30),ue=C.uniform(-50,50);E.push(z,f,P),E.push(z+I,f+ae,P+ue);const we=C.random(),le=new Fe;le.setHSL(we,1,.6),re.push(le.r,le.g,le.b),re.push(le.r*.5,le.g*.5,le.b*.5)}Y.setAttribute("position",new ze(E,3)),Y.setAttribute("color",new ze(re,3));const U=new Je({vertexColors:!0,transparent:!0,opacity:.4,blending:Le}),ne=new qe(Y,U);ne.isGlitchLines=!0,ie.add(ne);const c=new Te,t=new Re(20,32,32),o=new Ge({color:0,transparent:!0,opacity:.95}),g=new B(t,o);c.add(g);const r=new Qe(25,80,64),S=new Ve({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;
          
          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);
            
            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;
            
            vec3 hotColor = vec3(1.0, 0.5, 0.0);
            vec3 coldColor = vec3(0.0, 0.3, 1.0);
            vec3 color = mix(coldColor, hotColor, intensity);
            
            color *= (0.7 + swirl * 0.3);
            
            float alpha = intensity * 0.8;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Le,side:Ke}),h=new B(r,S);h.rotation.x=Math.PI/2,h.isAccretionDisk=!0,c.add(h);for(let d=0;d<8;d++){const z=30+d*20,f=new zt(z,1+d*.5,8,64),P=new Ge({color:new Fe().setHSL((.7+d*.05)%1,1,.5),transparent:!0,opacity:.3-d*.03,wireframe:!0}),I=new B(f,P);I.rotation.x=C.uniform(0,Math.PI),I.rotation.y=C.uniform(0,Math.PI),I.isDistortionRing=!0,I.rotationSpeed=C.uniform(.001,.005)*(d%2===0?1:-1),c.add(I)}ie.add(c);const H=new et(5,100,8),k=new He({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:Le}),R=new B(H,k);R.position.y=50,ie.add(R);const K=new B(H,k);K.position.y=-50,K.rotation.z=Math.PI,ie.add(K)}const Me=[],ve=new Z(G+999);for(let l=0;l<F;l++){const n=ve.uniform(-50,50),s=ve.uniform(-20,20),i=ve.uniform(-50,50),x=ve.uniform(.5,1);Me.push({x:n,y:s,z:i,sizeMultiplier:x})}if(a!=="Singularity Void"){const l=[],n=[],s=[],i=[],x=[];for(let E=0;E<xe.length;E+=3){const re=xe[E],U=xe[E+1],ne=xe[E+2];let c=1/0,t=null;for(const o of Me){const g=Math.sqrt(Math.pow(re-o.x,2)+Math.pow(U-o.y,2)+Math.pow(ne-o.z,2));g<c&&(c=g,t=o)}if(!(c<.4))if(c<10&&t){const o=1-(c-.4)/9.6;t.x-re,t.y-U,t.z-ne;const g=Math.atan2(ne-t.z,re-t.x),r=o*.8,S=8;for(let f=0;f<S-1;f++){const P=f/(S-1),I=(f+1)/(S-1),ae=c*(1-P*r*.7),ue=g+P*r*1.5,we=t.x+ae*Math.cos(ue),le=U+(t.y-U)*P*.3,Oe=t.z+ae*Math.sin(ue),$e=c*(1-I*r*.7),We=g+I*r*1.5,Be=t.x+$e*Math.cos(We),be=U+(t.y-U)*I*.3,je=t.z+$e*Math.sin(We);i.push(we,le,Oe),i.push(Be,be,je)}const h=o*1.5,H=he[E],k=he[E+1],R=he[E+2],K=Math.min(H+h,2),d=Math.max(k*(1-h*.6),.1),z=Math.max(R*(1-h*.8),.1);for(let f=0;f<S-1;f++){const P=f/(S-1),I=(f+1)/(S-1),ae=1-P*o*.6,ue=1-I*o*.6,we=h*(.5+P*.5),le=h*(.5+I*.5);x.push(Math.min(K+we*.3,2)*ae,Math.max(d*(1-we*.2),.1)*ae,Math.max(z*(1-we*.4),.1)*ae),x.push(Math.min(K+le*.3,2)*ue,Math.max(d*(1-le*.2),.1)*ue,Math.max(z*(1-le*.4),.1)*ue)}l.push(re,U,ne),n.push(K,d,z),s.push(Math.max(v[E/3]*(1-o*.5),.3))}else l.push(re,U,ne),n.push(he[E],he[E+1],he[E+2]),s.push(v[E/3])}Ce.setAttribute("position",new ze(l,3)),Ce.setAttribute("color",new ze(n,3)),Ce.setAttribute("size",new ze(s,1));const Q=new Ve({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (400.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {
            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);
            
            if (distanceFromCenter > 0.5) {
              discard;
            }
            
            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);
            
            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:Le,vertexColors:!0,depthWrite:!1}),Y=new tt(Ce,Q);if(ie.add(Y),i.length>0){const E=new Ue;E.setAttribute("position",new ze(i,3)),E.setAttribute("color",new ze(x,3));const re=new Je({vertexColors:!0,transparent:!0,opacity:.8,linewidth:2,blending:Le}),U=new qe(E,re);ie.add(U)}}else{Ce.setAttribute("position",new ze(xe,3)),Ce.setAttribute("color",new ze(he,3)),Ce.setAttribute("size",new ze(v,1));const l=new Rt({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:Le,sizeAttenuation:!0}),n=new tt(Ce,l);ie.add(n)}for(let l=0;l<F;l++){const n=new Te,s=l<Me.length?Me[l]:{x:C.uniform(-50,50),y:C.uniform(-20,20),z:C.uniform(-50,50),sizeMultiplier:C.uniform(.5,1)},{x:i,y:x,z:m,sizeMultiplier:y}=s,Q=new Re(.8*y,16,16),Y=new Ge({color:0,transparent:!0,opacity:.9}),E=new B(Q,Y);n.add(E),[{innerRadius:1.2*y,outerRadius:1.5*y,color:16777215,opacity:.8,emissive:16777164},{innerRadius:1.5*y,outerRadius:1.8*y,color:16755200,opacity:.7,emissive:16746496},{innerRadius:1.8*y,outerRadius:2.2*y,color:16729088,opacity:.6,emissive:16720384},{innerRadius:2.2*y,outerRadius:2.8*y,color:11141120,opacity:.5,emissive:6684672},{innerRadius:2.8*y,outerRadius:3.5*y,color:4456448,opacity:.3,emissive:2228224}].forEach((U,ne)=>{const c=new Qe(U.innerRadius,U.outerRadius,32),t=new He({color:U.color,transparent:!0,opacity:U.opacity,emissive:U.emissive,emissiveIntensity:.3,side:Ke}),o=new B(c,t);o.rotation.x=Math.PI/2,o.rotation.z=C.uniform(0,Math.PI*2),o.isAccretionRing=!0,o.rotationSpeed=.002+ne*5e-4,n.add(o)}),n.position.set(i,x,m),ie.add(n)}for(let l=0;l<D;l++){const n=C.uniform(.6,1),s=new Re(n,8,8),i=new He({color:16776960,emissive:16776960,emissiveIntensity:1}),x=new B(s,i);x.position.set(C.uniform(-w,w),C.uniform(-w/4,w/4),C.uniform(-w,w)),x.isPulsar=!0,x.pulseSpeed=C.uniform(1,3),ie.add(x)}for(let l=0;l<T;l++){const n=new Te,s=C.uniform(.8,1.3),i=new Re(s,16,16),x=new He({color:16777215,emissive:16777215,emissiveIntensity:2}),m=new B(i,x);n.add(m);const y=new et(.5*s,12*s,8),Q=new He({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),Y=new B(y,Q);Y.position.y=6*s,n.add(Y);const E=new B(y,Q);E.position.y=-6*s,E.rotation.z=Math.PI,n.add(E),n.position.set(C.uniform(-w,w),C.uniform(-w/4,w/4),C.uniform(-w,w)),ie.add(n)}const pe=new it(4210752,.5);de.add(pe);const se=new Nt(16777215,.5,1e3);se.position.set(0,100,0),de.add(se);const te=l=>{l.key==="Escape"&&document.dispatchEvent(new CustomEvent("galaxy-close-fullscreen"))};document.addEventListener("keydown",te);const W=()=>{V.current=requestAnimationFrame(W);const l=performance.now()/1e3;if(b.current&&!_.current){if(j.current){const s=performance.now()-ce.current,i=3e3;if(s<i){const x=s/i,m=x*x*x;N.current=ee.current*m}else N.current=ee.current,j.current=!1}b.current.rotation.y+=N.current}ie.children.forEach(n=>{if(n.isPulsar){const s=n.pulseSpeed||1;n.scale.setScalar(1+Math.sin(Date.now()*.001*s)*.3)}if(n.isSingularityShader&&n instanceof B){const s=n.material;s.uniforms&&s.uniforms.time&&(s.uniforms.time.value=l);const i=n.shaderSpeed||1;n.rotation.y+=.001*i,n.rotation.x+=5e-4*i}if(n.isAccretionDisk&&n instanceof B){const s=n.material;s.uniforms&&s.uniforms.time&&(s.uniforms.time.value=l),n.rotation.z+=.002}if(n.isDistortionRing){const s=n.rotationSpeed||.001;n.rotation.x+=s,n.rotation.y+=s*.7,n.scale.setScalar(1+Math.sin(l*2)*.1)}if(n.isGlitchLines&&n instanceof qe){const s=n.material;s.opacity=.2+Math.sin(l*3)*.2,n.rotation.z+=5e-4}n instanceof Te&&n.children.forEach(s=>{if(s.isAccretionDisk&&s instanceof B){const i=s.material;i.uniforms&&i.uniforms.time&&(i.uniforms.time.value=l),s.rotation.z+=.002}if(s.isAccretionRing&&s instanceof B){const i=s.rotationSpeed||.002;s.rotation.z+=i}if(s.isDistortionRing){const i=s.rotationSpeed||.001;s.rotation.x+=i,s.rotation.y+=i*.7,s.scale.setScalar(1+Math.sin(l*2)*.1)}})}),$.current&&$.current.update(),fe.render(de,ge)};W();const p=()=>{if(!A.current||!fe)return;const l=A.current,n=l.clientWidth,s=l.clientHeight;fe.setSize(n,s),ge.aspect=n/s,ge.updateProjectionMatrix()};return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p),document.removeEventListener("keydown",te),L.current&&clearTimeout(L.current),$.current&&$.current.dispose(),V.current&&cancelAnimationFrame(V.current),Ne&&fe.domElement&&Ne.removeChild(fe.domElement),fe.dispose()}},[a,M,F,D,T,G]),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{ref:A,className:"w-full h-full"}),J&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:J})})]})},on=({galaxyUrl:a,galaxyType:M="Spiral",numSystems:F=1e4,blackHoles:D=5,pulsars:T=10,quasars:G=3,galaxyName:J})=>{const[A,Se]=u.useState(!1),[O,V]=u.useState(!1),[$,b]=u.useState(!1),[L,N]=u.useState(!1),[ee,j]=u.useState(!1),ce=u.useRef(null);u.useEffect(()=>{const Z=document.createElement("style");return Z.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(Z),()=>{document.head.removeChild(Z)}},[]);const _=()=>{V(!0),setTimeout(()=>{Se(!1),V(!1)},300)};return u.useEffect(()=>(document.addEventListener("galaxy-close-fullscreen",_),()=>{document.removeEventListener("galaxy-close-fullscreen",_)}),[]),u.useEffect(()=>{if($){const Z=setTimeout(()=>b(!1),50);return()=>clearTimeout(Z)}},[$]),u.useEffect(()=>{const Z=setInterval(()=>{ce.current&&L&&!ce.current.isGeneratingImage&&L&&N(!1)},50);return()=>clearInterval(Z)},[L]),u.useEffect(()=>{const Z=()=>{j(!0)},Ne=pt.subscribe("mining_completed",Z);return()=>{Ne()}},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Galaxy Visualization"})}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx(Et,{ref:ce,galaxyType:M,numSystems:F,blackHoles:D,pulsars:T,quasars:G,galaxyName:J,galaxyUrl:a,onExpandClick:()=>{Se(!0),b(!0)}}),e.jsx(Ut,{isActive:ee,onAnimationComplete:()=>{j(!1)}})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsx($t,{href:a,onTakeScreenshot:()=>{ce.current&&!L&&(N(!0),ce.current.captureScreenshot())},isGeneratingImage:L}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]}),A&&ht.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${O||$?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${O||$?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:"Galaxy View"})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Galaxy Visualization"}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Type: ",M," • Systems: ",F.toLocaleString()]})]})}),e.jsx("button",{onClick:_,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(sn,{galaxyType:M,numSystems:F,blackHoles:D,pulsars:T,quasars:G,galaxyName:J})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},rn=({className:a=""})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 16 16",className:a,children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M3.03 1.97a.75.75 0 0 0-1.06 1.06l.83.83A8.2 8.2 0 0 0 .5 6.876l-.26.585a1.33 1.33 0 0 0 0 1.079l.26.585a8.21 8.21 0 0 0 11.434 3.87l1.036 1.035a.75.75 0 1 0 1.06-1.06zm7.788 9.908l-1.294-1.293a3 3 0 0 1-4.109-4.109L3.866 4.927A6.7 6.7 0 0 0 1.87 7.486L1.641 8l.23.515a6.71 6.71 0 0 0 8.947 3.363M6.55 7.611A1.502 1.502 0 0 0 8.389 9.45zm1.658-2.604l2.784 2.784a3 3 0 0 0-2.784-2.784m5.92 3.508a6.7 6.7 0 0 1-.915 1.496l1.065 1.066A8.2 8.2 0 0 0 15.5 9.125l.26-.585a1.33 1.33 0 0 0 0-1.08l-.26-.584A8.21 8.21 0 0 0 5.572 2.37L6.81 3.61a6.71 6.71 0 0 1 7.32 3.877l.228.514z",clipRule:"evenodd",strokeWidth:"0.5",stroke:"currentColor"})}),an=({systems:a,coordinates:M})=>{const[F,D]=u.useState(new Map);return u.useEffect(()=>{(()=>{try{const G=new Map;a.forEach(J=>{const A=It(M,J.index,J.num_planets||1);G.set(J.index,A)}),D(G)}catch{}})()},[M,a]),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:a.map(T=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[(()=>{const G=F.get(T.index)||"none";return G==="complete"?e.jsx("div",{className:"absolute top-1 right-1 z-10",title:"System fully explored",children:e.jsx(Xt,{className:"text-green-400"})}):G==="partial"?e.jsx("div",{className:"absolute top-1 right-1 z-10",title:"System partially explored",children:e.jsx(rn,{className:"text-yellow-400"})}):null})(),e.jsxs("button",{onClick:()=>window.location.href=`/system/${T.index}`,className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["#",T.number]}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:T.name})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},T.index))}),a.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No systems found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This galaxy appears to be empty"})]})]})},cn=({currentGalaxy:a})=>{const[M,F]=u.useState(!1),[D,T]=u.useState(!1),[G,J]=u.useState(!0),A=1e7;u.useEffect(()=>{const[b,L,N]=a.coordinates,ee=!(b===0&&L===0&&N===0),j=!(b===A&&L===A&&N===A);F(ee),T(j),J(!1)},[a.coordinates]);const Se=()=>{const[b,L,N]=a.coordinates;return N>0?[b,L,N-1]:L>0?[b,L-1,A]:b>0?[b-1,A,A]:[0,0,0]},O=()=>{const[b,L,N]=a.coordinates;return N<A?[b,L,N+1]:L<A?[b,L+1,0]:b<A?[b+1,0,0]:[A,A,A]},V=()=>{if(M){if(!Xe.canAffordTravel("galaxy",1)){Xe.executeTravel("galaxy",1);return}if(!Xe.executeTravel("galaxy",1))return;const[L,N,ee]=Se(),j=document.createElement("form");j.method="POST",j.action="/navigate";const ce=document.createElement("input");ce.type="hidden",ce.name="x",ce.value=L.toString();const _=document.createElement("input");_.type="hidden",_.name="y",_.value=N.toString();const Z=document.createElement("input");Z.type="hidden",Z.name="z",Z.value=ee.toString(),j.appendChild(ce),j.appendChild(_),j.appendChild(Z),document.body.appendChild(j),j.submit()}},$=()=>{if(D){if(!Xe.canAffordTravel("galaxy",1)){Xe.executeTravel("galaxy",1);return}if(!Xe.executeTravel("galaxy",1))return;const[L,N,ee]=O(),j=document.createElement("form");j.method="POST",j.action="/navigate";const ce=document.createElement("input");ce.type="hidden",ce.name="x",ce.value=L.toString();const _=document.createElement("input");_.type="hidden",_.name="y",_.value=N.toString();const Z=document.createElement("input");Z.type="hidden",Z.name="z",Z.value=ee.toString(),j.appendChild(ce),j.appendChild(_),j.appendChild(Z),document.body.appendChild(j),j.submit()}};return G?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:V,disabled:!M,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${M?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:$,disabled:!D,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${D?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},ln=({page:a,prevPage:M,nextPage:F,finish:D,galaxyCoordinates:T})=>{const[G,J]=u.useState(new Set),A="px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",Se="bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg",O="bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white border border-white/20",V=b=>{if(!T)return!1;try{const L=at.generateGalaxyUrl(T,b);return ft.isLocationSaved(L)}catch{return!1}},$=()=>{if(T){const b=new Set,L=2,N=Math.max(1,a-L),ee=Math.min(D,a+L);N>1&&V(1)&&b.add(1);for(let j=N;j<=ee;j++)V(j)&&b.add(j);ee<D&&V(D)&&b.add(D),J(b)}};return u.useEffect(()=>{$()},[a,T,D]),u.useEffect(()=>{const b=L=>{const N=L.detail.location;if(N.type==="galaxy"&&T)try{const ee=N.stargateUrl.split("/stargate/")[1];if(ee){const j=atob(ee.replace(/-/g,"+").replace(/_/g,"/"));new URLSearchParams(j).get("coordinates")===T.join(",")&&$()}}catch{$()}};return window.addEventListener("locationSaved",b),()=>{window.removeEventListener("locationSaved",b)}},[T,a,D]),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 sm:gap-4 flex-wrap",children:[a!==1&&e.jsxs("button",{onClick:()=>window.location.href="/galaxy/1",className:`${A} ${O}`,title:"First page",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),M&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${M}`,className:`${A} ${O}`,title:"Previous page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),(()=>{const b=[],N=Math.max(1,a-2),ee=Math.min(D,a+2);N>1&&(b.push(e.jsxs("button",{onClick:()=>window.location.href="/galaxy/1",className:`${A} ${O} relative`,children:["1",G.has(1)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-green-400 shadow-sm",title:"This page is saved"})]},1)),N>2&&b.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"start-ellipsis")));for(let j=N;j<=ee;j++)j===a?b.push(e.jsxs("span",{className:`${A} ${Se} cursor-default relative`,children:[j,G.has(j)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-green-400 shadow-sm",title:"This page is saved"})]},j)):b.push(e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${j}`,className:`${A} ${O} cursor-pointer relative`,children:[j,G.has(j)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-green-400 shadow-sm",title:"This page is saved"})]},j));return ee<D&&(ee<D-1&&b.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"end-ellipsis")),b.push(e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${D}`,className:`${A} ${O} relative`,children:[D,G.has(D)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-green-400 shadow-sm",title:"This page is saved"})]},D))),b})(),F&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${F}`,className:`${A} ${O}`,title:"Next page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),a!==D&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${D}`,className:`${A} ${O}`,title:"Last page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]}),e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-400",children:["Page ",a," of ",D]})]})},mt=({galaxy:a,systems:M,galaxy_url:F,version:D,page:T,prev_page:G,next_page:J,finish:A,image_url:Se})=>{const[O]=u.useState(a.coordinates.join(","));u.useEffect(()=>{document.body.setAttribute("data-coordinates",O),Dt(O)},[O]);const V=$=>$.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsx(At,{}),e.jsxs("div",{className:"w-full min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white flex flex-col",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(Tt,{}),e.jsxs("div",{className:"relative z-10 pt-1 flex-1 flex flex-col",children:[e.jsx(_t,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8 flex-1",children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["Galaxy '",V(a.name),"'"]}),e.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-300 flex items-center justify-center gap-x-4 gap-y-1 flex-wrap",children:[e.jsx(Zt,{size:15,color:"#ffffffff"}),a.coordinates.join(", ")]})]}),e.jsx(cn,{currentGalaxy:a}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(on,{galaxyUrl:F,galaxyType:a.galaxy_type,numSystems:a.num_systems,blackHoles:a.black_holes,pulsars:a.pulsars,quasars:a.quasars,galaxyName:V(a.name)})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(nn,{galaxy:a})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Systems in '",V(a.name),"'"]}),e.jsx(an,{systems:M,coordinates:O})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsx("span",{className:"text-base sm:text-lg",children:"← Go Back to Planetary Index"})})}),e.jsx(ln,{page:T,prevPage:G,nextPage:J,finish:A,galaxyCoordinates:a.coordinates})]}),e.jsx(Kt,{version:D})]}),e.jsx(Jt,{}),e.jsx(Ht,{currentLocation:{type:"galaxy",name:a.name,coordinates:a.coordinates.join(",")}}),e.jsx(Qt,{currentView:"galaxy"})]})]})};document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("atlas-react-root");if(!a)return;const M=F=>{const D=document.getElementById(F);if(!D||!D.textContent)return null;try{return JSON.parse(D.textContent.trim())}catch{return null}};try{const F=M("data-galaxy")||{},D=M("data-systems")||[],T=M("data-navigation")||{},G=M("data-common")||{},J={galaxy:{name:F.name||"Unknown Galaxy",coordinates:F.coordinates||[0,0,0],galaxy_type:F.galaxy_type||"Unknown",num_systems:F.num_systems||0,black_holes:F.black_holes||0,pulsars:F.pulsars||0,quasars:F.quasars||0},systems:D,galaxy_url:T.galaxy_url||"#",version:G.version||"1.0.0",page:T.page||1,prev_page:T.prev_page,next_page:T.next_page,finish:T.finish||1,image_url:G.image_url||""};dt.createRoot(a).render(ut.createElement(mt,J))}catch{const D={galaxy:{name:"Unknown Galaxy",coordinates:[0,0,0],galaxy_type:"Unknown",num_systems:0,black_holes:0,pulsars:0,quasars:0},systems:[],galaxy_url:"#",version:"1.0.0",page:1,finish:1,image_url:""};dt.createRoot(a).render(ut.createElement(mt,D))}});
