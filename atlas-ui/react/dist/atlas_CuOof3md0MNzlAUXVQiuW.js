import{r as d,j as e}from"./atlas_Bv5zr7cG9joXJ1l7Eo-6s.js";import{L as j,R as u}from"./atlas_DAYqZwNxr3YCvSeonN8gY.js";class ${static encodeUrl(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_")}static generateGalaxyUrl(t,o=1){const r=`coordinates=${t[0]},${t[1]},${t[2]}&page=${o}`,n=this.encodeUrl(r);return`${window.location.origin}/stargate/${n}`}static generateSystemUrl(t,o,r=1){const n=`coordinates=${t[0]},${t[1]},${t[2]}&system=${o}&page=${r}`,g=this.encodeUrl(n);return`${window.location.origin}/stargate/${g}`}static generatePlanetUrl(t,o,r,n=1){const g=`coordinates=${t[0]},${t[1]},${t[2]}&system=${o}&planet=${r.toLowerCase()}&page=${n}`,s=this.encodeUrl(g);return`${window.location.origin}/stargate/${s}`}static getCurrentPage(){try{const o=new URLSearchParams(window.location.search).get("page");if(o)return parseInt(o,10);const r=window.location.pathname.match(/\/galaxy\/(\d+)/);return r?parseInt(r[1],10):1}catch{return 1}}}const M=({type:c,name:t,coordinates:o,systemIndex:r,planetName:n,className:g=""})=>{const[s,p]=d.useState(!1),[i,x]=d.useState(!1),h=()=>{try{const a=o.split(",").map(Number),m=$.getCurrentPage();switch(c){case"galaxy":return $.generateGalaxyUrl(a,m);case"system":if(r!==void 0)return $.generateSystemUrl(a,r,m);break;case"planet":if(r!==void 0&&n)return $.generatePlanetUrl(a,r,n,m);break}return window.location.pathname}catch(a){return console.error("Error generating stargate URL:",a),window.location.pathname}};d.useEffect(()=>{const a=j.getLocations(),m=h(),v=a.some(C=>C.stargateUrl===m);p(v)},[o,r,n,c]);const b=async()=>{x(!0);try{const a=h();j.saveLocation({name:t,type:c,stargateUrl:a}),p(!0),setTimeout(()=>{x(!1)},300)}catch(a){console.error("Error saving location:",a),x(!1)}},f=a=>a.replace(/_/g," ");return e.jsx(e.Fragment,{children:e.jsx("button",{onClick:b,disabled:s||i,className:`inline-flex items-center self-start space-x-1 px-1.5 py-0.5 rounded transition-all duration-200 text-[10px] font-medium ${s?"bg-green-500/20 border border-green-500/50 text-green-400 cursor-default":i?"bg-blue-500/20 border border-blue-500/50 text-blue-400 cursor-wait":"bg-white/10 hover:bg-white/20 border border-white/20 hover:border-white/40 text-white hover:text-blue-300"} ${g}`,title:s?"Location saved":`Save ${f(t)} to bookmarks`,children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-[10px] uppercase",children:"Saving..."})]}):s?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),e.jsx("span",{className:"text-[10px] uppercase",children:"Saved"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"text-[10px] uppercase",children:"Save"})]})})})},B=({locationType:c,locationId:t,coordinates:o,systemIndex:r,planetName:n,className:g=""})=>{const[s,p]=d.useState(!1),[i,x]=d.useState(0),[h,b]=d.useState(!1),[f,a]=d.useState(0);d.useEffect(()=>{const l=u.generateLocationId(c,o,r,n),w=()=>{p(u.canCollectFromLocation(l)),x(u.getTimeUntilNextCollection(l));const N=u.getLocationCollection(l);a(N?.totalCollections||0)};w();const L=setInterval(w,3e4);return()=>clearInterval(L)},[c,o,r,n]);const m=async()=>{b(!0);const l=u.generateLocationId(c,o,r,n),w=u.collectResources(l,c);w&&(u.showCollectionSuccess(w,c),p(!1),x(1),a(L=>L+1)),setTimeout(()=>b(!1),1e3)},v=()=>h?"Collecting...":!s&&i>0?`${Math.ceil(i*60)}m`:"Collect",C=()=>h?"⚡":!s&&i>0?"⏰":"📦",S=()=>{const l=u.calculateReward(c,f);return`${l.antimatter}AM | ${l.element115}E115 | ${l.deuterium}D`},U="inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 border",k=s&&!h?"bg-gradient-to-r from-green-600/20 to-blue-600/20 hover:from-green-600/30 hover:to-blue-600/30 text-green-300 border-green-500/50 hover:border-green-400/70 cursor-pointer transform hover:scale-105":"bg-gray-700/30 text-gray-400 border-gray-600/50 cursor-not-allowed";return e.jsxs("button",{onClick:m,disabled:!s||h,className:`${U} ${k} ${g}`,title:s?`Collect: ${S()}`:`Cooldown: ${Math.ceil(i*60)} minutes remaining`,children:[e.jsx("span",{className:"text-base",children:C()}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"leading-tight",children:v()}),f>0&&e.jsxs("span",{className:"text-xs opacity-70",children:["#",f+1]})]})]})};export{B as R,M as S};
