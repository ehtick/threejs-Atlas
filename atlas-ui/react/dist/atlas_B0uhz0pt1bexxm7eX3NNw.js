import{r as w,j as e,a as ot,c as et,R as tt}from"./atlas_BiACxVxc6cO5okV5F68Rd.js";import{R as Mt,L as jt,g as St,S as Fe,m as Nt,F as zt,H as Rt,a as Ct}from"./atlas_BAqEsQWQ_MCEaSfE85tyi.js";import{W as Xe}from"./atlas_hV4YbJX4LmBeaYZmYRF0y.js";import{a2 as Ye,C as Ge,a3 as Oe,G as Pe,q as it,cG as at,W as Te,cH as De,cI as Be,b as je,z as ke,M as H,V as _e,B as Ae,cJ as rt,n as ct,a8 as Ze,a7 as lt,v as dt,cK as ut,cL as mt,S as Ie,c as ht,A as Re,g as Me,x as $e,D as He,H as pt,t as Ue,m as Le,P as We,X as ft,y as xt}from"./atlas_BOOzg5XYrrU1N4SZySfRd.js";import{R as Et,S as kt,M as Pt,a as Ke,b as nt,D as Lt,T as Gt}from"./atlas_JNmU8gMIa1SHExpBzTLAF.js";import{O as gt}from"./atlas_BJLzboHTaSIGvKgNbvLUr.js";import{V as It}from"./atlas_DrLTn8mjMle6vK3_h1E1S.js";import"./atlas_5StMBQg7EZ_DcUhMgqODi.js";const Dt=({coordinates:a,galaxyName:I})=>{const D=w.useRef(null),V=w.useRef(null),k=w.useRef(null),C=w.useRef(null);return w.useEffect(()=>{if(!D.current)return;const F=D.current,P=F.clientWidth,ge=F.clientHeight,se=new Ye;se.background=new Ge(657930),V.current=se;const $=new Oe(45,P/ge,.1,1e3);$.position.set(20,15,20),$.lookAt(0,0,0);const T=new Xe({antialias:!0,alpha:!0});T.setSize(P,ge),T.setClearColor(0,.2),k.current=T,F.appendChild(T.domElement);const q=0,U=1e7,Y=5e6,[O,A,re]=a,b=((O-q)/(U-q)-.5)*16,ee=((A-q)/(U-q)-.5)*16,we=((re-q)/(U-q)-.5)*16,x=new Pe;se.add(x);const j=new it(16,16,16),y=new at(j),S=new Te({color:16777215,opacity:.4,transparent:!0,linewidth:2}),W=new De(y,S);x.add(W);const B=new Be(16,16,16777215,16777215);B.material.opacity=.1,B.material.transparent=!0,B.position.y=-8,x.add(B);const Z=new Be(16,16,16777215,16777215);Z.material.opacity=.05,Z.material.transparent=!0,Z.rotation.z=Math.PI/2,Z.position.x=-8,x.add(Z);const M=new Be(16,16,16777215,16777215);M.material.opacity=.05,M.material.transparent=!0,M.rotation.x=Math.PI/2,M.position.z=-8,x.add(M);const ae=new je(.5,32,32),pe=new ke({color:16777215,transparent:!0,opacity:.9}),K=new H(ae,pe);K.position.set(0,0,0),x.add(K);const R=new H(new je(.8,32,32),new ke({color:16777215,transparent:!0,opacity:.2}));K.add(R);const xe=new je(.4,32,32),be=new ke({color:6605055,transparent:!0,opacity:1}),ve=new H(xe,be);ve.position.set(b,ee,we),x.add(ve);const o=new H(new je(.7,32,32),new ke({color:6605055,transparent:!0,opacity:.3}));if(ve.add(o),Math.sqrt(Math.pow(O-Y,2)+Math.pow(A-Y,2)+Math.pow(re-Y,2))<2e6){const s=[new _e(0,0,0),new _e(b,ee,we)],d=new Ae().setFromPoints(s),h=new rt({color:16762980,dashSize:.6,gapSize:.6,opacity:.4,transparent:!0,linewidth:2}),J=new ct(d,h);J.computeLineDistances(),x.add(J)}const n=new Ze(4210752,.6);se.add(n);const m=new lt(16777215,.8);m.position.set(10,10,10),se.add(m);const ce=(s,d)=>{const h=document.createElement("canvas"),J=h.getContext("2d");if(!J)return null;h.width=64,h.height=64,J.fillStyle=`#${d.toString(16).padStart(6,"0")}`,J.font="bold 48px Arial",J.textAlign="center",J.textBaseline="middle",J.fillText(s,32,32);const z=new dt(h),ue=new ut({map:z,transparent:!0,opacity:.8}),me=new mt(ue);return me.scale.set(1.6,1.6,1),me},oe=ce("X",16739179);oe&&(oe.position.set(8.4,-7.6,-7.6),x.add(oe));const le=ce("Y",7077739);le&&(le.position.set(-7.6,8.4,-7.6),x.add(le));const X=ce("Z",7039999);X&&(X.position.set(-7.6,-7.6,8.4),x.add(X));let L=!1,l=0,i=0,t=!0,c=0;const v=s=>{L=!0,t=!1,l=s.clientX,i=s.clientY},E=s=>{if(!L)return;const d=s.clientX-l,h=s.clientY-i;x.rotation.y+=d*.01,x.rotation.x+=h*.01,l=s.clientX,i=s.clientY},N=()=>{L=!1,setTimeout(()=>{L||(t=!0)},3e3)},p=s=>{s.preventDefault();const d=.1,h=$.position.distanceTo(new _e(0,0,0));s.deltaY>0&&h<50?$.position.multiplyScalar(1+d):s.deltaY<0&&h>10&&$.position.multiplyScalar(1-d)},f=s=>{s.key==="Escape"&&document.dispatchEvent(new CustomEvent("universe-close-fullscreen"))},te=s=>{if(s.preventDefault(),s.touches.length===1)L=!0,t=!1,l=s.touches[0].clientX,i=s.touches[0].clientY;else if(s.touches.length===2){const d=s.touches[0].clientX-s.touches[1].clientX,h=s.touches[0].clientY-s.touches[1].clientY;c=Math.sqrt(d*d+h*h)}},de=s=>{if(s.preventDefault(),s.touches.length===1&&L){const d=s.touches[0].clientX-l,h=s.touches[0].clientY-i;x.rotation.y+=d*.01,x.rotation.x+=h*.01,l=s.touches[0].clientX,i=s.touches[0].clientY}else if(s.touches.length===2){const d=s.touches[0].clientX-s.touches[1].clientX,h=s.touches[0].clientY-s.touches[1].clientY,J=Math.sqrt(d*d+h*h);if(c>0){const ue=J/c,me=$.position.distanceTo(new _e(0,0,0));ue>1&&me>10?$.position.multiplyScalar(1-.01):ue<1&&me<50&&$.position.multiplyScalar(1+.01)}c=J}},g=s=>{s.preventDefault(),L=!1,c=0,setTimeout(()=>{L||(t=!0)},3e3)},u=T.domElement;u.style.cursor="grab",u.addEventListener("mousedown",s=>{u.style.cursor="grabbing",v(s)}),u.addEventListener("mousemove",E),u.addEventListener("mouseup",()=>{u.style.cursor="grab",N()}),u.addEventListener("mouseleave",()=>{u.style.cursor="grab",N()}),u.addEventListener("wheel",p),u.addEventListener("touchstart",te,{passive:!1}),u.addEventListener("touchmove",de,{passive:!1}),u.addEventListener("touchend",g,{passive:!1}),document.addEventListener("keydown",f);const G=()=>{C.current=requestAnimationFrame(G),t&&(x.rotation.y+=.002,x.rotation.x+=.001);const s=Date.now()*.005;K.scale.setScalar(1+Math.sin(s)*.1),ve.rotation.y+=.01,T.render(se,$)};G();const he=()=>{const s=F.clientWidth,d=F.clientHeight;$.aspect=s/d,$.updateProjectionMatrix(),T.setSize(s,d)};return window.addEventListener("resize",he),()=>{window.removeEventListener("resize",he),document.removeEventListener("keydown",f),u.removeEventListener("mousedown",v),u.removeEventListener("mousemove",E),u.removeEventListener("mouseup",N),u.removeEventListener("mouseleave",N),u.removeEventListener("wheel",p),u.removeEventListener("touchstart",te),u.removeEventListener("touchmove",de),u.removeEventListener("touchend",g),C.current&&cancelAnimationFrame(C.current),F&&T.domElement&&F.removeChild(T.domElement),T.dispose(),j.dispose(),y.dispose(),S.dispose(),ae.dispose(),pe.dispose(),xe.dispose(),be.dispose()}},[a,I]),e.jsx("div",{ref:D,className:"w-full h-full"})},At=({coordinates:a,galaxyName:I})=>{const D=w.useRef(null),V=w.useRef(null),k=w.useRef(null),C=w.useRef(null),[F,P]=w.useState(!1),[ge,se]=w.useState(!1),[$,T]=w.useState(!1),q=()=>{se(!0),setTimeout(()=>{P(!1),se(!1)},300)};w.useEffect(()=>{const b=ee=>{ee.key==="Escape"&&F&&q()};return document.addEventListener("universe-close-fullscreen",q),document.addEventListener("keydown",b),()=>{document.removeEventListener("universe-close-fullscreen",q),document.removeEventListener("keydown",b)}},[F]),w.useEffect(()=>{if(F&&$){const b=setTimeout(()=>{T(!1)},50);return()=>clearTimeout(b)}},[F,$]),w.useEffect(()=>{if(!D.current)return;const b=D.current,ee=b.clientWidth,we=ee<640,x=new Ye;x.background=new Ge(657930),V.current=x;const j=new Oe(30,ee/120,.1,1e3);j.position.set(12,8,12),j.lookAt(0,0,0);const y=new Xe({antialias:!0,alpha:!0});y.setSize(ee,120),y.setClearColor(0,.2),k.current=y,b.appendChild(y.domElement);const S=0,W=1e7,B=5e6,[Z,M,ae]=a,pe=((Z-S)/(W-S)-.5)*8,K=((M-S)/(W-S)-.5)*8,R=((ae-S)/(W-S)-.5)*8,xe=new Pe;x.add(xe);const be=new it(8,8,8),ve=new at(be),o=new Te({color:16777215,opacity:.4,transparent:!0}),r=new De(ve,o);xe.add(r);const n=new Be(8,8,16777215,16777215);n.material.opacity=.1,n.material.transparent=!0,n.position.y=-4,xe.add(n);const m=new Be(8,8,16777215,16777215);m.material.opacity=.05,m.material.transparent=!0,m.rotation.z=Math.PI/2,m.position.x=-4,xe.add(m);const ce=new Be(8,8,16777215,16777215);ce.material.opacity=.05,ce.material.transparent=!0,ce.rotation.x=Math.PI/2,ce.position.z=-4,xe.add(ce);const oe=new je(.25,16,16),le=new ke({color:16777215,transparent:!0,opacity:.9}),X=new H(oe,le);X.position.set(0,0,0),xe.add(X);const L=new H(new je(.45,16,16),new ke({color:16777215,transparent:!0,opacity:.2}));X.add(L);const l=new je(.2,16,16),i=new ke({color:6605055,transparent:!0,opacity:1}),t=new H(l,i);t.position.set(pe,K,R),xe.add(t);const c=new H(new je(.35,16,16),new ke({color:6605055,transparent:!0,opacity:.3}));if(t.add(c),Math.sqrt(Math.pow(Z-B,2)+Math.pow(M-B,2)+Math.pow(ae-B,2))<2e6){const _=[new _e(0,0,0),new _e(pe,K,R)],Q=new Ae().setFromPoints(_),ne=new rt({color:16762980,dashSize:.3,gapSize:.3,opacity:.4,transparent:!0}),ie=new ct(Q,ne);ie.computeLineDistances(),xe.add(ie)}const E=new Ze(4210752,.6);x.add(E);const N=new lt(16777215,.8);N.position.set(5,5,5),x.add(N);const p=(_,Q)=>{const ne=document.createElement("canvas"),ie=ne.getContext("2d");if(!ie)return null;ne.width=32,ne.height=32,ie.fillStyle=`#${Q.toString(16).padStart(6,"0")}`,ie.font="bold 24px Arial",ie.textAlign="center",ie.textBaseline="middle",ie.fillText(_,16,16);const ye=new dt(ne),Ne=new ut({map:ye,transparent:!0,opacity:.8}),fe=new mt(Ne);return fe.scale.set(.8,.8,1),fe},f=p("X",16739179);f&&(f.position.set(4.2,-3.8,-3.8),xe.add(f));const te=p("Y",7077739);te&&(te.position.set(-3.8,4.2,-3.8),xe.add(te));const de=p("Z",7039999);de&&(de.position.set(-3.8,-3.8,4.2),xe.add(de));let g=!1,u=0,G=0,he=!0;const s=_=>{g=!0,he=!1,u=_.clientX,G=_.clientY},d=_=>{if(!g)return;const Q=_.clientX-u,ne=_.clientY-G;xe.rotation.y+=Q*.01,xe.rotation.x+=ne*.01,u=_.clientX,G=_.clientY},h=()=>{g=!1,setTimeout(()=>{g||(he=!0)},3e3)},J=_=>{_.preventDefault();const Q=.1,ne=j.position.distanceTo(new _e(0,0,0));_.deltaY>0&&ne<25?j.position.multiplyScalar(1+Q):_.deltaY<0&&ne>5&&j.position.multiplyScalar(1-Q)},z=y.domElement;z.style.cursor="grab",z.style.borderRadius="8px",z.addEventListener("mousedown",_=>{z.style.cursor="grabbing",s(_)}),z.addEventListener("mousemove",d),z.addEventListener("mouseup",()=>{z.style.cursor="grab",h()}),z.addEventListener("mouseleave",()=>{z.style.cursor="grab",h()}),z.addEventListener("wheel",J);const ue=()=>{C.current=requestAnimationFrame(ue),he&&(xe.rotation.y+=.002,xe.rotation.x+=.001);const _=Date.now()*.005;X.scale.setScalar(1+Math.sin(_)*.1),t.rotation.y+=.01,y.render(x,j)};ue();const me=()=>{const _=b.clientWidth,Q=_<640?150:160;j.aspect=_/Q,j.updateProjectionMatrix(),y.setSize(_,Q)};return window.addEventListener("resize",me),()=>{window.removeEventListener("resize",me),z.removeEventListener("mousedown",s),z.removeEventListener("mousemove",d),z.removeEventListener("mouseup",h),z.removeEventListener("mouseleave",h),z.removeEventListener("wheel",J),C.current&&cancelAnimationFrame(C.current),b&&y.domElement&&b.removeChild(y.domElement),y.dispose(),be.dispose(),ve.dispose(),o.dispose(),oe.dispose(),le.dispose(),l.dispose(),i.dispose()}},[a,I]);const U=b=>b.replace(/_/g," "),Y=b=>b>=1e6?`${(b/1e6).toFixed(1)}M`:b>=1e3?`${(b/1e3).toFixed(1)}K`:b.toString(),[O,A,re]=a;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Galaxy Location"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:D,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsx("button",{onClick:()=>{P(!0),T(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-[10px]",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:U(I)})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[Y(O),", ",Y(A),", ",Y(re)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Drag: Rotate View"})]})]}),F&&ot.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${ge||$?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${ge||$?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:U(I)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[U(I)," - Galaxy Location"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Galaxy"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[Y(O),", ",Y(A),", ",Y(re)]})]})]}),e.jsx("button",{onClick:q,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Dt,{coordinates:a,galaxyName:I})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},_t=({galaxy:a})=>{const[I,D]=w.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});w.useEffect(()=>{let k;const C=()=>{const se=Ke.generateLocationId("galaxy",a.coordinates.join(","),void 0,void 0),$=Ke.canCollectFromLocation(se),T=Ke.getTimeUntilNextCollection(se),q=a.coordinates,U=nt.generateGalaxyUrl(q,nt.getCurrentPage()),O=jt.getLocations().some(A=>A.stargateUrl===U);D(A=>({isOnCooldown:!$&&T>0,isSaved:O,isCollecting:A.isCollecting,timeUntilNext:T}))},F=()=>{D(se=>({...se,isCollecting:!0})),k=setTimeout(()=>{D(se=>({...se,isCollecting:!1}))},1e3)};C();const P=setInterval(C,1e3),ge=Mt.subscribe("mining_completed",F);return()=>{clearInterval(P),k&&clearTimeout(k),ge()}},[a.name,a.coordinates]);const V=k=>k.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(Et,{locationType:"galaxy",locationId:a.name,coordinates:a.coordinates.join(","),className:"text-xs"}),e.jsx(kt,{type:"galaxy",name:a.name,coordinates:a.coordinates.join(","),className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Pt,{isOnCooldown:I.isOnCooldown,isSaved:I.isSaved,isCollecting:I.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300",children:a.galaxy_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Solar Systems"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:a.num_systems.toLocaleString()})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-2",children:e.jsx(At,{coordinates:a.coordinates,galaxyName:a.name})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-gray-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Cosmic Objects"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-pink-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Black Holes"}),e.jsx("div",{className:"text-xs font-bold text-pink-300",children:a.black_holes.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Pulsars"}),e.jsx("div",{className:"text-xs font-bold text-cyan-300",children:a.pulsars.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-indigo-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Quasars"}),e.jsx("div",{className:"text-xs font-bold text-indigo-300",children:a.quasars.toLocaleString()})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:V(a.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:a.coordinates.join(", ")})]})]})]})]})},Ft=({galaxyType:a,numSystems:I,blackHoles:D,pulsars:V,quasars:k,seed:C=12345,onExpandClick:F,galaxyName:P})=>{const ge=w.useRef(null),se=w.useRef(null),$=w.useRef(null),T=w.useRef(null),q=w.useRef(null),U=w.useRef(null),Y=w.useRef(null),O=w.useRef(!1),[A,re]=w.useState(!1),[b,ee]=w.useState(!1),we=w.useRef(null);class x{seed;constructor(S){this.seed=S}random(){const S=Math.sin(this.seed++)*1e4;return S-Math.floor(S)}uniform(S,W){return S+this.random()*(W-S)}gauss(S,W){let B=0,Z=0;for(;B===0;)B=this.random();for(;Z===0;)Z=this.random();const M=Math.sqrt(-2*Math.log(B))*Math.cos(2*Math.PI*Z);return S+W*M}randint(S,W){return Math.floor(this.uniform(S,W+1))}}w.useEffect(()=>{const y=Y.current;if(!y)return;const S=y.getContext("2d");if(!S)return;let W=[];const B=800;let Z,M;const ae=800;let pe,K=.5;function R(){const o=y?.parentElement;if(!o||!y)return;const r=o.clientWidth,n=o.clientHeight;y.width=Math.min(r,ae),y.height=Math.min(n,ae),Z=y.width/2,M=y.height/2}function xe(){R(),W=[];for(let o=0;o<B;o++)W.push({x:Math.random()*(y?.width||800),y:Math.random()*(y?.height||800),z:Math.random()*(y?.width||800),o:Math.random()});be()}function be(){!y||!S||(S.clearRect(0,0,y.width,y.height),W.forEach(o=>{o.z-=K,o.z<=0&&(o.z=y.width,o.x=Math.random()*y.width,o.y=Math.random()*y.height,o.o=Math.random());const r=y.width/o.z,n=(o.x-Z)*r+Z,m=(o.y-M)*r+M,ce=2*r;S.beginPath(),S.fillStyle=`rgba(255, 255, 255, ${o.o})`,S.arc(n,m,ce,0,2*Math.PI),S.fill()}),!O.current&&K<60&&(K+=1),O.current&&K>2&&(K-=2),pe=requestAnimationFrame(be))}xe();const ve=()=>R();return window.addEventListener("resize",ve),()=>{window.removeEventListener("resize",ve),pe&&cancelAnimationFrame(pe)}},[]),w.useEffect(()=>{if(!ge.current)return;const y=ge.current,S=y.clientWidth,W=y.clientHeight,B=Math.min(S,W),Z=new Ye;Z.background=new Ge(17),se.current=Z;const M=new Oe(45,1,.1,1e4);M.position.set(0,200,400),M.lookAt(0,0,0),we.current=M;const ae=new Xe({antialias:!0,alpha:!0});ae.setSize(B,B),ae.setClearColor(17,1),$.current=ae,y.appendChild(ae.domElement);const pe=new gt(M,ae.domElement);pe.enableDamping=!0,pe.dampingFactor=.05,pe.minDistance=50,pe.maxDistance=800,pe.autoRotate=!0,pe.autoRotateSpeed=.5,pe.enablePan=!0,pe.enableZoom=!0,pe.target.set(0,0,0),q.current=pe;const K=new Pe;U.current=K,Z.add(K);const R=new x(C),xe=R.uniform(0,2*Math.PI),be=new Ae,ve=[],o=[],r=[],n=200;let m=I;if(a==="Spiral"){m=Math.min(I,5e4);const l=4,i=2*Math.PI/l,t=.15,c=.5,v=.1;for(let E=0;E<m*v;E++){const N=R.uniform(0,2*Math.PI),p=R.gauss(n*.1,n*.05),f=R.gauss(0,5),te=p*Math.cos(N),de=p*Math.sin(N);ve.push(te,f,de),o.push(1,1,1);const g=C+E*1337,u=new x(g),G=u.gauss(1,.3),he=u.random()<.05,s=u.random()<.3;let d=Math.max(.3,G);he&&(d*=3+u.uniform(0,2)),s&&(d*=.5+u.uniform(0,.3)),p<n*.2&&(d*=1.8+u.uniform(0,.7),o[o.length-3]=1.2,o[o.length-2]=1.1,o[o.length-1]=.9),r.push(Math.min(d*1.5,12))}for(let E=0;E<m;E++){const N=c*Math.sqrt(E/m)*2*Math.PI,p=E%l*i,f=n*Math.sqrt(E/m),te=f*Math.cos(N+p+xe)+R.uniform(-t*f,t*f),de=f*Math.sin(N+p+xe)+R.uniform(-t*f,t*f),g=R.gauss(0,3);ve.push(te,g,de),o.push(1,1,.8);const u=C+E*1337,G=new x(u),he=G.gauss(.8,.25),s=G.random()<.03,d=G.random()<.4;let h=Math.max(.2,he);s&&(h*=2.5+G.uniform(0,1.5)),d&&(h*=.4+G.uniform(0,.2)),f>n*.7&&(h*=.8),r.push(Math.min(h*1.3,8))}}else if(a==="Elliptical"){m=Math.min(I,1e5);for(let l=0;l<m;l++){const i=R.uniform(0,2*Math.PI),t=R.uniform(-1,1),c=Math.sqrt(1-t*t),v=R.random(),E=Math.pow(v,.6),N=-Math.log(1-E*.98)*n*.35,p=N*c*Math.cos(i),f=N*t*.6,te=N*c*Math.sin(i);ve.push(p,f,te),o.push(1,.9,.7);const de=C+l*1337,g=new x(de),u=g.gauss(.6,.2),G=g.random()<.08,he=g.random()<.25;let s=Math.max(.2,u);G&&(s*=2+g.uniform(0,1)),he&&(s*=.6+g.uniform(0,.2)),Math.sqrt(p*p+f*f+te*te)<n*.3&&(s*=1.5+g.uniform(0,.5)),r.push(Math.min(s*1.4,7))}}else if(a==="Dwarf"){m=Math.min(I/100,1e4);for(let l=0;l<m;l++){const i=R.uniform(0,2*Math.PI),t=R.uniform(0,Math.PI),c=R.gauss(n/3,n*.3),v=c*Math.sin(t)*Math.cos(i),E=c*Math.cos(t)*.5,N=c*Math.sin(t)*Math.sin(i);ve.push(v,E,N),o.push(.8,.8,1);const p=C+l*1337,f=new x(p),te=f.gauss(.7,.3),de=f.random()<.02,g=f.random()<.6;let u=Math.max(.3,te);de&&(u*=2.5+f.uniform(0,1)),g&&(u*=.5+f.uniform(0,.3)),r.push(Math.min(u*1.2,5))}}else if(a==="Singularity Void"){m=1e4;for(let ne=0;ne<m;ne++){const ie=ne/m,ye=ie*30*Math.PI,Ne=n*(1-ie*.8)+R.uniform(-10,10),fe=(ie-.5)*300+Math.sin(ye*.5)*20,Ce=Ne*Math.cos(ye)+Math.sin(ie*20)*10,Ee=Ne*Math.sin(ye)+Math.cos(ie*20)*10;ve.push(Ce,fe,Ee);const ze=(ie+Math.sin(ye*.1))%1,Se=new Ge;Se.setHSL(ze,1,.5+Math.sin(ie*10)*.3),o.push(Se.r,Se.g,Se.b),r.push(R.uniform(.3,2)*(1+Math.sin(ie*50)*.5))}const l=(ne,ie,ye=1)=>{const Ne=new je(ne,64,64),fe=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,Ce=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;

          void main() {
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);

            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;

            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;

            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x +
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);

            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;

            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);

            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;

            gl_FragColor = vec4(color, ${ie});
          }
        `,Ee=new Ie({uniforms:{time:{value:0},speed:{value:ye}},vertexShader:fe,fragmentShader:Ce,transparent:!0,blending:Re,side:He,depthWrite:!1}),ze=new H(Ne,Ee);return ze.isSingularityShader=!0,ze.shaderSpeed=ye,ze},i=l(250,.3,1);K.add(i);const t=l(180,.4,-.7);K.add(t);const c=l(120,.5,1.5);K.add(c);const v=l(300,.2,.5);v.scale.set(-1,1,1),K.add(v);const E=new je(350,32,32),N=new Ie({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);


            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;

            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;

          void main() {

            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;

            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;

            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Re,side:ht,depthWrite:!1}),p=new H(E,N);p.isSingularityShader=!0,p.shaderSpeed=.3,K.add(p);const f=new Ae,te=[],de=[];for(let ne=0;ne<1e3;ne++){const ie=R.uniform(-n,n),ye=R.uniform(-n/2,n/2),Ne=R.uniform(-n,n),fe=R.uniform(-50,50),Ce=R.uniform(-30,30),Ee=R.uniform(-50,50);te.push(ie,ye,Ne),te.push(ie+fe,ye+Ce,Ne+Ee);const ze=R.random(),Se=new Ge;Se.setHSL(ze,1,.6),de.push(Se.r,Se.g,Se.b),de.push(Se.r*.5,Se.g*.5,Se.b*.5)}f.setAttribute("position",new Me(te,3)),f.setAttribute("color",new Me(de,3));const g=new Te({vertexColors:!0,transparent:!0,opacity:.4,blending:Re}),u=new De(f,g);u.isGlitchLines=!0,K.add(u);const G=new Pe,he=new je(20,32,32),s=new ke({color:0,transparent:!0,opacity:.95}),d=new H(he,s);G.add(d);const h=new $e(25,80,64),J=new Ie({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;

          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);


            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;


            vec3 hotColor = vec3(1.0, 0.5, 0.0);
            vec3 coldColor = vec3(0.0, 0.3, 1.0);
            vec3 color = mix(coldColor, hotColor, intensity);


            color *= (0.7 + swirl * 0.3);


            float alpha = intensity * 0.8;

            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Re,side:He}),z=new H(h,J);z.rotation.x=Math.PI/2,z.isAccretionDisk=!0,G.add(z);for(let ne=0;ne<8;ne++){const ie=30+ne*20,ye=new pt(ie,1+ne*.5,8,64),Ne=new ke({color:new Ge().setHSL((.7+ne*.05)%1,1,.5),transparent:!0,opacity:.3-ne*.03,wireframe:!0}),fe=new H(ye,Ne);fe.rotation.x=R.uniform(0,Math.PI),fe.rotation.y=R.uniform(0,Math.PI),fe.isDistortionRing=!0,fe.rotationSpeed=R.uniform(.001,.005)*(ne%2===0?1:-1),G.add(fe)}K.add(G);const ue=new Ue(5,100,8),me=new Le({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:Re}),_=new H(ue,me);_.position.y=50,K.add(_);const Q=new H(ue,me);Q.position.y=-50,Q.rotation.z=Math.PI,K.add(Q)}if(a!=="Singularity Void"){const l=[],i=new x(C+999);for(let g=0;g<D;g++){const u=i.uniform(-50,50),G=i.uniform(-20,20),he=i.uniform(-50,50);l.push({x:u,y:G,z:he})}const t=[],c=[],v=[],E=[],N=[],p=.4,f=p*25;for(let g=0;g<ve.length;g+=3){const u=ve[g],G=ve[g+1],he=ve[g+2];let s=1/0,d=null;for(const h of l){const J=Math.sqrt(Math.pow(u-h.x,2)+Math.pow(G-h.y,2)+Math.pow(he-h.z,2));J<s&&(s=J,d=h)}if(!(s<p))if(s<f&&d){const h=1-(s-p)/(f-p);d.x-u,d.y-G,d.z-he;const J=Math.atan2(he-d.z,u-d.x),z=h*.8,ue=8;for(let fe=0;fe<ue-1;fe++){const Ce=fe/(ue-1),Ee=(fe+1)/(ue-1),ze=s*(1-Ce*z*.7),Se=J+Ce*z*1.5,qe=d.x+ze*Math.cos(Se),Ve=G+(d.y-G)*Ce*.3,vt=d.z+ze*Math.sin(Se),Je=s*(1-Ee*z*.7),Qe=J+Ee*z*1.5,wt=d.x+Je*Math.cos(Qe),bt=G+(d.y-G)*Ee*.3,yt=d.z+Je*Math.sin(Qe);E.push(qe,Ve,vt),E.push(wt,bt,yt)}const me=h*1.5,_=o[g],Q=o[g+1],ne=o[g+2],ie=Math.min(_+me,2),ye=Math.max(Q*(1-me*.6),.1),Ne=Math.max(ne*(1-me*.8),.1);for(let fe=0;fe<ue-1;fe++){const Ce=fe/(ue-1),Ee=(fe+1)/(ue-1),ze=1-Ce*h*.6,Se=1-Ee*h*.6,qe=me*(.5+Ce*.5),Ve=me*(.5+Ee*.5);N.push(Math.min(ie+qe*.3,2)*ze,Math.max(ye*(1-qe*.2),.1)*ze,Math.max(Ne*(1-qe*.4),.1)*ze),N.push(Math.min(ie+Ve*.3,2)*Se,Math.max(ye*(1-Ve*.2),.1)*Se,Math.max(Ne*(1-Ve*.4),.1)*Se)}t.push(u,G,he),c.push(ie,ye,Ne),v.push(Math.max(r[g/3]*(1-h*.5),.3))}else t.push(u,G,he),c.push(o[g],o[g+1],o[g+2]),v.push(r[g/3])}be.setAttribute("position",new Me(t,3)),be.setAttribute("color",new Me(c,3)),be.setAttribute("size",new Me(v,1));const te=new Ie({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (400.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {

            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);

            if (distanceFromCenter > 0.5) {
              discard;
            }


            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);

            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:Re,vertexColors:!0,depthWrite:!1}),de=new We(be,te);if(K.add(de),E.length>0){const g=new Ae;g.setAttribute("position",new Me(E,3)),g.setAttribute("color",new Me(N,3));const u=new Te({vertexColors:!0,transparent:!0,opacity:.8,linewidth:2,blending:Re}),G=new De(g,u);K.add(G)}}else{be.setAttribute("position",new Me(ve,3)),be.setAttribute("color",new Me(o,3)),be.setAttribute("size",new Me(r,1));const l=new ft({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:Re,sizeAttenuation:!0}),i=new We(be,l);K.add(i)}const ce=new x(C+999);for(let l=0;l<D;l++){const i=new Pe,t=ce.uniform(-50,50),c=ce.uniform(-20,20),v=ce.uniform(-50,50),E=new je(1.5,16,16),N=new ke({color:0,transparent:!0,opacity:.9}),p=new H(E,N);i.add(p),[{innerRadius:2,outerRadius:2.3,color:16777215,opacity:.8,emissive:16777164},{innerRadius:2.3,outerRadius:2.7,color:16755200,opacity:.7,emissive:16746496},{innerRadius:2.7,outerRadius:3.2,color:16729088,opacity:.6,emissive:16720384},{innerRadius:3.2,outerRadius:4,color:11141120,opacity:.5,emissive:6684672},{innerRadius:4,outerRadius:5,color:4456448,opacity:.3,emissive:2228224}].forEach((te,de)=>{const g=new $e(te.innerRadius,te.outerRadius,32),u=new Le({color:te.color,transparent:!0,opacity:te.opacity,emissive:te.emissive,emissiveIntensity:.3,side:He}),G=new H(g,u);G.rotation.x=Math.PI/2,G.rotation.z=R.uniform(0,Math.PI*2),G.isAccretionRing=!0,G.rotationSpeed=.002+de*5e-4,i.add(G)}),i.position.set(t,c,v),K.add(i)}for(let l=0;l<V;l++){const i=new je(1.5,8,8),t=new Le({color:16776960,emissive:16776960,emissiveIntensity:1}),c=new H(i,t);c.position.set(R.uniform(-n,n),R.uniform(-n/4,n/4),R.uniform(-n,n)),c.isPulsar=!0,c.pulseSpeed=R.uniform(1,3),K.add(c)}for(let l=0;l<k;l++){const i=new Pe,t=new je(2,16,16),c=new Le({color:16777215,emissive:16777215,emissiveIntensity:2}),v=new H(t,c);i.add(v);const E=new Ue(1,20,8),N=new Le({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),p=new H(E,N);p.position.y=10,i.add(p);const f=new H(E,N);f.position.y=-10,f.rotation.z=Math.PI,i.add(f),i.position.set(R.uniform(-n,n),R.uniform(-n/4,n/4),R.uniform(-n,n)),K.add(i)}const oe=new Ze(4210752,.5);Z.add(oe);const le=new xt(16777215,.5,1e3);le.position.set(0,100,0),Z.add(le);const X=()=>{T.current=requestAnimationFrame(X);const l=performance.now()/1e3;U.current&&(U.current.rotation.y+=.001),K.children.forEach(i=>{if(i.isPulsar){const t=i.pulseSpeed||1;i.scale.setScalar(1+Math.sin(Date.now()*.001*t)*.3)}if(i.isSingularityShader&&i instanceof H){const t=i.material;t.uniforms&&t.uniforms.time&&(t.uniforms.time.value=l);const c=i.shaderSpeed||1;i.rotation.y+=.001*c,i.rotation.x+=5e-4*c}if(i.isAccretionDisk&&i instanceof H){const t=i.material;t.uniforms&&t.uniforms.time&&(t.uniforms.time.value=l),i.rotation.z+=.002}if(i.isDistortionRing){const t=i.rotationSpeed||.001;i.rotation.x+=t,i.rotation.y+=t*.7,i.scale.setScalar(1+Math.sin(l*2)*.1)}if(i.isGlitchLines&&i instanceof De){const t=i.material;t.opacity=.2+Math.sin(l*3)*.2,i.rotation.z+=5e-4}i instanceof Pe&&i.children.forEach(t=>{if(t.isAccretionDisk&&t instanceof H){const c=t.material;c.uniforms&&c.uniforms.time&&(c.uniforms.time.value=l),t.rotation.z+=.002}if(t.isAccretionRing&&t instanceof H){const c=t.rotationSpeed||.002;t.rotation.z+=c}if(t.isDistortionRing){const c=t.rotationSpeed||.001;t.rotation.x+=c,t.rotation.y+=c*.7,t.scale.setScalar(1+Math.sin(l*2)*.1)}})}),q.current&&q.current.update(),ae.render(Z,M)};X(),setTimeout(()=>{re(!0),ee(!0),O.current=!0},800);const L=()=>{if(!ge.current||!ae)return;const l=ge.current,i=Math.min(l.clientWidth,l.clientHeight);ae.setSize(i,i),M.aspect=1,M.updateProjectionMatrix()};return window.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),q.current&&q.current.dispose(),T.current&&cancelAnimationFrame(T.current),y&&ae.domElement&&y.removeChild(ae.domElement),ae.dispose()}},[a,I,D,V,k,C]);const j=()=>{if(!$.current||!se.current||!we.current)return;const y=$.current,S=se.current,W=we.current,B=y.domElement.width,Z=y.domElement.height;y.setSize(3840,3840),W.aspect=1,W.updateProjectionMatrix(),y.render(S,W),y.domElement.toBlob(pe=>{if(pe){const K=URL.createObjectURL(pe),R=document.createElement("a");R.href=K,R.download=`galaxy_${P||a}_${Date.now()}.png`,R.click(),URL.revokeObjectURL(K)}y.setSize(B,Z),W.aspect=1,W.updateProjectionMatrix()},"image/png",1)};return e.jsxs("div",{className:"relative w-full h-full bg-black rounded",children:[e.jsx("canvas",{ref:Y,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${b?"opacity-0":"opacity-100"}`,style:{filter:b?"blur(50px)":"none"}}),e.jsxs("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${A?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:[e.jsx("div",{ref:ge,className:"w-full h-full border border-white/20 rounded bg-black/20"}),A&&P&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:P})}),A&&e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 z-10",children:[e.jsx("button",{onClick:j,className:"p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg",title:"Download screenshot",children:e.jsx(Lt,{className:"w-4 h-4 text-white"})}),F&&e.jsx("button",{onClick:F,className:"p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]})]})]})},Bt=({galaxyType:a,numSystems:I,blackHoles:D,pulsars:V,quasars:k,seed:C=12345,galaxyName:F})=>{const P=w.useRef(null),ge=w.useRef(null),se=w.useRef(null),$=w.useRef(null),T=w.useRef(null),q=w.useRef(null);class U{seed;constructor(O){this.seed=O}random(){const O=Math.sin(this.seed++)*1e4;return O-Math.floor(O)}uniform(O,A){return O+this.random()*(A-O)}gauss(O,A){let re=0,b=0;for(;re===0;)re=this.random();for(;b===0;)b=this.random();const ee=Math.sqrt(-2*Math.log(re))*Math.cos(2*Math.PI*b);return O+A*ee}randint(O,A){return Math.floor(this.uniform(O,A+1))}}return w.useEffect(()=>{if(!P.current)return;const Y=P.current,O=Y.clientWidth,A=Y.clientHeight,re=new Ye;re.background=new Ge(17),ge.current=re;const b=new Oe(45,O/A,.1,1e4);b.position.set(0,200,400),b.lookAt(0,0,0);const ee=new Xe({antialias:!0,alpha:!0});ee.setSize(O,A),ee.setClearColor(17,1),se.current=ee,Y.appendChild(ee.domElement);const we=new gt(b,ee.domElement);we.enableDamping=!0,we.dampingFactor=.05,we.minDistance=50,we.maxDistance=1200,we.autoRotate=!0,we.autoRotateSpeed=.5,we.enablePan=!0,we.enableZoom=!0,we.target.set(0,0,0),T.current=we;const x=new Pe;q.current=x,re.add(x);const j=new U(C),y=j.uniform(0,2*Math.PI),S=new Ae,W=[],B=[],Z=[],M=200;let ae=I;if(a==="Spiral"){ae=Math.min(I,5e4);const o=4,r=2*Math.PI/o,n=.15,m=.5,ce=.1;for(let oe=0;oe<ae*ce;oe++){const le=j.uniform(0,2*Math.PI),X=j.gauss(M*.1,M*.05),L=j.gauss(0,5),l=X*Math.cos(le),i=X*Math.sin(le);W.push(l,L,i),B.push(1,1,1);const t=C+oe*1337,c=new U(t),v=c.gauss(1,.3),E=c.random()<.05,N=c.random()<.3;let p=Math.max(.3,v);E&&(p*=3+c.uniform(0,2)),N&&(p*=.5+c.uniform(0,.3)),X<M*.2&&(p*=1.8+c.uniform(0,.7),B[B.length-3]=1.2,B[B.length-2]=1.1,B[B.length-1]=.9),Z.push(Math.min(p*1.5,12))}for(let oe=0;oe<ae;oe++){const le=m*Math.sqrt(oe/ae)*2*Math.PI,X=oe%o*r,L=M*Math.sqrt(oe/ae),l=L*Math.cos(le+X+y)+j.uniform(-n*L,n*L),i=L*Math.sin(le+X+y)+j.uniform(-n*L,n*L),t=j.gauss(0,3);W.push(l,t,i),B.push(1,1,.8);const c=C+oe*1337,v=new U(c),E=v.gauss(.8,.25),N=v.random()<.03,p=v.random()<.4;let f=Math.max(.2,E);N&&(f*=2.5+v.uniform(0,1.5)),p&&(f*=.4+v.uniform(0,.2)),L>M*.7&&(f*=.8),Z.push(Math.min(f*1.3,8))}}else if(a==="Elliptical"){ae=Math.min(I,1e5);for(let o=0;o<ae;o++){const r=j.uniform(0,2*Math.PI),n=j.uniform(-1,1),m=Math.sqrt(1-n*n),ce=j.random(),oe=Math.pow(ce,.6),le=-Math.log(1-oe*.98)*M*.35,X=le*m*Math.cos(r),L=le*n*.6,l=le*m*Math.sin(r);W.push(X,L,l),B.push(1,.9,.7);const i=C+o*1337,t=new U(i),c=t.gauss(.6,.2),v=t.random()<.08,E=t.random()<.25;let N=Math.max(.2,c);v&&(N*=2+t.uniform(0,1)),E&&(N*=.6+t.uniform(0,.2)),Math.sqrt(X*X+L*L+l*l)<M*.3&&(N*=1.5+t.uniform(0,.5)),Z.push(Math.min(N*1.4,7))}}else if(a==="Dwarf"){ae=Math.min(I/100,1e4);for(let o=0;o<ae;o++){const r=j.uniform(0,2*Math.PI),n=j.uniform(0,Math.PI),m=j.gauss(M/3,M*.3),ce=m*Math.sin(n)*Math.cos(r),oe=m*Math.cos(n)*.5,le=m*Math.sin(n)*Math.sin(r);W.push(ce,oe,le),B.push(.8,.8,1);const X=C+o*1337,L=new U(X),l=L.gauss(.7,.3),i=L.random()<.02,t=L.random()<.6;let c=Math.max(.3,l);i&&(c*=2.5+L.uniform(0,1)),t&&(c*=.5+L.uniform(0,.3)),Z.push(Math.min(c*1.2,5))}}else if(a==="Singularity Void"){ae=1e4;for(let s=0;s<ae;s++){const d=s/ae,h=d*30*Math.PI,J=M*(1-d*.8)+j.uniform(-10,10),z=(d-.5)*300+Math.sin(h*.5)*20,ue=J*Math.cos(h)+Math.sin(d*20)*10,me=J*Math.sin(h)+Math.cos(d*20)*10;W.push(ue,z,me);const _=(d+Math.sin(h*.1))%1,Q=new Ge;Q.setHSL(_,1,.5+Math.sin(d*10)*.3),B.push(Q.r,Q.g,Q.b),Z.push(j.uniform(.3,2)*(1+Math.sin(d*50)*.5))}const o=(s,d,h=1)=>{const J=new je(s,64,64),z=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,ue=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;
          
          void main() {
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);
            
            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;
            
            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;
            
            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x + 
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);
            
            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;
            
            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);
            
            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;
            
            gl_FragColor = vec4(color, ${d});
          }
        `,me=new Ie({uniforms:{time:{value:0},speed:{value:h}},vertexShader:z,fragmentShader:ue,transparent:!0,blending:Re,side:He,depthWrite:!1}),_=new H(J,me);return _.isSingularityShader=!0,_.shaderSpeed=h,_},r=o(250,.3,1);x.add(r);const n=o(180,.4,-.7);x.add(n);const m=o(120,.5,1.5);x.add(m);const ce=o(300,.2,.5);ce.scale.set(-1,1,1),x.add(ce);const oe=new je(350,32,32),le=new Ie({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            
            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          
          void main() {
            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;
            
            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Re,side:ht,depthWrite:!1}),X=new H(oe,le);X.isSingularityShader=!0,X.shaderSpeed=.3,x.add(X);const L=new Ae,l=[],i=[];for(let s=0;s<1e3;s++){const d=j.uniform(-M,M),h=j.uniform(-M/2,M/2),J=j.uniform(-M,M),z=j.uniform(-50,50),ue=j.uniform(-30,30),me=j.uniform(-50,50);l.push(d,h,J),l.push(d+z,h+ue,J+me);const _=j.random(),Q=new Ge;Q.setHSL(_,1,.6),i.push(Q.r,Q.g,Q.b),i.push(Q.r*.5,Q.g*.5,Q.b*.5)}L.setAttribute("position",new Me(l,3)),L.setAttribute("color",new Me(i,3));const t=new Te({vertexColors:!0,transparent:!0,opacity:.4,blending:Re}),c=new De(L,t);c.isGlitchLines=!0,x.add(c);const v=new Pe,E=new je(20,32,32),N=new ke({color:0,transparent:!0,opacity:.95}),p=new H(E,N);v.add(p);const f=new $e(25,80,64),te=new Ie({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;
          
          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);
            
            // Swirling pattern
            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;
            
            // Colors from hot (inner) to cold (outer)
            vec3 hotColor = vec3(1.0, 0.5, 0.0); // Orange
            vec3 coldColor = vec3(0.0, 0.3, 1.0); // Blue
            vec3 color = mix(coldColor, hotColor, intensity);
            
            // Add swirl variation
            color *= (0.7 + swirl * 0.3);
            
            // Fade out at edges
            float alpha = intensity * 0.8;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:Re,side:He}),de=new H(f,te);de.rotation.x=Math.PI/2,de.isAccretionDisk=!0,v.add(de);for(let s=0;s<8;s++){const d=30+s*20,h=new pt(d,1+s*.5,8,64),J=new ke({color:new Ge().setHSL((.7+s*.05)%1,1,.5),transparent:!0,opacity:.3-s*.03,wireframe:!0}),z=new H(h,J);z.rotation.x=j.uniform(0,Math.PI),z.rotation.y=j.uniform(0,Math.PI),z.isDistortionRing=!0,z.rotationSpeed=j.uniform(.001,.005)*(s%2===0?1:-1),v.add(z)}x.add(v);const g=new Ue(5,100,8),u=new Le({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:Re}),G=new H(g,u);G.position.y=50,x.add(G);const he=new H(g,u);he.position.y=-50,he.rotation.z=Math.PI,x.add(he)}if(a!=="Singularity Void"){const o=[],r=new U(C+999);for(let t=0;t<D;t++){const c=r.uniform(-50,50),v=r.uniform(-20,20),E=r.uniform(-50,50);o.push({x:c,y:v,z:E})}const n=[],m=[],ce=[],oe=[],le=[],X=.4,L=X*25;for(let t=0;t<W.length;t+=3){const c=W[t],v=W[t+1],E=W[t+2];let N=1/0,p=null;for(const f of o){const te=Math.sqrt(Math.pow(c-f.x,2)+Math.pow(v-f.y,2)+Math.pow(E-f.z,2));te<N&&(N=te,p=f)}if(!(N<X))if(N<L&&p){const f=1-(N-X)/(L-X);p.x-c,p.y-v,p.z-E;const te=Math.atan2(E-p.z,c-p.x),de=f*.8,g=8;for(let z=0;z<g-1;z++){const ue=z/(g-1),me=(z+1)/(g-1),_=N*(1-ue*de*.7),Q=te+ue*de*1.5,ne=p.x+_*Math.cos(Q),ie=v+(p.y-v)*ue*.3,ye=p.z+_*Math.sin(Q),Ne=N*(1-me*de*.7),fe=te+me*de*1.5,Ce=p.x+Ne*Math.cos(fe),Ee=v+(p.y-v)*me*.3,ze=p.z+Ne*Math.sin(fe);oe.push(ne,ie,ye),oe.push(Ce,Ee,ze)}const u=f*1.5,G=B[t],he=B[t+1],s=B[t+2],d=Math.min(G+u,2),h=Math.max(he*(1-u*.6),.1),J=Math.max(s*(1-u*.8),.1);for(let z=0;z<g-1;z++){const ue=z/(g-1),me=(z+1)/(g-1),_=1-ue*f*.6,Q=1-me*f*.6,ne=u*(.5+ue*.5),ie=u*(.5+me*.5);le.push(Math.min(d+ne*.3,2)*_,Math.max(h*(1-ne*.2),.1)*_,Math.max(J*(1-ne*.4),.1)*_),le.push(Math.min(d+ie*.3,2)*Q,Math.max(h*(1-ie*.2),.1)*Q,Math.max(J*(1-ie*.4),.1)*Q)}n.push(c,v,E),m.push(d,h,J),ce.push(Math.max(Z[t/3]*(1-f*.5),.3))}else n.push(c,v,E),m.push(B[t],B[t+1],B[t+2]),ce.push(Z[t/3])}S.setAttribute("position",new Me(n,3)),S.setAttribute("color",new Me(m,3)),S.setAttribute("size",new Me(ce,1));const l=new Ie({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (400.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {
            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);
            
            if (distanceFromCenter > 0.5) {
              discard;
            }
            
            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);
            
            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:Re,vertexColors:!0,depthWrite:!1}),i=new We(S,l);if(x.add(i),oe.length>0){const t=new Ae;t.setAttribute("position",new Me(oe,3)),t.setAttribute("color",new Me(le,3));const c=new Te({vertexColors:!0,transparent:!0,opacity:.8,linewidth:2,blending:Re}),v=new De(t,c);x.add(v)}}else{S.setAttribute("position",new Me(W,3)),S.setAttribute("color",new Me(B,3)),S.setAttribute("size",new Me(Z,1));const o=new ft({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:Re,sizeAttenuation:!0}),r=new We(S,o);x.add(r)}const pe=new U(C+999);for(let o=0;o<D;o++){const r=new Pe,n=pe.uniform(-50,50),m=pe.uniform(-20,20),ce=pe.uniform(-50,50),oe=new je(1.5,16,16),le=new ke({color:0,transparent:!0,opacity:.9}),X=new H(oe,le);r.add(X),[{innerRadius:2,outerRadius:2.3,color:16777215,opacity:.8,emissive:16777164},{innerRadius:2.3,outerRadius:2.7,color:16755200,opacity:.7,emissive:16746496},{innerRadius:2.7,outerRadius:3.2,color:16729088,opacity:.6,emissive:16720384},{innerRadius:3.2,outerRadius:4,color:11141120,opacity:.5,emissive:6684672},{innerRadius:4,outerRadius:5,color:4456448,opacity:.3,emissive:2228224}].forEach((l,i)=>{const t=new $e(l.innerRadius,l.outerRadius,32),c=new Le({color:l.color,transparent:!0,opacity:l.opacity,emissive:l.emissive,emissiveIntensity:.3,side:He}),v=new H(t,c);v.rotation.x=Math.PI/2,v.rotation.z=j.uniform(0,Math.PI*2),v.isAccretionRing=!0,v.rotationSpeed=.002+i*5e-4,r.add(v)}),r.position.set(n,m,ce),x.add(r)}for(let o=0;o<V;o++){const r=new je(1.5,8,8),n=new Le({color:16776960,emissive:16776960,emissiveIntensity:1}),m=new H(r,n);m.position.set(j.uniform(-M,M),j.uniform(-M/4,M/4),j.uniform(-M,M)),m.isPulsar=!0,m.pulseSpeed=j.uniform(1,3),x.add(m)}for(let o=0;o<k;o++){const r=new Pe,n=new je(2,16,16),m=new Le({color:16777215,emissive:16777215,emissiveIntensity:2}),ce=new H(n,m);r.add(ce);const oe=new Ue(1,20,8),le=new Le({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),X=new H(oe,le);X.position.y=10,r.add(X);const L=new H(oe,le);L.position.y=-10,L.rotation.z=Math.PI,r.add(L),r.position.set(j.uniform(-M,M),j.uniform(-M/4,M/4),j.uniform(-M,M)),x.add(r)}const K=new Ze(4210752,.5);re.add(K);const R=new xt(16777215,.5,1e3);R.position.set(0,100,0),re.add(R);const xe=o=>{o.key==="Escape"&&document.dispatchEvent(new CustomEvent("galaxy-close-fullscreen"))};document.addEventListener("keydown",xe);const be=()=>{$.current=requestAnimationFrame(be);const o=performance.now()/1e3;q.current&&(q.current.rotation.y+=.001),x.children.forEach(r=>{if(r.isPulsar){const n=r.pulseSpeed||1;r.scale.setScalar(1+Math.sin(Date.now()*.001*n)*.3)}if(r.isSingularityShader&&r instanceof H){const n=r.material;n.uniforms&&n.uniforms.time&&(n.uniforms.time.value=o);const m=r.shaderSpeed||1;r.rotation.y+=.001*m,r.rotation.x+=5e-4*m}if(r.isAccretionDisk&&r instanceof H){const n=r.material;n.uniforms&&n.uniforms.time&&(n.uniforms.time.value=o),r.rotation.z+=.002}if(r.isDistortionRing){const n=r.rotationSpeed||.001;r.rotation.x+=n,r.rotation.y+=n*.7,r.scale.setScalar(1+Math.sin(o*2)*.1)}if(r.isGlitchLines&&r instanceof De){const n=r.material;n.opacity=.2+Math.sin(o*3)*.2,r.rotation.z+=5e-4}r instanceof Pe&&r.children.forEach(n=>{if(n.isAccretionDisk&&n instanceof H){const m=n.material;m.uniforms&&m.uniforms.time&&(m.uniforms.time.value=o),n.rotation.z+=.002}if(n.isAccretionRing&&n instanceof H){const m=n.rotationSpeed||.002;n.rotation.z+=m}if(n.isDistortionRing){const m=n.rotationSpeed||.001;n.rotation.x+=m,n.rotation.y+=m*.7,n.scale.setScalar(1+Math.sin(o*2)*.1)}})}),T.current&&T.current.update(),ee.render(re,b)};be();const ve=()=>{if(!P.current||!ee)return;const o=P.current,r=o.clientWidth,n=o.clientHeight;ee.setSize(r,n),b.aspect=r/n,b.updateProjectionMatrix()};return window.addEventListener("resize",ve),()=>{window.removeEventListener("resize",ve),document.removeEventListener("keydown",xe),T.current&&T.current.dispose(),$.current&&cancelAnimationFrame($.current),Y&&ee.domElement&&Y.removeChild(ee.domElement),ee.dispose()}},[a,I,D,V,k,C]),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{ref:P,className:"w-full h-full"}),F&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:F})})]})},Ht=({galaxyUrl:a,galaxyType:I="Spiral",numSystems:D=1e4,blackHoles:V=5,pulsars:k=10,quasars:C=3,galaxyName:F})=>{const[P,ge]=w.useState("Aligning Stargate..."),[se,$]=w.useState(!1),[T,q]=w.useState(!1),[U,Y]=w.useState(!1),[O,A]=w.useState(!1);w.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){ge("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),$(!0);const ee=(S,W)=>Array.from({length:W},()=>S[Math.floor(Math.random()*S.length)]).join(""),we=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:35},{chars:"0123456789ABCDEF",duration:20,iterations:50},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:'\",.<>?/`~",duration:15,iterations:100}];let x=0,j=0;const y=()=>{if(x>=we.length){const W="Stargate system aligned";let B=0;ge("");const Z=()=>{B<W.length?(ge(W.substring(0,B+1)),B++,setTimeout(Z,30)):$(!1)};Z();return}const S=we[x];ge(ee(S.chars,32)),j++,j>=S.iterations&&(x++,j=0),setTimeout(y,S.duration)};y()},[]),w.useEffect(()=>{const b=document.createElement("style");return b.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(b),()=>{document.head.removeChild(b)}},[]);const re=()=>{Y(!0),setTimeout(()=>{q(!1),Y(!1)},300)};return w.useEffect(()=>(document.addEventListener("galaxy-close-fullscreen",re),()=>{document.removeEventListener("galaxy-close-fullscreen",re)}),[]),w.useEffect(()=>{if(O){const b=setTimeout(()=>A(!1),50);return()=>clearTimeout(b)}},[O]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Galaxy Visualization"})}),e.jsx("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:e.jsx(Ft,{galaxyType:I,numSystems:D,blackHoles:V,pulsars:k,quasars:C,galaxyName:F,onExpandClick:()=>{q(!0),A(!0)}})}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:a,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${se?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),P]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]}),T&&ot.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${U||O?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${U||O?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:"Galaxy View"})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Galaxy Visualization"}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Type: ",I," • Systems: ",D.toLocaleString()]})]})}),e.jsx("button",{onClick:re,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Bt,{galaxyType:I,numSystems:D,blackHoles:V,pulsars:k,quasars:C,galaxyName:F})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},Tt=({systems:a,coordinates:I})=>{const[D,V]=w.useState(new Map);return w.useEffect(()=>{(()=>{try{const C=new Map;a.forEach(F=>{const P=St(I,F.index,F.num_planets||1);C.set(F.index,P)}),V(C)}catch{}})()},[I,a]),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:a.map(k=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[(()=>{const C=D.get(k.index)||"none";return C==="complete"?e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}):C==="partial"?e.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500/20 border border-yellow-500/50 text-yellow-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"PARTIAL"}):null})(),e.jsxs("button",{onClick:()=>window.location.href=`/system/${k.index}`,className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["#",k.number]}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:k.name})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},k.index))}),a.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No systems found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This galaxy appears to be empty"})]})]})},qt=({currentGalaxy:a})=>{const[I,D]=w.useState(!1),[V,k]=w.useState(!1),[C,F]=w.useState(!0),P=1e7;w.useEffect(()=>{const[q,U,Y]=a.coordinates,O=!(q===0&&U===0&&Y===0),A=!(q===P&&U===P&&Y===P);D(O),k(A),F(!1)},[a.coordinates]);const ge=()=>{const[q,U,Y]=a.coordinates;return Y>0?[q,U,Y-1]:U>0?[q,U-1,P]:q>0?[q-1,P,P]:[0,0,0]},se=()=>{const[q,U,Y]=a.coordinates;return Y<P?[q,U,Y+1]:U<P?[q,U+1,0]:q<P?[q+1,0,0]:[P,P,P]},$=()=>{if(I){if(!Fe.canAffordTravel("galaxy",1)){Fe.executeTravel("galaxy",1);return}if(!Fe.executeTravel("galaxy",1))return;const[U,Y,O]=ge(),A=document.createElement("form");A.method="POST",A.action="/navigate";const re=document.createElement("input");re.type="hidden",re.name="x",re.value=U.toString();const b=document.createElement("input");b.type="hidden",b.name="y",b.value=Y.toString();const ee=document.createElement("input");ee.type="hidden",ee.name="z",ee.value=O.toString(),A.appendChild(re),A.appendChild(b),A.appendChild(ee),document.body.appendChild(A),A.submit()}},T=()=>{if(V){if(!Fe.canAffordTravel("galaxy",1)){Fe.executeTravel("galaxy",1);return}if(!Fe.executeTravel("galaxy",1))return;const[U,Y,O]=se(),A=document.createElement("form");A.method="POST",A.action="/navigate";const re=document.createElement("input");re.type="hidden",re.name="x",re.value=U.toString();const b=document.createElement("input");b.type="hidden",b.name="y",b.value=Y.toString();const ee=document.createElement("input");ee.type="hidden",ee.name="z",ee.value=O.toString(),A.appendChild(re),A.appendChild(b),A.appendChild(ee),document.body.appendChild(A),A.submit()}};return C?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:$,disabled:!I,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${I?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:T,disabled:!V,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${V?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},Vt=({page:a,prevPage:I,nextPage:D,finish:V})=>{const k="px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",C="bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg",F="bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white border border-white/20";return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 sm:gap-4 flex-wrap",children:[a!==1&&e.jsxs("button",{onClick:()=>window.location.href="/galaxy/1",className:`${k} ${F}`,title:"First page",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),I&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${I}`,className:`${k} ${F}`,title:"Previous page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),(()=>{const P=[],se=Math.max(1,a-2),$=Math.min(V,a+2);se>1&&(P.push(e.jsx("button",{onClick:()=>window.location.href="/galaxy/1",className:`${k} ${F}`,children:"1"},1)),se>2&&P.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"start-ellipsis")));for(let T=se;T<=$;T++)T===a?P.push(e.jsx("span",{className:`${k} ${C} cursor-default`,children:T},T)):P.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${T}`,className:`${k} ${F} cursor-pointer`,children:T},T));return $<V&&($<V-1&&P.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"end-ellipsis")),P.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${V}`,className:`${k} ${F}`,children:V},V))),P})(),D&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${D}`,className:`${k} ${F}`,title:"Next page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),a!==V&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${V}`,className:`${k} ${F}`,title:"Last page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]}),e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-400",children:["Page ",a," of ",V]})]})},st=({galaxy:a,systems:I,galaxy_url:D,version:V,page:k,prev_page:C,next_page:F,finish:P,image_url:ge})=>{const[se]=w.useState(a.coordinates.join(","));w.useEffect(()=>{document.body.setAttribute("data-coordinates",se),Nt(se)},[se]);const $=T=>T.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(zt,{}),e.jsxs("div",{className:"relative z-10 pt-1",children:[e.jsx(Rt,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["Galaxy '",$(a.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Coordinates ",a.coordinates.join(", ")]})]}),e.jsx(qt,{currentGalaxy:a}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(Ht,{galaxyUrl:D,galaxyType:a.galaxy_type,numSystems:a.num_systems,blackHoles:a.black_holes,pulsars:a.pulsars,quasars:a.quasars,galaxyName:$(a.name)})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(_t,{galaxy:a})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Systems in '",$(a.name),"'"]}),e.jsx(Tt,{systems:I,coordinates:se})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsx("span",{className:"text-base sm:text-lg",children:"← Go Back to Planetary Index"})})}),e.jsx(Vt,{page:k,prevPage:C,nextPage:F,finish:P})]}),e.jsx(It,{version:V})]}),e.jsx(Gt,{}),e.jsx(Ct,{currentLocation:{type:"galaxy",name:a.name,coordinates:a.coordinates.join(",")}})]})};document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("atlas-react-root");if(!a)return;const I=D=>{const V=document.getElementById(D);if(!V||!V.textContent)return null;try{return JSON.parse(V.textContent.trim())}catch{return null}};try{const D=I("data-galaxy")||{},V=I("data-systems")||[],k=I("data-navigation")||{},C=I("data-common")||{},F={galaxy:{name:D.name||"Unknown Galaxy",coordinates:D.coordinates||[0,0,0],galaxy_type:D.galaxy_type||"Unknown",num_systems:D.num_systems||0,black_holes:D.black_holes||0,pulsars:D.pulsars||0,quasars:D.quasars||0},systems:V,galaxy_url:k.galaxy_url||"#",version:C.version||"1.0.0",page:k.page||1,prev_page:k.prev_page,next_page:k.next_page,finish:k.finish||1,image_url:C.image_url||""};et.createRoot(a).render(tt.createElement(st,F))}catch{const V={galaxy:{name:"Unknown Galaxy",coordinates:[0,0,0],galaxy_type:"Unknown",num_systems:0,black_holes:0,pulsars:0,quasars:0},systems:[],galaxy_url:"#",version:"1.0.0",page:1,finish:1,image_url:""};et.createRoot(a).render(tt.createElement(st,V))}});
