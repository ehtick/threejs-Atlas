import{a as ft,g as vt,r as b,j as a,R as f}from"./atlas_BbN-uIjV0wYM8qO8tvbuH.js";var xt=ft();const yt=vt(xt);class C{static STORAGE_KEY="_atlasLocations";static MAX_LOCATIONS=50;static getLocations(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return[];const e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(t){return console.error("Error reading saved locations:",t),[]}}static saveLocation(t){try{const e=this.getLocations(),s=e.findIndex(i=>i.stargateUrl===t.stargateUrl),o={...t,id:this.generateId(),timestamp:Date.now()};s!==-1?(e[s]=o,console.log("📍 Updated saved location:",t.name)):(e.push(o),console.log("📍 Saved new location:",t.name)),e.length>this.MAX_LOCATIONS&&(e.sort((i,l)=>l.timestamp-i.timestamp),e.splice(this.MAX_LOCATIONS)),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(e){console.error("Error saving location:",e)}}static removeLocation(t){try{const s=this.getLocations().filter(o=>o.id!==t);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(s)),console.log("🗑️ Removed saved location")}catch(e){console.error("Error removing location:",e)}}static clearAllLocations(){try{localStorage.removeItem(this.STORAGE_KEY),console.log("🗑️ Cleared all saved locations")}catch(t){console.error("Error clearing locations:",t)}}static generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static getLocationStats(){const t=this.getLocations();return{total:t.length,galaxies:t.filter(e=>e.type==="galaxy").length,systems:t.filter(e=>e.type==="system").length,planets:t.filter(e=>e.type==="planet").length}}}class T{static encodeUrl(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_")}static generateGalaxyUrl(t,e=1){const s=`coordinates=${t[0]},${t[1]},${t[2]}&page=${e}`,o=this.encodeUrl(s);return`${window.location.origin}/stargate/${o}`}static generateSystemUrl(t,e,s=1){const o=`coordinates=${t[0]},${t[1]},${t[2]}&system=${e}&page=${s}`,i=this.encodeUrl(o);return`${window.location.origin}/stargate/${i}`}static generatePlanetUrl(t,e,s,o=1){const i=`coordinates=${t[0]},${t[1]},${t[2]}&system=${e}&planet=${s.toLowerCase()}&page=${o}`,l=this.encodeUrl(i);return`${window.location.origin}/stargate/${l}`}static getCurrentPage(){try{const e=new URLSearchParams(window.location.search).get("page");if(e)return parseInt(e,10);const s=window.location.pathname.match(/\/galaxy\/(\d+)/);return s?parseInt(s[1],10):1}catch{return 1}}}const Rt=({type:n,name:t,coordinates:e,systemIndex:s,planetName:o,className:i=""})=>{const[l,h]=b.useState(!1),[c,r]=b.useState(!1),m=()=>{try{const g=e.split(",").map(Number),v=T.getCurrentPage();switch(n){case"galaxy":return T.generateGalaxyUrl(g,v);case"system":if(s!==void 0)return T.generateSystemUrl(g,s,v);break;case"planet":if(s!==void 0&&o)return T.generatePlanetUrl(g,s,o,v);break}return window.location.pathname}catch(g){return console.error("Error generating stargate URL:",g),window.location.pathname}};b.useEffect(()=>{const g=C.getLocations(),v=m(),y=g.some(d=>d.stargateUrl===v);h(y)},[e,s,o,n]);const p=async()=>{r(!0);try{const g=m();C.saveLocation({name:t,type:n,stargateUrl:g}),h(!0),setTimeout(()=>{r(!1)},300)}catch(g){console.error("Error saving location:",g),r(!1)}},u=g=>g.replace(/_/g," ");return a.jsx(a.Fragment,{children:a.jsx("button",{onClick:p,disabled:l||c,className:`inline-flex items-center self-start space-x-1 px-1.5 py-0.5 rounded transition-all duration-200 text-[10px] font-medium ${l?"bg-green-500/20 border border-green-500/50 text-green-400 cursor-default":c?"bg-blue-500/20 border border-blue-500/50 text-blue-400 cursor-wait":"bg-white/10 hover:bg-white/20 border border-white/20 hover:border-white/40 text-white hover:text-blue-300"} ${i}`,title:l?"Location saved":`Save ${u(t)} to bookmarks`,children:c?a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a.jsx("span",{className:"text-[10px] uppercase",children:"Saving..."})]}):l?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),a.jsx("span",{className:"text-[10px] uppercase",children:"Saved"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),a.jsx("span",{className:"text-[10px] uppercase",children:"Save Location"})]})})})};function wt(){return f.createElement("svg",{"aria-hidden":"true","data-rmiz-btn-unzoom-icon":!0,fill:"currentColor",focusable:"false",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},f.createElement("path",{d:"M 14.144531 1.148438 L 9 6.292969 L 9 3 L 8 3 L 8 8 L 13 8 L 13 7 L 9.707031 7 L 14.855469 1.851563 Z M 8 8 L 3 8 L 3 9 L 6.292969 9 L 1.148438 14.144531 L 1.851563 14.855469 L 7 9.707031 L 7 13 L 8 13 Z"}))}function bt(){return f.createElement("svg",{"aria-hidden":"true","data-rmiz-btn-zoom-icon":!0,fill:"currentColor",focusable:"false",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},f.createElement("path",{d:"M 9 1 L 9 2 L 12.292969 2 L 2 12.292969 L 2 9 L 1 9 L 1 14 L 6 14 L 6 13 L 2.707031 13 L 13 2.707031 L 13 6 L 14 6 L 14 1 Z"}))}const $=(n,t)=>n===t?.tagName?.toUpperCase?.(),_=n=>$("DIV",n)||$("SPAN",n),R=n=>$("IMG",n),q=n=>n.complete&&n.naturalHeight!==0,k=n=>$("SVG",n),tt=({height:n,offset:t,width:e})=>Math.min((window.innerWidth-t*2)/e,(window.innerHeight-t*2)/n),St=({containerHeight:n,containerWidth:t,offset:e,targetHeight:s,targetWidth:o})=>{const i=tt({height:s,offset:e,width:o}),l=o>s?o/t:s/n;return i>1?l:i*l},I=({containerHeight:n,containerWidth:t,hasScalableSrc:e,offset:s,targetHeight:o,targetWidth:i})=>!n||!t?1:!e&&o&&i?St({containerHeight:n,containerWidth:t,offset:s,targetHeight:o,targetWidth:i}):tt({height:n,offset:s,width:t}),Et=/url(?:\(['"]?)(.*?)(?:['"]?\))/,Q=n=>{if(n){if(R(n))return n.currentSrc;if(_(n)){const t=window.getComputedStyle(n).backgroundImage;if(t)return Et.exec(t)?.[1]}}},Lt=n=>{if(n)return R(n)?n.alt??void 0:n.getAttribute("aria-label")??void 0},Nt=({containerHeight:n,containerLeft:t,containerTop:e,containerWidth:s,hasScalableSrc:o,offset:i,targetHeight:l,targetWidth:h})=>{const c=I({containerHeight:n,containerWidth:s,hasScalableSrc:o,offset:i,targetHeight:l,targetWidth:h});return{top:e,left:t,width:s*c,height:n*c,transform:`translate(0,0) scale(${1/c})`}},w=({position:n,relativeNum:t})=>{const e=parseFloat(n);return n.endsWith("%")?t*e/100:e},Ct=({containerHeight:n,containerLeft:t,containerTop:e,containerWidth:s,hasScalableSrc:o,objectFit:i,objectPosition:l,offset:h,targetHeight:c,targetWidth:r})=>{if(i==="scale-down"&&(r<=s&&c<=n?i="none":i="contain"),i==="cover"||i==="contain"){const m=s/r,p=n/c,u=i==="cover"?Math.max(m,p):Math.min(m,p),[g="50%",v="50%"]=l.split(" "),y=w({position:g,relativeNum:s-r*u}),d=w({position:v,relativeNum:n-c*u}),x=I({containerHeight:c*u,containerWidth:r*u,hasScalableSrc:o,offset:h,targetHeight:c,targetWidth:r});return{top:e+d,left:t+y,width:r*u*x,height:c*u*x,transform:`translate(0,0) scale(${1/x})`}}else if(i==="none"){const[m="50%",p="50%"]=l.split(" "),u=w({position:m,relativeNum:s-r}),g=w({position:p,relativeNum:n-c}),v=I({containerHeight:c,containerWidth:r,hasScalableSrc:o,offset:h,targetHeight:c,targetWidth:r});return{top:e+g,left:t+u,width:r*v,height:c*v,transform:`translate(0,0) scale(${1/v})`}}else if(i==="fill"){const m=s/r,p=n/c,u=Math.max(m,p),g=I({containerHeight:c*u,containerWidth:r*u,hasScalableSrc:o,offset:h,targetHeight:c,targetWidth:r});return{width:s*g,height:n*g,transform:`translate(0,0) scale(${1/g})`}}else return{}},It=({backgroundPosition:n,backgroundSize:t,containerHeight:e,containerLeft:s,containerTop:o,containerWidth:i,hasScalableSrc:l,offset:h,targetHeight:c,targetWidth:r})=>{if(t==="cover"||t==="contain"){const m=i/r,p=e/c,u=t==="cover"?Math.max(m,p):Math.min(m,p),[g="50%",v="50%"]=n.split(" "),y=w({position:g,relativeNum:i-r*u}),d=w({position:v,relativeNum:e-c*u}),x=I({containerHeight:c*u,containerWidth:r*u,hasScalableSrc:l,offset:h,targetHeight:c,targetWidth:r});return{top:o+d,left:s+y,width:r*u*x,height:c*u*x,transform:`translate(0,0) scale(${1/x})`}}else if(t==="auto"){const[m="50%",p="50%"]=n.split(" "),u=w({position:m,relativeNum:i-r}),g=w({position:p,relativeNum:e-c}),v=I({containerHeight:c,containerWidth:r,hasScalableSrc:l,offset:h,targetHeight:c,targetWidth:r});return{top:o+g,left:s+u,width:r*v,height:c*v,transform:`translate(0,0) scale(${1/v})`}}else{const[m="50%",p="50%"]=t.split(" "),u=w({position:m,relativeNum:i}),g=w({position:p,relativeNum:e}),v=u/r,y=g/c,d=Math.min(v,y),[x="50%",S="50%"]=n.split(" "),E=w({position:x,relativeNum:i-r*d}),A=w({position:S,relativeNum:e-c*d}),L=I({containerHeight:c*d,containerWidth:r*d,hasScalableSrc:l,offset:h,targetHeight:c,targetWidth:r});return{top:o+A,left:s+E,width:r*d*L,height:c*d*L,transform:`translate(0,0) scale(${1/L})`}}},jt=/\.svg$/i,Dt=({hasZoomImg:n,imgSrc:t,isSvg:e,isZoomed:s,loadedImgEl:o,offset:i,shouldRefresh:l,targetEl:h})=>{const c=e||t?.slice?.(0,18)==="data:image/svg+xml"||n||!!(t&&jt.test(t)),r=h.getBoundingClientRect(),m=window.getComputedStyle(h),p=o!=null&&_(h),u=o!=null&&!p,g=Nt({containerHeight:r.height,containerLeft:r.left,containerTop:r.top,containerWidth:r.width,hasScalableSrc:c,offset:i,targetHeight:o?.naturalHeight||r.height,targetWidth:o?.naturalWidth||r.width}),v=u?Ct({containerHeight:r.height,containerLeft:r.left,containerTop:r.top,containerWidth:r.width,hasScalableSrc:c,objectFit:m.objectFit,objectPosition:m.objectPosition,offset:i,targetHeight:o?.naturalHeight||r.height,targetWidth:o?.naturalWidth||r.width}):void 0,y=p?It({backgroundPosition:m.backgroundPosition,backgroundSize:m.backgroundSize,containerHeight:r.height,containerLeft:r.left,containerTop:r.top,containerWidth:r.width,hasScalableSrc:c,offset:i,targetHeight:o?.naturalHeight||r.height,targetWidth:o?.naturalWidth||r.width}):void 0,d=Object.assign({},g,v,y);if(s){const x=window.innerWidth/2,S=window.innerHeight/2,E=parseFloat(String(d.left||0))+parseFloat(String(d.width||0))/2,A=parseFloat(String(d.top||0))+parseFloat(String(d.height||0))/2,L=x-E,z=S-A;l&&(d.transitionDuration="0.01ms"),d.transform=`translate(${L}px,${z}px) scale(1)`}return d},G=n=>{if(!n)return{};if(k(n)){const t=n.parentElement,e=n.getBoundingClientRect();if(t){const s=t.getBoundingClientRect();return{height:e.height,left:s.left-e.left,top:s.top-e.top,width:e.width}}else return{height:e.height,left:e.left,width:e.width,top:e.top}}else return{height:n.offsetHeight,left:n.offsetLeft,width:n.offsetWidth,top:n.offsetTop}},At=n=>{const t="-zoom",e=["clip-path","fill","mask","marker-start","marker-mid","marker-end"],s=new Map;if(n.hasAttribute("id")){const o=n.id,i=o+t;s.set(o,i),n.id=i}n.querySelectorAll("[id]").forEach(o=>{const i=o.id,l=i+t;s.set(i,l),o.id=l}),s.forEach((o,i)=>{const l=`url(#${i})`,h=`url(#${o})`,c=e.map(r=>`[${r}="${l}"]`).join(", ");n.querySelectorAll(c).forEach(r=>{e.forEach(m=>{r.getAttribute(m)===l&&r.setAttribute(m,h)})})}),n.querySelectorAll("style").forEach(o=>{s.forEach((i,l)=>{o.textContent&&(o.textContent=o.textContent.replaceAll(`#${l}`,`#${i}`))})})},Ot=["img","svg",'[role="img"]',"[data-zoom]"].map(n=>`${n}:not([aria-hidden="true"])`).join(","),W={overflow:"",width:""};function zt(n){return f.createElement(et,{...n})}class et extends f.Component{constructor(){super(...arguments),this.state={id:"",isZoomImgLoaded:!1,loadedImgEl:void 0,modalState:"UNLOADED",shouldRefresh:!1,styleGhost:{}},this.refContent=f.createRef(),this.refDialog=f.createRef(),this.refModalContent=f.createRef(),this.refModalImg=f.createRef(),this.refWrap=f.createRef(),this.imgEl=null,this.isScaling=!1,this.prevBodyAttrs=W,this.styleModalImg={},this.handleModalStateChange=t=>{const{modalState:e}=this.state;t!=="LOADING"&&e==="LOADING"?(this.loadZoomImg(),window.addEventListener("resize",this.handleResize,{passive:!0}),window.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),window.addEventListener("touchmove",this.handleTouchMove,{passive:!0}),window.addEventListener("touchend",this.handleTouchEnd,{passive:!0}),window.addEventListener("touchcancel",this.handleTouchCancel,{passive:!0}),document.addEventListener("keydown",this.handleKeyDown,!0)):t!=="LOADED"&&e==="LOADED"?window.addEventListener("wheel",this.handleWheel,{passive:!0}):t!=="UNLOADING"&&e==="UNLOADING"?(this.ensureImgTransitionEnd(),window.removeEventListener("wheel",this.handleWheel),window.removeEventListener("touchstart",this.handleTouchStart),window.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("touchend",this.handleTouchEnd),window.removeEventListener("touchcancel",this.handleTouchCancel),document.removeEventListener("keydown",this.handleKeyDown,!0)):t!=="UNLOADED"&&e==="UNLOADED"&&(this.bodyScrollEnable(),window.removeEventListener("resize",this.handleResize),this.refModalImg.current?.removeEventListener?.("transitionend",this.handleImgTransitionEnd),this.refDialog.current?.close?.())},this.getDialogContainer=()=>{let t=document.querySelector("[data-rmiz-portal]");return t==null&&(t=document.createElement("div"),t.setAttribute("data-rmiz-portal",""),document.body.appendChild(t)),t},this.setId=()=>{const t=()=>Math.random().toString(16).slice(-4);this.setState({id:t()+t()+t()})},this.setAndTrackImg=()=>{const t=this.refContent.current;t&&(this.imgEl=t.querySelector(Ot),this.imgEl?(this.contentNotFoundChangeObserver?.disconnect?.(),this.imgEl.addEventListener("load",this.handleImgLoad),this.imgEl.addEventListener("click",this.handleZoom),this.state.loadedImgEl||this.handleImgLoad(),this.imgElResizeObserver=new ResizeObserver(e=>{const s=e[0];s?.target&&(this.imgEl=s.target,this.setState({styleGhost:G(this.imgEl)}))}),this.imgElResizeObserver.observe(this.imgEl),this.contentChangeObserver||(this.contentChangeObserver=new MutationObserver(()=>{this.setState({styleGhost:G(this.imgEl)})}),this.contentChangeObserver.observe(t,{attributes:!0,childList:!0,subtree:!0}))):this.contentNotFoundChangeObserver||(this.contentNotFoundChangeObserver=new MutationObserver(this.setAndTrackImg),this.contentNotFoundChangeObserver.observe(t,{childList:!0,subtree:!0})))},this.handleIfZoomChanged=t=>{const{isZoomed:e}=this.props;!t&&e?this.zoom():t&&!e&&this.unzoom()},this.handleImgLoad=()=>{const t=Q(this.imgEl);if(!t)return;const e=new Image;R(this.imgEl)&&(e.sizes=this.imgEl.sizes,e.srcset=this.imgEl.srcset,e.crossOrigin=this.imgEl.crossOrigin),e.src=t;const s=()=>{this.setState({loadedImgEl:e,styleGhost:G(this.imgEl)})};e.decode().then(s).catch(()=>{if(q(e)){s();return}e.onload=s})},this.handleZoom=()=>{!this.props.isDisabled&&this.hasImage()&&this.props.onZoomChange?.(!0)},this.handleUnzoom=()=>{this.props.isDisabled||this.props.onZoomChange?.(!1)},this.handleBtnUnzoomClick=t=>{t.preventDefault(),t.stopPropagation(),this.handleUnzoom()},this.handleDialogCancel=t=>{t.preventDefault()},this.handleDialogClick=t=>{(t.target===this.refModalContent.current||t.target===this.refModalImg.current)&&(t.stopPropagation(),this.handleUnzoom())},this.handleDialogClose=t=>{t.stopPropagation(),this.handleUnzoom()},this.handleKeyDown=t=>{(t.key==="Escape"||t.keyCode===27)&&(t.preventDefault(),t.stopPropagation(),this.handleUnzoom())},this.handleWheel=t=>{t.ctrlKey||(t.stopPropagation(),queueMicrotask(()=>{this.handleUnzoom()}))},this.handleTouchStart=t=>{if(t.touches.length>1){this.isScaling=!0;return}t.changedTouches.length===1&&t.changedTouches[0]&&(this.touchYStart=t.changedTouches[0].screenY)},this.handleTouchMove=t=>{const e=window.visualViewport?.scale??1;if(this.props.canSwipeToUnzoom&&!this.isScaling&&e<=1&&this.touchYStart!=null&&t.changedTouches[0]){this.touchYEnd=t.changedTouches[0].screenY;const s=Math.max(this.touchYStart,this.touchYEnd),o=Math.min(this.touchYStart,this.touchYEnd);Math.abs(s-o)>this.props.swipeToUnzoomThreshold&&(this.touchYStart=void 0,this.touchYEnd=void 0,this.handleUnzoom())}},this.handleTouchEnd=()=>{this.isScaling=!1,this.touchYStart=void 0,this.touchYEnd=void 0},this.handleTouchCancel=()=>{this.isScaling=!1,this.touchYStart=void 0,this.touchYEnd=void 0},this.handleResize=()=>{this.setState({shouldRefresh:!0})},this.hasImage=()=>this.imgEl&&(this.state.loadedImgEl||k(this.imgEl))&&window.getComputedStyle(this.imgEl).display!=="none",this.zoom=()=>{this.bodyScrollDisable(),this.refDialog.current?.showModal?.(),this.refModalImg.current?.addEventListener?.("transitionend",this.handleImgTransitionEnd),this.setState({modalState:"LOADING"})},this.unzoom=()=>{this.setState({modalState:"UNLOADING"})},this.handleImgTransitionEnd=()=>{clearTimeout(this.timeoutTransitionEnd),this.state.modalState==="LOADING"?this.setState({modalState:"LOADED"}):this.state.modalState==="UNLOADING"&&this.setState({shouldRefresh:!1,modalState:"UNLOADED"})},this.ensureImgTransitionEnd=()=>{if(this.refModalImg.current){const t=window.getComputedStyle(this.refModalImg.current).transitionDuration,e=parseFloat(t);if(e){const s=e*(t.endsWith("ms")?1:1e3)+50;this.timeoutTransitionEnd=setTimeout(this.handleImgTransitionEnd,s)}}},this.bodyScrollDisable=()=>{this.prevBodyAttrs={overflow:document.body.style.overflow,width:document.body.style.width};const t=document.body.clientWidth;document.body.style.overflow="hidden",document.body.style.width=`${t}px`},this.bodyScrollEnable=()=>{document.body.style.width=this.prevBodyAttrs.width,document.body.style.overflow=this.prevBodyAttrs.overflow,this.prevBodyAttrs=W},this.loadZoomImg=()=>{const{props:{zoomImg:t}}=this,e=t?.src;if(e){const s=new Image;s.sizes=t?.sizes??"",s.srcset=t?.srcSet??"",s.crossOrigin=t?.crossOrigin??void 0,s.src=e;const o=()=>{this.setState({isZoomImgLoaded:!0})};s.decode().then(o).catch(()=>{if(q(s)){o();return}s.onload=o})}},this.UNSAFE_handleSvg=()=>{const{imgEl:t,refModalImg:e,styleModalImg:s}=this;if(k(t)){const o=t.cloneNode(!0);At(o),o.style.width=`${s.width||0}px`,o.style.height=`${s.height||0}px`,o.addEventListener("click",this.handleUnzoom),e.current?.firstChild?.remove?.(),e.current?.appendChild?.(o)}}}render(){const{handleBtnUnzoomClick:t,handleDialogCancel:e,handleDialogClick:s,handleDialogClose:o,handleUnzoom:i,handleZoom:l,imgEl:h,props:{a11yNameButtonUnzoom:c,a11yNameButtonZoom:r,children:m,classDialog:p,IconUnzoom:u,IconZoom:g,isZoomed:v,wrapElement:y,ZoomContent:d,zoomImg:x,zoomMargin:S},refContent:E,refDialog:A,refModalContent:L,refModalImg:z,refWrap:st,state:{id:P,isZoomImgLoaded:B,loadedImgEl:ot,modalState:N,shouldRefresh:nt,styleGhost:at}}=this,Y=`rmiz-modal-${P}`,Z=`rmiz-modal-img-${P}`,it=_(h),M=R(h),K=k(h),U=Lt(h),F=Q(h),rt=M?h.sizes:void 0,lt=M?h.srcset:void 0,ct=M?h.crossOrigin:void 0,dt=!!x?.src,O=this.hasImage(),ht=U?`${r}: ${U}`:r,mt=N==="LOADING"||N==="LOADED",gt=O?"found":"not-found",ut=N==="UNLOADED"||N==="UNLOADING"?"hidden":"visible",pt={visibility:N==="UNLOADED"?"visible":"hidden"};this.styleModalImg=O?Dt({hasZoomImg:dt,imgSrc:F,isSvg:K,isZoomed:v&&mt,loadedImgEl:ot,offset:S,shouldRefresh:nt,targetEl:h}):{};let V=null;if(O){const X=M||it?f.createElement("img",{alt:U,crossOrigin:ct,sizes:rt,src:F,srcSet:lt,...B&&N==="LOADED"?x:{},"data-rmiz-modal-img":"",height:this.styleModalImg.height||void 0,id:Z,ref:z,style:this.styleModalImg,width:this.styleModalImg.width||void 0}):K?f.createElement("div",{"data-rmiz-modal-img":!0,ref:z,style:this.styleModalImg}):null,J=f.createElement("button",{"aria-label":c,"data-rmiz-btn-unzoom":"",onClick:t,type:"button"},f.createElement(u,null));V=d?f.createElement(d,{buttonUnzoom:J,modalState:N,img:X,isZoomImgLoaded:B,onUnzoom:i}):f.createElement(f.Fragment,null,X,J)}return f.createElement(y,{"aria-owns":Y,"data-rmiz":"",ref:st},f.createElement(y,{"data-rmiz-content":gt,ref:E,style:pt},m),O&&f.createElement(y,{"data-rmiz-ghost":"",style:at},f.createElement("button",{"aria-label":ht,"data-rmiz-btn-zoom":"",onClick:l,type:"button"},f.createElement(g,null))),O&&yt.createPortal(f.createElement("dialog",{"aria-labelledby":Z,"aria-modal":"true",className:p,"data-rmiz-modal":"",id:Y,onClick:s,onClose:o,onCancel:e,ref:A,role:"dialog"},f.createElement("div",{"data-rmiz-modal-overlay":ut}),f.createElement("div",{"data-rmiz-modal-content":"",ref:L},V)),this.getDialogContainer()))}componentDidMount(){this.setId(),this.setAndTrackImg(),this.handleImgLoad(),this.UNSAFE_handleSvg()}componentWillUnmount(){this.state.modalState!=="UNLOADED"&&this.bodyScrollEnable(),this.contentChangeObserver?.disconnect?.(),this.contentNotFoundChangeObserver?.disconnect?.(),this.imgElResizeObserver?.disconnect?.(),this.imgEl?.removeEventListener?.("load",this.handleImgLoad),this.imgEl?.removeEventListener?.("click",this.handleZoom),this.refModalImg.current?.removeEventListener?.("transitionend",this.handleImgTransitionEnd),window.removeEventListener("wheel",this.handleWheel),window.removeEventListener("touchstart",this.handleTouchStart),window.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("touchend",this.handleTouchEnd),window.removeEventListener("touchcancel",this.handleTouchCancel),window.removeEventListener("resize",this.handleResize),document.removeEventListener("keydown",this.handleKeyDown,!0)}componentDidUpdate(t,e){this.handleModalStateChange(e.modalState),this.UNSAFE_handleSvg(),this.handleIfZoomChanged(t.isZoomed)}}et.defaultProps={a11yNameButtonUnzoom:"Minimize image",a11yNameButtonZoom:"Expand image",canSwipeToUnzoom:!0,IconUnzoom:wt,IconZoom:bt,isDisabled:!1,swipeToUnzoomThreshold:10,wrapElement:"div",zoomMargin:0};function Ut(n){const[t,e]=f.useState(!1);return f.createElement(zt,{...n,isZoomed:t,onZoomChange:e})}const j=n=>{const[t,e,s]=n.split(",").map(Number);return`${t.toString(36)}_${e.toString(36)}_${s.toString(36)}`};class D{static STORAGE_KEY="__atlasArchive";static MAX_ENTRIES_PER_GALAXY=1e3;static getData(){try{this.cleanupLegacyStorage();const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):{g:{}}}catch(t){return console.error("Error reading Atlas archive:",t),{g:{}}}}static cleanupLegacyStorage(){try{const t="atlasHistoricalData";localStorage.getItem(t)&&(localStorage.removeItem(t),console.log("🧹 Cleaned up legacy storage (atlasHistoricalData)"))}catch(t){console.error("Error cleaning up legacy storage:",t)}}static saveData(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(e){console.error("Error saving Atlas archive:",e)}}static performCleanup(t){const e=Object.keys(t.g);if(e.length>100){const s=e.slice(0,e.length-100);s.forEach(o=>delete t.g[o]),console.log(`🧹 Cleaned up ${s.length} old galaxy records`)}Object.keys(t.g).forEach(s=>{const o=t.g[s],i=Object.keys(o);i.length>this.MAX_ENTRIES_PER_GALAXY&&i.slice(0,i.length-this.MAX_ENTRIES_PER_GALAXY).forEach(h=>delete o[h])})}static performEmergencyCleanup(){const t=document.body.getAttribute("data-coordinates");if(t){const e=j(t),s=this.getData(),o=s.g[e];s.g={},o&&(s.g[e]=o),this.saveData(s),console.log("🚨 Emergency cleanup: kept only current galaxy data")}}static markPlanetVisited(t,e,s,o){const i=this.getData(),l=j(t),h=e.toString(16),c=o.findIndex(m=>m.name.toLowerCase()===s.toLowerCase());if(c===-1){console.warn(`Planet ${s} not found in system planets list`);return}i.g[l]||(i.g[l]={}),i.g[l][h]||(i.g[l][h]="");const r=this.bitmapToIndices(i.g[l][h]);r.includes(c)||(r.push(c),i.g[l][h]=this.indicesToBitmap(r),this.saveData(i),console.log(`✅ Marked planet '${s}' as visited (index: ${c})`))}static markSystemVisited(t,e){const s=this.getData(),o=j(t),i=e.toString(16);s.g[o]||(s.g[o]={}),s.g[o][i]||(s.g[o][i]="",this.saveData(s),console.log(`✅ Marked system ${e} as visited`))}static bitmapToIndices(t){return t?t.split("").map((e,s)=>e==="1"?s:-1).filter(e=>e!==-1):[]}static indicesToBitmap(t){if(t.length===0)return"";const e=Math.max(...t),s=Array(e+1).fill("0");return t.forEach(o=>{o>=0&&(s[o]="1")}),s.join("")}static isSystemVisited(t,e){const s=this.getData(),o=j(t),i=e.toString(16);return!!(s.g[o]&&i in s.g[o])}static getVisitedPlanets(t,e,s){const o=this.getData(),i=j(t),l=e.toString(16),h=o.g[i]?.[l]||"";return this.bitmapToIndices(h).map(r=>{const m=s[r];return m?m.name.toLowerCase():null}).filter(r=>r!==null)}static getVisitedPlanetCount(t,e){const s=this.getData(),o=j(t),i=e.toString(16),l=s.g[o]?.[i]||"";return this.bitmapToIndices(l).length}static getStorageStats(){const t=this.getData(),e=JSON.stringify(t);let s=0,o=0;return Object.values(t.g).forEach(i=>{s+=Object.keys(i).length,Object.values(i).forEach(l=>{o+=l.length})}),{size:e.length,galaxies:Object.keys(t.g).length,systems:s,planets:o}}}const Gt=(n,t,e,s)=>{D.markPlanetVisited(n,t,e,s)},_t=(n,t)=>{D.markSystemVisited(n,t)},Pt=(n,t,e)=>D.getVisitedPlanets(n,t,e),Mt=(n,t)=>D.isSystemVisited(n,t),Bt=(n,t,e,s)=>{if(!Mt(n,t))return"none";{const o=D.getVisitedPlanetCount(n,t);return o>=e&&e>0?"complete":(o>0,"partial")}},Tt=()=>D.getStorageStats();class kt{static STORAGE_KEY="_atlasDailyChallenges";static BASE_GOALS={galaxies:4,systems:10,planets:30};static getTodaysChallenges(){const t=new Date().toISOString().split("T")[0],e=this.getStoredChallenges();return!e||e.date!==t?this.createNewDayChallenges(t,e):e}static getStoredChallenges(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Error reading daily challenges:",t),null}}static createNewDayChallenges(t,e){const s=e?e.dayNumber+1:1,o=Math.pow(2,s-1),i=this.getCurrentStats(),l=[{type:"galaxies",current:i.galaxies,target:this.BASE_GOALS.galaxies*o,dayNumber:s,completed:!1},{type:"systems",current:i.systems,target:this.BASE_GOALS.systems*o,dayNumber:s,completed:!1},{type:"planets",current:i.planets,target:this.BASE_GOALS.planets*o,dayNumber:s,completed:!1}],h={date:t,dayNumber:s,challenges:l,lastReset:Date.now()};return this.saveChallenges(h),console.log(`🌟 Day ${s} challenges created! Multiplier: x${o}`),h}static getCurrentStats(){try{const t=localStorage.getItem("__atlasArchive");if(!t)return{galaxies:0,systems:0,planets:0};const e=JSON.parse(t);let s=0,o=0;return Object.values(e.g||{}).forEach(i=>{s+=Object.keys(i).length,Object.values(i).forEach(l=>{typeof l=="string"&&(o+=(l.match(/1/g)||[]).length)})}),{galaxies:Object.keys(e.g||{}).length,systems:s,planets:o}}catch(t){return console.error("Error getting current stats:",t),{galaxies:0,systems:0,planets:0}}}static updateProgress(){const t=this.getTodaysChallenges(),e=this.getCurrentStats();return t.challenges.forEach(s=>{const o=e[s.type];s.current=o,s.completed=o>=s.target}),this.saveChallenges(t),t}static saveChallenges(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(e){console.error("Error saving daily challenges:",e)}}static getCompletionStatus(){const t=this.getTodaysChallenges(),e=t.challenges.filter(o=>o.completed).length,s=t.challenges.length;return{completed:e,total:s,allCompleted:e===s}}static getDayInfo(){const t=this.getTodaysChallenges();return{dayNumber:t.dayNumber,multiplier:Math.pow(2,t.dayNumber-1)}}}const H=({value:n,max:t,label:e,color:s="indigo",size:o="xs",showPercentage:i=!1})=>{const l=t>0?Math.min(n/t*100,100):0,h={indigo:{bg:"bg-indigo-500/20",fill:"bg-gradient-to-r from-indigo-500 to-indigo-400",text:"text-indigo-400"},blue:{bg:"bg-blue-500/20",fill:"bg-gradient-to-r from-blue-500 to-blue-400",text:"text-blue-400"},purple:{bg:"bg-purple-500/20",fill:"bg-gradient-to-r from-purple-500 to-purple-400",text:"text-purple-400"},cyan:{bg:"bg-cyan-500/20",fill:"bg-gradient-to-r from-cyan-500 to-cyan-400",text:"text-cyan-400"},green:{bg:"bg-green-500/20",fill:"bg-gradient-to-r from-green-500 to-green-400",text:"text-green-400"}},c={xs:"h-1.5",sm:"h-2"},r=h[s],m=c[o];return a.jsxs("div",{className:"w-full",children:[e&&a.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[a.jsx("span",{className:"text-gray-400",children:e}),i&&a.jsxs("span",{className:`${r.text} font-medium`,children:[l.toFixed(0),"%"]})]}),a.jsx("div",{className:`w-full ${r.bg} rounded-full overflow-hidden ${m}`,children:a.jsx("div",{className:`${r.fill} ${m} rounded-full transition-all duration-700 ease-out shadow-sm`,style:{width:`${l}%`},children:a.jsx("div",{className:`w-full h-full ${r.fill} opacity-50 animate-pulse`})})})]})},Yt=({currentLocation:n})=>{const[t,e]=b.useState(!1),[s,o]=b.useState("stats"),[i,l]=b.useState(null),[h,c]=b.useState([]),[r,m]=b.useState(null),[p,u]=b.useState(null);b.useEffect(()=>{if(t){l(Tt()),c(C.getLocations()),m(C.getLocationStats());const d=kt.updateProgress();u(d)}},[t]);const g=d=>{if(d===0)return"0 B";const x=1024,S=["B","KB","MB"],E=Math.floor(Math.log(d)/Math.log(x));return parseFloat((d/Math.pow(x,E)).toFixed(2))+" "+S[E]},v=d=>d.replace(/_/g," "),y=(d,x)=>{d.stopPropagation(),C.removeLocation(x),c(C.getLocations()),m(C.getLocationStats())};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed bottom-4 sm:bottom-6 right-4 sm:right-6 z-50",children:a.jsxs("button",{onClick:()=>e(!t),className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-600 via-purple-600 to-blue-800 hover:from-blue-500 hover:via-purple-500 hover:to-blue-700 text-white rounded-full shadow-2xl border-2 border-blue-400/30 transition-all duration-300 transform hover:scale-105 backdrop-blur-sm",title:"Spaceship Control Panel",children:[a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("svg",{className:"flex items-center justify-center",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",children:a.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[a.jsx("path",{d:"M12 3a6.02 6.02 0 0 0-5.923 4.9c-.086.466-.13.699.032 1.005c.161.307.39.409.847.613c1.38.614 3.134.982 5.044.982s3.665-.368 5.044-.982c.457-.204.686-.306.847-.613c.162-.306.118-.54.032-1.005A6.02 6.02 0 0 0 12 3"}),a.jsx("path",{d:"M17 5.5c2.989.788 5 2.26 5 3.945C22 11.961 17.523 14 12 14S2 11.96 2 9.445C2 7.76 4.011 6.288 7 5.5M12 18v3m5-4l1 4M7 17l-1 4"})]})})}),a.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-400/20 animate-ping"})]})}),t&&a.jsxs("div",{className:"fixed bottom-20 sm:bottom-24 right-2 sm:right-6 w-[calc(100vw-1rem)] sm:w-96 max-w-md max-h-[70vh] sm:max-h-96 bg-black/90 backdrop-blur-xl rounded-2xl border border-blue-400/30 shadow-2xl z-40 overflow-hidden",children:[a.jsxs("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 p-4 border-b border-white/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),a.jsx("h3",{className:"text-white font-bold text-lg",children:"🚀 Spaceship Control"})]}),a.jsx("button",{onClick:()=>e(!1),className:"text-gray-400 hover:text-white transition-colors duration-200",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.jsxs("div",{className:"flex mt-3 space-x-1",children:[a.jsx("button",{onClick:()=>o("stats"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${s==="stats"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:"📊 Statistics"}),a.jsxs("button",{onClick:()=>o("locations"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${s==="locations"?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:["📍 Saved Locations (",r?.total||0,")"]})]})]}),a.jsxs("div",{className:"p-4 max-h-64 overflow-y-auto",children:[s==="stats"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"text-white font-semibold text-sm",children:"🌟 Daily Challenges"}),p&&a.jsxs("div",{className:"text-xs text-indigo-400 font-medium",children:["Day ",p.dayNumber," • x",Math.pow(2,p.dayNumber-1)]})]}),p&&a.jsx("div",{className:"space-y-3 mb-4",children:p.challenges.map(d=>{const x={galaxies:"indigo",systems:"blue",planets:"purple"},S={galaxies:"Galaxies Explored",systems:"Systems Visited",planets:"Planets Discovered"};return a.jsxs("div",{className:"relative",children:[a.jsx(H,{value:d.current,max:d.target,label:`${S[d.type]}: ${d.current}/${d.target}`,color:x[d.type],showPercentage:!0}),d.completed&&a.jsx("div",{className:"absolute -right-3 top-0 text-white bg-green-500 px-0.5 rounded-full text-[8px]",children:"✓"})]},d.type)})}),p&&a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-4",children:[a.jsxs("div",{className:"bg-white/5 rounded-lg p-2 border border-indigo-500/20",children:[a.jsx("div",{className:"text-gray-400",children:"Completed"}),a.jsxs("div",{className:"text-indigo-400 font-bold",children:[p.challenges.filter(d=>d.completed).length,"/",p.challenges.length]})]}),a.jsxs("div",{className:"bg-white/5 rounded-lg p-2 border border-green-500/20",children:[a.jsx("div",{className:"text-gray-400",children:"Archive Size"}),a.jsx("div",{className:"text-green-400 font-bold",children:i?g(i.size):"0 B"})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold mb-3 text-sm",children:"📍 Saved Locations"}),a.jsx("div",{className:"mb-3",children:a.jsx(H,{value:r?.total||0,max:50,label:`Saved Locations: ${r?.total||0}/50`,color:"cyan",showPercentage:!0})}),a.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[a.jsxs("div",{className:"bg-white/5 rounded p-1.5 text-center",children:[a.jsx("div",{className:"text-gray-400 text-[10px]",children:"Galaxies"}),a.jsx("div",{className:"text-indigo-400 font-bold text-xs",children:r?.galaxies||0})]}),a.jsxs("div",{className:"bg-white/5 rounded p-1.5 text-center",children:[a.jsx("div",{className:"text-gray-400 text-[10px]",children:"Systems"}),a.jsx("div",{className:"text-blue-400 font-bold text-xs",children:r?.systems||0})]}),a.jsxs("div",{className:"bg-white/5 rounded p-1.5 text-center",children:[a.jsx("div",{className:"text-gray-400 text-[10px]",children:"Planets"}),a.jsx("div",{className:"text-purple-400 font-bold text-xs",children:r?.planets||0})]})]})]})]}),s==="locations"&&a.jsx("div",{className:"space-y-2",children:h.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"No saved locations"}),a.jsx("div",{className:"text-gray-500 text-xs",children:"Use the 📍 button to save locations"})]}):h.map(d=>a.jsx("div",{className:"bg-white/5 hover:bg-white/10 rounded-lg p-3 border border-white/10 hover:border-white/20 transition-all duration-200 group",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("a",{href:d.stargateUrl,className:"flex-1 min-w-0 hover:text-blue-300 transition-colors duration-200",title:`Navigate to ${v(d.name)}`,children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[a.jsxs("div",{className:"text-xs",children:[d.type==="galaxy"&&"🌌",d.type==="system"&&"⭐",d.type==="planet"&&"🪐"]}),a.jsx("div",{className:"text-white text-sm font-medium truncate",children:v(d.name)})]}),a.jsxs("div",{className:"text-gray-400 text-xs truncate",children:["Saved ",new Date(d.timestamp).toLocaleDateString()]})]}),a.jsx("button",{onClick:x=>y(x,d.id),className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-400 transition-all duration-200 ml-2",title:"Remove location",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},d.id))})]})]})]})};export{Rt as S,Ut as U,Yt as a,Pt as b,_t as c,Bt as g,Gt as m,xt as r};
