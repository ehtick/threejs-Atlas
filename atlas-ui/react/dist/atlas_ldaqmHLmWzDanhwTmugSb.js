import{r as x,j as e}from"./atlas_Bv5zr7cG9joXJ1l7Eo-6s.js";class y{static STORAGE_KEY="_atlasLocations";static MAX_LOCATIONS=50;static getLocations(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return[];const s=JSON.parse(t);return Array.isArray(s)?s:[]}catch(t){return console.error("Error reading saved locations:",t),[]}}static saveLocation(t){try{const s=this.getLocations(),a=s.findIndex(o=>o.stargateUrl===t.stargateUrl),r={...t,id:this.generateId(),timestamp:Date.now()};a!==-1?s[a]=r:s.push(r),s.length>this.MAX_LOCATIONS&&(s.sort((o,n)=>n.timestamp-o.timestamp),s.splice(this.MAX_LOCATIONS)),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(s))}catch(s){console.error("Error saving location:",s)}}static removeLocation(t){try{const a=this.getLocations().filter(r=>r.id!==t);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(a))}catch(s){console.error("Error removing location:",s)}}static clearAllLocations(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(t){console.error("Error clearing locations:",t)}}static generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static getLocationStats(){const t=this.getLocations();return{total:t.length,galaxies:t.filter(s=>s.type==="galaxy").length,systems:t.filter(s=>s.type==="system").length,planets:t.filter(s=>s.type==="planet").length}}}class S{static encodeUrl(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_")}static generateGalaxyUrl(t,s=1){const a=`coordinates=${t[0]},${t[1]},${t[2]}&page=${s}`,r=this.encodeUrl(a);return`${window.location.origin}/stargate/${r}`}static generateSystemUrl(t,s,a=1){const r=`coordinates=${t[0]},${t[1]},${t[2]}&system=${s}&page=${a}`,o=this.encodeUrl(r);return`${window.location.origin}/stargate/${o}`}static generatePlanetUrl(t,s,a,r=1){const o=`coordinates=${t[0]},${t[1]},${t[2]}&system=${s}&planet=${a.toLowerCase()}&page=${r}`,n=this.encodeUrl(o);return`${window.location.origin}/stargate/${n}`}static getCurrentPage(){try{const s=new URLSearchParams(window.location.search).get("page");if(s)return parseInt(s,10);const a=window.location.pathname.match(/\/galaxy\/(\d+)/);return a?parseInt(a[1],10):1}catch{return 1}}}const $=({type:l,name:t,coordinates:s,systemIndex:a,planetName:r,className:o=""})=>{const[n,d]=x.useState(!1),[h,c]=x.useState(!1),m=()=>{try{const g=s.split(",").map(Number),p=S.getCurrentPage();switch(l){case"galaxy":return S.generateGalaxyUrl(g,p);case"system":if(a!==void 0)return S.generateSystemUrl(g,a,p);break;case"planet":if(a!==void 0&&r)return S.generatePlanetUrl(g,a,r,p);break}return window.location.pathname}catch(g){return console.error("Error generating stargate URL:",g),window.location.pathname}};x.useEffect(()=>{const g=y.getLocations(),p=m(),w=g.some(i=>i.stargateUrl===p);d(w)},[s,a,r,l]);const u=async()=>{c(!0);try{const g=m();y.saveLocation({name:t,type:l,stargateUrl:g}),d(!0),setTimeout(()=>{c(!1)},300)}catch(g){console.error("Error saving location:",g),c(!1)}},j=g=>g.replace(/_/g," ");return e.jsx(e.Fragment,{children:e.jsx("button",{onClick:u,disabled:n||h,className:`inline-flex items-center self-start space-x-1 px-1.5 py-0.5 rounded transition-all duration-200 text-[10px] font-medium ${n?"bg-green-500/20 border border-green-500/50 text-green-400 cursor-default":h?"bg-blue-500/20 border border-blue-500/50 text-blue-400 cursor-wait":"bg-white/10 hover:bg-white/20 border border-white/20 hover:border-white/40 text-white hover:text-blue-300"} ${o}`,title:n?"Location saved":`Save ${j(t)} to bookmarks`,children:h?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-[10px] uppercase",children:"Saving..."})]}):n?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),e.jsx("span",{className:"text-[10px] uppercase",children:"Saved"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"text-[10px] uppercase",children:"Save"})]})})})},v=l=>{const[t,s,a]=l.split(",").map(Number);return`${t.toString(36)}_${s.toString(36)}_${a.toString(36)}`};class f{static STORAGE_KEY="__atlasArchive";static MAX_ENTRIES_PER_GALAXY=1e3;static getData(){try{this.cleanupLegacyStorage();const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):{g:{}}}catch(t){return console.error("Error reading Atlas archive:",t),{g:{}}}}static cleanupLegacyStorage(){try{const t="atlasHistoricalData";localStorage.getItem(t)&&localStorage.removeItem(t)}catch(t){console.error("Error cleaning up legacy storage:",t)}}static saveData(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(s){console.error("Error saving Atlas archive:",s)}}static performCleanup(t){const s=Object.keys(t.g);s.length>100&&s.slice(0,s.length-100).forEach(r=>delete t.g[r]),Object.keys(t.g).forEach(a=>{const r=t.g[a],o=Object.keys(r);o.length>this.MAX_ENTRIES_PER_GALAXY&&o.slice(0,o.length-this.MAX_ENTRIES_PER_GALAXY).forEach(d=>delete r[d])})}static performEmergencyCleanup(){const t=document.body.getAttribute("data-coordinates");if(t){const s=v(t),a=this.getData(),r=a.g[s];a.g={},r&&(a.g[s]=r),this.saveData(a)}}static markPlanetVisited(t,s,a,r){const o=this.getData(),n=v(t),d=s.toString(16),h=r.findIndex(m=>m.name.toLowerCase()===a.toLowerCase());if(h===-1){console.warn(`Planet ${a} not found in system planets list`);return}o.g[n]||(o.g[n]={}),o.g[n][d]||(o.g[n][d]="");const c=this.bitmapToIndices(o.g[n][d]);c.includes(h)||(c.push(h),o.g[n][d]=this.indicesToBitmap(c),this.saveData(o))}static markSystemVisited(t,s){const a=this.getData(),r=v(t),o=s.toString(16);a.g[r]||(a.g[r]={}),a.g[r][o]||(a.g[r][o]="",this.saveData(a))}static bitmapToIndices(t){return t?t.split("").map((s,a)=>s==="1"?a:-1).filter(s=>s!==-1):[]}static indicesToBitmap(t){if(t.length===0)return"";const s=Math.max(...t),a=Array(s+1).fill("0");return t.forEach(r=>{r>=0&&(a[r]="1")}),a.join("")}static isSystemVisited(t,s){const a=this.getData(),r=v(t),o=s.toString(16);return!!(a.g[r]&&o in a.g[r])}static getVisitedPlanets(t,s,a){const r=this.getData(),o=v(t),n=s.toString(16),d=r.g[o]?.[n]||"";return this.bitmapToIndices(d).map(c=>{const m=a[c];return m?m.name.toLowerCase():null}).filter(c=>c!==null)}static getVisitedPlanetCount(t,s){const a=this.getData(),r=v(t),o=s.toString(16),n=a.g[r]?.[o]||"";return this.bitmapToIndices(n).length}static getStorageStats(){const t=this.getData(),s=JSON.stringify(t);let a=0,r=0;return Object.values(t.g).forEach(o=>{a+=Object.keys(o).length,Object.values(o).forEach(n=>{r+=n.length})}),{size:s.length,galaxies:Object.keys(t.g).length,systems:a,planets:r}}}const _=(l,t,s,a)=>{f.markPlanetVisited(l,t,s,a)},D=(l,t)=>{f.markSystemVisited(l,t)},I=(l,t,s)=>f.getVisitedPlanets(l,t,s),C=(l,t)=>f.isSystemVisited(l,t),P=(l,t,s,a)=>{if(!C(l,t))return"none";{const r=f.getVisitedPlanetCount(l,t);return r>=s&&s>0?"complete":(r>0,"partial")}},A=()=>f.getStorageStats();class k{static STORAGE_KEY="_atlasDailyChallenges";static BASE_GOALS={galaxies:4,systems:10,planets:30};static getTodaysChallenges(){const t=new Date().toISOString().split("T")[0],s=this.getStoredChallenges();return!s||s.date!==t?this.createNewDayChallenges(t,s):s}static getStoredChallenges(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Error reading daily challenges:",t),null}}static createNewDayChallenges(t,s){const a=s?s.dayNumber+1:1,r=Math.pow(2,a-1),o=this.getCurrentStats(),n=[{type:"galaxies",current:o.galaxies,target:this.BASE_GOALS.galaxies*r,dayNumber:a,completed:!1},{type:"systems",current:o.systems,target:this.BASE_GOALS.systems*r,dayNumber:a,completed:!1},{type:"planets",current:o.planets,target:this.BASE_GOALS.planets*r,dayNumber:a,completed:!1}],d={date:t,dayNumber:a,challenges:n,lastReset:Date.now()};return this.saveChallenges(d),d}static getCurrentStats(){try{const t=localStorage.getItem("__atlasArchive");if(!t)return{galaxies:0,systems:0,planets:0};const s=JSON.parse(t);let a=0,r=0;return Object.values(s.g||{}).forEach(o=>{a+=Object.keys(o).length,Object.values(o).forEach(n=>{typeof n=="string"&&(r+=(n.match(/1/g)||[]).length)})}),{galaxies:Object.keys(s.g||{}).length,systems:a,planets:r}}catch(t){return console.error("Error getting current stats:",t),{galaxies:0,systems:0,planets:0}}}static updateProgress(){const t=this.getTodaysChallenges(),s=this.getCurrentStats();return t.challenges.forEach(a=>{const r=s[a.type];a.current=r,a.completed=r>=a.target}),this.saveChallenges(t),t}static saveChallenges(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(s){console.error("Error saving daily challenges:",s)}}static getCompletionStatus(){const t=this.getTodaysChallenges(),s=t.challenges.filter(r=>r.completed).length,a=t.challenges.length;return{completed:s,total:a,allCompleted:s===a}}static getDayInfo(){const t=this.getTodaysChallenges();return{dayNumber:t.dayNumber,multiplier:Math.pow(2,t.dayNumber-1)}}}const E=({value:l,max:t,label:s,color:a="indigo",size:r="xs",showPercentage:o=!1})=>{const n=t>0?Math.min(l/t*100,100):0,d={indigo:{bg:"bg-indigo-500/20",fill:"bg-gradient-to-r from-indigo-500 to-indigo-400",text:"text-indigo-400"},blue:{bg:"bg-blue-500/20",fill:"bg-gradient-to-r from-blue-500 to-blue-400",text:"text-blue-400"},purple:{bg:"bg-purple-500/20",fill:"bg-gradient-to-r from-purple-500 to-purple-400",text:"text-purple-400"},cyan:{bg:"bg-cyan-500/20",fill:"bg-gradient-to-r from-cyan-500 to-cyan-400",text:"text-cyan-400"},green:{bg:"bg-green-500/20",fill:"bg-gradient-to-r from-green-500 to-green-400",text:"text-green-400"}},h={xs:"h-1.5",sm:"h-2"},c=d[a],m=h[r];return e.jsxs("div",{className:"w-full",children:[s&&e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400",children:s}),o&&e.jsxs("span",{className:`${c.text} font-medium`,children:[n.toFixed(0),"%"]})]}),e.jsx("div",{className:`w-full ${c.bg} rounded-full overflow-hidden ${m}`,children:e.jsx("div",{className:`${c.fill} ${m} rounded-full transition-all duration-700 ease-out shadow-sm`,style:{width:`${n}%`},children:e.jsx("div",{className:`w-full h-full ${c.fill} opacity-50 animate-pulse`})})})]})},M=({currentLocation:l})=>{const[t,s]=x.useState(!1),[a,r]=x.useState("stats"),[o,n]=x.useState(null),[d,h]=x.useState([]),[c,m]=x.useState(null),[u,j]=x.useState(null);x.useEffect(()=>{if(t){n(A()),h(y.getLocations()),m(y.getLocationStats());const i=k.updateProgress();j(i)}},[t]);const g=i=>{if(i===0)return"0 B";const b=1024,N=["B","KB","MB"],L=Math.floor(Math.log(i)/Math.log(b));return parseFloat((i/Math.pow(b,L)).toFixed(2))+" "+N[L]},p=i=>i.replace(/_/g," "),w=(i,b)=>{i.stopPropagation(),y.removeLocation(b),h(y.getLocations()),m(y.getLocationStats())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed bottom-4 sm:bottom-6 right-4 sm:right-6 z-50",children:e.jsxs("button",{onClick:()=>s(!t),className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-600 via-purple-600 to-blue-800 hover:from-blue-500 hover:via-purple-500 hover:to-blue-700 text-white rounded-full shadow-2xl border-2 border-blue-400/30 transition-all duration-300 transform hover:scale-105 backdrop-blur-sm",title:"Spaceship Control Panel",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("svg",{className:"flex items-center justify-center",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[e.jsx("path",{d:"M12 3a6.02 6.02 0 0 0-5.923 4.9c-.086.466-.13.699.032 1.005c.161.307.39.409.847.613c1.38.614 3.134.982 5.044.982s3.665-.368 5.044-.982c.457-.204.686-.306.847-.613c.162-.306.118-.54.032-1.005A6.02 6.02 0 0 0 12 3"}),e.jsx("path",{d:"M17 5.5c2.989.788 5 2.26 5 3.945C22 11.961 17.523 14 12 14S2 11.96 2 9.445C2 7.76 4.011 6.288 7 5.5M12 18v3m5-4l1 4M7 17l-1 4"})]})})}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-400/20 animate-ping"})]})}),t&&e.jsxs("div",{className:"fixed bottom-20 sm:bottom-24 right-2 sm:right-6 w-[calc(100vw-1rem)] sm:w-96 max-w-md max-h-[70vh] sm:max-h-96 bg-black/90 backdrop-blur-xl rounded-2xl border border-blue-400/30 shadow-2xl z-40 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 p-4 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),e.jsx("h3",{className:"text-white font-bold text-lg",children:"🚀 Spaceship Control"})]}),e.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-white transition-colors duration-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex mt-3 space-x-1",children:[e.jsx("button",{onClick:()=>r("stats"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${a==="stats"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:"📊 Statistics"}),e.jsxs("button",{onClick:()=>r("locations"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${a==="locations"?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:["📍 Saved Locations (",c?.total||0,")"]})]})]}),e.jsxs("div",{className:"p-4 max-h-64 overflow-y-auto",children:[a==="stats"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-white font-semibold text-sm",children:"🌟 Daily Challenges"}),u&&e.jsxs("div",{className:"text-xs text-indigo-400 font-medium",children:["Day ",u.dayNumber," • x",Math.pow(2,u.dayNumber-1)]})]}),u&&e.jsx("div",{className:"space-y-3 mb-4",children:u.challenges.map(i=>{const b={galaxies:"indigo",systems:"blue",planets:"purple"},N={galaxies:"Galaxies Explored",systems:"Systems Visited",planets:"Planets Discovered"};return e.jsxs("div",{className:"relative",children:[e.jsx(E,{value:i.current,max:i.target,label:`${N[i.type]}: ${i.current}/${i.target}`,color:b[i.type],showPercentage:!0}),i.completed&&e.jsx("div",{className:"absolute -right-3 top-0 text-white bg-green-500 px-0.5 rounded-full text-[8px]",children:"✓"})]},i.type)})}),u&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-4",children:[e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 border border-indigo-500/20",children:[e.jsx("div",{className:"text-gray-400",children:"Completed"}),e.jsxs("div",{className:"text-indigo-400 font-bold",children:[u.challenges.filter(i=>i.completed).length,"/",u.challenges.length]})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-2 border border-green-500/20",children:[e.jsx("div",{className:"text-gray-400",children:"Archive Size"}),e.jsx("div",{className:"text-green-400 font-bold",children:o?g(o.size):"0 B"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-3 text-sm",children:"📍 Saved Locations"}),e.jsx("div",{className:"mb-3",children:e.jsx(E,{value:c?.total||0,max:50,label:`Saved Locations: ${c?.total||0}/50`,color:"cyan",showPercentage:!0})}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 text-center",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Galaxies"}),e.jsx("div",{className:"text-indigo-400 font-bold text-xs",children:c?.galaxies||0})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 text-center",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Systems"}),e.jsx("div",{className:"text-blue-400 font-bold text-xs",children:c?.systems||0})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 text-center",children:[e.jsx("div",{className:"text-gray-400 text-[10px]",children:"Planets"}),e.jsx("div",{className:"text-purple-400 font-bold text-xs",children:c?.planets||0})]})]})]})]}),a==="locations"&&e.jsx("div",{className:"space-y-2",children:d.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-sm mb-2",children:"No saved locations"}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Use the 📍 button to save locations"})]}):d.map(i=>e.jsx("div",{className:"bg-white/5 hover:bg-white/10 rounded-lg p-3 border border-white/10 hover:border-white/20 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("a",{href:i.stargateUrl,className:"flex-1 min-w-0 hover:text-blue-300 transition-colors duration-200",title:`Navigate to ${p(i.name)}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsxs("div",{className:"text-xs",children:[i.type==="galaxy"&&"🌌",i.type==="system"&&"⭐",i.type==="planet"&&"🪐"]}),e.jsx("div",{className:"text-white text-sm font-medium truncate",children:p(i.name)})]}),e.jsxs("div",{className:"text-gray-400 text-xs truncate",children:["Saved ",new Date(i.timestamp).toLocaleDateString()]})]}),e.jsx("button",{onClick:b=>w(b,i.id),className:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-red-400 transition-all duration-200 ml-2",title:"Remove location",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},i.id))})]})]})]})};export{$ as S,M as a,I as b,D as c,P as g,_ as m};
