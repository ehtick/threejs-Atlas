class l{constructor(){this.forbiddenWords=["nigga","nigger","negro","coon","chink","gook","spic","wetback","kike","heeb","raghead","towelhead","sandnigger","paki","pancho","panchito","faggot","fag","dyke","tranny","shemale","ladyboy","gay","queer","hitler","nazi","heil","sieg","aryan","swastika","1488","14/88","white power","white supremacy","kkk","ku klux","bitch","whore","slut","cunt","hoe","thot","kys","murder","rape","terrorist","genocide","holocaust","clickhere","buynow","freemoney","winner","prize","urgent","fuck","shit","damn","ass","piss","cock","dick","pussy","dildo","jewrat","mudslime","christcuck","islamist","jihadist","zionist","infidel","kafir","goyim","crusader","heathen","blasphemy","卐","卍","tripleparen","pepe","kek","based","redpilled"],this.urlPatterns=[/https?:\/\/[^\s]+/gi,/www\.[^\s]+/gi,/[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}/gi,/bit\.ly\/[^\s]+/gi,/tinyurl\.com\/[^\s]+/gi,/t\.co\/[^\s]+/gi],this.personalInfoPatterns=[/\b\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/g,/\b\d{3}[-.\s]?\d{2}[-.\s]?\d{2}[-.\s]?\d{2}[-.\s]?\d{2}\b/g,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g],this.obfuscationMap={"@":"a",4:"a",3:"e",1:"i","!":"i",0:"o",5:"s",7:"t","+":"t",ph:"f",ck:"ck",rn:"m",rrn:"rn",rrrn:"rrn",а:"a",е:"e",о:"o",р:"p",с:"c",х:"x",у:"y",і:"i",ѕ:"s",ј:"j","ӏ":"l",α:"a",ο:"o",ρ:"p",υ:"y",ν:"v"," ":"","​":"","‌":"","‍":"",ii:"i",oo:"o",aa:"a",ee:"e"}}normalizeText(e){if(!e||typeof e!="string")return"";let r=e.toLowerCase();r=r.replace(/[\s\-_\.]+/g,"");for(let t=0;t<3;t++)Object.entries(this.obfuscationMap).forEach(([n,s])=>{try{const i=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),a=new RegExp(i,"g");r=r.replace(a,s)}catch{r=r.replace(new RegExp(n,"g"),s)}});return r=r.replace(/rn/g,"m"),r=r.replace(/vv/g,"w"),r=r.replace(/\|V\|/g,"m"),r=r.replace(/\\/g,"l"),r=r.replace(/[^a-z0-9]/g,""),r=r.trim(),r}detectEvasionPatterns(e){for(const r of this.forbiddenWords){const t=r.split("").join("[\\s\\-_\\.]*");if(new RegExp(t,"i").test(e))return!0}return!1}containsForbiddenWords(e){const r=this.normalizeText(e);if(this.detectEvasionPatterns(e))return{found:!0,word:"evasion pattern",reason:"Hate Speech"};for(const t of this.forbiddenWords){const n=t.toLowerCase();if(r.includes(n))return{found:!0,word:t,reason:"Hate Speech"};try{const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp(`\\b${s}\\b`,"i").test(r))return{found:!0,word:t,reason:"Hate Speech"}}catch{}if(this.isSimilarWord(r,n))return{found:!0,word:t,reason:"Hate Speech"}}return{found:!1}}isSimilarWord(e,r){if(Math.abs(e.length-r.length)>3)return!1;let t=0;const n=Math.min(e.length,r.length);for(let s=0;s<n;s++)e[s]===r[s]&&t++;return t/n>.8&&n>4}containsUrls(e){for(const r of this.urlPatterns)if(r.test(e))return{found:!0,reason:"URL/Link"};return{found:!1}}containsSpam(e){for(const n of this.personalInfoPatterns)if(n.test(e))return{found:!0,reason:"Personal Info"};const r=e.toLowerCase().split(/\s+/),t={};for(const n of r)if(n.length>2&&(t[n]=(t[n]||0)+1,t[n]>5))return{found:!0,reason:"Excessive Repetition"};return{found:!1}}filterContent(e){if(!e||typeof e!="string"||e.trim()==="")return{isBlocked:!1,originalText:e,filteredText:e,reason:null};const r=this.containsForbiddenWords(e);if(r.found)return{isBlocked:!0,originalText:e,filteredText:"Hate Speech",reason:"Hate Speech",details:`Contains prohibited word: ${r.word}`};if(this.containsUrls(e).found)return{isBlocked:!0,originalText:e,filteredText:"URL/Link",reason:"URL/Link",details:"Contains URLs or links"};const n=this.containsSpam(e);return n.found?{isBlocked:!0,originalText:e,filteredText:"Spam",reason:"Spam",details:`Spam pattern detected: ${n.reason}`}:{isBlocked:!1,originalText:e,filteredText:e,reason:null}}filterSeed(e){return this.filterContent(e)}shouldDisplayContent(e){return!this.filterContent(e).isBlocked}getDisplayText(e){return this.filterContent(e).filteredText}}const c=new l;class d{static MAX_DISPLAY_LENGTH=45;static sanitizeForDisplay(e){if(!e)return"";const t=String(e).replace(/[<>"'&]/g,"");return t.length>this.MAX_DISPLAY_LENGTH?t.substring(0,this.MAX_DISPLAY_LENGTH-3)+"...":t}}export{d as S,c};
