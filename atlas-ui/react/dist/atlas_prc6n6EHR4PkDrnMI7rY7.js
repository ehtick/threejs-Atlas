import{S as g}from"./atlas_C0O52P_24VXpcB_jxaut3.js";import{G as H,V as _,B as L,C as P,r as O,A as Y,L as D}from"./atlas_DfFO9DeAqJfHmKzNHJUiw.js";const e={RAY_COUNT:{min:8,max:33},RAY_INTENSITY:{min:.5,max:2},PULSE_SPEED:{min:1,max:6},RAY_LENGTH:{min:.5,max:2.5},RAY_THICKNESS:{min:.02,max:.15},TIME_SPEED:{min:.8,max:1.5},COLOR_VARIATION:{min:.2,max:.6}};class V{rays;group;params;startTime;rayMaterials;rayData;stormFreq1;stormFreq2;stormThreshold;constructor(s,t={}){const i=t.seed||Math.floor(Math.random()*1e6),n=new g(i);this.startTime=t.startTime||i%1e4/1e3,this.params={rayCount:t.rayCount||Math.floor(n.uniform(e.RAY_COUNT.min,e.RAY_COUNT.max)),rayIntensity:t.rayIntensity||n.uniform(e.RAY_INTENSITY.min,e.RAY_INTENSITY.max),pulseSpeed:t.pulseSpeed||n.uniform(e.PULSE_SPEED.min,e.PULSE_SPEED.max),rayLength:t.rayLength||n.uniform(e.RAY_LENGTH.min,e.RAY_LENGTH.max),rayThickness:t.rayThickness||n.uniform(e.RAY_THICKNESS.min,e.RAY_THICKNESS.max),timeSpeed:t.timeSpeed||n.uniform(e.TIME_SPEED.min,e.TIME_SPEED.max),colorVariation:t.colorVariation||n.uniform(e.COLOR_VARIATION.min,e.COLOR_VARIATION.max),seed:i,startTime:this.startTime};const r=i%1e3/1e3;this.stormFreq1=.01+r*.005,this.stormFreq2=.003+r*.002,this.stormThreshold=.75+r*.15,this.group=new H,this.rays=[],this.rayMaterials=[],this.rayData=[],this.generateRays(s,n)}generateRays(s,t){const i=this.params.rayCount;for(let r=0;r<i;r++){const l=[],a=t.spherePosition(s*1.05),f=new _(a.x,a.y,a.z),R=s*(2+this.params.rayLength*t.uniform(.8,1.2)),u=f.clone().normalize().multiplyScalar(R),p=8+Math.floor(t.uniform(0,5));for(let T=0;T<=p;T++){const I=T/p,F=new _().lerpVectors(f,u,I);if(T>0&&T<p){const A=t.spherePosition(s*.05*(1-I)),x=new _(A.x,A.y,A.z);F.add(x)}l.push(F)}const M=new L().setFromPoints(l),d=200+t.uniform(-30,30),S=.8+t.uniform(-.2,.2),E=.6+t.uniform(-.1,.1),m=new P;m.setHSL(d/360,S,E);const y=this.params.colorVariation;m.r=Math.min(1,m.r+t.uniform(-y,y)),m.g=Math.min(1,m.g+t.uniform(-y,y)),m.b=Math.min(1,m.b+t.uniform(-y,y));const c=new O({color:m,transparent:!0,opacity:0,linewidth:this.params.rayThickness*100,blending:Y}),h=new D(M,c);this.rayData.push({startPos:f,endPos:u,phase:t.uniform(0,Math.PI*2),frequency:this.params.pulseSpeed*t.uniform(.8,1.2),color:m,activationOffset:t.uniform(0,100)}),this.rays.push(h),this.rayMaterials.push(c),this.group.add(h)}const n=Math.floor(i*.5);for(let r=0;r<n;r++){const l=[],a=t.spherePosition(s*1.02),f=new _(a.x,a.y,a.z),R=s*(1.5+this.params.rayLength*.5*t.uniform(.6,1)),C=f.clone().normalize(),u=t.spherePosition(.2),p=new _(u.x,u.y,u.z);C.add(p).normalize();const M=C.multiplyScalar(R),d=4+Math.floor(t.uniform(0,3));for(let F=0;F<=d;F++){const A=F/d,x=new _().lerpVectors(f,M,A);if(F>0&&F<d){const b=t.spherePosition(s*.02*(1-A)),G=new _(b.x,b.y,b.z);x.add(G)}l.push(x)}const S=new L().setFromPoints(l),E=200+t.uniform(-30,30),m=.6+t.uniform(-.2,.2),y=.4+t.uniform(-.1,.1),c=new P;c.setHSL(E/360,m,y);const h=this.params.colorVariation*.7;c.r=Math.min(1,c.r+t.uniform(-h,h)),c.g=Math.min(1,c.g+t.uniform(-h,h)),c.b=Math.min(1,c.b+t.uniform(-h,h));const T=new O({color:c,transparent:!0,opacity:0,linewidth:this.params.rayThickness*50,blending:Y}),I=new D(S,T);this.rayData.push({startPos:f,endPos:M,phase:t.uniform(0,Math.PI*2),frequency:this.params.pulseSpeed*t.uniform(1.5,2.5),color:c,activationOffset:t.uniform(0,150)}),this.rays.push(I),this.rayMaterials.push(T),this.group.add(I)}}addToScene(s,t){t&&this.group.position.copy(t),s.add(this.group)}update(){const t=(this.startTime+Date.now()/1e3*this.params.timeSpeed)%1e3;this.rayMaterials.forEach((i,n)=>{const r=this.rayData[n],l=t*r.frequency+r.phase,a=(t+r.activationOffset)*.1,f=Math.sin(a)*Math.sin(a*.3)*Math.sin(a*.7);if(f>.2){const C=Math.max(0,(f-.2)/.8),u=Math.sin(l)*.3+.7,p=Math.sin(l*12)>.9?1.5:1,S=Math.sin(t*this.stormFreq1)*Math.sin(t*this.stormFreq2)>this.stormThreshold?1.5:1;let E=C*u*p*S*this.params.rayIntensity;E=Math.min(1,E),i.opacity=E,p>1.2||S>1.2?i.color.setRGB(Math.min(1,r.color.r+.3),Math.min(1,r.color.g+.3),Math.min(1,r.color.b+.3)):i.color.copy(r.color)}else i.opacity=0}),this.group.rotation.y=t*.005,this.group.rotation.x=Math.sin(t*.002)*.1}getObject3D(){return this.group}dispose(){this.rays.forEach(s=>{s.geometry.dispose(),s.material.dispose()})}}function q(o,s,t){const i=t||Math.floor(Math.random()*1e6),n=new g(i+7777),r=n.uniform(e.TIME_SPEED.min,e.TIME_SPEED.max),l=i%1e4/1e3,a={rayCount:Math.floor(n.uniform(e.RAY_COUNT.min,e.RAY_COUNT.max)),rayIntensity:n.uniform(e.RAY_INTENSITY.min,e.RAY_INTENSITY.max),pulseSpeed:n.uniform(e.PULSE_SPEED.min,e.PULSE_SPEED.max),rayLength:n.uniform(e.RAY_LENGTH.min,e.RAY_LENGTH.max),rayThickness:n.uniform(e.RAY_THICKNESS.min,e.RAY_THICKNESS.max),timeSpeed:r,colorVariation:n.uniform(e.COLOR_VARIATION.min,e.COLOR_VARIATION.max),seed:i,startTime:l};return new V(o,a)}function N(o){const s=o.replace("#",""),t=parseInt(s.substr(0,2),16)/255,i=parseInt(s.substr(2,2),16)/255,n=parseInt(s.substr(4,2),16)/255;return new P(t,i,n)}function w(o){return o.length>=3?new P(o[0],o[1],o[2]):new P(.5,.5,.5)}function z(o){if(o.ocean_color){if(typeof o.ocean_color=="string")return N(o.ocean_color);if(Array.isArray(o.ocean_color))return w(o.ocean_color)}if(o.planet_info?.base_color){if(typeof o.planet_info.base_color=="string")return N(o.planet_info.base_color);if(Array.isArray(o.planet_info.base_color))return w(o.planet_info.base_color)}if(o.base_color){if(typeof o.base_color=="string")return N(o.base_color);if(Array.isArray(o.base_color))return w(o.base_color)}const s=o.planet_info?.type||o.type||"Unknown";return k(s)}function k(o){const t={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"}[o]||"#FFFFFF";return N(t)}export{V as P,q as c,z as g};
