import{r as s,j as e,a as qe,c as et,R as tt}from"./atlas_BiACxVxc6cO5okV5F68Rd.js";import{R as st,L as nt,c as at,d as rt,S as Ee,e as Pe,F as ot,H as it,a as lt}from"./atlas_DV2TxjXVLZiB7z8gZlLyQ.js";import{W as Ie}from"./atlas_hV4YbJX4LmBeaYZmYRF0y.js";import{a2 as _e,C as Ge,a3 as Oe,G as $e,b as me,z as ue,M as he,V as Fe,B as Ve,W as Be,n as Ye,a8 as We,y as He,v as Ue,cK as Ke,cL as Ze,I as ze}from"./atlas_BOOzg5XYrrU1N4SZySfRd.js";import{R as ct,S as dt,M as mt,a as Te,b as Xe,T as ut}from"./atlas_CucbVO37Kcy0bEJq4UQQ7.js";import{O as ht}from"./atlas_BJLzboHTaSIGvKgNbvLUr.js";import{V as xt}from"./atlas_c-mX1IzYsquxm9YzhFAN0.js";import"./atlas_5StMBQg7EZ_DcUhMgqODi.js";const Je=({planets:n,stars:o,systemName:p,cosmicOriginTime:M,currentTime:y,onTimeOffsetChange:E})=>{const Y=s.useRef(null),b=s.useRef(null),i=s.useRef(null),_=s.useRef(null),k=s.useRef([]),R=s.useRef([]),l=s.useRef([]),G=s.useRef(0),H=(S,P="#ffffff")=>{const L=document.createElement("canvas"),d=L.getContext("2d");if(!d)return null;L.width=768,L.height=192,d.fillStyle="rgba(0, 0, 0, 0.8)",d.fillRect(0,0,L.width,L.height),d.strokeStyle="#ffffff",d.lineWidth=3,d.strokeRect(3,3,L.width-6,L.height-6),d.fillStyle=P,d.font="bold 48px Arial",d.textAlign="center",d.textBaseline="middle",d.fillText(S,384,96);const c=new Ue(L),N=new Ke({map:c,transparent:!0,alphaTest:.1}),V=new Ze(N);return V.scale.set(30,7.5,1),V};return G.current=y,s.useEffect(()=>{if(!Y.current)return;const S=Y.current,P=S.clientWidth,L=S.clientHeight,d=new _e;d.background=new Ge(17),b.current=d;const c=new Oe(60,P/L,.1,1e4);c.position.set(0,120,180),c.lookAt(0,0,0);const N=new Ie({antialias:!0,alpha:!0});N.setSize(P,L),N.setClearColor(17,1),i.current=N,S.appendChild(N.domElement);const V={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},Z={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},O=new $e;o.forEach((t,F)=>{const j=parseFloat(t.Size)*4,C=new me(j,32,32),J=Z[t.Color]||"#FFFF44",T=new ue({color:J,transparent:!0,opacity:.9}),$=new he(C,T);o.length===1?$.position.set(0,0,0):o.length===2?$.position.set(F===0?-j*2:j*2,0,0):F===0?$.position.set(-j*2,0,0):F===1?$.position.set(j*2,0,0):$.position.set(0,j*2,0);const Q=new me(j*1.5,32,32),ce=new ue({color:J,transparent:!0,opacity:.3}),re=new he(Q,ce);$.add(re),O.add($)}),d.add(O);const U=Math.max(...n.map(t=>t.orbital_radius)),z=150;n.forEach((t,F)=>{const C=30+t.orbital_radius/U*z,J=t.eccentricity_factor,T=C,$=T*Math.sqrt(1-J*J),Q=360,ce=2,re=4;for(let X=0;X<Q;X+=ce+re){const q=[];for(let K=X;K<Math.min(X+ce,Q-1);K++){const oe=K/Q*2*Math.PI,ie=T*Math.cos(oe),ve=$*Math.sin(oe);q.push(new Fe(ie,0,ve))}if(q.length>1){const K=new Ve().setFromPoints(q),oe=new Be({color:7372944,transparent:!0,opacity:.8,linewidth:2}),ie=new Ye(K,oe);d.add(ie),R.current.push(ie)}}const g=t.diameter/8e3,f=Math.max(Math.min(g,8),2.5),W=new me(f,32,32),de=V[t.planet_type]||"#FFFFFF",a=new ue({color:de,transparent:!0,opacity:.9}),h=new he(W,a),v=new he(new me(f*1.5,32,32),new ue({color:de,transparent:!0,opacity:.2}));h.add(v),d.add(h),k.current.push(h),h.planetData=t,h.orbitRadius=C,h.semiMajorAxis=T,h.semiMinorAxis=$;const I=t.name.replace(/_/g," "),B=H(I,"#ffffff");B&&(B.position.copy(h.position),B.position.y+=f+10,B.planetData=t,d.add(B),l.current.push(B))});const se=new We(4210752,.4);d.add(se);const xe=new He(16777215,1,2e3);xe.position.set(0,0,0),d.add(xe);let ne=!1,ee=0,ae=0,le=0;const be=t=>{ne=!0,ee=t.clientX,ae=t.clientY},pe=t=>{if(!ne)return;const F=t.clientX-ee,j=t.clientY-ae,C=new ze;C.setFromVector3(c.position),C.theta-=F*.01,C.phi+=j*.01,C.phi=Math.max(.1,Math.min(Math.PI-.1,C.phi)),c.position.setFromSpherical(C),c.lookAt(0,0,0),ee=t.clientX,ae=t.clientY},r=()=>{ne=!1,setTimeout(()=>{},3e3)},m=t=>{if(t.ctrlKey)t.preventDefault(),t.deltaY>0?E(604800):E(-604800);else{t.preventDefault();const F=.1,j=c.position.distanceTo(new Fe(0,0,0));t.deltaY>0&&j<800?c.position.multiplyScalar(1+F):t.deltaY<0&&j>50&&c.position.multiplyScalar(1-F)}},w=t=>{t.key==="Escape"&&document.dispatchEvent(new CustomEvent("solar-system-close-fullscreen"))},x=t=>{if(t.preventDefault(),t.touches.length===1)ne=!0,ee=t.touches[0].clientX,ae=t.touches[0].clientY;else if(t.touches.length===2){const F=t.touches[0].clientX-t.touches[1].clientX,j=t.touches[0].clientY-t.touches[1].clientY;le=Math.sqrt(F*F+j*j)}},D=t=>{if(t.preventDefault(),t.touches.length===1&&ne){const F=t.touches[0].clientX-ee,j=t.touches[0].clientY-ae,C=new ze;C.setFromVector3(c.position),C.theta-=F*.01,C.phi+=j*.01,C.phi=Math.max(.1,Math.min(Math.PI-.1,C.phi)),c.position.setFromSpherical(C),c.lookAt(0,0,0),ee=t.touches[0].clientX,ae=t.touches[0].clientY}else if(t.touches.length===2){const F=t.touches[0].clientX-t.touches[1].clientX,j=t.touches[0].clientY-t.touches[1].clientY,C=Math.sqrt(F*F+j*j);if(le>0){const T=C/le,$=c.position.distanceTo(new Fe(0,0,0));T>1&&$>50?c.position.multiplyScalar(1-.01):T<1&&$<800&&c.position.multiplyScalar(1+.01)}le=C}},A=t=>{t.preventDefault(),ne=!1,le=0,setTimeout(()=>{},3e3)},u=N.domElement;u.style.cursor="grab",u.addEventListener("mousedown",t=>{u.style.cursor="grabbing",be(t)}),u.addEventListener("mousemove",pe),u.addEventListener("mouseup",()=>{u.style.cursor="grab",r()}),u.addEventListener("mouseleave",()=>{u.style.cursor="grab",r()}),u.addEventListener("wheel",m),u.addEventListener("touchstart",x,{passive:!1}),u.addEventListener("touchmove",D,{passive:!1}),u.addEventListener("touchend",A,{passive:!1}),document.addEventListener("keydown",w);const je=()=>{_.current=requestAnimationFrame(je),k.current.forEach((t,F)=>{const j=t.planetData,C=t.semiMajorAxis,J=t.semiMinorAxis,T=j.orbital_period_seconds,$=2*Math.PI/T,Q=(j.initial_orbital_angle+G.current*$)%(2*Math.PI);t.position.x=C*Math.cos(Q),t.position.z=J*Math.sin(Q),t.position.y=0;const ce=j.rotation_period_seconds,re=2*Math.PI/ce;if(t.rotation.y=G.current*re%(2*Math.PI),l.current[F]){const g=t.geometry.parameters?.radius||2;l.current[F].position.copy(t.position),l.current[F].position.y+=g+10}}),N.render(d,c)};je();const we=()=>{const t=S.clientWidth,F=S.clientHeight;c.aspect=t/F,c.updateProjectionMatrix(),N.setSize(t,F)};return window.addEventListener("resize",we),()=>{window.removeEventListener("resize",we),document.removeEventListener("keydown",w),u.removeEventListener("mousedown",be),u.removeEventListener("mousemove",pe),u.removeEventListener("mouseup",r),u.removeEventListener("mouseleave",r),u.removeEventListener("wheel",m),u.removeEventListener("touchstart",x),u.removeEventListener("touchmove",D),u.removeEventListener("touchend",A),_.current&&cancelAnimationFrame(_.current),S&&N.domElement&&S.removeChild(N.domElement),N.dispose(),k.current=[],R.current=[],l.current=[]}},[n,o,M]),e.jsx("div",{ref:Y,className:"w-full h-full"})},ft=({planets:n,stars:o,systemName:p,cosmicOriginTime:M})=>{const y=s.useRef(null),E=s.useRef(null),Y=s.useRef(null),b=s.useRef(null),i=s.useRef([]),_=s.useRef([]),k=s.useRef([]),R=s.useRef(0),l=Math.floor(Date.now()/1e3),[G,H]=s.useState(0),[S,P]=s.useState(!1),[L,d]=s.useState(!1),[c,N]=s.useState(!1),[V,Z]=s.useState(0),[O,U]=s.useState(null),[z,se]=s.useState(!0),[xe,ne]=s.useState(null),ee=l-M+G;R.current=ee,s.useEffect(()=>{(async()=>{try{se(!0),ne(null);const m=await fetch("/api/system/rendering-data");if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const w=await m.json();if(w.success)U(w.system_data);else throw new Error(w.error||"Failed to fetch system data")}catch(m){ne(m instanceof Error?m.message:"Unknown error")}finally{se(!1)}})()},[]);const ae=()=>{d(!0),setTimeout(()=>{P(!1),d(!1)},300)},le=(r,m="#ffffff")=>{const w=document.createElement("canvas"),x=w.getContext("2d");if(!x)return null;w.width=512,w.height=128,x.fillStyle="rgba(0, 0, 0, 0.7)",x.fillRect(0,0,w.width,w.height),x.strokeStyle="#ffffff",x.lineWidth=2,x.strokeRect(2,2,w.width-4,w.height-4),x.fillStyle=m,x.font="bold 32px Arial",x.textAlign="center",x.textBaseline="middle",x.fillText(r,256,64);const D=new Ue(w),A=new Ke({map:D,transparent:!0,alphaTest:.1}),u=new Ze(A);return u.scale.set(20,5,1),u};s.useEffect(()=>{const r=m=>{m.key==="Escape"&&S&&ae()};return S&&Z(G),document.addEventListener("solar-system-close-fullscreen",ae),document.addEventListener("keydown",r),()=>{document.removeEventListener("solar-system-close-fullscreen",ae),document.removeEventListener("keydown",r)}},[S,G]),s.useEffect(()=>{if(S&&c){const r=setTimeout(()=>{N(!1)},50);return()=>clearTimeout(r)}},[S,c]),s.useEffect(()=>{if(z||!O||(window.tonnirLoggedInSystem=!1,!y.current))return;const r=y.current,m=r.clientWidth,w=m<640,x=new _e;x.background=new Ge(17),E.current=x;const D=new Oe(45,m/(w?120:140),.1,1e4);D.position.set(0,80,120),D.lookAt(0,0,0);const A=new Ie({antialias:!0,alpha:!0});A.setSize(m,w?120:140),A.setClearColor(17,1),Y.current=A,r.appendChild(A.domElement);const u={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},je={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},we=new $e;O.stars.forEach((a,h)=>{const v=parseFloat(a.Size)*3,I=new me(v,16,16),B=je[a.Color]||"#FFFF44",X=new ue({color:B,transparent:!0,opacity:.9}),q=new he(I,X);O.stars.length===1?q.position.set(0,0,0):O.stars.length===2?q.position.set(h===0?-v*2:v*2,0,0):h===0?q.position.set(-v*2,0,0):h===1?q.position.set(v*2,0,0):q.position.set(0,v*2,0);const K=new me(v*1.5,16,16),oe=new ue({color:B,transparent:!0,opacity:.3}),ie=new he(K,oe);q.add(ie),we.add(q)}),x.add(we);const t=O.timing.max_orbital_radius,F=80;window.systemMaxOrbitalRadius=t,O.planets.forEach((a,h)=>{const I=20+a.orbital_radius/t*F,B=a.eccentricity_factor,X=I,q=X*Math.sqrt(1-B*B),K=360,oe=2,ie=4;for(let ke=0;ke<K;ke+=oe+ie){const Ae=[];for(let Me=ke;Me<Math.min(ke+oe,K-1);Me++){const Re=Me/K*2*Math.PI,Le=X*Math.cos(Re),Qe=q*Math.sin(Re);Ae.push(new Fe(Le,0,Qe))}if(Ae.length>1){const Me=new Ve().setFromPoints(Ae),Re=new Be({color:7372944,transparent:!0,opacity:.8,linewidth:2}),Le=new Ye(Me,Re);x.add(Le),_.current.push(Le)}}const ve=a.diameter/15e3,fe=Math.max(Math.min(ve,4),1.5),De=new me(fe,16,16),ye=u[a.planet_type]||"#FFFFFF",Se=new ue({color:ye,transparent:!0,opacity:.9}),te=new he(De,Se),Ne=new he(new me(fe*1.5,16,16),new ue({color:ye,transparent:!0,opacity:.2}));te.add(Ne),x.add(te),i.current.push(te),te.planetData=a,te.orbitRadius=I,te.semiMajorAxis=X,te.semiMinorAxis=q;const Ce=a.name.replace(/_/g," "),ge=le(Ce,"#ffffff");ge&&(ge.position.copy(te.position),ge.position.y+=fe+6,ge.planetData=a,x.add(ge),k.current.push(ge))});const j=new We(4210752,.4);x.add(j);const C=new He(16777215,1,1e3);C.position.set(0,0,0),x.add(C);let J=!1,T=0,$=0;const Q=a=>{J=!0,T=a.clientX,$=a.clientY},ce=a=>{if(!J)return;const h=a.clientX-T,v=a.clientY-$,I=new ze;I.setFromVector3(D.position),I.theta-=h*.01,I.phi+=v*.01,I.phi=Math.max(.1,Math.min(Math.PI-.1,I.phi)),D.position.setFromSpherical(I),D.lookAt(0,0,0),T=a.clientX,$=a.clientY},re=()=>{J=!1,setTimeout(()=>{},3e3)},g=a=>{if(a.ctrlKey)a.preventDefault(),a.deltaY>0?H(h=>h+604800):H(h=>h-604800);else{a.preventDefault();const h=.1,v=D.position.distanceTo(new Fe(0,0,0));a.deltaY>0&&v<500?D.position.multiplyScalar(1+h):a.deltaY<0&&v>20&&D.position.multiplyScalar(1-h)}},f=A.domElement;f.style.cursor="grab",f.style.borderRadius="8px",f.addEventListener("mousedown",a=>{f.style.cursor="grabbing",Q(a)}),f.addEventListener("mousemove",ce),f.addEventListener("mouseup",()=>{f.style.cursor="grab",re()}),f.addEventListener("mouseleave",()=>{f.style.cursor="grab",re()}),f.addEventListener("wheel",g);const W=()=>{b.current=requestAnimationFrame(W),i.current.forEach((a,h)=>{const v=a.planetData,I=a.semiMajorAxis,B=a.semiMinorAxis,X=v.orbital_period_seconds,q=2*Math.PI/X,K=(v.initial_orbital_angle+R.current*q)%(2*Math.PI);a.position.x=I*Math.cos(K),a.position.z=B*Math.sin(K),a.position.y=0;const oe=v.rotation_period_seconds,ie=2*Math.PI/oe;if(a.rotation.y=R.current*ie%(2*Math.PI),k.current[h]){const ve=a.geometry.parameters?.radius||2;k.current[h].position.copy(a.position),k.current[h].position.y+=ve+6}}),A.render(x,D)};W();const de=()=>{const a=r.clientWidth,h=a<640?120:140;D.aspect=a/h,D.updateProjectionMatrix(),A.setSize(a,h)};return window.addEventListener("resize",de),()=>{window.removeEventListener("resize",de),f.removeEventListener("mousedown",Q),f.removeEventListener("mousemove",ce),f.removeEventListener("mouseup",re),f.removeEventListener("mouseleave",re),f.removeEventListener("wheel",g),b.current&&cancelAnimationFrame(b.current),r&&A.domElement&&r.removeChild(A.domElement),A.dispose(),i.current=[],_.current=[],k.current=[]}},[n,o,M,O]);const be=r=>{const m=Math.floor(r/31557600),w=Math.floor(r%(365.25*24*3600)/(24*3600)),x=Math.floor(r%(24*3600)/3600);return m>0?`${m}y ${w}d ${x}h`:w>0?`${w}d ${x}h`:`${x}h`},pe=r=>r.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Solar System Perspective"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:y,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),!z&&!xe&&p&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:p})}),e.jsx("button",{onClick:()=>{P(!0),N(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-[10px]",children:[O?.planets?.length||n.length," Planets"]})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Time: ",be(ee)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View"})]})]}),S&&qe.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${L||c?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${L||c?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:pe(p)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:pe(p)}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[O?.planets?.length||n.length," Planets"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Time: ",be(l-M+V)]})]})]}),e.jsx("button",{onClick:ae,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2 sm:mb-4 px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"-15y"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"range",min:-15*365.25*24*3600,max:15*365.25*24*3600,step:604800,value:V,onChange:r=>Z(Number(r.target.value)),className:`w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer 
                               [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 
                               [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-400 
                               [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-600
                               [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg`}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-2 bg-yellow-400 rounded"})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"+15y"}),e.jsx("button",{onClick:()=>Z(0),className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors duration-200",title:"Reset to current time",children:"Now"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-1",children:["Time Travel: ",V===0?"Present":V>0?`+${Math.abs(V/(365.25*24*3600)).toFixed(1)} years`:`-${Math.abs(V/(365.25*24*3600)).toFixed(1)} years`," • Range: 30 years"]})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Je,{planets:O?.planets||n,stars:O?.stars||o,systemName:p,cosmicOriginTime:M,currentTime:l-M+V,onTimeOffsetChange:r=>Z(m=>m+r)})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},pt=({system:n,galaxy:o,systemIndex:p,cosmicOriginTime:M})=>{const[y,E]=s.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});s.useEffect(()=>{let b;const i=()=>{const l=Te.generateLocationId("system",o.coordinates.join(","),p,void 0),G=Te.canCollectFromLocation(l),H=Te.getTimeUntilNextCollection(l),S=o.coordinates,P=Xe.generateSystemUrl(S,p,Xe.getCurrentPage()),d=nt.getLocations().some(c=>c.stargateUrl===P);E(c=>({isOnCooldown:!G&&H>0,isSaved:d,isCollecting:c.isCollecting,timeUntilNext:H}))},_=()=>{E(l=>({...l,isCollecting:!0})),b=setTimeout(()=>{E(l=>({...l,isCollecting:!1}))},1e3)};i();const k=setInterval(i,1e3),R=st.subscribe("mining_completed",_);return()=>{clearInterval(k),b&&clearTimeout(b),R()}},[n.name,p,o.coordinates]);const Y=b=>b.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(ct,{locationType:"system",locationId:n.name,coordinates:o.coordinates.join(","),systemIndex:p,className:"text-xs"}),e.jsx(dt,{type:"system",name:n.name,coordinates:o.coordinates.join(","),systemIndex:p,className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(mt,{isOnCooldown:y.isOnCooldown,isSaved:y.isSaved,isCollecting:y.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"System Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300 capitalize",children:n.star_system_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Planets"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:n.num_planets})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-orange-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Stars"}),e.jsx("div",{className:"text-sm font-bold text-orange-300",children:n.stars.length})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-3",children:e.jsx(ft,{planets:n.planets,stars:n.stars,systemName:n.name,cosmicOriginTime:M})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-yellow-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Stellar Composition"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1",children:n.stars.map((b,i)=>e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-yellow-500/20",children:[e.jsxs("div",{className:"text-xs text-gray-300",children:["Star ",i+1]}),e.jsx("div",{className:"text-xs font-bold text-yellow-300",children:b.Type}),e.jsxs("div",{className:"text-xs text-gray-300",children:[b.Color," • ",b.Size]})]},i))})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"System:"}),e.jsx("div",{className:"text-white truncate font-medium",children:Y(n.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"System ID:"}),e.jsxs("div",{className:"text-white font-medium",children:["#",p+1]})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:Y(o.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:o.coordinates.join(", ")})]})]})]})]})},gt=({planets:n,stars:o,systemName:p,cosmicOriginTime:M})=>{const y=s.useRef(null),E=s.useRef(null),Y=s.useRef(null),b=s.useRef(null),i=s.useRef([]),_=s.useRef([]),k=s.useRef([]),R=s.useRef(null),l=s.useRef(0),G=Math.floor(Date.now()/1e3),[H,S]=s.useState(0),[P,L]=s.useState(!1),[d,c]=s.useState(!1),[N,V]=s.useState(!1),[Z,O]=s.useState(0),[U,z]=s.useState(null),[se,xe]=s.useState(!0),[ne,ee]=s.useState(null),ae=G-M+H;l.current=ae,s.useEffect(()=>{(async()=>{try{xe(!0),ee(null);const m=await fetch("/api/system/rendering-data");if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const w=await m.json();if(w.success)z(w.system_data);else throw new Error(w.error||"Failed to fetch system data")}catch(m){ee(m instanceof Error?m.message:"Unknown error")}finally{xe(!1)}})()},[]);const le=()=>{c(!0),setTimeout(()=>{L(!1),c(!1)},300)};s.useEffect(()=>{const r=m=>{m.key==="Escape"&&P&&le()};return P&&O(H),document.addEventListener("solar-system-close-fullscreen",le),document.addEventListener("keydown",r),()=>{document.removeEventListener("solar-system-close-fullscreen",le),document.removeEventListener("keydown",r)}},[P,H]),s.useEffect(()=>{if(P&&N){const r=setTimeout(()=>{V(!1)},50);return()=>clearTimeout(r)}},[P,N]),s.useEffect(()=>{if(se||!U||(window.tonnirLoggedInSystem=!1,!y.current))return;const r=y.current,m=r.clientWidth,w=r.clientHeight,x=Math.min(m,w),D=new _e;D.background=new Ge(17),E.current=D;const A=new Oe(45,1,.1,1e4);A.position.set(0,300,0),A.lookAt(0,0,0);const u=new Ie({antialias:!0,alpha:!0});u.setSize(x,x),u.setClearColor(17,1),Y.current=u,r.appendChild(u.domElement);const je={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},we={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},t=new $e;U.stars.forEach((g,f)=>{const W=parseFloat(g.Size)*3,de=new me(W,16,16),a=we[g.Color]||"#FFFF44",h=new ue({color:a,transparent:!0,opacity:.9}),v=new he(de,h);U.stars.length===1?v.position.set(0,0,0):U.stars.length===2?v.position.set(f===0?-W*2:W*2,0,0):f===0?v.position.set(-W*2,0,0):f===1?v.position.set(W*2,0,0):v.position.set(0,W*2,0);const I=new me(W*1.5,16,16),B=new ue({color:a,transparent:!0,opacity:.3}),X=new he(I,B);v.add(X),t.add(v)}),D.add(t);const F=U.timing.max_orbital_radius,j=80;window.systemMaxOrbitalRadius=F,U.planets.forEach((g,f)=>{const de=20+g.orbital_radius/F*j,a=g.eccentricity_factor,h=de,v=h*Math.sqrt(1-a*a),I=360,B=2,X=4;for(let ye=0;ye<I;ye+=B+X){const Se=[];for(let te=ye;te<Math.min(ye+B,I-1);te++){const Ne=te/I*2*Math.PI,Ce=h*Math.cos(Ne),ge=v*Math.sin(Ne);Se.push(new Fe(Ce,0,ge))}if(Se.length>1){const te=new Ve().setFromPoints(Se),Ne=new Be({color:7372944,transparent:!0,opacity:.8,linewidth:2}),Ce=new Ye(te,Ne);D.add(Ce),_.current.push(Ce)}}const q=g.diameter/15e3,K=Math.max(Math.min(q,4),1.5),oe=new me(K,16,16),ie=je[g.planet_type]||"#FFFFFF",ve=new ue({color:ie,transparent:!0,opacity:.9}),fe=new he(oe,ve),De=new he(new me(K*1.5,16,16),new ue({color:ie,transparent:!0,opacity:.2}));fe.add(De),D.add(fe),i.current.push(fe),fe.planetData=g,fe.orbitRadius=de,fe.semiMajorAxis=h,fe.semiMinorAxis=v,k.current.push(null)});const C=new We(4210752,.4);D.add(C);const J=new He(16777215,1,1e3);J.position.set(0,0,0),D.add(J);const T=new ht(A,u.domElement);T.enableDamping=!0,T.dampingFactor=.05,T.minDistance=50,T.maxDistance=800,T.autoRotate=!1,T.autoRotateSpeed=.5,T.enablePan=!0,T.enableZoom=!0,T.target.set(0,0,0),R.current=T;const $=g=>{if(g.ctrlKey)g.preventDefault(),g.deltaY>0?S(f=>f+604800):S(f=>f-604800);else{g.preventDefault();const f=.1,W=A.position.distanceTo(new Fe(0,0,0));g.deltaY>0&&W<500?A.position.multiplyScalar(1+f):g.deltaY<0&&W>20&&A.position.multiplyScalar(1-f)}},Q=u.domElement;Q.style.borderRadius="8px",Q.addEventListener("wheel",$);const ce=()=>{b.current=requestAnimationFrame(ce),i.current.forEach((g,f)=>{const W=g.planetData,de=g.semiMajorAxis,a=g.semiMinorAxis,h=W.orbital_period_seconds,v=2*Math.PI/h,I=(W.initial_orbital_angle+l.current*v)%(2*Math.PI);g.position.x=de*Math.cos(I),g.position.z=a*Math.sin(I),g.position.y=0;const B=W.rotation_period_seconds,X=2*Math.PI/B;g.rotation.y=l.current*X%(2*Math.PI)}),R.current&&R.current.update(),u.render(D,A)};ce();const re=()=>{if(!y.current||!u)return;const g=y.current,f=Math.min(g.clientWidth,g.clientHeight);u.setSize(f,f),A.aspect=1,A.updateProjectionMatrix()};return window.addEventListener("resize",re),()=>{window.removeEventListener("resize",re),Q.removeEventListener("wheel",$),R.current&&R.current.dispose(),b.current&&cancelAnimationFrame(b.current),r&&u.domElement&&r.removeChild(u.domElement),u.dispose(),i.current=[],_.current=[],k.current=[]}},[n,o,M,U,H]);const be=r=>{const m=Math.floor(r/31557600),w=Math.floor(r%(365.25*24*3600)/(24*3600)),x=Math.floor(r%(24*3600)/3600);return m>0?`${m}y ${w}d ${x}h`:w>0?`${w}d ${x}h`:`${x}h`},pe=r=>r.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col items-center w-full h-full",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{ref:y,className:"w-full h-full border border-white/20 rounded bg-black/20"}),!se&&!ne&&p&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:pe(p)})}),e.jsx("button",{onClick:()=>{L(!0),V(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]})}),P&&qe.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${d||N?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${d||N?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:pe(p)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:pe(p)}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[U?.planets?.length||n.length," Planets"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Time: ",be(G-M+Z)]})]})]}),e.jsx("button",{onClick:le,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2 sm:mb-4 px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"-15y"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"range",min:-15*365.25*24*3600,max:15*365.25*24*3600,step:604800,value:Z,onChange:r=>O(Number(r.target.value)),className:`w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer 
                               [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 
                               [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-400 
                               [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-600
                               [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg`}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-2 bg-yellow-400 rounded"})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"+15y"}),e.jsx("button",{onClick:()=>O(0),className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors duration-200",title:"Reset to current time",children:"Now"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-1",children:["Time Travel: ",Z===0?"Present":Z>0?`+${Math.abs(Z/(365.25*24*3600)).toFixed(1)} years`:`-${Math.abs(Z/(365.25*24*3600)).toFixed(1)} years`," • Range: 30 years"]})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Je,{planets:U?.planets||n,stars:U?.stars||o,systemName:p,cosmicOriginTime:M,currentTime:G-M+Z,onTimeOffsetChange:r=>O(m=>m+r)})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},bt=({systemUrl:n,system:o,cosmicOriginTime:p})=>{const M=s.useRef(null),[y,E]=s.useState("Aligning Stargate..."),[Y,b]=s.useState(!1),[i,_]=s.useState(!1),[k,R]=s.useState(!1);return s.useEffect(()=>{const l=M.current;if(!l)return;const G=l.getContext("2d");if(!G)return;let H=[];const S=800;let P,L;const d=800;let c,N=.5;function V(){const z=l?.parentElement;if(!z||!l)return;const se=z.clientWidth,xe=z.clientHeight;l.width=Math.min(se,d),l.height=Math.min(xe,d),P=l.width/2,L=l.height/2}function Z(){V(),H=[];for(let z=0;z<S;z++)H.push({x:Math.random()*(l?.width||800),y:Math.random()*(l?.height||800),z:Math.random()*(l?.width||800),o:Math.random()});O()}function O(){!l||!G||(G.clearRect(0,0,l.width,l.height),H.forEach(z=>{z.z-=N,z.z<=0&&(z.z=l.width,z.x=Math.random()*l.width,z.y=Math.random()*l.height,z.o=Math.random());const se=l.width/z.z,xe=(z.x-P)*se+P,ne=(z.y-L)*se+L,ee=2*se;G.beginPath(),G.fillStyle=`rgba(255, 255, 255, ${z.o})`,G.arc(xe,ne,ee,0,2*Math.PI),G.fill()}),N<60&&(N+=1),c=requestAnimationFrame(O))}Z();const U=()=>V();return window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U),c&&cancelAnimationFrame(c)}},[]),s.useEffect(()=>{_(!0),setTimeout(()=>{R(!0)},800)},[]),s.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){E("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),b(!0);const G=(d,c)=>Array.from({length:c},()=>d[Math.floor(Math.random()*d.length)]).join(""),H=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:30},{chars:"0123456789ABCDEF",duration:20,iterations:40},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:\\'\",.<>?/`~",duration:10,iterations:100}];let S=0,P=0;const L=()=>{if(S>=H.length){const c="Stargate system aligned";let N=0;E("");const V=()=>{N<c.length?(E(c.substring(0,N+1)),N++,setTimeout(V,30)):b(!1)};V();return}const d=H[S];E(G(d.chars,32)),P++,P>=d.iterations&&(S++,P=0),setTimeout(L,d.duration)};L()},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-medium text-white",children:o?.name||"System"})}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx("canvas",{ref:M,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${k?"opacity-0":"opacity-100"}`,style:{filter:k?"blur(50px)":"none"}}),i&&o&&e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${i&&k?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:e.jsx(gt,{planets:o.planets,stars:o.stars,systemName:o.name,cosmicOriginTime:p||0})})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:n,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${Y?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),y]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},wt=({planets:n,coordinates:o,systemIndex:p})=>{const[M,y]=s.useState(new Set),E=i=>({"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"})[i]||"#FFFFFF";s.useEffect(()=>{(()=>{try{const _=at(o,p,n),k=new Set;_.forEach(R=>{k.add(R.toLowerCase())}),y(k)}catch{}})()},[o,p,n]);const Y=i=>i.replace(/_/g," "),b=i=>{try{rt(o,p,i,n)}catch{}window.location.href=`/planet/${i.toLowerCase()}`};return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:n.map(i=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group overflow-hidden",children:[M.has(i.name.toLowerCase())&&e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}),e.jsx("div",{className:"absolute -top-3 -left-3 w-8 h-8 rounded-full border border-white/40 shadow-sm z-20 animate-pulse",style:{backgroundColor:E(i.planet_type)}}),e.jsxs("button",{onClick:()=>b(i.name),className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Planet"}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:Y(i.name)})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},i.name))}),n.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No planets found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This system appears to be empty"})]})]})},vt=({currentSystem:n,galaxy:o})=>{const[p,M]=s.useState(!1),[y,E]=s.useState(!1),[Y,b]=s.useState(!0);s.useEffect(()=>{M(n.index>0),E(!0),b(!1)},[n.index]);const i=async()=>{if(n.index>0){if(!Ee.canAffordTravel("system",1)){Ee.executeTravel("system",1);return}if(!Ee.executeTravel("system",1))return;const R=o.coordinates.join(",");Pe(R,n.index-1),window.location.href=`/system/${n.index-1}`}},_=async()=>{if(!Ee.canAffordTravel("system",1)){Ee.executeTravel("system",1);return}if(!Ee.executeTravel("system",1))return;const R=o.coordinates.join(",");Pe(R,n.index+1),window.location.href=`/system/${n.index+1}`};return Y?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:i,disabled:!p,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${p?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:_,disabled:!y,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${y?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},yt=({system:n,galaxy:o,system_url:p,version:M,system_index:y,image_url:E,page:Y,cosmic_origin_time:b})=>{const[i]=s.useState(o.coordinates.join(","));s.useEffect(()=>{document.body.setAttribute("data-coordinates",i),document.body.setAttribute("data-system-index",y.toString()),Pe(i,y)},[i,y]);const _=R=>R.replace(/_/g," "),k=R=>R.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(ot,{}),e.jsxs("div",{className:"relative z-10 pt-1",children:[e.jsx(it,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["System '",_(n.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Galaxy '",k(o.name),"' - Coordinates ",o.coordinates.join(", ")]})]}),e.jsx(vt,{currentSystem:{name:n.name,index:y},galaxy:o}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(bt,{systemUrl:p,system:n,cosmicOriginTime:b})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(pt,{system:n,galaxy:o,systemIndex:y,cosmicOriginTime:b})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Planets in '",_(n.name),"'"]}),e.jsx(wt,{planets:n.planets,coordinates:i,systemIndex:y})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${Y}`,className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsxs("span",{className:"text-base sm:text-lg",children:["← Back to Galaxy '",k(o.name),"'"]})})})]}),e.jsx(xt,{version:M})]}),e.jsx(ut,{}),e.jsx(lt,{currentLocation:{type:"system",name:n.name,coordinates:o.coordinates.join(","),systemIndex:n.index}})]})};document.addEventListener("DOMContentLoaded",async()=>{try{const n=document.getElementById("system-data"),o=document.getElementById("galaxy-data"),p=document.getElementById("meta-data");if(!n||!o||!p)return;const M=JSON.parse(n.textContent||"{}"),y=JSON.parse(o.textContent||"{}"),E=JSON.parse(p.textContent||"{}"),Y={system:M,galaxy:y,system_url:E.system_url,version:E.version,system_index:E.system_index,image_url:E.image_url,page:E.page||1,cosmic_origin_time:E.cosmic_origin_time},b=document.getElementById("atlas-react-root");b&&et.createRoot(b).render(tt.createElement(yt,Y))}catch{}});
