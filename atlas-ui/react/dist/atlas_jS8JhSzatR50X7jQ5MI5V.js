import{r as c,j as e,a as st,U as ot,c as Be,R as Fe}from"./atlas_BGo7KNTC_D9rNHeIOnwpB.js";import{R as at,L as it,g as rt,S as Se,m as lt,F as ct,H as dt,a as ut}from"./atlas_CUYkglEYtrK-j5RaIV74A.js";import{W as De}from"./atlas_CpfeS5VhE5H57rIqo09CI.js";import{W as Ge,C as Ce,X as Ie,G as Me,q as Ye,cz as Oe,x as Ae,cA as Le,cB as ze,b as ue,z as ce,M as Q,V as Ne,B as Re,cC as Ue,n as Ze,a0 as _e,$ as Ke,v as Qe,cD as Je,cE as et,S as Ee,c as mt,A as je,g as ye,cF as ht,D as $e,cG as He,t as Ve,P as qe,y as pt,cH as xt}from"./atlas_Bng76Ipsc6y2pOae0EuhP.js";import{R as ft,S as gt,M as vt,a as Pe,b as We,T as wt}from"./atlas_tWwhs3uxVw9kyauFo4waU.js";import{O as bt}from"./atlas_sLbA9m1UOHQtiV0wkxe1n.js";import{V as yt}from"./atlas_BC--f3teBajIZvYzpPvMJ.js";import"./atlas_5StMBQg7EZ_DcUhMgqODi.js";const jt=({coordinates:t,galaxyName:d})=>{const v=c.useRef(null),y=c.useRef(null),u=c.useRef(null),j=c.useRef(null);return c.useEffect(()=>{if(!v.current)return;const w=v.current,m=w.clientWidth,se=w.clientHeight,P=new Ge;P.background=new Ce(657930),y.current=P;const N=new Ie(45,m/se,.1,1e3);N.position.set(20,15,20),N.lookAt(0,0,0);const M=new De({antialias:!0,alpha:!0});M.setSize(m,se),M.setClearColor(0,.2),u.current=M,w.appendChild(M.domElement);const S=0,E=1e7,_=5e6,[Z,b,L]=t,h=((Z-S)/(E-S)-.5)*16,i=((b-S)/(E-S)-.5)*16,W=((L-S)/(E-S)-.5)*16,x=new Me;P.add(x);const T=new Ye(16,16,16),R=new Oe(T),z=new Ae({color:16777215,opacity:.4,transparent:!0,linewidth:2}),r=new Le(R,z);x.add(r);const te=new ze(16,16,16777215,16777215);te.material.opacity=.1,te.material.transparent=!0,te.position.y=-8,x.add(te);const Y=new ze(16,16,16777215,16777215);Y.material.opacity=.05,Y.material.transparent=!0,Y.rotation.z=Math.PI/2,Y.position.x=-8,x.add(Y);const O=new ze(16,16,16777215,16777215);O.material.opacity=.05,O.material.transparent=!0,O.rotation.x=Math.PI/2,O.position.z=-8,x.add(O);const J=new ue(.5,32,32),le=new ce({color:16777215,transparent:!0,opacity:.9}),f=new Q(J,le);f.position.set(0,0,0),x.add(f);const C=new Q(new ue(.8,32,32),new ce({color:16777215,transparent:!0,opacity:.2}));f.add(C);const $=new ue(.4,32,32),fe=new ce({color:6605055,transparent:!0,opacity:1}),pe=new Q($,fe);pe.position.set(h,i,W),x.add(pe);const ge=new Q(new ue(.7,32,32),new ce({color:6605055,transparent:!0,opacity:.3}));if(pe.add(ge),Math.sqrt(Math.pow(Z-_,2)+Math.pow(b-_,2)+Math.pow(L-_,2))<2e6){const a=[new Ne(0,0,0),new Ne(h,i,W)],X=new Re().setFromPoints(a),p=new Ue({color:16762980,dashSize:.6,gapSize:.6,opacity:.4,transparent:!0,linewidth:2}),I=new Ze(X,p);I.computeLineDistances(),x.add(I)}const l=new _e(4210752,.6);P.add(l);const n=new Ke(16777215,.8);n.position.set(10,10,10),P.add(n);const s=(a,X)=>{const p=document.createElement("canvas"),I=p.getContext("2d");if(!I)return null;p.width=64,p.height=64,I.fillStyle=`#${X.toString(16).padStart(6,"0")}`,I.font="bold 48px Arial",I.textAlign="center",I.textBaseline="middle",I.fillText(a,32,32);const A=new Qe(p),ie=new Je({map:A,transparent:!0,opacity:.8}),ne=new et(ie);return ne.scale.set(1.6,1.6,1),ne},g=s("X",16739179);g&&(g.position.set(8.4,-7.6,-7.6),x.add(g));const K=s("Y",7077739);K&&(K.position.set(-7.6,8.4,-7.6),x.add(K));const k=s("Z",7039999);k&&(k.position.set(-7.6,-7.6,8.4),x.add(k));let D=!1,G=0,o=0,B=!0,q=0;const ae=a=>{D=!0,B=!1,G=a.clientX,o=a.clientY},H=a=>{if(!D)return;const X=a.clientX-G,p=a.clientY-o;x.rotation.y+=X*.01,x.rotation.x+=p*.01,G=a.clientX,o=a.clientY},U=()=>{D=!1,setTimeout(()=>{D||(B=!0)},3e3)},me=a=>{a.preventDefault();const X=.1,p=N.position.distanceTo(new Ne(0,0,0));a.deltaY>0&&p<50?N.position.multiplyScalar(1+X):a.deltaY<0&&p>10&&N.position.multiplyScalar(1-X)},xe=a=>{a.key==="Escape"&&document.dispatchEvent(new CustomEvent("universe-close-fullscreen"))},de=a=>{if(a.preventDefault(),a.touches.length===1)D=!0,B=!1,G=a.touches[0].clientX,o=a.touches[0].clientY;else if(a.touches.length===2){const X=a.touches[0].clientX-a.touches[1].clientX,p=a.touches[0].clientY-a.touches[1].clientY;q=Math.sqrt(X*X+p*p)}},he=a=>{if(a.preventDefault(),a.touches.length===1&&D){const X=a.touches[0].clientX-G,p=a.touches[0].clientY-o;x.rotation.y+=X*.01,x.rotation.x+=p*.01,G=a.touches[0].clientX,o=a.touches[0].clientY}else if(a.touches.length===2){const X=a.touches[0].clientX-a.touches[1].clientX,p=a.touches[0].clientY-a.touches[1].clientY,I=Math.sqrt(X*X+p*p);if(q>0){const ie=I/q,ne=N.position.distanceTo(new Ne(0,0,0));ie>1&&ne>10?N.position.multiplyScalar(1-.01):ie<1&&ne<50&&N.position.multiplyScalar(1+.01)}q=I}},ve=a=>{a.preventDefault(),D=!1,q=0,setTimeout(()=>{D||(B=!0)},3e3)},V=M.domElement;V.style.cursor="grab",V.addEventListener("mousedown",a=>{V.style.cursor="grabbing",ae(a)}),V.addEventListener("mousemove",H),V.addEventListener("mouseup",()=>{V.style.cursor="grab",U()}),V.addEventListener("mouseleave",()=>{V.style.cursor="grab",U()}),V.addEventListener("wheel",me),V.addEventListener("touchstart",de,{passive:!1}),V.addEventListener("touchmove",he,{passive:!1}),V.addEventListener("touchend",ve,{passive:!1}),document.addEventListener("keydown",xe);const we=()=>{j.current=requestAnimationFrame(we),B&&(x.rotation.y+=.002,x.rotation.x+=.001);const a=Date.now()*.005;f.scale.setScalar(1+Math.sin(a)*.1),pe.rotation.y+=.01,M.render(P,N)};we();const be=()=>{const a=w.clientWidth,X=w.clientHeight;N.aspect=a/X,N.updateProjectionMatrix(),M.setSize(a,X)};return window.addEventListener("resize",be),()=>{window.removeEventListener("resize",be),document.removeEventListener("keydown",xe),V.removeEventListener("mousedown",ae),V.removeEventListener("mousemove",H),V.removeEventListener("mouseup",U),V.removeEventListener("mouseleave",U),V.removeEventListener("wheel",me),V.removeEventListener("touchstart",de),V.removeEventListener("touchmove",he),V.removeEventListener("touchend",ve),j.current&&cancelAnimationFrame(j.current),w&&M.domElement&&w.removeChild(M.domElement),M.dispose(),T.dispose(),R.dispose(),z.dispose(),J.dispose(),le.dispose(),$.dispose(),fe.dispose()}},[t,d]),e.jsx("div",{ref:v,className:"w-full h-full"})},Mt=({coordinates:t,galaxyName:d})=>{const v=c.useRef(null),y=c.useRef(null),u=c.useRef(null),j=c.useRef(null),[w,m]=c.useState(!1),[se,P]=c.useState(!1),[N,M]=c.useState(!1),S=()=>{P(!0),setTimeout(()=>{m(!1),P(!1)},300)};c.useEffect(()=>{const h=i=>{i.key==="Escape"&&w&&S()};return document.addEventListener("universe-close-fullscreen",S),document.addEventListener("keydown",h),()=>{document.removeEventListener("universe-close-fullscreen",S),document.removeEventListener("keydown",h)}},[w]),c.useEffect(()=>{if(w&&N){const h=setTimeout(()=>{M(!1)},50);return()=>clearTimeout(h)}},[w,N]),c.useEffect(()=>{if(!v.current)return;const h=v.current,i=h.clientWidth,W=i<640,x=new Ge;x.background=new Ce(657930),y.current=x;const T=new Ie(30,i/120,.1,1e3);T.position.set(12,8,12),T.lookAt(0,0,0);const R=new De({antialias:!0,alpha:!0});R.setSize(i,120),R.setClearColor(0,.2),u.current=R,h.appendChild(R.domElement);const z=0,r=1e7,te=5e6,[Y,O,J]=t,le=((Y-z)/(r-z)-.5)*8,f=((O-z)/(r-z)-.5)*8,C=((J-z)/(r-z)-.5)*8,$=new Me;x.add($);const fe=new Ye(8,8,8),pe=new Oe(fe),ge=new Ae({color:16777215,opacity:.4,transparent:!0}),ke=new Le(pe,ge);$.add(ke);const l=new ze(8,8,16777215,16777215);l.material.opacity=.1,l.material.transparent=!0,l.position.y=-4,$.add(l);const n=new ze(8,8,16777215,16777215);n.material.opacity=.05,n.material.transparent=!0,n.rotation.z=Math.PI/2,n.position.x=-4,$.add(n);const s=new ze(8,8,16777215,16777215);s.material.opacity=.05,s.material.transparent=!0,s.rotation.x=Math.PI/2,s.position.z=-4,$.add(s);const g=new ue(.25,16,16),K=new ce({color:16777215,transparent:!0,opacity:.9}),k=new Q(g,K);k.position.set(0,0,0),$.add(k);const D=new Q(new ue(.45,16,16),new ce({color:16777215,transparent:!0,opacity:.2}));k.add(D);const G=new ue(.2,16,16),o=new ce({color:6605055,transparent:!0,opacity:1}),B=new Q(G,o);B.position.set(le,f,C),$.add(B);const q=new Q(new ue(.35,16,16),new ce({color:6605055,transparent:!0,opacity:.3}));if(B.add(q),Math.sqrt(Math.pow(Y-te,2)+Math.pow(O-te,2)+Math.pow(J-te,2))<2e6){const F=[new Ne(0,0,0),new Ne(le,f,C)],re=new Re().setFromPoints(F),oe=new Ue({color:16762980,dashSize:.3,gapSize:.3,opacity:.4,transparent:!0}),ee=new Ze(re,oe);ee.computeLineDistances(),$.add(ee)}const H=new _e(4210752,.6);x.add(H);const U=new Ke(16777215,.8);U.position.set(5,5,5),x.add(U);const me=(F,re)=>{const oe=document.createElement("canvas"),ee=oe.getContext("2d");if(!ee)return null;oe.width=32,oe.height=32,ee.fillStyle=`#${re.toString(16).padStart(6,"0")}`,ee.font="bold 24px Arial",ee.textAlign="center",ee.textBaseline="middle",ee.fillText(F,16,16);const tt=new Qe(oe),nt=new Je({map:tt,transparent:!0,opacity:.8}),Te=new et(nt);return Te.scale.set(.8,.8,1),Te},xe=me("X",16739179);xe&&(xe.position.set(4.2,-3.8,-3.8),$.add(xe));const de=me("Y",7077739);de&&(de.position.set(-3.8,4.2,-3.8),$.add(de));const he=me("Z",7039999);he&&(he.position.set(-3.8,-3.8,4.2),$.add(he));let ve=!1,V=0,we=0,be=!0;const a=F=>{ve=!0,be=!1,V=F.clientX,we=F.clientY},X=F=>{if(!ve)return;const re=F.clientX-V,oe=F.clientY-we;$.rotation.y+=re*.01,$.rotation.x+=oe*.01,V=F.clientX,we=F.clientY},p=()=>{ve=!1,setTimeout(()=>{ve||(be=!0)},3e3)},I=F=>{F.preventDefault();const re=.1,oe=T.position.distanceTo(new Ne(0,0,0));F.deltaY>0&&oe<25?T.position.multiplyScalar(1+re):F.deltaY<0&&oe>5&&T.position.multiplyScalar(1-re)},A=R.domElement;A.style.cursor="grab",A.style.borderRadius="8px",A.addEventListener("mousedown",F=>{A.style.cursor="grabbing",a(F)}),A.addEventListener("mousemove",X),A.addEventListener("mouseup",()=>{A.style.cursor="grab",p()}),A.addEventListener("mouseleave",()=>{A.style.cursor="grab",p()}),A.addEventListener("wheel",I);const ie=()=>{j.current=requestAnimationFrame(ie),be&&($.rotation.y+=.002,$.rotation.x+=.001);const F=Date.now()*.005;k.scale.setScalar(1+Math.sin(F)*.1),B.rotation.y+=.01,R.render(x,T)};ie();const ne=()=>{const F=h.clientWidth,re=F<640?150:160;T.aspect=F/re,T.updateProjectionMatrix(),R.setSize(F,re)};return window.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),A.removeEventListener("mousedown",a),A.removeEventListener("mousemove",X),A.removeEventListener("mouseup",p),A.removeEventListener("mouseleave",p),A.removeEventListener("wheel",I),j.current&&cancelAnimationFrame(j.current),h&&R.domElement&&h.removeChild(R.domElement),R.dispose(),fe.dispose(),pe.dispose(),ge.dispose(),g.dispose(),K.dispose(),G.dispose(),o.dispose()}},[t,d]);const E=h=>h.replace(/_/g," "),_=h=>h>=1e6?`${(h/1e6).toFixed(1)}M`:h>=1e3?`${(h/1e3).toFixed(1)}K`:h.toString(),[Z,b,L]=t;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Galaxy Location"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:v,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsxs("button",{onClick:()=>{m(!0),M(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 flex items-center gap-1 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:[e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),e.jsx("span",{className:"text-xs text-white hidden sm:inline",children:"Expand"})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-[10px]",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:E(d)})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[_(Z),", ",_(b),", ",_(L)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Drag: Rotate View"})]})]}),w&&st.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${se||N?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${se||N?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:E(d)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[E(d)," - Galaxy Location"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Galaxy"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[_(Z),", ",_(b),", ",_(L)]})]})]}),e.jsx("button",{onClick:S,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(jt,{coordinates:t,galaxyName:d})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},Nt=({galaxy:t})=>{const[d,v]=c.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});c.useEffect(()=>{let u;const j=()=>{const P=Pe.generateLocationId("galaxy",t.coordinates.join(","),void 0,void 0),N=Pe.canCollectFromLocation(P),M=Pe.getTimeUntilNextCollection(P),S=t.coordinates,E=We.generateGalaxyUrl(S,We.getCurrentPage()),Z=it.getLocations().some(b=>b.stargateUrl===E);v(b=>({isOnCooldown:!N&&M>0,isSaved:Z,isCollecting:b.isCollecting,timeUntilNext:M}))},w=()=>{v(P=>({...P,isCollecting:!0})),u=setTimeout(()=>{v(P=>({...P,isCollecting:!1}))},1e3)};j();const m=setInterval(j,1e3),se=at.subscribe("mining_completed",w);return()=>{clearInterval(m),u&&clearTimeout(u),se()}},[t.name,t.coordinates]);const y=u=>u.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(ft,{locationType:"galaxy",locationId:t.name,coordinates:t.coordinates.join(","),className:"text-xs"}),e.jsx(gt,{type:"galaxy",name:t.name,coordinates:t.coordinates.join(","),className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(vt,{isOnCooldown:d.isOnCooldown,isSaved:d.isSaved,isCollecting:d.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300",children:t.galaxy_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Solar Systems"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:t.num_systems.toLocaleString()})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-2",children:e.jsx(Mt,{coordinates:t.coordinates,galaxyName:t.name})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-gray-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Cosmic Objects"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-pink-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Black Holes"}),e.jsx("div",{className:"text-xs font-bold text-pink-300",children:t.black_holes.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Pulsars"}),e.jsx("div",{className:"text-xs font-bold text-cyan-300",children:t.pulsars.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-indigo-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Quasars"}),e.jsx("div",{className:"text-xs font-bold text-indigo-300",children:t.quasars.toLocaleString()})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:y(t.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:t.coordinates.join(", ")})]})]})]})]})},St=({galaxyType:t,numSystems:d,blackHoles:v,pulsars:y,quasars:u,seed:j=12345,imageUrl:w})=>{const m=c.useRef(null),se=c.useRef(null),P=c.useRef(null),N=c.useRef(null),M=c.useRef(null),S=c.useRef(null),[E,_]=c.useState(!1);class Z{seed;constructor(L){this.seed=L}random(){const L=Math.sin(this.seed++)*1e4;return L-Math.floor(L)}uniform(L,h){return L+this.random()*(h-L)}gauss(L,h){let i=0,W=0;for(;i===0;)i=this.random();for(;W===0;)W=this.random();const x=Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*W);return L+h*x}randint(L,h){return Math.floor(this.uniform(L,h+1))}}return c.useEffect(()=>{if(!m.current)return;const b=m.current,L=b.clientWidth,h=b.clientHeight,i=Math.min(L,h),W=new Ge;W.background=new Ce(17),se.current=W;const x=new Ie(45,1,.1,1e4);x.position.set(0,200,400),x.lookAt(0,0,0);const T=new De({antialias:!0,alpha:!0});T.setSize(i,i),T.setClearColor(17,1),P.current=T,b.appendChild(T.domElement);const R=new bt(x,T.domElement);R.enableDamping=!0,R.dampingFactor=.05,R.minDistance=50,R.maxDistance=800,R.autoRotate=!0,R.autoRotateSpeed=.5,R.enablePan=!0,R.enableZoom=!0,R.target.set(0,0,0),M.current=R;const z=new Me;S.current=z,W.add(z);const r=new Z(j),te=r.uniform(0,2*Math.PI),Y=new Re,O=[],J=[],le=[],f=200;let C=d;if(t==="Spiral"){C=Math.min(d,5e4);const l=4,n=2*Math.PI/l,s=.15,g=.5,K=.1;for(let k=0;k<C*K;k++){const D=r.uniform(0,2*Math.PI),G=r.gauss(f*.1,f*.05),o=r.gauss(0,5),B=G*Math.cos(D),q=G*Math.sin(D);O.push(B,o,q),J.push(1,1,1);const ae=j+k*1337,H=new Z(ae),U=H.gauss(1,.3),me=H.random()<.05,xe=H.random()<.3;let de=Math.max(.3,U);me&&(de*=3+H.uniform(0,2)),xe&&(de*=.5+H.uniform(0,.3)),G<f*.2&&(de*=1.5+H.uniform(0,.5),J[J.length-3]=1.2,J[J.length-2]=1.1,J[J.length-1]=.9),le.push(Math.min(de,8))}for(let k=0;k<C;k++){const D=g*Math.sqrt(k/C)*2*Math.PI,G=k%l*n,o=f*Math.sqrt(k/C),B=o*Math.cos(D+G+te)+r.uniform(-s*o,s*o),q=o*Math.sin(D+G+te)+r.uniform(-s*o,s*o),ae=r.gauss(0,3);O.push(B,ae,q),J.push(1,1,.8);const H=j+k*1337,U=new Z(H),me=U.gauss(.8,.25),xe=U.random()<.03,de=U.random()<.4;let he=Math.max(.2,me);xe&&(he*=2.5+U.uniform(0,1.5)),de&&(he*=.4+U.uniform(0,.2)),o>f*.7&&(he*=.7),le.push(Math.min(he,6))}}else if(t==="Elliptical"){C=Math.min(d,1e5);for(let l=0;l<C;l++){const n=r.uniform(0,2*Math.PI),s=r.uniform(0,Math.PI),g=r.gauss(f/4,f/8),K=g*Math.sin(s)*Math.cos(n),k=g*Math.cos(s)*.6,D=g*Math.sin(s)*Math.sin(n);O.push(K,k,D),J.push(1,.9,.7);const G=j+l*1337,o=new Z(G),B=o.gauss(.6,.2),q=o.random()<.08,ae=o.random()<.25;let H=Math.max(.2,B);q&&(H*=2+o.uniform(0,1)),ae&&(H*=.6+o.uniform(0,.2)),Math.sqrt(K*K+k*k+D*D)<f*.3&&(H*=1.3+o.uniform(0,.4)),le.push(Math.min(H,5))}}else if(t==="Dwarf"){C=Math.min(d/100,1e4);for(let l=0;l<C;l++){const n=r.uniform(0,2*Math.PI),s=r.uniform(0,Math.PI),g=r.gauss(f/3,f*.3),K=g*Math.sin(s)*Math.cos(n),k=g*Math.cos(s)*.5,D=g*Math.sin(s)*Math.sin(n);O.push(K,k,D),J.push(.8,.8,1);const G=j+l*1337,o=new Z(G),B=o.gauss(.7,.3),q=o.random()<.02,ae=o.random()<.6;let H=Math.max(.3,B);q&&(H*=2.5+o.uniform(0,1)),ae&&(H*=.5+o.uniform(0,.3)),le.push(Math.min(H,4))}}else if(t==="Singularity Void"){C=1e4;for(let p=0;p<C;p++){const I=p/C,A=I*30*Math.PI,ie=f*(1-I*.8)+r.uniform(-10,10),ne=(I-.5)*300+Math.sin(A*.5)*20,F=ie*Math.cos(A)+Math.sin(I*20)*10,re=ie*Math.sin(A)+Math.cos(I*20)*10;O.push(F,ne,re);const oe=(I+Math.sin(A*.1))%1,ee=new Ce;ee.setHSL(oe,1,.5+Math.sin(I*10)*.3),J.push(ee.r,ee.g,ee.b),le.push(r.uniform(.3,2)*(1+Math.sin(I*50)*.5))}const l=(p,I,A=1)=>{const ie=new ue(p,64,64),ne=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,F=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;
          
          void main() {
            // Use spherical coordinates for better wrapping
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);
            
            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;
            
            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;
            
            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x + 
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);
            
            // Add depth-based color variation
            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;
            
            // Add purple/violet tint for void effect
            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);
            
            // Edge glow effect
            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;
            
            gl_FragColor = vec4(color, ${I});
          }
        `,re=new Ee({uniforms:{time:{value:0},speed:{value:A}},vertexShader:ne,fragmentShader:F,transparent:!0,blending:je,side:$e,depthWrite:!1}),oe=new Q(ie,re);return oe.isSingularityShader=!0,oe.shaderSpeed=A,oe},n=l(250,.3,1);z.add(n);const s=l(180,.4,-.7);z.add(s);const g=l(120,.5,1.5);z.add(g);const K=l(300,.2,.5);K.scale.set(-1,1,1),z.add(K);const k=new ue(350,32,32),D=new Ee({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            
            // Distort vertices for gravitational lensing effect
            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          
          void main() {
            // Create a subtle distortion effect
            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;
            
            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:je,side:mt,depthWrite:!1}),G=new Q(k,D);G.isSingularityShader=!0,G.shaderSpeed=.3,z.add(G);const o=new Re,B=[],q=[];for(let p=0;p<1e3;p++){const I=r.uniform(-f,f),A=r.uniform(-f/2,f/2),ie=r.uniform(-f,f),ne=r.uniform(-50,50),F=r.uniform(-30,30),re=r.uniform(-50,50);B.push(I,A,ie),B.push(I+ne,A+F,ie+re);const oe=r.random(),ee=new Ce;ee.setHSL(oe,1,.6),q.push(ee.r,ee.g,ee.b),q.push(ee.r*.5,ee.g*.5,ee.b*.5)}o.setAttribute("position",new ye(B,3)),o.setAttribute("color",new ye(q,3));const ae=new Ae({vertexColors:!0,transparent:!0,opacity:.4,blending:je}),H=new Le(o,ae);H.isGlitchLines=!0,z.add(H);const U=new Me,me=new ue(20,32,32),xe=new ce({color:0,transparent:!0,opacity:.95}),de=new Q(me,xe);U.add(de);const he=new ht(25,80,64),ve=new Ee({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;
          
          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);
            
            // Swirling pattern
            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;
            
            // Colors from hot (inner) to cold (outer)
            vec3 hotColor = vec3(1.0, 0.5, 0.0); // Orange
            vec3 coldColor = vec3(0.0, 0.3, 1.0); // Blue
            vec3 color = mix(coldColor, hotColor, intensity);
            
            // Add swirl variation
            color *= (0.7 + swirl * 0.3);
            
            // Fade out at edges
            float alpha = intensity * 0.8;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:je,side:$e}),V=new Q(he,ve);V.rotation.x=Math.PI/2,V.isAccretionDisk=!0,U.add(V);for(let p=0;p<8;p++){const I=30+p*20,A=new He(I,1+p*.5,8,64),ie=new ce({color:new Ce().setHSL((.7+p*.05)%1,1,.5),transparent:!0,opacity:.3-p*.03,wireframe:!0}),ne=new Q(A,ie);ne.rotation.x=r.uniform(0,Math.PI),ne.rotation.y=r.uniform(0,Math.PI),ne.isDistortionRing=!0,ne.rotationSpeed=r.uniform(.001,.005)*(p%2===0?1:-1),U.add(ne)}z.add(U);const we=new Ve(5,100,8),be=new ce({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:je}),a=new Q(we,be);a.position.y=50,z.add(a);const X=new Q(we,be);X.position.y=-50,X.rotation.z=Math.PI,z.add(X)}if(t!=="Singularity Void"){const l=[],n=new Z(j+999);for(let o=0;o<v;o++){const B=n.uniform(-50,50),q=n.uniform(-20,20),ae=n.uniform(-50,50);l.push({x:B,y:q,z:ae})}const s=[],g=[],K=[],k=30;for(let o=0;o<O.length;o+=3){const B=O[o],q=O[o+1],ae=O[o+2];let H=!1;for(const U of l)if(Math.sqrt(Math.pow(B-U.x,2)+Math.pow(q-U.y,2)+Math.pow(ae-U.z,2))<k){H=!0;break}H||(s.push(B,q,ae),g.push(J[o],J[o+1],J[o+2]),K.push(le[o/3]))}Y.setAttribute("position",new ye(s,3)),Y.setAttribute("color",new ye(g,3)),Y.setAttribute("size",new ye(K,1));const D=new Ee({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (300.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {
            // Create circular points instead of squares
            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);
            
            if (distanceFromCenter > 0.5) {
              discard;
            }
            
            // Add soft falloff for better appearance
            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);
            
            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:je,vertexColors:!0,depthWrite:!1}),G=new qe(Y,D);z.add(G)}else{Y.setAttribute("position",new ye(O,3)),Y.setAttribute("color",new ye(J,3)),Y.setAttribute("size",new ye(le,1));const l=new pt({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:je,sizeAttenuation:!0}),n=new qe(Y,l);z.add(n)}const $=new Z(j+999);for(let l=0;l<v;l++){const n=new Me,s=$.uniform(-50,50),g=$.uniform(-20,20),K=$.uniform(-50,50),k=new ue(3,16,16),D=new ce({color:0,transparent:!0,opacity:.9}),G=new Q(k,D);n.add(G);const o=new He(8,2,8,32),B=new ce({color:65535,transparent:!0,opacity:.6,emissive:65535,emissiveIntensity:.5}),q=new Q(o,B);q.rotation.x=Math.PI/2,n.add(q),n.position.set(s,g,K),z.add(n)}for(let l=0;l<y;l++){const n=new ue(1.5,8,8),s=new ce({color:16776960,emissive:16776960,emissiveIntensity:1}),g=new Q(n,s);g.position.set(r.uniform(-f,f),r.uniform(-f/4,f/4),r.uniform(-f,f)),g.isPulsar=!0,g.pulseSpeed=r.uniform(1,3),z.add(g)}for(let l=0;l<u;l++){const n=new Me,s=new ue(2,16,16),g=new ce({color:16777215,emissive:16777215,emissiveIntensity:2}),K=new Q(s,g);n.add(K);const k=new Ve(1,20,8),D=new ce({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),G=new Q(k,D);G.position.y=10,n.add(G);const o=new Q(k,D);o.position.y=-10,o.rotation.z=Math.PI,n.add(o),n.position.set(r.uniform(-f,f),r.uniform(-f/4,f/4),r.uniform(-f,f)),z.add(n)}const fe=new _e(4210752,.5);W.add(fe);const pe=new xt(16777215,.5,1e3);pe.position.set(0,100,0),W.add(pe);const ge=()=>{N.current=requestAnimationFrame(ge);const l=performance.now()/1e3;S.current&&(S.current.rotation.y+=.001),z.children.forEach(n=>{if(n.isPulsar){const s=n.pulseSpeed||1;n.scale.setScalar(1+Math.sin(Date.now()*.001*s)*.3)}if(n.isSingularityShader&&n instanceof Q){const s=n.material;s.uniforms&&s.uniforms.time&&(s.uniforms.time.value=l);const g=n.shaderSpeed||1;n.rotation.y+=.001*g,n.rotation.x+=5e-4*g}if(n.isAccretionDisk&&n instanceof Q){const s=n.material;s.uniforms&&s.uniforms.time&&(s.uniforms.time.value=l),n.rotation.z+=.002}if(n.isDistortionRing){const s=n.rotationSpeed||.001;n.rotation.x+=s,n.rotation.y+=s*.7,n.scale.setScalar(1+Math.sin(l*2)*.1)}if(n.isGlitchLines&&n instanceof Le){const s=n.material;s.opacity=.2+Math.sin(l*3)*.2,n.rotation.z+=5e-4}n instanceof Me&&n.children.forEach(s=>{if(s.isAccretionDisk&&s instanceof Q){const g=s.material;g.uniforms&&g.uniforms.time&&(g.uniforms.time.value=l),s.rotation.z+=.002}if(s.isDistortionRing){const g=s.rotationSpeed||.001;s.rotation.x+=g,s.rotation.y+=g*.7,s.scale.setScalar(1+Math.sin(l*2)*.1)}})}),M.current&&M.current.update(),T.render(W,x)};ge();const ke=()=>{if(!m.current||!T)return;const l=m.current,n=Math.min(l.clientWidth,l.clientHeight);T.setSize(n,n),x.aspect=1,x.updateProjectionMatrix()};return window.addEventListener("resize",ke),()=>{window.removeEventListener("resize",ke),M.current&&M.current.dispose(),N.current&&cancelAnimationFrame(N.current),b&&T.domElement&&b.removeChild(T.domElement),T.dispose()}},[t,d,v,y,u,j]),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{ref:m,className:"w-full h-full border border-white/20 rounded bg-black/20"}),w&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>_(!E),className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 flex items-center gap-1 backdrop-blur-sm shadow-lg z-10",title:E?"Hide 2D Image":"Show 2D Image",children:[e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),e.jsx("span",{className:"text-xs text-white hidden sm:inline",children:E?"Hide":"2D"})]}),E&&e.jsxs("div",{className:"absolute bottom-2 left-2 w-48 h-48 border-2 border-blue-400/50 rounded-lg overflow-hidden bg-black/80 backdrop-blur-sm z-10",children:[e.jsx("img",{src:w,alt:"2D Galaxy visualization",className:"w-full h-full object-contain"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-xs p-1 text-center",children:"2D Reference"})]})]}),e.jsx("div",{className:"absolute top-2 left-2 bg-black/60 backdrop-blur-sm border border-white/30 rounded-lg px-3 py-1 z-10",children:e.jsxs("span",{className:"text-white text-sm font-medium",children:[t," Galaxy"]})}),e.jsxs("div",{className:"absolute bottom-2 right-2 bg-black/60 backdrop-blur-sm border border-white/30 rounded-lg px-3 py-2 z-10 text-xs text-white/80",children:[e.jsxs("div",{children:["Systems: ",d.toLocaleString()]}),e.jsxs("div",{children:["Black Holes: ",v]}),e.jsxs("div",{children:["Pulsars: ",y]}),e.jsxs("div",{children:["Quasars: ",u]})]})]})},Ct=({galaxyUrl:t,imageUrl:d,galaxyType:v="Spiral",numSystems:y=1e4,blackHoles:u=5,pulsars:j=10,quasars:w=3})=>{const m=c.useRef(null),se=c.useRef(null),[P,N]=c.useState("Aligning Stargate..."),[M,S]=c.useState(!1),[E,_]=c.useState(!1),[Z,b]=c.useState(!1),[L,h]=c.useState("3d");return c.useEffect(()=>{const i=m.current;if(!i)return;const W=i.getContext("2d");if(!W)return;let x=[];const T=800;let R,z;const r=800;let te,Y=.5;function O(){const C=i?.parentElement;if(!C||!i)return;const $=C.clientWidth,fe=C.clientHeight;i.width=Math.min($,r),i.height=Math.min(fe,r),R=i.width/2,z=i.height/2}function J(){O(),x=[];for(let C=0;C<T;C++)x.push({x:Math.random()*(i?.width||800),y:Math.random()*(i?.height||800),z:Math.random()*(i?.width||800),o:Math.random()});le()}function le(){!i||!W||(W.clearRect(0,0,i.width,i.height),x.forEach(C=>{C.z-=Y,C.z<=0&&(C.z=i.width,C.x=Math.random()*i.width,C.y=Math.random()*i.height,C.o=Math.random());const $=i.width/C.z,fe=(C.x-R)*$+R,pe=(C.y-z)*$+z,ge=2*$;W.beginPath(),W.fillStyle=`rgba(255, 255, 255, ${C.o})`,W.arc(fe,pe,ge,0,2*Math.PI),W.fill()}),Y<60&&(Y+=1),te=requestAnimationFrame(le))}J();const f=()=>O();return window.addEventListener("resize",f),()=>{window.removeEventListener("resize",f),te&&cancelAnimationFrame(te)}},[]),c.useEffect(()=>{if(d){const i=new Image;i.onload=()=>{se.current&&(se.current.src=d,_(!0),b(!0))},i.onerror=()=>{setTimeout(()=>{_(!0),b(!0)},1500)},i.src=d}else setTimeout(()=>{_(!0),b(!0)},1500)},[d]),c.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){N("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),S(!0);const W=(r,te)=>Array.from({length:te},()=>r[Math.floor(Math.random()*r.length)]).join(""),x=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:35},{chars:"0123456789ABCDEF",duration:20,iterations:50},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:'\",.<>?/`~",duration:15,iterations:100}];let T=0,R=0;const z=()=>{if(T>=x.length){const te="Stargate system aligned";let Y=0;N("");const O=()=>{Y<te.length?(N(te.substring(0,Y+1)),Y++,setTimeout(O,30)):S(!1)};O();return}const r=x[T];N(W(r.chars,32)),R++,R>=r.iterations&&(T++,R=0),setTimeout(z,r.duration)};z()},[]),c.useEffect(()=>{const i=document.createElement("style");return i.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(i),()=>{document.head.removeChild(i)}},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Galaxy Visualization"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>h("3d"),className:`px-3 py-1 text-xs rounded-l-lg border transition-all ${L==="3d"?"bg-blue-500/30 border-blue-400 text-blue-300":"bg-white/10 border-white/20 text-gray-400 hover:bg-white/20"}`,children:"3D View"}),e.jsx("button",{onClick:()=>h("2d"),className:`px-3 py-1 text-xs rounded-r-lg border transition-all ${L==="2d"?"bg-blue-500/30 border-blue-400 text-blue-300":"bg-white/10 border-white/20 text-gray-400 hover:bg-white/20"}`,children:"2D View"})]})]}),e.jsx("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:L==="3d"?e.jsx(St,{galaxyType:v,numSystems:y,blackHoles:u,pulsars:j,quasars:w,imageUrl:d}):e.jsxs(e.Fragment,{children:[e.jsx("canvas",{ref:m,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${Z?"opacity-0":"opacity-100"}`,style:{filter:Z?"blur(50px)":"none"}}),e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${E?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:E&&d?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ot,{zoomMargin:20,classDialog:"backdrop-blur-3xl",children:e.jsx("img",{ref:se,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl shadow-blue-500/20",src:d,alt:"Galaxy visualization",style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"transparent"}})})}):e.jsx("img",{ref:se,className:"w-full h-full object-cover",src:"/static/images/placeholder-min.jpg",alt:"Galaxy visualization"})})]})}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:t,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${M?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),P]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},zt=({systems:t,coordinates:d})=>{const[v,y]=c.useState(new Map);return c.useEffect(()=>{(()=>{try{const j=new Map;t.forEach(w=>{const m=rt(d,w.index,w.num_planets||1);j.set(w.index,m)}),y(j)}catch{}})()},[d,t]),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:t.map(u=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[(()=>{const j=v.get(u.index)||"none";return j==="complete"?e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}):j==="partial"?e.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500/20 border border-yellow-500/50 text-yellow-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"PARTIAL"}):null})(),e.jsxs("button",{onClick:()=>window.location.href=`/system/${u.index}`,className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["#",u.number]}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:u.name})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},u.index))}),t.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No systems found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This galaxy appears to be empty"})]})]})},kt=({currentGalaxy:t})=>{const[d,v]=c.useState(!1),[y,u]=c.useState(!1),[j,w]=c.useState(!0),m=1e7;c.useEffect(()=>{const[S,E,_]=t.coordinates,Z=!(S===0&&E===0&&_===0),b=!(S===m&&E===m&&_===m);v(Z),u(b),w(!1)},[t.coordinates]);const se=()=>{const[S,E,_]=t.coordinates;return _>0?[S,E,_-1]:E>0?[S,E-1,m]:S>0?[S-1,m,m]:[0,0,0]},P=()=>{const[S,E,_]=t.coordinates;return _<m?[S,E,_+1]:E<m?[S,E+1,0]:S<m?[S+1,0,0]:[m,m,m]},N=()=>{if(d){if(!Se.canAffordTravel("galaxy",1)){Se.executeTravel("galaxy",1);return}if(!Se.executeTravel("galaxy",1))return;const[E,_,Z]=se(),b=document.createElement("form");b.method="POST",b.action="/navigate";const L=document.createElement("input");L.type="hidden",L.name="x",L.value=E.toString();const h=document.createElement("input");h.type="hidden",h.name="y",h.value=_.toString();const i=document.createElement("input");i.type="hidden",i.name="z",i.value=Z.toString(),b.appendChild(L),b.appendChild(h),b.appendChild(i),document.body.appendChild(b),b.submit()}},M=()=>{if(y){if(!Se.canAffordTravel("galaxy",1)){Se.executeTravel("galaxy",1);return}if(!Se.executeTravel("galaxy",1))return;const[E,_,Z]=P(),b=document.createElement("form");b.method="POST",b.action="/navigate";const L=document.createElement("input");L.type="hidden",L.name="x",L.value=E.toString();const h=document.createElement("input");h.type="hidden",h.name="y",h.value=_.toString();const i=document.createElement("input");i.type="hidden",i.name="z",i.value=Z.toString(),b.appendChild(L),b.appendChild(h),b.appendChild(i),document.body.appendChild(b),b.submit()}};return j?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:N,disabled:!d,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${d?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:M,disabled:!y,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${y?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},Et=({page:t,prevPage:d,nextPage:v,finish:y})=>{const u="px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",j="bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg",w="bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white border border-white/20";return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 sm:gap-4 flex-wrap",children:[t!==1&&e.jsxs("button",{onClick:()=>window.location.href="/galaxy/1",className:`${u} ${w}`,title:"First page",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),d&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${d}`,className:`${u} ${w}`,title:"Previous page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),(()=>{const m=[],P=Math.max(1,t-2),N=Math.min(y,t+2);P>1&&(m.push(e.jsx("button",{onClick:()=>window.location.href="/galaxy/1",className:`${u} ${w}`,children:"1"},1)),P>2&&m.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"start-ellipsis")));for(let M=P;M<=N;M++)M===t?m.push(e.jsx("span",{className:`${u} ${j} cursor-default`,children:M},M)):m.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${M}`,className:`${u} ${w} cursor-pointer`,children:M},M));return N<y&&(N<y-1&&m.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"end-ellipsis")),m.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${y}`,className:`${u} ${w}`,children:y},y))),m})(),v&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${v}`,className:`${u} ${w}`,title:"Next page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),t!==y&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${y}`,className:`${u} ${w}`,title:"Last page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]}),e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-400",children:["Page ",t," of ",y]})]})},Xe=({galaxy:t,systems:d,galaxy_url:v,version:y,page:u,prev_page:j,next_page:w,finish:m,image_url:se})=>{const[P]=c.useState(t.coordinates.join(","));c.useEffect(()=>{document.body.setAttribute("data-coordinates",P),lt(P)},[P]);const N=M=>M.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(ct,{}),e.jsxs("div",{className:"relative z-10 pt-1",children:[e.jsx(dt,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["Galaxy '",N(t.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Coordinates ",t.coordinates.join(", ")]})]}),e.jsx(kt,{currentGalaxy:t}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(Ct,{galaxyUrl:v,imageUrl:se,galaxyType:t.galaxy_type,numSystems:t.num_systems,blackHoles:t.black_holes,pulsars:t.pulsars,quasars:t.quasars})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(Nt,{galaxy:t})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Systems in '",N(t.name),"'"]}),e.jsx(zt,{systems:d,coordinates:P})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsx("span",{className:"text-base sm:text-lg",children:"← Go Back to Planetary Index"})})}),e.jsx(Et,{page:u,prevPage:j,nextPage:w,finish:m})]}),e.jsx(yt,{version:y})]}),e.jsx(wt,{}),e.jsx(ut,{currentLocation:{type:"galaxy",name:t.name,coordinates:t.coordinates.join(",")}})]})};document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("atlas-react-root");if(!t)return;const d=v=>{const y=document.getElementById(v);if(!y||!y.textContent)return null;try{return JSON.parse(y.textContent.trim())}catch{return null}};try{const v=d("data-galaxy")||{},y=d("data-systems")||[],u=d("data-navigation")||{},j=d("data-common")||{},w={galaxy:{name:v.name||"Unknown Galaxy",coordinates:v.coordinates||[0,0,0],galaxy_type:v.galaxy_type||"Unknown",num_systems:v.num_systems||0,black_holes:v.black_holes||0,pulsars:v.pulsars||0,quasars:v.quasars||0},systems:y,galaxy_url:u.galaxy_url||"#",version:j.version||"1.0.0",page:u.page||1,prev_page:u.prev_page,next_page:u.next_page,finish:u.finish||1,image_url:j.image_url||""};Be.createRoot(t).render(Fe.createElement(Xe,w))}catch{const y={galaxy:{name:"Unknown Galaxy",coordinates:[0,0,0],galaxy_type:"Unknown",num_systems:0,black_holes:0,pulsars:0,quasars:0},systems:[],galaxy_url:"#",version:"1.0.0",page:1,finish:1,image_url:""};Be.createRoot(t).render(Fe.createElement(Xe,y))}});
