class a{constructor(){this.forbiddenWords=["nigga","nigger","negro","coon","chink","gook","spic","wetback","kike","heeb","raghead","towelhead","sandnigger","paki","pancho","panchito","faggot","fag","dyke","tranny","shemale","ladyboy","gay","queer","hitler","nazi","heil","sieg","aryan","swastika","1488","14/88","white power","white supremacy","kkk","ku klux","bitch","whore","slut","cunt","hoe","thot","kys","murder","rape","terrorist","genocide","holocaust","clickhere","buynow","freemoney","winner","prize","urgent","fuck","shit","damn","ass","piss","cock","dick","pussy","dildo","jewrat","mudslime","christcuck","islamist","jihadist","zionist","infidel","kafir","goyim","crusader","heathen","blasphemy","卐","卍","tripleparen","pepe","kek","based","redpilled"],this.urlPatterns=[/https?:\/\/[^\s]+/gi,/www\.[^\s]+/gi,/[a-zA-Z0-9][a-zA-Z0-9-]{1,61}[a-zA-Z0-9]\.[a-zA-Z]{2,}/gi,/bit\.ly\/[^\s]+/gi,/tinyurl\.com\/[^\s]+/gi,/t\.co\/[^\s]+/gi],this.personalInfoPatterns=[/\b\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/g,/\b\d{3}[-.\s]?\d{2}[-.\s]?\d{2}[-.\s]?\d{2}[-.\s]?\d{2}\b/g,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g],this.obfuscationMap={"@":"a",4:"a",3:"e",1:"i","!":"i",0:"o",5:"s",7:"t","+":"t",ph:"f",ck:"ck",rn:"m",rrn:"rn",rrrn:"rrn",а:"a",е:"e",о:"o",р:"p",с:"c",х:"x",у:"y",і:"i",ѕ:"s",ј:"j","ӏ":"l",α:"a",ο:"o",ρ:"p",υ:"y",ν:"v"," ":"","​":"","‌":"","‍":"",ii:"i",oo:"o",aa:"a",ee:"e"}}normalizeText(r){if(!r||typeof r!="string")return"";let e=r.toLowerCase();e=e.replace(/[\s\-_\.]+/g,"");for(let n=0;n<3;n++)Object.entries(this.obfuscationMap).forEach(([t,s])=>{try{const o=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(o,"g");e=e.replace(i,s)}catch{e=e.replace(new RegExp(t,"g"),s)}});return e=e.replace(/rn/g,"m"),e=e.replace(/vv/g,"w"),e=e.replace(/\|V\|/g,"m"),e=e.replace(/\\/g,"l"),e=e.replace(/[^a-z0-9]/g,""),e=e.trim(),e}detectEvasionPatterns(r){for(const e of this.forbiddenWords){const n=e.split("").join("[\\s\\-_\\.]*");if(new RegExp(n,"i").test(r))return!0}return!1}containsForbiddenWords(r){const e=this.normalizeText(r);if(this.detectEvasionPatterns(r))return{found:!0,word:"evasion pattern",reason:"Hate Speech"};for(const n of this.forbiddenWords){const t=n.toLowerCase();if(e.includes(t))return{found:!0,word:n,reason:"Hate Speech"};try{const s=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp(`\\b${s}\\b`,"i").test(e))return{found:!0,word:n,reason:"Hate Speech"}}catch{}if(this.isSimilarWord(e,t))return{found:!0,word:n,reason:"Hate Speech"}}return{found:!1}}isSimilarWord(r,e){if(Math.abs(r.length-e.length)>3)return!1;let n=0;const t=Math.min(r.length,e.length);for(let s=0;s<t;s++)r[s]===e[s]&&n++;return n/t>.8&&t>4}containsUrls(r){for(const e of this.urlPatterns)if(e.test(r))return{found:!0,reason:"URL/Link"};return{found:!1}}containsSpam(r){for(const t of this.personalInfoPatterns)if(t.test(r))return{found:!0,reason:"Personal Info"};const e=r.toLowerCase().split(/\s+/),n={};for(const t of e)if(t.length>2&&(n[t]=(n[t]||0)+1,n[t]>5))return{found:!0,reason:"Excessive Repetition"};return{found:!1}}filterContent(r){if(!r||typeof r!="string"||r.trim()==="")return{isBlocked:!1,originalText:r,filteredText:r,reason:null};const e=this.containsForbiddenWords(r);if(e.found)return{isBlocked:!0,originalText:r,filteredText:"Hate Speech",reason:"Hate Speech",details:`Contains prohibited word: ${e.word}`};if(this.containsUrls(r).found)return{isBlocked:!0,originalText:r,filteredText:"URL/Link",reason:"URL/Link",details:"Contains URLs or links"};const t=this.containsSpam(r);return t.found?{isBlocked:!0,originalText:r,filteredText:"Spam",reason:"Spam",details:`Spam pattern detected: ${t.reason}`}:{isBlocked:!1,originalText:r,filteredText:r,reason:null}}filterSeed(r){return this.filterContent(r)}shouldDisplayContent(r){return!this.filterContent(r).isBlocked}getDisplayText(r){return this.filterContent(r).filteredText}}const c=new a;export{c};
