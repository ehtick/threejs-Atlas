import{j as e,r as f}from"./atlas_BSujyM3STIIs7ogMAeFeS.js";import{g as k,s as R,a as w,m as Me,r as De,S as m,R as oe,A as z,E as G,D as $,U as xe}from"./atlas_Boy0K2B_wkWzeR1-wXZuF.js";const Te=({size:g=16,color:t="currentColor",className:s=""})=>e.jsxs("svg",{width:g,height:g,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("path",{d:"M2 12h20",stroke:t,strokeWidth:"1",opacity:"0.4"}),e.jsx("path",{d:"M2 8h20",stroke:t,strokeWidth:"0.6",opacity:"0.3"}),e.jsx("path",{d:"M2 16h20",stroke:t,strokeWidth:"0.6",opacity:"0.3"}),e.jsx("path",{d:"M12 2v20",stroke:t,strokeWidth:"1",opacity:"0.4"}),e.jsx("path",{d:"M8 2v20",stroke:t,strokeWidth:"0.6",opacity:"0.3"}),e.jsx("path",{d:"M16 2v20",stroke:t,strokeWidth:"0.6",opacity:"0.3"}),e.jsx("path",{d:"M6 6L18 18",stroke:t,strokeWidth:"0.8",opacity:"0.3"}),e.jsx("path",{d:"M6 18L18 6",stroke:t,strokeWidth:"0.8",opacity:"0.3"}),e.jsx("circle",{cx:"12",cy:"12",r:"2",fill:t,opacity:"0.7"}),e.jsx("text",{x:"20",y:"12",fill:t,fontSize:"8",opacity:"0.6",dy:"3",children:"X"}),e.jsx("text",{x:"12",y:"4",fill:t,fontSize:"8",opacity:"0.6",textAnchor:"middle",children:"Y"}),e.jsx("text",{x:"17",y:"7",fill:t,fontSize:"8",opacity:"0.6",children:"Z"})]});class B{static STORAGE_KEY="_atlasDailyChallenges";static BASE_GOALS={galaxies:1,systems:3,planets:10};static getTodaysChallenges(){const t=new Date().toISOString().split("T")[0],s=this.getStoredChallenges();return!s||s.date!==t?this.createNewDayChallenges(t,s):s}static getStoredChallenges(){try{const t=k(this.STORAGE_KEY);return t?JSON.parse(t):null}catch(t){return console.error("Error reading daily challenges:",t),null}}static createNewDayChallenges(t,s){const a=s?s.dayNumber+1:1,r=Math.pow(1.1,a-1),n=this.getCurrentStats(),o=[{type:"galaxies",current:n.galaxies,target:Math.ceil(a*this.BASE_GOALS.galaxies*r),dayNumber:a,completed:!1},{type:"systems",current:n.systems,target:Math.ceil(a*this.BASE_GOALS.systems*r),dayNumber:a,completed:!1},{type:"planets",current:n.planets,target:Math.ceil(a*this.BASE_GOALS.planets*r),dayNumber:a,completed:!1}],c=(s?.totalCompletedDays||0)+(s?.dayCompleted?1:0),d={date:t,dayNumber:a,challenges:o,lastReset:Date.now(),totalCompletedDays:c,dayCompleted:!1};return this.saveChallenges(d),d}static getCurrentStats(){try{const t=k("__atlasArchive");if(!t)return{galaxies:0,systems:0,planets:0};const s=JSON.parse(t);let a=0,r=0;Object.values(s.g||{}).forEach(d=>{a+=Object.keys(d).length,Object.values(d).forEach(i=>{typeof i=="string"&&(r+=(i.match(/1/g)||[]).length)})});const n=new Set(Object.keys(s.g||{})),o=new Set(Object.keys(s.gv||{}));return{galaxies:new Set([...n,...o]).size,systems:a,planets:r}}catch(t){return console.error("Error getting current stats:",t),{galaxies:0,systems:0,planets:0}}}static updateProgress(){const t=this.getTodaysChallenges(),s=this.getCurrentStats();return t.challenges.forEach(r=>{const n=s[r.type];r.current=n,r.completed=n>=r.target}),t.challenges.every(r=>r.completed)&&!t.dayCompleted&&(t.dayCompleted=!0),this.saveChallenges(t),t}static getCompletedDaysCount(){try{return this.getTodaysChallenges().totalCompletedDays||0}catch(t){return console.error("Error getting completed days count:",t),0}}static saveChallenges(t){try{R(this.STORAGE_KEY,JSON.stringify(t))}catch(s){console.error("Error saving daily challenges:",s)}}static getCompletionStatus(){const t=this.getTodaysChallenges(),s=t.challenges.filter(r=>r.completed).length,a=t.challenges.length;return{completed:s,total:a,allCompleted:s===a}}static getDayInfo(){const t=this.getTodaysChallenges(),s=Math.pow(1.1,t.dayNumber-1);return{dayNumber:t.dayNumber,multiplier:Math.round(s*100)/100}}}const D=g=>{const[t,s,a]=g.split(",").map(Number);return`${t.toString(36)}_${s.toString(36)}_${a.toString(36)}`};class U{static STORAGE_KEY=w.ARCHIVE;static MAX_ENTRIES_PER_GALAXY=1e3;static getData(){try{this.migrateToEncodedStorage(),this.cleanupLegacyStorage();const t=k(this.STORAGE_KEY);if(!t)return{g:{},gv:{}};const s=JSON.parse(t);return s.gv||(s.gv={}),s}catch(t){return console.error("Error reading Atlas archive:",t),{g:{},gv:{}}}}static cleanupLegacyStorage(){try{const t="atlasHistoricalData";localStorage.getItem(t)&&localStorage.removeItem(t)}catch(t){console.error("Error cleaning up legacy storage:",t)}}static migrateToEncodedStorage(){try{localStorage.getItem(this.STORAGE_KEY)&&Me()}catch(t){console.error("Error migrating to encoded storage:",t)}}static saveData(t){try{R(this.STORAGE_KEY,JSON.stringify(t))}catch(s){console.error("Error saving Atlas archive:",s)}}static performCleanup(t){const s=Object.keys(t.g);s.length>100&&s.slice(0,s.length-100).forEach(r=>delete t.g[r]),Object.keys(t.g).forEach(a=>{const r=t.g[a],n=Object.keys(r);n.length>this.MAX_ENTRIES_PER_GALAXY&&n.slice(0,n.length-this.MAX_ENTRIES_PER_GALAXY).forEach(c=>delete r[c])})}static performEmergencyCleanup(){const t=document.body.getAttribute("data-coordinates");if(t){const s=D(t),a=this.getData(),r=a.g[s];a.g={},r&&(a.g[s]=r),this.saveData(a)}}static markPlanetVisited(t,s,a,r){const n=this.getData(),o=D(t),c=s.toString(16),d=r.findIndex(u=>u.name.toLowerCase()===a.toLowerCase());if(d===-1){console.warn(`Planet ${a} not found in system planets list`);return}n.g[o]||(n.g[o]={}),n.g[o][c]||(n.g[o][c]="");const i=this.bitmapToIndices(n.g[o][c]);i.includes(d)||(i.push(d),n.g[o][c]=this.indicesToBitmap(i),this.saveData(n),B.updateProgress())}static markGalaxyVisited(t){const s=this.getData(),a=D(t);s.gv[a]||(s.gv[a]=!0,console.log(`🌌 Galaxy marked as visited: ${t} (hash: ${a})`),this.saveData(s),B.updateProgress())}static markSystemVisited(t,s){const a=this.getData(),r=D(t),n=s.toString(16);this.markGalaxyVisited(t),a.g[r]||(a.g[r]={}),a.g[r][n]||(a.g[r][n]="",this.saveData(a),B.updateProgress())}static bitmapToIndices(t){return t?t.split("").map((s,a)=>s==="1"?a:-1).filter(s=>s!==-1):[]}static indicesToBitmap(t){if(t.length===0)return"";const s=Math.max(...t),a=Array(s+1).fill("0");return t.forEach(r=>{r>=0&&(a[r]="1")}),a.join("")}static isGalaxyVisited(t){const s=this.getData(),a=D(t);return!!s.gv[a]}static isSystemVisited(t,s){const a=this.getData(),r=D(t),n=s.toString(16);return!!(a.g[r]&&n in a.g[r])}static getVisitedPlanets(t,s,a){const r=this.getData(),n=D(t),o=s.toString(16),c=r.g[n]?.[o]||"";return this.bitmapToIndices(c).map(i=>{const u=a[i];return u?u.name.toLowerCase():null}).filter(i=>i!==null)}static getVisitedPlanetCount(t,s){const a=this.getData(),r=D(t),n=s.toString(16),o=a.g[r]?.[n]||"";return this.bitmapToIndices(o).length}static getStorageStats(){const t=this.getData();let s=0;Object.values(w).forEach(i=>{const u=k(i);u&&(s+=u.length)});let r=0,n=0;Object.values(t.g).forEach(i=>{r+=Object.keys(i).length,Object.values(i).forEach(u=>{typeof u=="string"&&(n+=(u.match(/1/g)||[]).length)})});const o=new Set(Object.keys(t.g||{})),c=new Set(Object.keys(t.gv||{})),d=new Set([...o,...c]);return{size:s,galaxies:d.size,visitedGalaxies:Object.keys(t.gv).length,systems:r,planets:n}}}const Pe=g=>{U.markGalaxyVisited(g)},_e=(g,t,s,a)=>{U.markPlanetVisited(g,t,s,a)},ze=(g,t)=>{U.markSystemVisited(g,t)},Ge=(g,t,s)=>U.getVisitedPlanets(g,t,s),Ie=(g,t)=>U.isSystemVisited(g,t),$e=(g,t,s,a)=>{if(!Ie(g,t))return"none";{const r=U.getVisitedPlanetCount(g,t);return r>=s&&s>0?"complete":(r>0,"partial")}},Oe=()=>U.getStorageStats();class H{static STORAGE_KEY="_atlasLocations";static BASE_MAX_LOCATIONS=5;static BONUS_PER_COMPLETION=5;static ABSOLUTE_MAX_LOCATIONS=999;static getLocations(){try{const t=k(this.STORAGE_KEY);if(!t)return[];const s=JSON.parse(t);return Array.isArray(s)?s:[]}catch(t){return console.error("Error reading saved locations:",t),[]}}static normalizeStargateUrl(t){const s=t.indexOf("/stargate/");return s!==-1?t.substring(s):t}static decodeStargateUrl(t){try{const s=t.match(/\/stargate\/([A-Za-z0-9\-_]+)/);if(!s)return t;const a=s[1],r=atob(a.replace(/-/g,"+").replace(/_/g,"/"));return r.includes("&system=")||r.includes("&planet=")?r.replace(/&page=\d+/,""):r}catch{return t}}static isLocationSaved(t){const s=this.normalizeStargateUrl(t),a=this.decodeStargateUrl(s);return this.getLocations().some(n=>{const o=this.normalizeStargateUrl(n.stargateUrl);return this.decodeStargateUrl(o)===a})}static isGalaxyLocationSavedDifferentPage(t,s){if(s!=="galaxy")return!1;try{const r=this.normalizeStargateUrl(t).split("/stargate/")[1];if(!r)return!1;const n=atob(r.replace(/-/g,"+").replace(/_/g,"/")),o=new URLSearchParams(n),c=o.get("coordinates"),d=o.get("page");return!c||!d?!1:this.getLocations().some(u=>{if(u.type!=="galaxy")return!1;try{const S=this.normalizeStargateUrl(u.stargateUrl).split("/stargate/")[1];if(!S)return!1;const N=atob(S.replace(/-/g,"+").replace(/_/g,"/")),b=new URLSearchParams(N),p=b.get("coordinates"),E=b.get("page");return p===c&&E!==d}catch{return!1}})}catch{return!1}}static async saveLocation(t){try{const s=this.getLocations(),a=this.getCurrentMaxLocations(),r=this.decodeStargateUrl(this.normalizeStargateUrl(t.stargateUrl)),n=s.findIndex(c=>this.decodeStargateUrl(this.normalizeStargateUrl(c.stargateUrl))===r),o={...t,id:this.generateId(),timestamp:Date.now()};return n!==-1?(s[n]=o,R(this.STORAGE_KEY,JSON.stringify(s)),!0):s.length>=a&&!await this.showSlotFullDialog(a)?!1:(s.push(o),s.length>a&&(s.sort((c,d)=>d.timestamp-c.timestamp),s.splice(a)),R(this.STORAGE_KEY,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("locationSaved",{detail:{location:o}})),!0)}catch(s){return console.error("Error saving location:",s),!1}}static saveLocationSync(t){const s=this.getLocations(),a=this.getCurrentMaxLocations(),r=this.decodeStargateUrl(this.normalizeStargateUrl(t.stargateUrl)),n=s.findIndex(c=>this.decodeStargateUrl(this.normalizeStargateUrl(c.stargateUrl))===r),o={...t,id:this.generateId(),timestamp:Date.now()};n!==-1?s[n]=o:s.push(o),s.length>a&&(s.sort((c,d)=>d.timestamp-c.timestamp),s.splice(a)),R(this.STORAGE_KEY,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("locationSaved",{detail:{location:o}}))}static removeLocation(t){try{const a=this.getLocations().filter(r=>r.id!==t);R(this.STORAGE_KEY,JSON.stringify(a))}catch(s){console.error("Error removing location:",s)}}static clearAllLocations(){try{De(this.STORAGE_KEY)}catch(t){console.error("Error clearing locations:",t)}}static generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static async showSlotFullDialog(t){return new Promise(s=>{const a=document.createElement("div");a.className="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm transition-all duration-300 opacity-0",a.style.backdropFilter="blur(8px)";const r=document.createElement("div");r.className="relative bg-gradient-to-br from-slate-900/95 to-slate-800/95 border border-slate-600/50 rounded-2xl p-8 max-w-md mx-4 text-white shadow-2xl backdrop-blur-xl transform scale-95 transition-all duration-300",r.style.backdropFilter="blur(20px)",r.style.boxShadow="0 25px 50px -12px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.05)";const n=document.createElement("div");n.className="text-center";const o=document.createElement("div");o.className="inline-flex items-center justify-center w-16 h-16 bg-amber-500/20 rounded-full mb-6";const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("class","w-8 h-8 text-amber-400"),c.setAttribute("fill","none"),c.setAttribute("stroke","currentColor"),c.setAttribute("viewBox","0 0 24 24");const d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-width","2"),d.setAttribute("d","M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z");const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("stroke-linecap","round"),i.setAttribute("stroke-linejoin","round"),i.setAttribute("stroke-width","2"),i.setAttribute("d","M15 11a3 3 0 11-6 0 3 3 0 016 0z"),c.appendChild(d),c.appendChild(i),o.appendChild(c);const u=document.createElement("h2");u.className="text-2xl font-bold mb-4 text-white",u.textContent="Storage Full";const y=document.createElement("p");y.className="text-slate-400 mb-6 text-[10px] bg-slate-800/50 rounded-lg p-3 border border-slate-700/50",y.textContent="💡 Complete daily challenges to increase your storage capacity";const S=document.createElement("p");S.className="text-slate-300 mb-4 text-base leading-relaxed",S.textContent="You have reached your maximum of ";const N=document.createElement("span");N.className="font-bold text-amber-400 bg-amber-400/10 px-2 py-1 rounded-lg",N.textContent=t.toString(),S.appendChild(N),S.appendChild(document.createTextNode(" saved locations."));const b=document.createElement("p");b.className="text-slate-200 mb-8 text-base",b.textContent="Overwrite the oldest saved location?";const p=document.createElement("div");p.className="flex gap-4 justify-center";const E=document.createElement("button");E.id="cancelSave",E.className="px-6 py-3 bg-slate-700/80 hover:bg-slate-600/80 border border-slate-600/50 hover:border-slate-500/50 rounded-xl transition-all duration-200 font-medium text-slate-200 hover:text-white transform hover:scale-105 hover:shadow-lg",E.textContent="Cancel";const v=document.createElement("button");v.id="confirmOverwrite",v.className="px-6 py-3 bg-gradient-to-r from-amber-600 to-amber-500 hover:from-amber-500 hover:to-amber-400 rounded-xl transition-all duration-200 font-semibold text-white transform hover:scale-105 hover:shadow-lg border border-amber-400/30",v.textContent="Overwrite",p.appendChild(E),p.appendChild(v),n.appendChild(o),n.appendChild(u),n.appendChild(y),n.appendChild(S),n.appendChild(b),n.appendChild(p),r.appendChild(n),a.appendChild(r),document.body.appendChild(a),requestAnimationFrame(()=>{a.style.opacity="1",r.style.transform="scale(1)"});const F=r.querySelector("#cancelSave"),A=r.querySelector("#confirmOverwrite"),I=L=>{a.style.opacity="0",r.style.transform="scale(0.95)",setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a),s(L)},300)};F?.addEventListener("click",()=>{I(!1)}),A?.addEventListener("click",()=>{I(!0)}),a.addEventListener("click",L=>{L.target===a&&I(!1)});const h=L=>{L.key==="Escape"&&(document.removeEventListener("keydown",h),I(!1))};document.addEventListener("keydown",h)})}static hasAvailableSlot(){const t=this.getLocations(),s=this.getCurrentMaxLocations();return t.length<s}static getAvailableSlots(){const t=this.getLocations(),s=this.getCurrentMaxLocations();return Math.max(0,s-t.length)}static getCurrentMaxLocations(){try{const t=this.getCompletedDaysCount(),s=B.getCompletionStatus().allCompleted?1:0,a=this.BASE_MAX_LOCATIONS+(t+s)*this.BONUS_PER_COMPLETION;return Math.min(a,this.ABSOLUTE_MAX_LOCATIONS)}catch(t){return console.error("Error calculating max locations:",t),this.BASE_MAX_LOCATIONS}}static getCompletedDaysCount(){try{const t=k("_atlasDailyChallenges");return t&&JSON.parse(t).totalCompletedDays||0}catch(t){return console.error("Error getting completion history:",t),0}}static getLocationStats(){const t=this.getLocations(),s=this.getCurrentMaxLocations();return{total:t.length,galaxies:t.filter(a=>a.type==="galaxy").length,systems:t.filter(a=>a.type==="system").length,planets:t.filter(a=>a.type==="planet").length,maxAllowed:s,available:Math.max(0,s-t.length)}}static async saveLocationWithConfirmation(t,s,a){try{const r={name:t,type:s,stargateUrl:a};return await this.saveLocation(r)?{success:!0,message:`Location "${t}" saved successfully!`}:{success:!1,message:"Save operation cancelled by user."}}catch(r){return console.error("Error saving location with confirmation:",r),{success:!1,message:"Failed to save location. Please try again."}}}}class ie{static VERSION="2.6.14";static generateFallbackHash(t){let s=0;for(let a=0;a<t.length;a++){const r=t.charCodeAt(a);s=(s<<5)-s+r,s=s&s}return Math.abs(s).toString(16).padStart(8,"0")}static async generateHash(t){if(!crypto||!crypto.subtle||!crypto.subtle.digest)return console.warn("crypto.subtle not available, using fallback hash"),this.generateFallbackHash(t);const s=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(a)).map(o=>o.toString(16).padStart(2,"0")).join("")}static async verifyHash(t,s){const a=await this.generateHash(t);if(s===a)return!0;if(s.length===8||a.length===8){if(!crypto||!crypto.subtle||!crypto.subtle.digest)return console.warn("Cannot verify SHA-256 hash in non-secure context, accepting"),!0;{const r=this.generateFallbackHash(t);return s===r}}return!1}static async exportAllData(){const t=Date.now(),s={spaceship:btoa(encodeURIComponent(w.SPACESHIP)),archive:btoa(encodeURIComponent(w.ARCHIVE)),dailyChallenges:btoa(encodeURIComponent(w.DAILY_CHALLENGES)),locations:btoa(encodeURIComponent(w.LOCATIONS))},a={spaceship:localStorage.getItem(s.spaceship),archive:localStorage.getItem(s.archive),dailyChallenges:localStorage.getItem(s.dailyChallenges),locations:localStorage.getItem(s.locations)},r={};a.spaceship&&(r.spaceship=await this.generateHash(a.spaceship)),a.archive&&(r.archive=await this.generateHash(a.archive)),a.dailyChallenges&&(r.dailyChallenges=await this.generateHash(a.dailyChallenges)),a.locations&&(r.locations=await this.generateHash(a.locations));const n={version:this.VERSION,timestamp:t,data:a,hashes:r},o=JSON.stringify(n),c=await this.generateHash(o),d={...n,checksum:c},i=JSON.stringify(d),u=new TextEncoder().encode(i);return btoa(String.fromCharCode(...u))}static async downloadExport(){try{const t=await this.exportAllData(),a=`atlas-data-saved-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.atl`,r=new Blob([t],{type:"application/octet-stream"}),n=URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}catch(t){throw console.error("Error exporting data:",t),new Error("Failed to export data")}}static async importData(t){return new Promise((s,a)=>{const r=new FileReader;r.onload=async n=>{try{const o=n.target?.result,c=atob(o).split("").map(p=>p.charCodeAt(0)),d=new TextDecoder().decode(new Uint8Array(c)),i=JSON.parse(d);if(!this.validateImportData(i))throw new Error("Invalid import data format");const{checksum:u,...y}=i,S=JSON.stringify(y);if(!await this.verifyHash(S,u))throw new Error("Data integrity check failed. File may have been tampered with.");if(i.data.spaceship&&i.hashes.spaceship&&!await this.verifyHash(i.data.spaceship,i.hashes.spaceship))throw new Error("Spaceship data integrity check failed");if(i.data.archive&&i.hashes.archive&&!await this.verifyHash(i.data.archive,i.hashes.archive))throw new Error("Archive data integrity check failed");if(i.data.dailyChallenges&&i.hashes.dailyChallenges&&!await this.verifyHash(i.data.dailyChallenges,i.hashes.dailyChallenges))throw new Error("Daily challenges data integrity check failed");if(i.data.locations&&i.hashes.locations&&!await this.verifyHash(i.data.locations,i.hashes.locations))throw new Error("Locations data integrity check failed");const b={spaceship:btoa(encodeURIComponent(w.SPACESHIP)),archive:btoa(encodeURIComponent(w.ARCHIVE)),dailyChallenges:btoa(encodeURIComponent(w.DAILY_CHALLENGES)),locations:btoa(encodeURIComponent(w.LOCATIONS))};i.data.spaceship!==void 0&&(i.data.spaceship===null?localStorage.removeItem(b.spaceship):localStorage.setItem(b.spaceship,i.data.spaceship)),i.data.archive!==void 0&&(i.data.archive===null?localStorage.removeItem(b.archive):localStorage.setItem(b.archive,i.data.archive)),i.data.dailyChallenges!==void 0&&(i.data.dailyChallenges===null?localStorage.removeItem(b.dailyChallenges):localStorage.setItem(b.dailyChallenges,i.data.dailyChallenges)),i.data.locations!==void 0&&(i.data.locations===null?localStorage.removeItem(b.locations):localStorage.setItem(b.locations,i.data.locations)),window.location.reload(),s()}catch(o){console.error("Error importing data:",o),a(new Error(o instanceof Error?o.message:"Failed to import data. Please ensure the file is valid."))}},r.onerror=()=>{a(new Error("Failed to read file"))},r.readAsText(t)})}static validateImportData(t){return t&&typeof t=="object"&&typeof t.version=="string"&&typeof t.timestamp=="number"&&t.data&&typeof t.data=="object"&&t.hashes&&typeof t.hashes=="object"&&typeof t.checksum=="string"}static getDataSummary(){const t=k(w.SPACESHIP),s=k(w.ARCHIVE),a=k(w.DAILY_CHALLENGES),r=k(w.LOCATIONS),n=o=>o?new Blob([o]).size:0;return{hasSpaceship:!!t,hasArchive:!!s,hasDailyChallenges:!!a,hasLocations:!!r,totalSize:n(t)+n(s)+n(a)+n(r)}}}const V=({value:g,max:t,label:s,color:a="indigo",size:r="xs",showPercentage:n=!1})=>{const o=t>0?Math.min(g/t*100,100):0,c={indigo:{bg:"bg-indigo-500/20",fill:"bg-gradient-to-r from-indigo-500 to-indigo-400",text:"text-indigo-400"},blue:{bg:"bg-blue-500/20",fill:"bg-gradient-to-r from-blue-500 to-blue-400",text:"text-blue-400"},purple:{bg:"bg-purple-500/20",fill:"bg-gradient-to-r from-purple-500 to-purple-400",text:"text-purple-400"},cyan:{bg:"bg-cyan-500/20",fill:"bg-gradient-to-r from-cyan-500 to-cyan-400",text:"text-cyan-400"},green:{bg:"bg-green-500/20",fill:"bg-gradient-to-r from-green-500 to-green-400",text:"text-green-400"},orange:{bg:"bg-orange-500/20",fill:"bg-gradient-to-r from-orange-500 to-orange-400",text:"text-orange-400"},yellow:{bg:"bg-yellow-500/20",fill:"bg-gradient-to-r from-yellow-500 to-yellow-400",text:"text-yellow-400"}},d={xs:"h-1.5",sm:"h-2"},i=c[a]||c.indigo,u=d[r];return e.jsxs("div",{className:"w-full",children:[s&&e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400",children:s}),n&&e.jsxs("span",{className:`${i.text} font-medium`,children:[o.toFixed(0),"%"]})]}),e.jsx("div",{className:`w-full ${i.bg} rounded-full overflow-hidden ${u}`,children:e.jsx("div",{className:`${i.fill} ${u} rounded-full transition-all duration-700 ease-out shadow-sm`,style:{width:`${o}%`},children:e.jsx("div",{className:`w-full h-full ${i.fill} opacity-50 animate-pulse`})})})]})},Be=({currentLocation:g})=>{const[t,s]=f.useState(!1),[a,r]=f.useState(!1),[n,o]=f.useState("stats"),[c,d]=f.useState(null),[i,u]=f.useState([]),[y,S]=f.useState(null),[N,b]=f.useState(null),[p,E]=f.useState({antimatter:0,element115:0,deuterium:0}),[v,F]=f.useState({level:1,efficiency:1,range:300,storage:500,multiplier:1}),[A,I]=f.useState({antimatter:0,element115:0,deuterium:0}),[h,L]=f.useState({antimatter:0,element115:0,deuterium:0,sources:{planets:0,systems:0,galaxies:0}}),[ee,le]=f.useState({antimatter:0,element115:0,deuterium:0,sources:{planets:0,systems:0,galaxies:0}}),[te,ce]=f.useState(!1),[K,de]=f.useState(!1),[,fe]=f.useState({}),[me,T]=f.useState(null),[ye,he]=f.useState(!1),se=f.useRef(null),ae=f.useRef(null),W=f.useRef(null);f.useEffect(()=>{if(t){d(Oe()),u(H.getLocations()),S(H.getLocationStats());const l=B.updateProgress();b(l),E(m.getResources()),F(m.getUpgrade());const x=m.getUpgrade();I(m.getUpgradeCost(x.level));const j=m.getAccumulatedResourcesWithLimit();L(j);const M=m.calculatePassiveGeneration();le(M)}},[t]),f.useEffect(()=>{if(!t)return;const l=()=>{const J=m.getAccumulatedResourcesWithLimit();L(J);const X=m.calculatePassiveGeneration();le(X)},x=()=>{E(m.getResources())},j=setInterval(l,15e3),M=oe.subscribe("resources_updated",x);let O=null;return n==="saved"&&(O=setInterval(()=>{fe({})},3e4)),()=>{clearInterval(j),O&&clearInterval(O),M()}},[t,n]);const re=()=>{r(!0),setTimeout(()=>{s(!1),r(!1)},300)},ve=async()=>{try{await ie.downloadExport()}catch(l){console.error("Export failed:",l),T("Export failed. Please try again."),setTimeout(()=>T(null),3e3)}},be=async l=>{const x=l.target.files?.[0];if(x){if(!x.name.endsWith(".atl")){T("Please select a valid .atl file"),setTimeout(()=>T(null),3e3);return}try{await ie.importData(x),he(!0),setTimeout(()=>he(!1),3e3)}catch(j){T(j instanceof Error?j.message:"Import failed"),setTimeout(()=>T(null),3e3)}W.current&&(W.current.value="")}},je=()=>{t?re():s(!0)};f.useEffect(()=>{const l=x=>{t&&!a&&se.current&&!se.current.contains(x.target)&&re()};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[t,a]),f.useEffect(()=>{const l=x=>{te&&!K&&ae.current&&!ae.current.contains(x.target)&&Y()};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[te,K]);const we=l=>{if(l===0)return"0 B";const x=1024,j=["B","KB","MB"],M=Math.floor(Math.log(l)/Math.log(x));return parseFloat((l/Math.pow(x,M)).toFixed(2))+" "+j[M]},ue=l=>l.replace(/_/g," "),Se=(l,x)=>{l.stopPropagation(),H.removeLocation(x),u(H.getLocations()),S(H.getLocationStats())},Y=()=>{de(!0),setTimeout(()=>{ce(!1),de(!1)},300)};return e.jsx(e.Fragment,{children:e.jsxs("div",{ref:se,className:"fixed bottom-4 sm:bottom-6 right-4 sm:right-6 z-50",children:[e.jsxs("button",{onClick:je,className:"w-12 h-12 sm:w-14 sm:h-14 bg-gradient-to-br from-blue-600 via-purple-600 to-blue-800 hover:from-blue-500 hover:via-purple-500 hover:to-blue-700 text-white rounded-full shadow-2xl border-2 border-blue-400/30 transition-all duration-300 transform hover:scale-105 backdrop-blur-sm",title:"Spaceship Control Panel",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("svg",{className:"flex items-center justify-center",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[e.jsx("path",{d:"M12 3a6.02 6.02 0 0 0-5.923 4.9c-.086.466-.13.699.032 1.005c.161.307.39.409.847.613c1.38.614 3.134.982 5.044.982s3.665-.368 5.044-.982c.457-.204.686-.306.847-.613c.162-.306.118-.54.032-1.005A6.02 6.02 0 0 0 12 3"}),e.jsx("path",{d:"M17 5.5c2.989.788 5 2.26 5 3.945C22 11.961 17.523 14 12 14S2 11.96 2 9.445C2 7.76 4.011 6.288 7 5.5M12 18v3m5-4l1 4M7 17l-1 4"})]})})}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-400/20 animate-ping"})]}),t&&e.jsxs("div",{className:"fixed bottom-20 sm:bottom-24 right-2 sm:right-6 w-[calc(100vw-1rem)] sm:w-96 max-w-md max-h-[70vh] sm:max-h-96 bg-black/90 backdrop-blur-xl rounded-2xl border border-blue-400/30 shadow-2xl z-40 overflow-hidden transition-all duration-300 ease-out",style:{animation:a?"slideDownFadeOut 0.3s ease-out forwards":"slideUpFadeIn 0.3s ease-out forwards"},children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 p-4 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),e.jsx("h3",{className:"text-white font-bold text-lg",children:"🚀 Spaceship Control"})]}),e.jsx("button",{onClick:re,className:"text-gray-400 hover:text-white transition-colors duration-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex mt-3 space-x-1 overflow-x-auto",children:[e.jsx("button",{onClick:()=>o("stats"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 whitespace-nowrap ${n==="stats"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:"📊 Stats"}),e.jsx("button",{onClick:()=>o("ship"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 whitespace-nowrap ${n==="ship"?"bg-green-500/30 text-green-300 border border-green-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:"🚀 Ship"}),e.jsxs("button",{onClick:()=>o("saved"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 whitespace-nowrap ${n==="saved"?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:["📍 Saved (",y?.total||0,")"]})]})]}),e.jsxs("div",{className:"p-4 max-h-64 overflow-y-auto [&::-webkit-scrollbar]:hidden [-ms-overflow-style:none] [scrollbar-width:none]",children:[n==="stats"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-2 text-xs",children:"🌟 Daily Challenges"}),e.jsx("div",{className:"bg-white/5 rounded p-2 border border-indigo-500/20",children:N&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"Today's Progress"}),e.jsxs("span",{className:"text-[9px] text-indigo-400",children:["Day ",N.dayNumber," • x",B.getDayInfo().multiplier]})]}),e.jsx("div",{className:"space-y-1.5 mb-2",children:N.challenges.map(l=>{const x={galaxies:"indigo",systems:"blue",planets:"purple"},j={galaxies:"Galaxies",systems:"Systems",planets:"Planets"};return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-[10px] text-gray-400 mb-0.5",children:j[l.type]}),e.jsx(V,{value:l.current,max:l.target,label:`${l.current}/${l.target}`,color:x[l.type],showPercentage:!0}),l.completed&&e.jsx("div",{className:"absolute -right-2 top-1.5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:12,viewBox:"0 0 128 128",children:e.jsx("path",{fill:"#40c0e7",stroke:"#40c0e7",strokeMiterlimit:10,strokeWidth:6,d:"M48.3 103.45L12.65 67.99a2.2 2.2 0 0 1 0-3.12l9-9.01c.86-.86 2.25-.86 3.11 0l23.47 23.33c.86.86 2.26.85 3.12-.01l51.86-52.36c.86-.87 2.26-.87 3.13-.01l9.01 9.01c.86.86.86 2.25.01 3.11l-56.5 57.01l.01.01l-7.45 7.49c-.86.86-2.26.86-3.12.01z"})})})]},l.type)})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-[10px]",children:[e.jsxs("div",{className:"bg-black/30 rounded p-1.5 border border-indigo-500/30",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Completed"}),e.jsxs("div",{className:"text-indigo-400 font-bold",children:[N.challenges.filter(l=>l.completed).length,"/",N.challenges.length]})]}),e.jsxs("div",{className:"bg-black/30 rounded p-1.5 border border-green-500/30",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Atlas Size"}),e.jsx("div",{className:"text-green-400 font-bold",children:c?we(c.size):"0 B"})]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-2 text-xs",children:"📍 Saved Locations"}),e.jsxs("div",{className:"bg-white/5 rounded p-2 border border-purple-500/20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"Storage Usage"}),e.jsxs("span",{className:"text-[9px] text-purple-400",children:[y?.total||0,"/",y?.maxAllowed||50," slots"]})]}),e.jsx("div",{className:"mb-2",children:e.jsx(V,{value:y?.total||0,max:y?.maxAllowed||50,label:`${y?.total||0}/${y?.maxAllowed||50}`,color:"purple",showPercentage:!0})}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-[10px]",children:[e.jsxs("div",{className:"bg-black/30 rounded p-1 text-center border border-indigo-500/30",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Galaxies"}),e.jsx("div",{className:"text-indigo-400 font-bold",children:y?.galaxies||0})]}),e.jsxs("div",{className:"bg-black/30 rounded p-1 text-center border border-blue-500/30",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Systems"}),e.jsx("div",{className:"text-blue-400 font-bold",children:y?.systems||0})]}),e.jsxs("div",{className:"bg-black/30 rounded p-1 text-center border border-purple-500/30",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Planets"}),e.jsx("div",{className:"text-purple-400 font-bold",children:y?.planets||0})]})]}),e.jsx("div",{className:"text-[8px] text-gray-500 mt-2",children:"Complete daily tasks to save more locations"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-2 text-xs",children:"💾 Data Management"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"bg-white/5 rounded p-2 border border-blue-500/20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:"Export/Import Atlas Data"}),e.jsx("span",{className:"text-[9px] text-blue-400",children:(()=>{const l=ie.getDataSummary();return`${[l.hasSpaceship,l.hasArchive,l.hasDailyChallenges,l.hasLocations].filter(Boolean).length}/4 keys`})()})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{onClick:ve,className:"flex-1 bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 text-[10px] px-2 py-1.5 rounded border border-blue-500/50 transition-colors duration-200 flex items-center justify-center gap-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:1.5,children:[e.jsx("path",{d:"M4 12a8 8 0 1 0 16 0"}),e.jsx("path",{strokeLinejoin:"round",d:"M12 14V4m0 0l3 3m-3-3L9 7"})]})}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:()=>W.current?.click(),className:"flex-1 bg-green-500/20 hover:bg-green-500/30 text-green-300 text-[10px] px-2 py-1.5 rounded border border-green-500/50 transition-colors duration-200 flex items-center justify-center gap-1",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"currentColor",d:"M14.47 10.47a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-1.06 0l-3-3a.75.75 0 1 1 1.06-1.06l1.72 1.72V4a.75.75 0 0 1 1.5 0v8.19z"}),e.jsx("path",{fill:"currentColor",d:"M20.75 12a.75.75 0 0 0-1.5 0a7.25 7.25 0 1 1-14.5 0a.75.75 0 0 0-1.5 0a8.75 8.75 0 1 0 17.5 0"})]}),e.jsx("span",{children:"Import"})]})]}),e.jsx("input",{ref:W,type:"file",accept:".atl",onChange:be,className:"hidden"}),me&&e.jsx("div",{className:"mt-2 text-[9px] text-red-400 bg-red-500/10 p-1 rounded",children:me}),ye&&e.jsx("div",{className:"mt-2 text-[9px] text-green-400 bg-green-500/10 p-1 rounded",children:"Data imported successfully! Reloading..."}),e.jsx("div",{className:"text-[8px] text-gray-500 mt-2",children:"Saves all localStorage keys to .atl file"})]})})]})]}),n==="ship"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-semibold mb-2 text-xs flex items-center gap-1",children:["⚡ Resources",e.jsxs("div",{className:"text-[10px] text-gray-400",children:["Lv.",v.level]})]}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-purple-500/20",children:[e.jsxs("div",{className:"flex justify-between text-[10px] mb-0.5",children:[e.jsxs("span",{className:"text-purple-300 flex items-center gap-1",children:[e.jsx(z,{size:12,color:"currentColor"}),"Antimatter"]}),e.jsxs("span",{className:"text-white font-mono",children:[p.antimatter,"/",v.storage]})]}),e.jsx(V,{value:p.antimatter,max:v.storage,label:"",color:"purple",showPercentage:!1})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsxs("div",{className:"flex justify-between text-[10px] mb-0.5",children:[e.jsxs("span",{className:"text-cyan-300 flex items-center gap-1",children:[e.jsx(G,{size:12,color:"currentColor"}),"Element 115"]}),e.jsxs("span",{className:"text-white font-mono",children:[p.element115,"/",v.storage]})]}),e.jsx(V,{value:p.element115,max:v.storage,label:"",color:"cyan",showPercentage:!1})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-orange-500/20",children:[e.jsxs("div",{className:"flex justify-between text-[10px] mb-0.5",children:[e.jsxs("span",{className:"text-orange-300 flex items-center gap-1",children:[e.jsx($,{size:12,color:"currentColor"}),"Deuterium"]}),e.jsxs("span",{className:"text-white font-mono",children:[p.deuterium,"/",v.storage]})]}),e.jsx(V,{value:p.deuterium,max:v.storage,label:"",color:"orange",showPercentage:!1})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-2 text-xs",children:"🔧 Ship Upgrade"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 text-[10px] mb-2",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1 border border-blue-500/20",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Efficiency"}),e.jsxs("div",{className:"text-blue-400 font-bold",children:[v.efficiency.toFixed(1),"x"]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1 border border-yellow-500/20",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Storage"}),e.jsx("div",{className:"text-yellow-400 font-bold",children:v.storage})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1 border border-indigo-500/20",children:[e.jsx("div",{className:"text-gray-400 text-[9px]",children:"Multiplier"}),e.jsxs("div",{className:"text-indigo-400 font-bold",children:[v.multiplier.toFixed(1),"x"]})]})]}),v.level<100&&!m.canAffordUpgrade()&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded p-1.5 mb-2",children:[e.jsx("div",{className:"text-[10px] text-red-300 font-semibold mb-0.5",children:"Missing resources:"}),e.jsxs("div",{className:"text-[9px] text-red-200 space-y-0.5",children:[A.antimatter>p.antimatter&&e.jsxs("div",{className:"flex items-center gap-1",children:["• Need ",A.antimatter-p.antimatter," more ",e.jsx(z,{size:10,color:"currentColor"})," Antimatter"]}),A.element115>p.element115&&e.jsxs("div",{className:"flex items-center gap-1",children:["• Need ",A.element115-p.element115," more ",e.jsx(G,{size:10,color:"currentColor"})," Element 115"]}),A.deuterium>p.deuterium&&e.jsxs("div",{className:"flex items-center gap-1",children:["• Need ",A.deuterium-p.deuterium," more ",e.jsx($,{size:10,color:"currentColor"})," Deuterium"]})]})]}),e.jsx("button",{onClick:()=>{if(m.upgradeShip()){E(m.getResources()),F(m.getUpgrade());const l=m.getUpgrade();I(m.getUpgradeCost(l.level));const x=m.getAccumulatedResourcesWithLimit();L(x),oe.emit("resources_updated")}},disabled:!m.canAffordUpgrade(),className:`w-full px-2 py-1.5 rounded text-[10px] font-medium transition-all duration-200 ${m.canAffordUpgrade()?"bg-gradient-to-r from-green-600/30 to-blue-600/30 hover:from-green-600/40 hover:to-blue-600/40 text-green-300 border border-green-500/50 hover:border-green-400/70 cursor-pointer":"bg-gray-700/30 text-gray-500 border border-gray-600/30 cursor-not-allowed"}`,children:v.level>=100?e.jsx("div",{className:"text-yellow-400",children:"🌟 MAX LEVEL - Ultimate Spaceship!"}):e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold",children:["Upgrade to Level ",v.level+1]}),e.jsxs("div",{className:"opacity-80 flex gap-2 justify-center mt-0.5",children:[e.jsxs("span",{className:"text-purple-300 flex items-center gap-0.5",children:[e.jsx(z,{size:10,color:"currentColor"}),A.antimatter,"AM"]}),e.jsxs("span",{className:"text-cyan-300 flex items-center gap-0.5",children:[e.jsx(G,{size:10,color:"currentColor"}),A.element115,"E115"]}),e.jsxs("span",{className:"text-orange-300 flex items-center gap-0.5",children:[e.jsx($,{size:10,color:"currentColor"}),A.deuterium,"D"]})]})]})})]})]}),n==="saved"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-500/20 to-blue-500/20 rounded-lg p-2 border border-purple-500/30",children:[e.jsxs("h4",{className:"text-white font-semibold text-xs flex items-center gap-1 mb-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M3.5 8V6.5l4-3l3 1.5l4-3l6 4.5V8zm-.476 8.124L1.184 9.5h21.632l-1.84 6.624a4.5 4.5 0 0 0-7.364 4.376h-3.224q.111-.483.112-1a4.5 4.5 0 0 0-7.476-3.376M6 22.5a3 3 0 1 0 0-6a3 3 0 0 0 0 6m12 0a3 3 0 1 0 0-6a3 3 0 0 0 0 6",clipRule:"evenodd"})}),"Mining Operations"]}),h.sources.planets===0&&h.sources.systems===0?e.jsx("div",{className:"text-[10px] text-gray-400",children:"💡 Save planets and systems to enable mining operations"}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] mb-1",children:[e.jsx("span",{className:"text-purple-300",children:"Generating/hour:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-purple-300 flex items-center gap-0.5",children:[e.jsx(z,{size:8,color:"currentColor"}),"+",Math.round(ee.antimatter*60)," AM"]}),e.jsxs("span",{className:"text-cyan-300 flex items-center gap-0.5",children:[e.jsx(G,{size:8,color:"currentColor"}),"+",Math.round(ee.element115*60)," E115"]}),e.jsxs("span",{className:"text-orange-300 flex items-center gap-0.5",children:[e.jsx($,{size:8,color:"currentColor"}),"+",Math.round(ee.deuterium*60)," D"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-[10px] mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"Ready to collect:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-purple-300 flex items-center gap-0.5",children:[e.jsx(z,{size:8,color:"currentColor"}),"+",Math.round(h.antimatter)," AM"]}),e.jsxs("span",{className:"text-cyan-300 flex items-center gap-0.5",children:[e.jsx(G,{size:8,color:"currentColor"}),"+",Math.round(h.element115)," E115"]}),e.jsxs("span",{className:"text-orange-300 flex items-center gap-0.5",children:[e.jsx($,{size:8,color:"currentColor"}),"+",Math.round(h.deuterium)," D"]})]})]}),e.jsxs("button",{onClick:()=>{ce(!0)},disabled:h.antimatter+h.element115+h.deuterium===0,className:`w-full px-2 py-1.5 rounded text-[10px] font-medium transition-all duration-200 ${h.antimatter+h.element115+h.deuterium>0?"bg-gradient-to-r from-purple-600/30 to-blue-600/30 hover:from-purple-600/40 hover:to-blue-600/40 text-purple-300 border border-purple-500/50 hover:border-purple-400/70 cursor-pointer":"bg-gray-700/30 text-gray-500 border border-gray-600/30 cursor-not-allowed"}`,children:["🚀 Collect From ",h.sources.planets,"🪐 ",h.sources.systems,"⭐"]})]})]}),e.jsx("div",{className:"space-y-1",children:i.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"text-gray-400 text-xs mb-1",children:"No saved locations"}),e.jsx("div",{className:"text-gray-500 text-[10px]",children:"Use the 📍 button to save locations"})]}):i.map(l=>{const j=((C,P)=>{try{const _=C.split("/stargate/")[1];if(!_)return"";const q=atob(_.replace(/-/g,"+").replace(/_/g,"/")),ne=new URLSearchParams(q),Z=ne.get("coordinates"),Q=ne.get("system"),pe=ne.get("planet");return Z?P==="galaxy"?`galaxy_${Z}`:P==="system"&&Q?`system_${Z}_${Q}`:P==="planet"&&Q&&pe?`planet_${Z}_${Q}_${pe}`:"":""}catch{return""}})(l.stargateUrl,l.type),M=j?xe.canCollectFromLocation(j):!0,O=j?xe.getTimeUntilNextCollection(j):0,J={planet:900*1e3,system:2700*1e3,galaxy:480*60*1e3},X=J[l.type]||J.planet,Ne=O*60*60*1e3,Ce=X-Ne,Ee=Math.max(0,Math.min(100,Ce/X*100)),Ae=C=>{if(C<=0)return"Ready";const P=Math.floor(C*60),_=Math.floor(P/60),q=P%60;return _>0?`${_}h ${q}m`:`${q}m`},ge=l.stargateUrl.indexOf("/stargate/"),ke=ge!==-1?l.stargateUrl.substring(ge):l.stargateUrl,Le=`${window.location.origin}${ke}`;return e.jsxs("a",{href:Le,className:"block bg-white/5 hover:bg-white/10 rounded p-1.5 border border-white/10 hover:border-white/20 transition-all duration-200 hover:text-blue-300",title:`Navigate to ${ue(l.name)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("div",{className:"text-[8px]",children:[l.type==="galaxy"&&"🌌",l.type==="system"&&"⭐",l.type==="planet"&&"🪐"]}),e.jsx("div",{className:"text-white text-[10px] font-medium truncate",children:ue(l.name)}),e.jsx("div",{className:"text-gray-500 text-[8px] shrink-0",children:(()=>{try{const C=new Date(l.timestamp);return isNaN(C.getTime())?"N/A":C.toLocaleDateString()}catch{return"N/A"}})()})]})}),e.jsx("button",{onClick:C=>{C.preventDefault(),C.stopPropagation(),Se(C,l.id)},className:"text-gray-400 hover:text-red-400 transition-all duration-200 ml-1 p-0.5",title:"Remove location",children:e.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),!M&&O>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[e.jsx("span",{className:"text-[8px] text-gray-400",children:"Manual mining cooldown"}),e.jsx("span",{className:"text-[8px] text-orange-400",children:Ae(O)})]}),e.jsx("div",{className:"w-full bg-gray-800/50 rounded-full h-1 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 to-yellow-500 rounded-full transition-all duration-300",style:{width:`${Ee}%`}})})]}),M&&j&&e.jsx("div",{className:"mt-1",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-[8px] text-green-400",children:"✓ Ready to mine"})})})]},l.id)})})]})]})]}),te&&e.jsx("div",{className:`fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 ${K?"animate-fadeOut":"animate-fadeIn"}`,children:e.jsxs("div",{ref:ae,className:`bg-black/90 backdrop-blur-xl rounded-2xl border border-purple-400/30 shadow-2xl w-full max-w-md ${K?"animate-slideDown":"animate-slideUp"}`,children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600/20 to-blue-600/20 px-4 py-3 border-b border-white/10 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M3.5 8V6.5l4-3l3 1.5l4-3l6 4.5V8zm-.476 8.124L1.184 9.5h21.632l-1.84 6.624a4.5 4.5 0 0 0-7.364 4.376h-3.224q.111-.483.112-1a4.5 4.5 0 0 0-7.476-3.376M6 22.5a3 3 0 1 0 0-6a3 3 0 0 0 0 6m12 0a3 3 0 1 0 0-6a3 3 0 0 0 0 6",clipRule:"evenodd"})}),"Mass Collection"]}),e.jsx("button",{onClick:Y,className:"text-gray-400 hover:text-white transition-colors duration-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm text-gray-300 mb-4",children:"Collect resources from all your saved mining locations at once."}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 mb-4",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Available to collect:"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`font-bold flex items-center justify-center gap-1 ${h.antimatter>0?"text-purple-300":"text-gray-500"}`,children:[e.jsx(z,{size:12,color:"currentColor"}),"+",Math.round(h.antimatter)]}),e.jsx("div",{className:"text-gray-500",children:"Antimatter"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`font-bold flex items-center justify-center gap-1 ${h.element115>0?"text-cyan-300":"text-gray-500"}`,children:[e.jsx(G,{size:12,color:"currentColor"}),"+",Math.round(h.element115)]}),e.jsx("div",{className:"text-gray-500",children:"Element 115"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`font-bold flex items-center justify-center gap-1 ${h.deuterium>0?"text-orange-300":"text-gray-500"}`,children:[e.jsx($,{size:12,color:"currentColor"}),"+",Math.round(h.deuterium)]}),e.jsx("div",{className:"text-gray-500",children:"Deuterium"})]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-4",children:["🌟 Sources: ",h.sources.planets," Planets, ",h.sources.systems," Systems"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Y,className:"flex-1 px-4 py-2 rounded-lg text-sm font-medium bg-gray-700/50 text-gray-300 hover:bg-gray-700/70 border border-gray-600/50 transition-all duration-200",children:"Cancel"}),e.jsx("button",{onClick:()=>{m.addResources({antimatter:Math.round(h.antimatter),element115:Math.round(h.element115),deuterium:Math.round(h.deuterium)}),m.showPassiveGenerationNotification(h);const l=JSON.parse(k("_atlasSpaceShip")||"{}");l.t||(l.t={}),l.t.lp=Date.now(),R("_atlasSpaceShip",JSON.stringify(l)),E(m.getResources());const x=m.getAccumulatedResourcesWithLimit();L(x),oe.emit("resources_updated"),Y()},className:"flex-1 px-4 py-2 rounded-lg text-sm font-medium bg-gradient-to-r from-purple-600/30 to-blue-600/30 hover:from-purple-600/40 hover:to-blue-600/40 text-purple-300 border border-purple-500/50 hover:border-purple-400/70 transition-all duration-200",children:"🚀 Collect All"})]})]})]})})]})})};class He{static getTravelCost(t,s=0){return m.calculateTravelCost(t,s)}static canAffordTravel(t,s=0){return!0}static executeTravel(t,s=0){const a=this.getTravelCost(t,s),r=m.getResources(),n=m.getUpgrade(),o={antimatter:Math.floor(a.antimatter/n.efficiency),element115:Math.floor(a.element115/n.efficiency),deuterium:Math.floor(a.deuterium/n.efficiency)};console.log("[DEBUG executeTravel] Distance:",s,"Base cost:",a,"Efficiency:",n.efficiency,"Actual cost:",o,"Resources:",r);const c=[r.antimatter/o.antimatter,r.element115/o.element115,r.deuterium/o.deuterium],d=Math.min(...c);return d>=1?(m.consumeResources(o),"success"):d>=.5?(m.consumeResources({antimatter:Math.min(r.antimatter,o.antimatter),element115:Math.min(r.element115,o.element115),deuterium:Math.min(r.deuterium,o.deuterium)}),"partial"):"emergency"}static previewTravelCost(t,s=0){const a=this.getTravelCost(t,s),r=m.getUpgrade(),n={antimatter:Math.floor(a.antimatter/r.efficiency),element115:Math.floor(a.element115/r.efficiency),deuterium:Math.floor(a.deuterium/r.efficiency)};return`${n.antimatter}AM | ${n.element115}E115 | ${n.deuterium}D`}static getActualTravelCost(t,s=0){const a=this.getTravelCost(t,s),r=m.getResources(),n=m.getUpgrade(),o={antimatter:Math.floor(a.antimatter/n.efficiency),element115:Math.floor(a.element115/n.efficiency),deuterium:Math.floor(a.deuterium/n.efficiency)},c=[r.antimatter/o.antimatter,r.element115/o.element115,r.deuterium/o.deuterium],d=Math.min(...c);return d>=1?o:d>=.5?{antimatter:Math.min(r.antimatter,o.antimatter),element115:Math.min(r.element115,o.element115),deuterium:Math.min(r.deuterium,o.deuterium)}:{antimatter:0,element115:0,deuterium:0}}static getTravelEfficiency(){return m.getUpgrade().efficiency}static getMaxTravelRange(){return m.getUpgrade().range}}export{Te as C,H as L,He as S,Be as a,Ge as b,_e as c,ze as d,$e as g,Pe as m};
