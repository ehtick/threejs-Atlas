import{r as g,j as e,a as nt,c as Je,R as Qe}from"./atlas_BiACxVxc6cO5okV5F68Rd.js";import{R as yt,L as bt,g as Mt,S as _e,m as jt,F as St,H as Nt,a as zt}from"./atlas_DV2TxjXVLZiB7z8gZlLyQ.js";import{W as We}from"./atlas_hV4YbJX4LmBeaYZmYRF0y.js";import{a2 as Xe,C as ke,a3 as Ye,G as Ee,q as st,cG as ot,W as Be,cH as Ge,cI as Fe,b as be,z as Ce,M as q,V as Ae,B as Ie,cJ as it,n as at,a8 as Ue,a7 as rt,v as ct,cK as lt,cL as dt,S as Le,c as ut,A as ze,g as ye,x as qe,D as Te,H as mt,t as Ve,m as Pe,P as $e,X as ht,y as pt}from"./atlas_BOOzg5XYrrU1N4SZySfRd.js";import{R as Rt,S as Ct,M as Et,a as Oe,b as et,T as Pt}from"./atlas_CucbVO37Kcy0bEJq4UQQ7.js";import{O as ft}from"./atlas_BJLzboHTaSIGvKgNbvLUr.js";import{V as kt}from"./atlas_DrLTn8mjMle6vK3_h1E1S.js";import"./atlas_5StMBQg7EZ_DcUhMgqODi.js";const Lt=({coordinates:i,galaxyName:D})=>{const F=g.useRef(null),W=g.useRef(null),P=g.useRef(null),C=g.useRef(null);return g.useEffect(()=>{if(!F.current)return;const H=F.current,A=H.clientWidth,ve=H.clientHeight,ae=new Xe;ae.background=new ke(657930),W.current=ae;const O=new Ye(45,A/ve,.1,1e3);O.position.set(20,15,20),O.lookAt(0,0,0);const V=new We({antialias:!0,alpha:!0});V.setSize(A,ve),V.setClearColor(0,.2),P.current=V,H.appendChild(V.domElement);const $=0,Y=1e7,Z=5e6,[K,T,re]=i,v=((K-$)/(Y-$)-.5)*16,J=((T-$)/(Y-$)-.5)*16,he=((re-$)/(Y-$)-.5)*16,c=new Ee;ae.add(c);const l=new st(16,16,16),le=new ot(l),oe=new Be({color:16777215,opacity:.4,transparent:!0,linewidth:2}),Q=new Ge(le,oe);c.add(Q);const _=new Fe(16,16,16777215,16777215);_.material.opacity=.1,_.material.transparent=!0,_.position.y=-8,c.add(_);const ne=new Fe(16,16,16777215,16777215);ne.material.opacity=.05,ne.material.transparent=!0,ne.rotation.z=Math.PI/2,ne.position.x=-8,c.add(ne);const w=new Fe(16,16,16777215,16777215);w.material.opacity=.05,w.material.transparent=!0,w.rotation.x=Math.PI/2,w.position.z=-8,c.add(w);const B=new be(.5,32,32),k=new Ce({color:16777215,transparent:!0,opacity:.9}),Re=new q(B,k);Re.position.set(0,0,0),c.add(Re);const Me=new q(new be(.8,32,32),new Ce({color:16777215,transparent:!0,opacity:.2}));Re.add(Me);const se=new be(.4,32,32),G=new Ce({color:6605055,transparent:!0,opacity:1}),fe=new q(se,G);fe.position.set(v,J,he),c.add(fe);const o=new q(new be(.7,32,32),new Ce({color:6605055,transparent:!0,opacity:.3}));if(fe.add(o),Math.sqrt(Math.pow(K-Z,2)+Math.pow(T-Z,2)+Math.pow(re-Z,2))<2e6){const n=[new Ae(0,0,0),new Ae(v,J,he)],S=new Ie().setFromPoints(n),N=new it({color:16762980,dashSize:.6,gapSize:.6,opacity:.4,transparent:!0,linewidth:2}),U=new at(S,N);U.computeLineDistances(),c.add(U)}const d=new Ue(4210752,.6);ae.add(d);const L=new rt(16777215,.8);L.position.set(10,10,10),ae.add(L);const ue=(n,S)=>{const N=document.createElement("canvas"),U=N.getContext("2d");if(!U)return null;N.width=64,N.height=64,U.fillStyle=`#${S.toString(16).padStart(6,"0")}`,U.font="bold 48px Arial",U.textAlign="center",U.textBaseline="middle",U.fillText(n,32,32);const R=new ct(N),xe=new lt({map:R,transparent:!0,opacity:.8}),pe=new dt(xe);return pe.scale.set(1.6,1.6,1),pe},ee=ue("X",16739179);ee&&(ee.position.set(8.4,-7.6,-7.6),c.add(ee));const ce=ue("Y",7077739);ce&&(ce.position.set(-7.6,8.4,-7.6),c.add(ce));const a=ue("Z",7039999);a&&(a.position.set(-7.6,-7.6,8.4),c.add(a));let t=!1,s=0,h=0,u=!0,m=0;const p=n=>{t=!0,u=!1,s=n.clientX,h=n.clientY},E=n=>{if(!t)return;const S=n.clientX-s,N=n.clientY-h;c.rotation.y+=S*.01,c.rotation.x+=N*.01,s=n.clientX,h=n.clientY},f=()=>{t=!1,setTimeout(()=>{t||(u=!0)},3e3)},y=n=>{n.preventDefault();const S=.1,N=O.position.distanceTo(new Ae(0,0,0));n.deltaY>0&&N<50?O.position.multiplyScalar(1+S):n.deltaY<0&&N>10&&O.position.multiplyScalar(1-S)},X=n=>{n.key==="Escape"&&document.dispatchEvent(new CustomEvent("universe-close-fullscreen"))},b=n=>{if(n.preventDefault(),n.touches.length===1)t=!0,u=!1,s=n.touches[0].clientX,h=n.touches[0].clientY;else if(n.touches.length===2){const S=n.touches[0].clientX-n.touches[1].clientX,N=n.touches[0].clientY-n.touches[1].clientY;m=Math.sqrt(S*S+N*N)}},I=n=>{if(n.preventDefault(),n.touches.length===1&&t){const S=n.touches[0].clientX-s,N=n.touches[0].clientY-h;c.rotation.y+=S*.01,c.rotation.x+=N*.01,s=n.touches[0].clientX,h=n.touches[0].clientY}else if(n.touches.length===2){const S=n.touches[0].clientX-n.touches[1].clientX,N=n.touches[0].clientY-n.touches[1].clientY,U=Math.sqrt(S*S+N*N);if(m>0){const xe=U/m,pe=O.position.distanceTo(new Ae(0,0,0));xe>1&&pe>10?O.position.multiplyScalar(1-.01):xe<1&&pe<50&&O.position.multiplyScalar(1+.01)}m=U}},M=n=>{n.preventDefault(),t=!1,m=0,setTimeout(()=>{t||(u=!0)},3e3)},z=V.domElement;z.style.cursor="grab",z.addEventListener("mousedown",n=>{z.style.cursor="grabbing",p(n)}),z.addEventListener("mousemove",E),z.addEventListener("mouseup",()=>{z.style.cursor="grab",f()}),z.addEventListener("mouseleave",()=>{z.style.cursor="grab",f()}),z.addEventListener("wheel",y),z.addEventListener("touchstart",b,{passive:!1}),z.addEventListener("touchmove",I,{passive:!1}),z.addEventListener("touchend",M,{passive:!1}),document.addEventListener("keydown",X);const de=()=>{C.current=requestAnimationFrame(de),u&&(c.rotation.y+=.002,c.rotation.x+=.001);const n=Date.now()*.005;Re.scale.setScalar(1+Math.sin(n)*.1),fe.rotation.y+=.01,V.render(ae,O)};de();const te=()=>{const n=H.clientWidth,S=H.clientHeight;O.aspect=n/S,O.updateProjectionMatrix(),V.setSize(n,S)};return window.addEventListener("resize",te),()=>{window.removeEventListener("resize",te),document.removeEventListener("keydown",X),z.removeEventListener("mousedown",p),z.removeEventListener("mousemove",E),z.removeEventListener("mouseup",f),z.removeEventListener("mouseleave",f),z.removeEventListener("wheel",y),z.removeEventListener("touchstart",b),z.removeEventListener("touchmove",I),z.removeEventListener("touchend",M),C.current&&cancelAnimationFrame(C.current),H&&V.domElement&&H.removeChild(V.domElement),V.dispose(),l.dispose(),le.dispose(),oe.dispose(),B.dispose(),k.dispose(),se.dispose(),G.dispose()}},[i,D]),e.jsx("div",{ref:F,className:"w-full h-full"})},Gt=({coordinates:i,galaxyName:D})=>{const F=g.useRef(null),W=g.useRef(null),P=g.useRef(null),C=g.useRef(null),[H,A]=g.useState(!1),[ve,ae]=g.useState(!1),[O,V]=g.useState(!1),$=()=>{ae(!0),setTimeout(()=>{A(!1),ae(!1)},300)};g.useEffect(()=>{const v=J=>{J.key==="Escape"&&H&&$()};return document.addEventListener("universe-close-fullscreen",$),document.addEventListener("keydown",v),()=>{document.removeEventListener("universe-close-fullscreen",$),document.removeEventListener("keydown",v)}},[H]),g.useEffect(()=>{if(H&&O){const v=setTimeout(()=>{V(!1)},50);return()=>clearTimeout(v)}},[H,O]),g.useEffect(()=>{if(!F.current)return;const v=F.current,J=v.clientWidth,he=J<640,c=new Xe;c.background=new ke(657930),W.current=c;const l=new Ye(30,J/120,.1,1e3);l.position.set(12,8,12),l.lookAt(0,0,0);const le=new We({antialias:!0,alpha:!0});le.setSize(J,120),le.setClearColor(0,.2),P.current=le,v.appendChild(le.domElement);const oe=0,Q=1e7,_=5e6,[ne,w,B]=i,k=((ne-oe)/(Q-oe)-.5)*8,Re=((w-oe)/(Q-oe)-.5)*8,Me=((B-oe)/(Q-oe)-.5)*8,se=new Ee;c.add(se);const G=new st(8,8,8),fe=new ot(G),o=new Be({color:16777215,opacity:.4,transparent:!0}),r=new Ge(fe,o);se.add(r);const d=new Fe(8,8,16777215,16777215);d.material.opacity=.1,d.material.transparent=!0,d.position.y=-4,se.add(d);const L=new Fe(8,8,16777215,16777215);L.material.opacity=.05,L.material.transparent=!0,L.rotation.z=Math.PI/2,L.position.x=-4,se.add(L);const ue=new Fe(8,8,16777215,16777215);ue.material.opacity=.05,ue.material.transparent=!0,ue.rotation.x=Math.PI/2,ue.position.z=-4,se.add(ue);const ee=new be(.25,16,16),ce=new Ce({color:16777215,transparent:!0,opacity:.9}),a=new q(ee,ce);a.position.set(0,0,0),se.add(a);const t=new q(new be(.45,16,16),new Ce({color:16777215,transparent:!0,opacity:.2}));a.add(t);const s=new be(.2,16,16),h=new Ce({color:6605055,transparent:!0,opacity:1}),u=new q(s,h);u.position.set(k,Re,Me),se.add(u);const m=new q(new be(.35,16,16),new Ce({color:6605055,transparent:!0,opacity:.3}));if(u.add(m),Math.sqrt(Math.pow(ne-_,2)+Math.pow(w-_,2)+Math.pow(B-_,2))<2e6){const x=[new Ae(0,0,0),new Ae(k,Re,Me)],j=new Ie().setFromPoints(x),ie=new it({color:16762980,dashSize:.3,gapSize:.3,opacity:.4,transparent:!0}),me=new at(j,ie);me.computeLineDistances(),se.add(me)}const E=new Ue(4210752,.6);c.add(E);const f=new rt(16777215,.8);f.position.set(5,5,5),c.add(f);const y=(x,j)=>{const ie=document.createElement("canvas"),me=ie.getContext("2d");if(!me)return null;ie.width=32,ie.height=32,me.fillStyle=`#${j.toString(16).padStart(6,"0")}`,me.font="bold 24px Arial",me.textAlign="center",me.textBaseline="middle",me.fillText(x,16,16);const ge=new ct(ie),Se=new lt({map:ge,transparent:!0,opacity:.8}),je=new dt(Se);return je.scale.set(.8,.8,1),je},X=y("X",16739179);X&&(X.position.set(4.2,-3.8,-3.8),se.add(X));const b=y("Y",7077739);b&&(b.position.set(-3.8,4.2,-3.8),se.add(b));const I=y("Z",7039999);I&&(I.position.set(-3.8,-3.8,4.2),se.add(I));let M=!1,z=0,de=0,te=!0;const n=x=>{M=!0,te=!1,z=x.clientX,de=x.clientY},S=x=>{if(!M)return;const j=x.clientX-z,ie=x.clientY-de;se.rotation.y+=j*.01,se.rotation.x+=ie*.01,z=x.clientX,de=x.clientY},N=()=>{M=!1,setTimeout(()=>{M||(te=!0)},3e3)},U=x=>{x.preventDefault();const j=.1,ie=l.position.distanceTo(new Ae(0,0,0));x.deltaY>0&&ie<25?l.position.multiplyScalar(1+j):x.deltaY<0&&ie>5&&l.position.multiplyScalar(1-j)},R=le.domElement;R.style.cursor="grab",R.style.borderRadius="8px",R.addEventListener("mousedown",x=>{R.style.cursor="grabbing",n(x)}),R.addEventListener("mousemove",S),R.addEventListener("mouseup",()=>{R.style.cursor="grab",N()}),R.addEventListener("mouseleave",()=>{R.style.cursor="grab",N()}),R.addEventListener("wheel",U);const xe=()=>{C.current=requestAnimationFrame(xe),te&&(se.rotation.y+=.002,se.rotation.x+=.001);const x=Date.now()*.005;a.scale.setScalar(1+Math.sin(x)*.1),u.rotation.y+=.01,le.render(c,l)};xe();const pe=()=>{const x=v.clientWidth,j=x<640?150:160;l.aspect=x/j,l.updateProjectionMatrix(),le.setSize(x,j)};return window.addEventListener("resize",pe),()=>{window.removeEventListener("resize",pe),R.removeEventListener("mousedown",n),R.removeEventListener("mousemove",S),R.removeEventListener("mouseup",N),R.removeEventListener("mouseleave",N),R.removeEventListener("wheel",U),C.current&&cancelAnimationFrame(C.current),v&&le.domElement&&v.removeChild(le.domElement),le.dispose(),G.dispose(),fe.dispose(),o.dispose(),ee.dispose(),ce.dispose(),s.dispose(),h.dispose()}},[i,D]);const Y=v=>v.replace(/_/g," "),Z=v=>v>=1e6?`${(v/1e6).toFixed(1)}M`:v>=1e3?`${(v/1e3).toFixed(1)}K`:v.toString(),[K,T,re]=i;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Galaxy Location"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:F,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsx("button",{onClick:()=>{A(!0),V(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-[10px]",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:Y(D)})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:[Z(K),", ",Z(T),", ",Z(re)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Drag: Rotate View"})]})]}),H&&nt.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${ve||O?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${ve||O?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:Y(D)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[Y(D)," - Galaxy Location"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-white rounded-full opacity-90"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Bit Bang"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Galaxy"})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:[Z(K),", ",Z(T),", ",Z(re)]})]})]}),e.jsx("button",{onClick:$,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Lt,{coordinates:i,galaxyName:D})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},It=({galaxy:i})=>{const[D,F]=g.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});g.useEffect(()=>{let P;const C=()=>{const ae=Oe.generateLocationId("galaxy",i.coordinates.join(","),void 0,void 0),O=Oe.canCollectFromLocation(ae),V=Oe.getTimeUntilNextCollection(ae),$=i.coordinates,Y=et.generateGalaxyUrl($,et.getCurrentPage()),K=bt.getLocations().some(T=>T.stargateUrl===Y);F(T=>({isOnCooldown:!O&&V>0,isSaved:K,isCollecting:T.isCollecting,timeUntilNext:V}))},H=()=>{F(ae=>({...ae,isCollecting:!0})),P=setTimeout(()=>{F(ae=>({...ae,isCollecting:!1}))},1e3)};C();const A=setInterval(C,1e3),ve=yt.subscribe("mining_completed",H);return()=>{clearInterval(A),P&&clearTimeout(P),ve()}},[i.name,i.coordinates]);const W=P=>P.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(Rt,{locationType:"galaxy",locationId:i.name,coordinates:i.coordinates.join(","),className:"text-xs"}),e.jsx(Ct,{type:"galaxy",name:i.name,coordinates:i.coordinates.join(","),className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Et,{isOnCooldown:D.isOnCooldown,isSaved:D.isSaved,isCollecting:D.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300",children:i.galaxy_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Solar Systems"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:i.num_systems.toLocaleString()})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-2",children:e.jsx(Gt,{coordinates:i.coordinates,galaxyName:i.name})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-gray-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Cosmic Objects"}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-pink-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Black Holes"}),e.jsx("div",{className:"text-xs font-bold text-pink-300",children:i.black_holes.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-cyan-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Pulsars"}),e.jsx("div",{className:"text-xs font-bold text-cyan-300",children:i.pulsars.toLocaleString()})]}),e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-indigo-500/20",children:[e.jsx("div",{className:"text-xs text-gray-300",children:"Quasars"}),e.jsx("div",{className:"text-xs font-bold text-indigo-300",children:i.quasars.toLocaleString()})]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:W(i.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:i.coordinates.join(", ")})]})]})]})]})},Dt=({galaxyType:i,numSystems:D,blackHoles:F,pulsars:W,quasars:P,seed:C=12345,onExpandClick:H,galaxyName:A})=>{const ve=g.useRef(null),ae=g.useRef(null),O=g.useRef(null),V=g.useRef(null),$=g.useRef(null),Y=g.useRef(null),Z=g.useRef(null),K=g.useRef(!1),[T,re]=g.useState(!1),[v,J]=g.useState(!1);class he{seed;constructor(l){this.seed=l}random(){const l=Math.sin(this.seed++)*1e4;return l-Math.floor(l)}uniform(l,le){return l+this.random()*(le-l)}gauss(l,le){let oe=0,Q=0;for(;oe===0;)oe=this.random();for(;Q===0;)Q=this.random();const _=Math.sqrt(-2*Math.log(oe))*Math.cos(2*Math.PI*Q);return l+le*_}randint(l,le){return Math.floor(this.uniform(l,le+1))}}return g.useEffect(()=>{const c=Z.current;if(!c)return;const l=c.getContext("2d");if(!l)return;let le=[];const oe=800;let Q,_;const ne=800;let w,B=.5;function k(){const G=c?.parentElement;if(!G||!c)return;const fe=G.clientWidth,o=G.clientHeight;c.width=Math.min(fe,ne),c.height=Math.min(o,ne),Q=c.width/2,_=c.height/2}function Re(){k(),le=[];for(let G=0;G<oe;G++)le.push({x:Math.random()*(c?.width||800),y:Math.random()*(c?.height||800),z:Math.random()*(c?.width||800),o:Math.random()});Me()}function Me(){!c||!l||(l.clearRect(0,0,c.width,c.height),le.forEach(G=>{G.z-=B,G.z<=0&&(G.z=c.width,G.x=Math.random()*c.width,G.y=Math.random()*c.height,G.o=Math.random());const fe=c.width/G.z,o=(G.x-Q)*fe+Q,r=(G.y-_)*fe+_,d=2*fe;l.beginPath(),l.fillStyle=`rgba(255, 255, 255, ${G.o})`,l.arc(o,r,d,0,2*Math.PI),l.fill()}),!K.current&&B<60&&(B+=1),K.current&&B>2&&(B-=2),w=requestAnimationFrame(Me))}Re();const se=()=>k();return window.addEventListener("resize",se),()=>{window.removeEventListener("resize",se),w&&cancelAnimationFrame(w)}},[]),g.useEffect(()=>{if(!ve.current)return;const c=ve.current,l=c.clientWidth,le=c.clientHeight,oe=Math.min(l,le),Q=new Xe;Q.background=new ke(17),ae.current=Q;const _=new Ye(45,1,.1,1e4);_.position.set(0,200,400),_.lookAt(0,0,0);const ne=new We({antialias:!0,alpha:!0});ne.setSize(oe,oe),ne.setClearColor(17,1),O.current=ne,c.appendChild(ne.domElement);const w=new ft(_,ne.domElement);w.enableDamping=!0,w.dampingFactor=.05,w.minDistance=50,w.maxDistance=800,w.autoRotate=!0,w.autoRotateSpeed=.5,w.enablePan=!0,w.enableZoom=!0,w.target.set(0,0,0),$.current=w;const B=new Ee;Y.current=B,Q.add(B);const k=new he(C),Re=k.uniform(0,2*Math.PI),Me=new Ie,se=[],G=[],fe=[],o=200;let r=D;if(i==="Spiral"){r=Math.min(D,5e4);const a=4,t=2*Math.PI/a,s=.15,h=.5,u=.1;for(let m=0;m<r*u;m++){const p=k.uniform(0,2*Math.PI),E=k.gauss(o*.1,o*.05),f=k.gauss(0,5),y=E*Math.cos(p),X=E*Math.sin(p);se.push(y,f,X),G.push(1,1,1);const b=C+m*1337,I=new he(b),M=I.gauss(1,.3),z=I.random()<.05,de=I.random()<.3;let te=Math.max(.3,M);z&&(te*=3+I.uniform(0,2)),de&&(te*=.5+I.uniform(0,.3)),E<o*.2&&(te*=1.8+I.uniform(0,.7),G[G.length-3]=1.2,G[G.length-2]=1.1,G[G.length-1]=.9),fe.push(Math.min(te*1.5,12))}for(let m=0;m<r;m++){const p=h*Math.sqrt(m/r)*2*Math.PI,E=m%a*t,f=o*Math.sqrt(m/r),y=f*Math.cos(p+E+Re)+k.uniform(-s*f,s*f),X=f*Math.sin(p+E+Re)+k.uniform(-s*f,s*f),b=k.gauss(0,3);se.push(y,b,X),G.push(1,1,.8);const I=C+m*1337,M=new he(I),z=M.gauss(.8,.25),de=M.random()<.03,te=M.random()<.4;let n=Math.max(.2,z);de&&(n*=2.5+M.uniform(0,1.5)),te&&(n*=.4+M.uniform(0,.2)),f>o*.7&&(n*=.8),fe.push(Math.min(n*1.3,8))}}else if(i==="Elliptical"){r=Math.min(D,1e5);for(let a=0;a<r;a++){const t=k.uniform(0,2*Math.PI),s=k.uniform(-1,1),h=Math.sqrt(1-s*s),u=k.random(),m=Math.pow(u,.6),p=-Math.log(1-m*.98)*o*.35,E=p*h*Math.cos(t),f=p*s*.6,y=p*h*Math.sin(t);se.push(E,f,y),G.push(1,.9,.7);const X=C+a*1337,b=new he(X),I=b.gauss(.6,.2),M=b.random()<.08,z=b.random()<.25;let de=Math.max(.2,I);M&&(de*=2+b.uniform(0,1)),z&&(de*=.6+b.uniform(0,.2)),Math.sqrt(E*E+f*f+y*y)<o*.3&&(de*=1.5+b.uniform(0,.5)),fe.push(Math.min(de*1.4,7))}}else if(i==="Dwarf"){r=Math.min(D/100,1e4);for(let a=0;a<r;a++){const t=k.uniform(0,2*Math.PI),s=k.uniform(0,Math.PI),h=k.gauss(o/3,o*.3),u=h*Math.sin(s)*Math.cos(t),m=h*Math.cos(s)*.5,p=h*Math.sin(s)*Math.sin(t);se.push(u,m,p),G.push(.8,.8,1);const E=C+a*1337,f=new he(E),y=f.gauss(.7,.3),X=f.random()<.02,b=f.random()<.6;let I=Math.max(.3,y);X&&(I*=2.5+f.uniform(0,1)),b&&(I*=.5+f.uniform(0,.3)),fe.push(Math.min(I*1.2,5))}}else if(i==="Singularity Void"){r=1e4;for(let x=0;x<r;x++){const j=x/r,ie=j*30*Math.PI,me=o*(1-j*.8)+k.uniform(-10,10),ge=(j-.5)*300+Math.sin(ie*.5)*20,Se=me*Math.cos(ie)+Math.sin(j*20)*10,je=me*Math.sin(ie)+Math.cos(j*20)*10;se.push(Se,ge,je);const Ne=(j+Math.sin(ie*.1))%1,we=new ke;we.setHSL(Ne,1,.5+Math.sin(j*10)*.3),G.push(we.r,we.g,we.b),fe.push(k.uniform(.3,2)*(1+Math.sin(j*50)*.5))}const a=(x,j,ie=1)=>{const me=new be(x,64,64),ge=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,Se=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;

          void main() {
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);

            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;

            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;

            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x +
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);

            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;

            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);

            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;

            gl_FragColor = vec4(color, ${j});
          }
        `,je=new Le({uniforms:{time:{value:0},speed:{value:ie}},vertexShader:ge,fragmentShader:Se,transparent:!0,blending:ze,side:Te,depthWrite:!1}),Ne=new q(me,je);return Ne.isSingularityShader=!0,Ne.shaderSpeed=ie,Ne},t=a(250,.3,1);B.add(t);const s=a(180,.4,-.7);B.add(s);const h=a(120,.5,1.5);B.add(h);const u=a(300,.2,.5);u.scale.set(-1,1,1),B.add(u);const m=new be(350,32,32),p=new Le({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);


            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;

            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;

          void main() {

            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;

            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;

            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:ze,side:ut,depthWrite:!1}),E=new q(m,p);E.isSingularityShader=!0,E.shaderSpeed=.3,B.add(E);const f=new Ie,y=[],X=[];for(let x=0;x<1e3;x++){const j=k.uniform(-o,o),ie=k.uniform(-o/2,o/2),me=k.uniform(-o,o),ge=k.uniform(-50,50),Se=k.uniform(-30,30),je=k.uniform(-50,50);y.push(j,ie,me),y.push(j+ge,ie+Se,me+je);const Ne=k.random(),we=new ke;we.setHSL(Ne,1,.6),X.push(we.r,we.g,we.b),X.push(we.r*.5,we.g*.5,we.b*.5)}f.setAttribute("position",new ye(y,3)),f.setAttribute("color",new ye(X,3));const b=new Be({vertexColors:!0,transparent:!0,opacity:.4,blending:ze}),I=new Ge(f,b);I.isGlitchLines=!0,B.add(I);const M=new Ee,z=new be(20,32,32),de=new Ce({color:0,transparent:!0,opacity:.95}),te=new q(z,de);M.add(te);const n=new qe(25,80,64),S=new Le({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;

          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);


            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;


            vec3 hotColor = vec3(1.0, 0.5, 0.0);
            vec3 coldColor = vec3(0.0, 0.3, 1.0);
            vec3 color = mix(coldColor, hotColor, intensity);


            color *= (0.7 + swirl * 0.3);


            float alpha = intensity * 0.8;

            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:ze,side:Te}),N=new q(n,S);N.rotation.x=Math.PI/2,N.isAccretionDisk=!0,M.add(N);for(let x=0;x<8;x++){const j=30+x*20,ie=new mt(j,1+x*.5,8,64),me=new Ce({color:new ke().setHSL((.7+x*.05)%1,1,.5),transparent:!0,opacity:.3-x*.03,wireframe:!0}),ge=new q(ie,me);ge.rotation.x=k.uniform(0,Math.PI),ge.rotation.y=k.uniform(0,Math.PI),ge.isDistortionRing=!0,ge.rotationSpeed=k.uniform(.001,.005)*(x%2===0?1:-1),M.add(ge)}B.add(M);const U=new Ve(5,100,8),R=new Pe({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:ze}),xe=new q(U,R);xe.position.y=50,B.add(xe);const pe=new q(U,R);pe.position.y=-50,pe.rotation.z=Math.PI,B.add(pe)}if(i!=="Singularity Void"){const a=[],t=new he(C+999);for(let b=0;b<F;b++){const I=t.uniform(-50,50),M=t.uniform(-20,20),z=t.uniform(-50,50);a.push({x:I,y:M,z})}const s=[],h=[],u=[],m=[],p=[],E=.4,f=E*25;for(let b=0;b<se.length;b+=3){const I=se[b],M=se[b+1],z=se[b+2];let de=1/0,te=null;for(const n of a){const S=Math.sqrt(Math.pow(I-n.x,2)+Math.pow(M-n.y,2)+Math.pow(z-n.z,2));S<de&&(de=S,te=n)}if(!(de<E))if(de<f&&te){const n=1-(de-E)/(f-E);te.x-I,te.y-M,te.z-z;const S=Math.atan2(z-te.z,I-te.x),N=n*.8,U=8;for(let ge=0;ge<U-1;ge++){const Se=ge/(U-1),je=(ge+1)/(U-1),Ne=de*(1-Se*N*.7),we=S+Se*N*1.5,De=te.x+Ne*Math.cos(we),He=M+(te.y-M)*Se*.3,xt=te.z+Ne*Math.sin(we),Ze=de*(1-je*N*.7),Ke=S+je*N*1.5,gt=te.x+Ze*Math.cos(Ke),vt=M+(te.y-M)*je*.3,wt=te.z+Ze*Math.sin(Ke);m.push(De,He,xt),m.push(gt,vt,wt)}const R=n*1.5,xe=G[b],pe=G[b+1],x=G[b+2],j=Math.min(xe+R,2),ie=Math.max(pe*(1-R*.6),.1),me=Math.max(x*(1-R*.8),.1);for(let ge=0;ge<U-1;ge++){const Se=ge/(U-1),je=(ge+1)/(U-1),Ne=1-Se*n*.6,we=1-je*n*.6,De=R*(.5+Se*.5),He=R*(.5+je*.5);p.push(Math.min(j+De*.3,2)*Ne,Math.max(ie*(1-De*.2),.1)*Ne,Math.max(me*(1-De*.4),.1)*Ne),p.push(Math.min(j+He*.3,2)*we,Math.max(ie*(1-He*.2),.1)*we,Math.max(me*(1-He*.4),.1)*we)}s.push(I,M,z),h.push(j,ie,me),u.push(Math.max(fe[b/3]*(1-n*.5),.3))}else s.push(I,M,z),h.push(G[b],G[b+1],G[b+2]),u.push(fe[b/3])}Me.setAttribute("position",new ye(s,3)),Me.setAttribute("color",new ye(h,3)),Me.setAttribute("size",new ye(u,1));const y=new Le({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (400.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {

            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);

            if (distanceFromCenter > 0.5) {
              discard;
            }


            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);

            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:ze,vertexColors:!0,depthWrite:!1}),X=new $e(Me,y);if(B.add(X),m.length>0){const b=new Ie;b.setAttribute("position",new ye(m,3)),b.setAttribute("color",new ye(p,3));const I=new Be({vertexColors:!0,transparent:!0,opacity:.8,linewidth:2,blending:ze}),M=new Ge(b,I);B.add(M)}}else{Me.setAttribute("position",new ye(se,3)),Me.setAttribute("color",new ye(G,3)),Me.setAttribute("size",new ye(fe,1));const a=new ht({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:ze,sizeAttenuation:!0}),t=new $e(Me,a);B.add(t)}const d=new he(C+999);for(let a=0;a<F;a++){const t=new Ee,s=d.uniform(-50,50),h=d.uniform(-20,20),u=d.uniform(-50,50),m=new be(1.5,16,16),p=new Ce({color:0,transparent:!0,opacity:.9}),E=new q(m,p);t.add(E),[{innerRadius:2,outerRadius:2.3,color:16777215,opacity:.8,emissive:16777164},{innerRadius:2.3,outerRadius:2.7,color:16755200,opacity:.7,emissive:16746496},{innerRadius:2.7,outerRadius:3.2,color:16729088,opacity:.6,emissive:16720384},{innerRadius:3.2,outerRadius:4,color:11141120,opacity:.5,emissive:6684672},{innerRadius:4,outerRadius:5,color:4456448,opacity:.3,emissive:2228224}].forEach((y,X)=>{const b=new qe(y.innerRadius,y.outerRadius,32),I=new Pe({color:y.color,transparent:!0,opacity:y.opacity,emissive:y.emissive,emissiveIntensity:.3,side:Te}),M=new q(b,I);M.rotation.x=Math.PI/2,M.rotation.z=k.uniform(0,Math.PI*2),M.isAccretionRing=!0,M.rotationSpeed=.002+X*5e-4,t.add(M)}),t.position.set(s,h,u),B.add(t)}for(let a=0;a<W;a++){const t=new be(1.5,8,8),s=new Pe({color:16776960,emissive:16776960,emissiveIntensity:1}),h=new q(t,s);h.position.set(k.uniform(-o,o),k.uniform(-o/4,o/4),k.uniform(-o,o)),h.isPulsar=!0,h.pulseSpeed=k.uniform(1,3),B.add(h)}for(let a=0;a<P;a++){const t=new Ee,s=new be(2,16,16),h=new Pe({color:16777215,emissive:16777215,emissiveIntensity:2}),u=new q(s,h);t.add(u);const m=new Ve(1,20,8),p=new Pe({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),E=new q(m,p);E.position.y=10,t.add(E);const f=new q(m,p);f.position.y=-10,f.rotation.z=Math.PI,t.add(f),t.position.set(k.uniform(-o,o),k.uniform(-o/4,o/4),k.uniform(-o,o)),B.add(t)}const L=new Ue(4210752,.5);Q.add(L);const ue=new pt(16777215,.5,1e3);ue.position.set(0,100,0),Q.add(ue);const ee=()=>{V.current=requestAnimationFrame(ee);const a=performance.now()/1e3;Y.current&&(Y.current.rotation.y+=.001),B.children.forEach(t=>{if(t.isPulsar){const s=t.pulseSpeed||1;t.scale.setScalar(1+Math.sin(Date.now()*.001*s)*.3)}if(t.isSingularityShader&&t instanceof q){const s=t.material;s.uniforms&&s.uniforms.time&&(s.uniforms.time.value=a);const h=t.shaderSpeed||1;t.rotation.y+=.001*h,t.rotation.x+=5e-4*h}if(t.isAccretionDisk&&t instanceof q){const s=t.material;s.uniforms&&s.uniforms.time&&(s.uniforms.time.value=a),t.rotation.z+=.002}if(t.isDistortionRing){const s=t.rotationSpeed||.001;t.rotation.x+=s,t.rotation.y+=s*.7,t.scale.setScalar(1+Math.sin(a*2)*.1)}if(t.isGlitchLines&&t instanceof Ge){const s=t.material;s.opacity=.2+Math.sin(a*3)*.2,t.rotation.z+=5e-4}t instanceof Ee&&t.children.forEach(s=>{if(s.isAccretionDisk&&s instanceof q){const h=s.material;h.uniforms&&h.uniforms.time&&(h.uniforms.time.value=a),s.rotation.z+=.002}if(s.isAccretionRing&&s instanceof q){const h=s.rotationSpeed||.002;s.rotation.z+=h}if(s.isDistortionRing){const h=s.rotationSpeed||.001;s.rotation.x+=h,s.rotation.y+=h*.7,s.scale.setScalar(1+Math.sin(a*2)*.1)}})}),$.current&&$.current.update(),ne.render(Q,_)};ee(),setTimeout(()=>{re(!0),J(!0),K.current=!0},800);const ce=()=>{if(!ve.current||!ne)return;const a=ve.current,t=Math.min(a.clientWidth,a.clientHeight);ne.setSize(t,t),_.aspect=1,_.updateProjectionMatrix()};return window.addEventListener("resize",ce),()=>{window.removeEventListener("resize",ce),$.current&&$.current.dispose(),V.current&&cancelAnimationFrame(V.current),c&&ne.domElement&&c.removeChild(ne.domElement),ne.dispose()}},[i,D,F,W,P,C]),e.jsxs("div",{className:"relative w-full h-full bg-black rounded",children:[e.jsx("canvas",{ref:Z,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${v?"opacity-0":"opacity-100"}`,style:{filter:v?"blur(50px)":"none"}}),e.jsxs("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${T?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:[e.jsx("div",{ref:ve,className:"w-full h-full border border-white/20 rounded bg-black/20"}),T&&A&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:A})}),T&&H&&e.jsx("button",{onClick:H,className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]})]})},At=({galaxyType:i,numSystems:D,blackHoles:F,pulsars:W,quasars:P,seed:C=12345,galaxyName:H})=>{const A=g.useRef(null),ve=g.useRef(null),ae=g.useRef(null),O=g.useRef(null),V=g.useRef(null),$=g.useRef(null);class Y{seed;constructor(K){this.seed=K}random(){const K=Math.sin(this.seed++)*1e4;return K-Math.floor(K)}uniform(K,T){return K+this.random()*(T-K)}gauss(K,T){let re=0,v=0;for(;re===0;)re=this.random();for(;v===0;)v=this.random();const J=Math.sqrt(-2*Math.log(re))*Math.cos(2*Math.PI*v);return K+T*J}randint(K,T){return Math.floor(this.uniform(K,T+1))}}return g.useEffect(()=>{if(!A.current)return;const Z=A.current,K=Z.clientWidth,T=Z.clientHeight,re=new Xe;re.background=new ke(17),ve.current=re;const v=new Ye(45,K/T,.1,1e4);v.position.set(0,200,400),v.lookAt(0,0,0);const J=new We({antialias:!0,alpha:!0});J.setSize(K,T),J.setClearColor(17,1),ae.current=J,Z.appendChild(J.domElement);const he=new ft(v,J.domElement);he.enableDamping=!0,he.dampingFactor=.05,he.minDistance=50,he.maxDistance=1200,he.autoRotate=!0,he.autoRotateSpeed=.5,he.enablePan=!0,he.enableZoom=!0,he.target.set(0,0,0),V.current=he;const c=new Ee;$.current=c,re.add(c);const l=new Y(C),le=l.uniform(0,2*Math.PI),oe=new Ie,Q=[],_=[],ne=[],w=200;let B=D;if(i==="Spiral"){B=Math.min(D,5e4);const o=4,r=2*Math.PI/o,d=.15,L=.5,ue=.1;for(let ee=0;ee<B*ue;ee++){const ce=l.uniform(0,2*Math.PI),a=l.gauss(w*.1,w*.05),t=l.gauss(0,5),s=a*Math.cos(ce),h=a*Math.sin(ce);Q.push(s,t,h),_.push(1,1,1);const u=C+ee*1337,m=new Y(u),p=m.gauss(1,.3),E=m.random()<.05,f=m.random()<.3;let y=Math.max(.3,p);E&&(y*=3+m.uniform(0,2)),f&&(y*=.5+m.uniform(0,.3)),a<w*.2&&(y*=1.8+m.uniform(0,.7),_[_.length-3]=1.2,_[_.length-2]=1.1,_[_.length-1]=.9),ne.push(Math.min(y*1.5,12))}for(let ee=0;ee<B;ee++){const ce=L*Math.sqrt(ee/B)*2*Math.PI,a=ee%o*r,t=w*Math.sqrt(ee/B),s=t*Math.cos(ce+a+le)+l.uniform(-d*t,d*t),h=t*Math.sin(ce+a+le)+l.uniform(-d*t,d*t),u=l.gauss(0,3);Q.push(s,u,h),_.push(1,1,.8);const m=C+ee*1337,p=new Y(m),E=p.gauss(.8,.25),f=p.random()<.03,y=p.random()<.4;let X=Math.max(.2,E);f&&(X*=2.5+p.uniform(0,1.5)),y&&(X*=.4+p.uniform(0,.2)),t>w*.7&&(X*=.8),ne.push(Math.min(X*1.3,8))}}else if(i==="Elliptical"){B=Math.min(D,1e5);for(let o=0;o<B;o++){const r=l.uniform(0,2*Math.PI),d=l.uniform(-1,1),L=Math.sqrt(1-d*d),ue=l.random(),ee=Math.pow(ue,.6),ce=-Math.log(1-ee*.98)*w*.35,a=ce*L*Math.cos(r),t=ce*d*.6,s=ce*L*Math.sin(r);Q.push(a,t,s),_.push(1,.9,.7);const h=C+o*1337,u=new Y(h),m=u.gauss(.6,.2),p=u.random()<.08,E=u.random()<.25;let f=Math.max(.2,m);p&&(f*=2+u.uniform(0,1)),E&&(f*=.6+u.uniform(0,.2)),Math.sqrt(a*a+t*t+s*s)<w*.3&&(f*=1.5+u.uniform(0,.5)),ne.push(Math.min(f*1.4,7))}}else if(i==="Dwarf"){B=Math.min(D/100,1e4);for(let o=0;o<B;o++){const r=l.uniform(0,2*Math.PI),d=l.uniform(0,Math.PI),L=l.gauss(w/3,w*.3),ue=L*Math.sin(d)*Math.cos(r),ee=L*Math.cos(d)*.5,ce=L*Math.sin(d)*Math.sin(r);Q.push(ue,ee,ce),_.push(.8,.8,1);const a=C+o*1337,t=new Y(a),s=t.gauss(.7,.3),h=t.random()<.02,u=t.random()<.6;let m=Math.max(.3,s);h&&(m*=2.5+t.uniform(0,1)),u&&(m*=.5+t.uniform(0,.3)),ne.push(Math.min(m*1.2,5))}}else if(i==="Singularity Void"){B=1e4;for(let n=0;n<B;n++){const S=n/B,N=S*30*Math.PI,U=w*(1-S*.8)+l.uniform(-10,10),R=(S-.5)*300+Math.sin(N*.5)*20,xe=U*Math.cos(N)+Math.sin(S*20)*10,pe=U*Math.sin(N)+Math.cos(S*20)*10;Q.push(xe,R,pe);const x=(S+Math.sin(N*.1))%1,j=new ke;j.setHSL(x,1,.5+Math.sin(S*10)*.3),_.push(j.r,j.g,j.b),ne.push(l.uniform(.3,2)*(1+Math.sin(S*50)*.5))}const o=(n,S,N=1)=>{const U=new be(n,64,64),R=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          void main() {
            vUv = uv;
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,xe=`
          varying vec2 vUv;
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          uniform float speed;
          
          void main() {
            float theta = atan(vPosition.z, vPosition.x);
            float phi = acos(vPosition.y / length(vPosition));
            vec2 p = vec2(theta / 3.14159, phi / 3.14159);
            
            float a = time * 40.0 * speed;
            float d, e, f, g = 1.0 / 40.0, h, i, r, q;
            
            e = 400.0 * (p.x * 0.5 + 0.5);
            f = 400.0 * (p.y * 0.5 + 0.5);
            i = 200.0 + sin(e * g + a / 150.0) * 20.0;
            d = 200.0 + cos(f * g / 2.0) * 18.0 + cos(e * g) * 7.0;
            r = sqrt(pow(abs(i - e), 2.0) + pow(abs(d - f), 2.0));
            q = f / r;
            e = (r * cos(q)) - a / 2.0;
            f = (r * sin(q)) - a / 2.0;
            d = sin(e * g) * 176.0 + sin(e * g) * 164.0 + r;
            h = ((f + d) + a / 2.0) * g;
            i = cos(h + r * p.x / 1.3) * (e + e + a) + cos(q * g * 6.0) * (r + h / 3.0);
            h = sin(f * g) * 144.0 - sin(e * g) * 212.0 * p.x;
            h = (h + (f - e) * q + sin(r - (a + h) / 7.0) * 10.0 + i / 4.0) * g;
            i += cos(h * 2.3 * sin(a / 350.0 - q)) * 184.0 * sin(q - (r * 4.3 + a / 12.0) * g) + tan(r * g + h) * 184.0 * cos(r * g + h);
            i = mod(i / 5.6, 256.0) / 64.0;
            if (i < 0.0) i += 4.0;
            if (i >= 2.0) i = 4.0 - i;
            d = r / 350.0;
            d += sin(d * d * 8.0) * 0.52;
            f = (sin(a * g) + 1.0) / 2.0;
            
            vec3 color = vec3(f * i / 1.6, i / 2.0 + d / 13.0, i) * d * p.x + 
                         vec3(i / 1.3 + d / 8.0, i / 2.0 + d / 18.0, i) * d * (1.0 - p.x);
            
            float depth = dot(vNormal, vec3(0.0, 0.0, 1.0));
            color *= 0.7 + depth * 0.3;
            
            color = mix(color, vec3(0.5, 0.0, 1.0), 0.3);
            
            float edgeFactor = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 2.0);
            color += vec3(0.5, 0.0, 1.0) * edgeFactor * 0.5;
            
            gl_FragColor = vec4(color, ${S});
          }
        `,pe=new Le({uniforms:{time:{value:0},speed:{value:N}},vertexShader:R,fragmentShader:xe,transparent:!0,blending:ze,side:Te,depthWrite:!1}),x=new q(U,pe);return x.isSingularityShader=!0,x.shaderSpeed=N,x},r=o(250,.3,1);c.add(r);const d=o(180,.4,-.7);c.add(d);const L=o(120,.5,1.5);c.add(L);const ue=o(300,.2,.5);ue.scale.set(-1,1,1),c.add(ue);const ee=new be(350,32,32),ce=new Le({uniforms:{time:{value:0}},vertexShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          void main() {
            vPosition = position;
            vNormal = normalize(normalMatrix * normal);
            
            vec3 distortedPosition = position;
            float distortion = sin(time * 0.5 + length(position) * 0.01) * 5.0;
            distortedPosition += normal * distortion;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4(distortedPosition, 1.0);
          }
        `,fragmentShader:`
          varying vec3 vPosition;
          varying vec3 vNormal;
          uniform float time;
          
          void main() {
            float fresnel = pow(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0))), 3.0);
            float wave = sin(time * 2.0 + length(vPosition) * 0.05) * 0.5 + 0.5;
            
            vec3 color = vec3(0.1, 0.0, 0.3) * fresnel * wave;
            float alpha = fresnel * 0.1 * wave;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:ze,side:ut,depthWrite:!1}),a=new q(ee,ce);a.isSingularityShader=!0,a.shaderSpeed=.3,c.add(a);const t=new Ie,s=[],h=[];for(let n=0;n<1e3;n++){const S=l.uniform(-w,w),N=l.uniform(-w/2,w/2),U=l.uniform(-w,w),R=l.uniform(-50,50),xe=l.uniform(-30,30),pe=l.uniform(-50,50);s.push(S,N,U),s.push(S+R,N+xe,U+pe);const x=l.random(),j=new ke;j.setHSL(x,1,.6),h.push(j.r,j.g,j.b),h.push(j.r*.5,j.g*.5,j.b*.5)}t.setAttribute("position",new ye(s,3)),t.setAttribute("color",new ye(h,3));const u=new Be({vertexColors:!0,transparent:!0,opacity:.4,blending:ze}),m=new Ge(t,u);m.isGlitchLines=!0,c.add(m);const p=new Ee,E=new be(20,32,32),f=new Ce({color:0,transparent:!0,opacity:.95}),y=new q(E,f);p.add(y);const X=new qe(25,80,64),b=new Le({uniforms:{time:{value:0},innerRadius:{value:25},outerRadius:{value:80}},vertexShader:`
          varying vec2 vUv;
          varying float vRadius;
          void main() {
            vUv = uv;
            vec4 worldPosition = modelMatrix * vec4(position, 1.0);
            vRadius = length(worldPosition.xy);
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,fragmentShader:`
          uniform float time;
          uniform float innerRadius;
          uniform float outerRadius;
          varying vec2 vUv;
          varying float vRadius;
          
          void main() {
            float normalizedRadius = (vRadius - innerRadius) / (outerRadius - innerRadius);
            float angle = atan(vUv.y - 0.5, vUv.x - 0.5);
            
            // Swirling pattern
            float swirl = sin(angle * 5.0 - time * 2.0 + normalizedRadius * 10.0) * 0.5 + 0.5;
            float intensity = 1.0 - normalizedRadius;
            
            // Colors from hot (inner) to cold (outer)
            vec3 hotColor = vec3(1.0, 0.5, 0.0); // Orange
            vec3 coldColor = vec3(0.0, 0.3, 1.0); // Blue
            vec3 color = mix(coldColor, hotColor, intensity);
            
            // Add swirl variation
            color *= (0.7 + swirl * 0.3);
            
            // Fade out at edges
            float alpha = intensity * 0.8;
            
            gl_FragColor = vec4(color, alpha);
          }
        `,transparent:!0,blending:ze,side:Te}),I=new q(X,b);I.rotation.x=Math.PI/2,I.isAccretionDisk=!0,p.add(I);for(let n=0;n<8;n++){const S=30+n*20,N=new mt(S,1+n*.5,8,64),U=new Ce({color:new ke().setHSL((.7+n*.05)%1,1,.5),transparent:!0,opacity:.3-n*.03,wireframe:!0}),R=new q(N,U);R.rotation.x=l.uniform(0,Math.PI),R.rotation.y=l.uniform(0,Math.PI),R.isDistortionRing=!0,R.rotationSpeed=l.uniform(.001,.005)*(n%2===0?1:-1),p.add(R)}c.add(p);const M=new Ve(5,100,8),z=new Pe({color:16711935,transparent:!0,opacity:.6,emissive:16711935,emissiveIntensity:1,blending:ze}),de=new q(M,z);de.position.y=50,c.add(de);const te=new q(M,z);te.position.y=-50,te.rotation.z=Math.PI,c.add(te)}if(i!=="Singularity Void"){const o=[],r=new Y(C+999);for(let u=0;u<F;u++){const m=r.uniform(-50,50),p=r.uniform(-20,20),E=r.uniform(-50,50);o.push({x:m,y:p,z:E})}const d=[],L=[],ue=[],ee=[],ce=[],a=.4,t=a*25;for(let u=0;u<Q.length;u+=3){const m=Q[u],p=Q[u+1],E=Q[u+2];let f=1/0,y=null;for(const X of o){const b=Math.sqrt(Math.pow(m-X.x,2)+Math.pow(p-X.y,2)+Math.pow(E-X.z,2));b<f&&(f=b,y=X)}if(!(f<a))if(f<t&&y){const X=1-(f-a)/(t-a);y.x-m,y.y-p,y.z-E;const b=Math.atan2(E-y.z,m-y.x),I=X*.8,M=8;for(let R=0;R<M-1;R++){const xe=R/(M-1),pe=(R+1)/(M-1),x=f*(1-xe*I*.7),j=b+xe*I*1.5,ie=y.x+x*Math.cos(j),me=p+(y.y-p)*xe*.3,ge=y.z+x*Math.sin(j),Se=f*(1-pe*I*.7),je=b+pe*I*1.5,Ne=y.x+Se*Math.cos(je),we=p+(y.y-p)*pe*.3,De=y.z+Se*Math.sin(je);ee.push(ie,me,ge),ee.push(Ne,we,De)}const z=X*1.5,de=_[u],te=_[u+1],n=_[u+2],S=Math.min(de+z,2),N=Math.max(te*(1-z*.6),.1),U=Math.max(n*(1-z*.8),.1);for(let R=0;R<M-1;R++){const xe=R/(M-1),pe=(R+1)/(M-1),x=1-xe*X*.6,j=1-pe*X*.6,ie=z*(.5+xe*.5),me=z*(.5+pe*.5);ce.push(Math.min(S+ie*.3,2)*x,Math.max(N*(1-ie*.2),.1)*x,Math.max(U*(1-ie*.4),.1)*x),ce.push(Math.min(S+me*.3,2)*j,Math.max(N*(1-me*.2),.1)*j,Math.max(U*(1-me*.4),.1)*j)}d.push(m,p,E),L.push(S,N,U),ue.push(Math.max(ne[u/3]*(1-X*.5),.3))}else d.push(m,p,E),L.push(_[u],_[u+1],_[u+2]),ue.push(ne[u/3])}oe.setAttribute("position",new ye(d,3)),oe.setAttribute("color",new ye(L,3)),oe.setAttribute("size",new ye(ue,1));const s=new Le({uniforms:{},vertexShader:`
          attribute float size;
          varying vec3 vColor;
          void main() {
            vColor = color;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (400.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
          }
        `,fragmentShader:`
          varying vec3 vColor;
          void main() {
            vec2 center = gl_PointCoord - vec2(0.5);
            float distanceFromCenter = length(center);
            
            if (distanceFromCenter > 0.5) {
              discard;
            }
            
            float alpha = 1.0 - (distanceFromCenter / 0.5);
            alpha = pow(alpha, 2.0);
            
            gl_FragColor = vec4(vColor, alpha * 0.8);
          }
        `,transparent:!0,blending:ze,vertexColors:!0,depthWrite:!1}),h=new $e(oe,s);if(c.add(h),ee.length>0){const u=new Ie;u.setAttribute("position",new ye(ee,3)),u.setAttribute("color",new ye(ce,3));const m=new Be({vertexColors:!0,transparent:!0,opacity:.8,linewidth:2,blending:ze}),p=new Ge(u,m);c.add(p)}}else{oe.setAttribute("position",new ye(Q,3)),oe.setAttribute("color",new ye(_,3)),oe.setAttribute("size",new ye(ne,1));const o=new ht({size:2,vertexColors:!0,transparent:!0,opacity:.8,blending:ze,sizeAttenuation:!0}),r=new $e(oe,o);c.add(r)}const k=new Y(C+999);for(let o=0;o<F;o++){const r=new Ee,d=k.uniform(-50,50),L=k.uniform(-20,20),ue=k.uniform(-50,50),ee=new be(1.5,16,16),ce=new Ce({color:0,transparent:!0,opacity:.9}),a=new q(ee,ce);r.add(a),[{innerRadius:2,outerRadius:2.3,color:16777215,opacity:.8,emissive:16777164},{innerRadius:2.3,outerRadius:2.7,color:16755200,opacity:.7,emissive:16746496},{innerRadius:2.7,outerRadius:3.2,color:16729088,opacity:.6,emissive:16720384},{innerRadius:3.2,outerRadius:4,color:11141120,opacity:.5,emissive:6684672},{innerRadius:4,outerRadius:5,color:4456448,opacity:.3,emissive:2228224}].forEach((s,h)=>{const u=new qe(s.innerRadius,s.outerRadius,32),m=new Pe({color:s.color,transparent:!0,opacity:s.opacity,emissive:s.emissive,emissiveIntensity:.3,side:Te}),p=new q(u,m);p.rotation.x=Math.PI/2,p.rotation.z=l.uniform(0,Math.PI*2),p.isAccretionRing=!0,p.rotationSpeed=.002+h*5e-4,r.add(p)}),r.position.set(d,L,ue),c.add(r)}for(let o=0;o<W;o++){const r=new be(1.5,8,8),d=new Pe({color:16776960,emissive:16776960,emissiveIntensity:1}),L=new q(r,d);L.position.set(l.uniform(-w,w),l.uniform(-w/4,w/4),l.uniform(-w,w)),L.isPulsar=!0,L.pulseSpeed=l.uniform(1,3),c.add(L)}for(let o=0;o<P;o++){const r=new Ee,d=new be(2,16,16),L=new Pe({color:16777215,emissive:16777215,emissiveIntensity:2}),ue=new q(d,L);r.add(ue);const ee=new Ve(1,20,8),ce=new Pe({color:16711680,transparent:!0,opacity:.6,emissive:16711680,emissiveIntensity:.5}),a=new q(ee,ce);a.position.y=10,r.add(a);const t=new q(ee,ce);t.position.y=-10,t.rotation.z=Math.PI,r.add(t),r.position.set(l.uniform(-w,w),l.uniform(-w/4,w/4),l.uniform(-w,w)),c.add(r)}const Re=new Ue(4210752,.5);re.add(Re);const Me=new pt(16777215,.5,1e3);Me.position.set(0,100,0),re.add(Me);const se=o=>{o.key==="Escape"&&document.dispatchEvent(new CustomEvent("galaxy-close-fullscreen"))};document.addEventListener("keydown",se);const G=()=>{O.current=requestAnimationFrame(G);const o=performance.now()/1e3;$.current&&($.current.rotation.y+=.001),c.children.forEach(r=>{if(r.isPulsar){const d=r.pulseSpeed||1;r.scale.setScalar(1+Math.sin(Date.now()*.001*d)*.3)}if(r.isSingularityShader&&r instanceof q){const d=r.material;d.uniforms&&d.uniforms.time&&(d.uniforms.time.value=o);const L=r.shaderSpeed||1;r.rotation.y+=.001*L,r.rotation.x+=5e-4*L}if(r.isAccretionDisk&&r instanceof q){const d=r.material;d.uniforms&&d.uniforms.time&&(d.uniforms.time.value=o),r.rotation.z+=.002}if(r.isDistortionRing){const d=r.rotationSpeed||.001;r.rotation.x+=d,r.rotation.y+=d*.7,r.scale.setScalar(1+Math.sin(o*2)*.1)}if(r.isGlitchLines&&r instanceof Ge){const d=r.material;d.opacity=.2+Math.sin(o*3)*.2,r.rotation.z+=5e-4}r instanceof Ee&&r.children.forEach(d=>{if(d.isAccretionDisk&&d instanceof q){const L=d.material;L.uniforms&&L.uniforms.time&&(L.uniforms.time.value=o),d.rotation.z+=.002}if(d.isAccretionRing&&d instanceof q){const L=d.rotationSpeed||.002;d.rotation.z+=L}if(d.isDistortionRing){const L=d.rotationSpeed||.001;d.rotation.x+=L,d.rotation.y+=L*.7,d.scale.setScalar(1+Math.sin(o*2)*.1)}})}),V.current&&V.current.update(),J.render(re,v)};G();const fe=()=>{if(!A.current||!J)return;const o=A.current,r=o.clientWidth,d=o.clientHeight;J.setSize(r,d),v.aspect=r/d,v.updateProjectionMatrix()};return window.addEventListener("resize",fe),()=>{window.removeEventListener("resize",fe),document.removeEventListener("keydown",se),V.current&&V.current.dispose(),O.current&&cancelAnimationFrame(O.current),Z&&J.domElement&&Z.removeChild(J.domElement),J.dispose()}},[i,D,F,W,P,C]),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{ref:A,className:"w-full h-full"}),H&&e.jsx("div",{className:"absolute bottom-0 left-0 p-2 text-white bg-black bg-opacity-50 max-w-xs rounded-tr-lg",children:e.jsx("h3",{className:"text-xs font-bold",children:H})})]})},_t=({galaxyUrl:i,galaxyType:D="Spiral",numSystems:F=1e4,blackHoles:W=5,pulsars:P=10,quasars:C=3,galaxyName:H})=>{const[A,ve]=g.useState("Aligning Stargate..."),[ae,O]=g.useState(!1),[V,$]=g.useState(!1),[Y,Z]=g.useState(!1),[K,T]=g.useState(!1);g.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){ve("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),O(!0);const J=(oe,Q)=>Array.from({length:Q},()=>oe[Math.floor(Math.random()*oe.length)]).join(""),he=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:35},{chars:"0123456789ABCDEF",duration:20,iterations:50},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:'\",.<>?/`~",duration:15,iterations:100}];let c=0,l=0;const le=()=>{if(c>=he.length){const Q="Stargate system aligned";let _=0;ve("");const ne=()=>{_<Q.length?(ve(Q.substring(0,_+1)),_++,setTimeout(ne,30)):O(!1)};ne();return}const oe=he[c];ve(J(oe.chars,32)),l++,l>=oe.iterations&&(c++,l=0),setTimeout(le,oe.duration)};le()},[]),g.useEffect(()=>{const v=document.createElement("style");return v.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(v),()=>{document.head.removeChild(v)}},[]);const re=()=>{Z(!0),setTimeout(()=>{$(!1),Z(!1)},300)};return g.useEffect(()=>(document.addEventListener("galaxy-close-fullscreen",re),()=>{document.removeEventListener("galaxy-close-fullscreen",re)}),[]),g.useEffect(()=>{if(K){const v=setTimeout(()=>T(!1),50);return()=>clearTimeout(v)}},[K]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Galaxy Visualization"})}),e.jsx("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:e.jsx(Dt,{galaxyType:D,numSystems:F,blackHoles:W,pulsars:P,quasars:C,galaxyName:H,onExpandClick:()=>{$(!0),T(!0)}})}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:i,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${ae?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),A]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]}),V&&nt.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${Y||K?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${Y||K?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:"Galaxy View"})}),e.jsx("div",{className:"hidden sm:block",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Galaxy Visualization"}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Type: ",D," • Systems: ",F.toLocaleString()]})]})}),e.jsx("button",{onClick:re,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(At,{galaxyType:D,numSystems:F,blackHoles:W,pulsars:P,quasars:C,galaxyName:H})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},Ft=({systems:i,coordinates:D})=>{const[F,W]=g.useState(new Map);return g.useEffect(()=>{(()=>{try{const C=new Map;i.forEach(H=>{const A=Mt(D,H.index,H.num_planets||1);C.set(H.index,A)}),W(C)}catch{}})()},[D,i]),e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:i.map(P=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[(()=>{const C=F.get(P.index)||"none";return C==="complete"?e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}):C==="partial"?e.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500/20 border border-yellow-500/50 text-yellow-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"PARTIAL"}):null})(),e.jsxs("button",{onClick:()=>window.location.href=`/system/${P.index}`,className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["#",P.number]}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:P.name})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},P.index))}),i.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No systems found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This galaxy appears to be empty"})]})]})},Tt=({currentGalaxy:i})=>{const[D,F]=g.useState(!1),[W,P]=g.useState(!1),[C,H]=g.useState(!0),A=1e7;g.useEffect(()=>{const[$,Y,Z]=i.coordinates,K=!($===0&&Y===0&&Z===0),T=!($===A&&Y===A&&Z===A);F(K),P(T),H(!1)},[i.coordinates]);const ve=()=>{const[$,Y,Z]=i.coordinates;return Z>0?[$,Y,Z-1]:Y>0?[$,Y-1,A]:$>0?[$-1,A,A]:[0,0,0]},ae=()=>{const[$,Y,Z]=i.coordinates;return Z<A?[$,Y,Z+1]:Y<A?[$,Y+1,0]:$<A?[$+1,0,0]:[A,A,A]},O=()=>{if(D){if(!_e.canAffordTravel("galaxy",1)){_e.executeTravel("galaxy",1);return}if(!_e.executeTravel("galaxy",1))return;const[Y,Z,K]=ve(),T=document.createElement("form");T.method="POST",T.action="/navigate";const re=document.createElement("input");re.type="hidden",re.name="x",re.value=Y.toString();const v=document.createElement("input");v.type="hidden",v.name="y",v.value=Z.toString();const J=document.createElement("input");J.type="hidden",J.name="z",J.value=K.toString(),T.appendChild(re),T.appendChild(v),T.appendChild(J),document.body.appendChild(T),T.submit()}},V=()=>{if(W){if(!_e.canAffordTravel("galaxy",1)){_e.executeTravel("galaxy",1);return}if(!_e.executeTravel("galaxy",1))return;const[Y,Z,K]=ae(),T=document.createElement("form");T.method="POST",T.action="/navigate";const re=document.createElement("input");re.type="hidden",re.name="x",re.value=Y.toString();const v=document.createElement("input");v.type="hidden",v.name="y",v.value=Z.toString();const J=document.createElement("input");J.type="hidden",J.name="z",J.value=K.toString(),T.appendChild(re),T.appendChild(v),T.appendChild(J),document.body.appendChild(T),T.submit()}};return C?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:O,disabled:!D,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${D?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:V,disabled:!W,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${W?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},Bt=({page:i,prevPage:D,nextPage:F,finish:W})=>{const P="px-4 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105",C="bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg",H="bg-white/10 text-gray-300 hover:bg-white/20 hover:text-white border border-white/20";return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 sm:gap-4 flex-wrap",children:[i!==1&&e.jsxs("button",{onClick:()=>window.location.href="/galaxy/1",className:`${P} ${H}`,title:"First page",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),D&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${D}`,className:`${P} ${H}`,title:"Previous page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),(()=>{const A=[],ae=Math.max(1,i-2),O=Math.min(W,i+2);ae>1&&(A.push(e.jsx("button",{onClick:()=>window.location.href="/galaxy/1",className:`${P} ${H}`,children:"1"},1)),ae>2&&A.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"start-ellipsis")));for(let V=ae;V<=O;V++)V===i?A.push(e.jsx("span",{className:`${P} ${C} cursor-default`,children:V},V)):A.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${V}`,className:`${P} ${H} cursor-pointer`,children:V},V));return O<W&&(O<W-1&&A.push(e.jsx("span",{className:"px-2 text-gray-400",children:"..."},"end-ellipsis")),A.push(e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${W}`,className:`${P} ${H}`,children:W},W))),A})(),F&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${F}`,className:`${P} ${H}`,title:"Next page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),i!==W&&e.jsxs("button",{onClick:()=>window.location.href=`/galaxy/${W}`,className:`${P} ${H}`,title:"Last page",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]}),e.jsxs("div",{className:"text-center mt-4 text-sm text-gray-400",children:["Page ",i," of ",W]})]})},tt=({galaxy:i,systems:D,galaxy_url:F,version:W,page:P,prev_page:C,next_page:H,finish:A,image_url:ve})=>{const[ae]=g.useState(i.coordinates.join(","));g.useEffect(()=>{document.body.setAttribute("data-coordinates",ae),jt(ae)},[ae]);const O=V=>V.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(St,{}),e.jsxs("div",{className:"relative z-10 pt-1",children:[e.jsx(Nt,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["Galaxy '",O(i.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Coordinates ",i.coordinates.join(", ")]})]}),e.jsx(Tt,{currentGalaxy:i}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(_t,{galaxyUrl:F,galaxyType:i.galaxy_type,numSystems:i.num_systems,blackHoles:i.black_holes,pulsars:i.pulsars,quasars:i.quasars,galaxyName:O(i.name)})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(It,{galaxy:i})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Systems in '",O(i.name),"'"]}),e.jsx(Ft,{systems:D,coordinates:ae})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href="/",className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsx("span",{className:"text-base sm:text-lg",children:"← Go Back to Planetary Index"})})}),e.jsx(Bt,{page:P,prevPage:C,nextPage:H,finish:A})]}),e.jsx(kt,{version:W})]}),e.jsx(Pt,{}),e.jsx(zt,{currentLocation:{type:"galaxy",name:i.name,coordinates:i.coordinates.join(",")}})]})};document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("atlas-react-root");if(!i)return;const D=F=>{const W=document.getElementById(F);if(!W||!W.textContent)return null;try{return JSON.parse(W.textContent.trim())}catch{return null}};try{const F=D("data-galaxy")||{},W=D("data-systems")||[],P=D("data-navigation")||{},C=D("data-common")||{},H={galaxy:{name:F.name||"Unknown Galaxy",coordinates:F.coordinates||[0,0,0],galaxy_type:F.galaxy_type||"Unknown",num_systems:F.num_systems||0,black_holes:F.black_holes||0,pulsars:F.pulsars||0,quasars:F.quasars||0},systems:W,galaxy_url:P.galaxy_url||"#",version:C.version||"1.0.0",page:P.page||1,prev_page:P.prev_page,next_page:P.next_page,finish:P.finish||1,image_url:C.image_url||""};Je.createRoot(i).render(Qe.createElement(tt,H))}catch{const W={galaxy:{name:"Unknown Galaxy",coordinates:[0,0,0],galaxy_type:"Unknown",num_systems:0,black_holes:0,pulsars:0,quasars:0},systems:[],galaxy_url:"#",version:"1.0.0",page:1,finish:1,image_url:""};Je.createRoot(i).render(Qe.createElement(tt,W))}});
