import{c as Ce,A as we,S as Le}from"./atlas_BJ-3dIBoTMvLRTvbW4jvB.js";import{c as Me,R as $e}from"./atlas_xRQAuIdLDLUWwjQ1hhLJT.js";import{c as ie,A as ke,a as _,b as Z,d as Ae,e as We}from"./atlas_DlxiDl5H4dCc4RtFDNV4-.js";import{c as u,L as R,a as Ge}from"./atlas_Ccem9BSdBGELhfnElOo6_.js";import{c as ae}from"./atlas_Dod4TvMiKE71aV5xLhCIO.js";import{c as oe,T as ze,a as Oe,b as Ve,d as qe}from"./atlas_Bce-1eIeRLx7SAlY51ZC8.js";import{c as ne,T as Ne}from"./atlas_CSSFvmzyNKG7QNx1A5fy7.js";import{c as D,R as Be}from"./atlas_DLWyiQr-j-hUe0BblWQax.js";import{P as He,c as Ue}from"./atlas_Bu5UDKz6Fxm2j5znUfuqR.js";import{g as C,c as je,P as Ye}from"./atlas_BoQX836U_P5ievxCWB0fm.js";import{P as Ke}from"./atlas_C3eT5YO8N8uINAkU4sfC8.js";import{c as fe}from"./atlas_D3JuxdFXN9TN3Y0vT6vrH.js";import{c as de}from"./atlas_BkU-BZFNU0Kk3GbuSxcOt.js";import{c as le}from"./atlas_BWX0SzH4ZKildB05q9kmO.js";import{c as Je}from"./atlas_0q73re8OGTbBFm-cq7mIP.js";import{c as Qe}from"./atlas_BSgVuGGMitm85ML_uFlwR.js";import{c as Xe}from"./atlas_BmPjqYkKBdIjG0mMXhEJD.js";import{c as Ze}from"./atlas_D3GNhDOca9tM2xz4UF0kl.js";import{c as ee,T as Re}from"./atlas_CEoXpB5Qz5gnhpnI1rVml.js";import{E as De,c as me}from"./atlas_Bm5CmJ6Y3wiNPdy4xBPs9.js";import{c as _e,E as es}from"./atlas_ClhQ4eskJsGKIwiNnH7TI.js";import{c as pe,C as ss}from"./atlas_CUq1rz_tq3RwyJKJXdtJS.js";import{c as ts,V as rs}from"./atlas_D343D3gC5Bhf8E3SyGD-Q.js";import{c as cs,M as is}from"./atlas_Dj0t6QoI2gZodGI_3YUXn.js";import{c as as,M as os}from"./atlas_BEAtmhQR2pKLss0iVjM9O.js";import{c as he,A as ns}from"./atlas_CYsk2fyQCI6aUldiF2q00.js";import{c as fs,S as ds}from"./atlas_OQLtGineOrjae7tCq3Z1z.js";import{P as se}from"./atlas_Bw0fu8vSuhWaeAZKJqlzI.js";import{F as ue}from"./atlas_465Qga5-jgR2SaZeKrI3B.js";import{c as ls,O as ms}from"./atlas_D8F237FmEt-gxC2GKz619.js";import{c as ge,F as _s}from"./atlas_CMogpnnx9irO0RjvZ_Elu.js";import{c as ye,A as ps}from"./atlas_DFoW4HgmlLMTSp87OppFy.js";import{c as Ee,O as hs}from"./atlas_CeFCrUiRjVtyJj2C26XU3.js";import{c as Se,L as us}from"./atlas_CnFeX1UquwFONPWwyH0Y0.js";import{c as gs,L as ys}from"./atlas_DrzNaGnbXhyGGPqXgh5dg.js";import{c as be,M as Es}from"./atlas_DjKkgDbOS3WgacErnTNEP.js";import{c as Ss,F as bs}from"./atlas_CwxbYudOIvRzf9WYQJAGh.js";import{c as Is,C as xs}from"./atlas_D_AoWN1edZOb1F97i-xfg.js";import{c as Ps,R as Ts}from"./atlas_BNEH8HDGdmhsX1S5s8FdV.js";import{c as Ie}from"./atlas_BShgu7srGlsrNBeL27QMh.js";import{c as vs,V as Fs}from"./atlas_ZjaJ_43RPC4E1k8nfj4yf.js";import{j as xe,C as te}from"./atlas_CqUMNY_RyRklhCsbOI68T.js";const Cs=!1;class I{static instance;creators=new Map;effects=new Map;nextId=1;layerSystem;constructor(){this.registerDefaultEffects()}static getInstance(){return I.instance||(I.instance=new I),I.instance}registerDefaultEffects(){this.registerEffect("atmosphere_glow",{create:(e,t)=>new ke(t,e),fromPythonData:(e,t)=>ie(t,e.atmosphere||{})}),this.registerEffect("atmosphere_clouds",{create:(e,t)=>new Z(t,e),fromPythonData:(e,t)=>_(t,e.surface_elements||{},void 0,e.timing?.cosmic_origin_time)}),this.registerEffect("atmospheric_streaks",{create:(e,t)=>new ns(t,e),fromPythonData:(e,t)=>he(t,e.atmosphere||{})}),this.registerEffect("atmosphere",{create:(e,t)=>new We(t,e),fromPythonData:(e,t)=>Ae(t,e)}),this.registerEffect("ring_system",{create:(e,t)=>new $e(t,e),fromPythonData:(e,t)=>Me(e.rings||{},t)}),this.registerEffect("fragmentation",{create:(e,t)=>new ue(t,e),fromPythonData:(e,t)=>new ue(t,{color:e.surface?.fragment_color||[.3,.3,.3],fragmentCount:e.surface?.fragment_count||20})}),this.registerEffect("land_masses",{create:(e,t)=>new R(t,e),fromPythonData:(e,t)=>u(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("ocean_waves",{create:(e,t)=>new ms(e),fromPythonData:(e,t)=>ls(e)}),this.registerEffect("aquifer_water",{create:(e,t,i)=>new ps(i,e),fromPythonData:(e,t,i)=>ye(i,e)}),this.registerEffect("ocean_currents",{create:(e,t,i)=>new hs(i,e),fromPythonData:(e,t,i)=>Ee(i,e)}),this.registerEffect("fluid_layers",{create:(e,t)=>new _s(t,e),fromPythonData:(e,t)=>ge(t,e)}),this.registerEffect("lava_flows",{create:(e,t)=>new us(t,e),fromPythonData:(e,t)=>Se(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("lava_rivers",{create:(e,t,i)=>new ys(t,e),fromPythonData:(e,t,i)=>gs(e,t)}),this.registerEffect("molten_lava",{create:(e,t,i)=>new Es(i,e),fromPythonData:(e,t,i)=>be(i,e,e.seeds?.planet_seed)}),this.registerEffect("fire_eruption",{create:(e,t)=>new bs(t,e),fromPythonData:(e,t,i)=>Ss(e,t)}),this.registerEffect("carbon_trails",{create:(e,t)=>new xs(t,e),fromPythonData:(e,t,i)=>Is(e,t)}),this.registerEffect("radiation_rings",{create:(e,t)=>new Ts(t,e),fromPythonData:(e,t)=>Ps(t,e,e.seeds?.planet_seed)}),this.registerEffect("crystal_formations",{create:(e,t)=>(console.warn("Crystal formations effect not implemented yet"),null)}),this.registerEffect("star_field",{create:(e,t)=>new ds(t,e),fromPythonData:(e,t)=>fs(t,e.seeds?.planet_seed||e.planet_seed)}),this.registerEffect("tundra_snowflakes",{create:(e,t)=>new ze(t,e),fromPythonData:(e,t)=>oe(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("toxic_post_processing",{create:(e,t)=>null,fromPythonData:(e,t)=>null}),this.registerEffect("toxic_waste_render",{create:(e,t)=>new Ne(t,e),fromPythonData:(e,t)=>ne(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("river_lines",{create:(e,t)=>new Be(t,e),fromPythonData:(e,t)=>D(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("anomaly_phase_matter",{create:(e,t)=>new we(t,e),fromPythonData:(e,t)=>Ce(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("pulsating_cube",{create:(e,t)=>new He(t,e),fromPythonData:(e,t)=>{const i=C(e);return Ue(t,e.surface_elements||{},e.seeds?.planet_seed,i,e)}}),this.registerEffect("planet_rays",{create:(e,t)=>new Ye(t,e),fromPythonData:(e,t)=>je(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("visual_debug_3d",{create:(e,t)=>new Fs(t,e),fromPythonData:(e,t)=>vs(e,t)}),this.registerEffect("terrain_cracks",{create:(e,t)=>new Re({...e,radius:t}),fromPythonData:(e,t)=>ee(e,t,e.seeds?.shape_seed||e.seeds?.planet_seed)}),this.registerEffect("exotic_geometric_shapes",{create:(e,t)=>new De(t,e),fromPythonData:(e,t)=>{const i=C(e);return me(t,e.surface_elements||{},e.seeds?.planet_seed,i)}}),this.registerEffect("exotic_doodles",{create:(e,t)=>new es(t,e),fromPythonData:(e,t)=>_e(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("cave_surface_holes",{create:(e,t,i)=>new ss(t,e),fromPythonData:(e,t,i)=>pe(t,e,e.seeds?.planet_seed)}),this.registerEffect("vegetation",{create:(e,t,i)=>new rs(t,e),fromPythonData:(e,t,i)=>ts(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time)}),this.registerEffect("magma_flows",{create:(e,t,i)=>new is(t,e),fromPythonData:(e,t,i)=>cs(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time)}),this.registerEffect("magma_eruptions",{create:(e,t,i)=>new os(t,e),fromPythonData:(e,t,i)=>as(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time)})}registerEffect(e,t){this.creators.set(e,t)}createEffect(e,t,i,o,h=0){const a=this.creators.get(e);if(!a)return console.warn(`Effect type '${e}' not registered`),null;try{const l=a.create(t,i,this.layerSystem);if(!l)return null;const g={id:`effect_${this.nextId++}`,type:e,effect:l,priority:h,enabled:!0};return this.effects.set(g.id,g),g}catch(l){return console.error(`Error creating effect '${e}':`,l),null}}createEffectFromPythonData(e,t,i,o,h=0){const a=this.creators.get(e);if(!a||!a.fromPythonData)return this.createEffect(e,t,i,o,h);try{const l=a.fromPythonData(t,i,this.layerSystem);if(!l)return null;const g={id:`effect_${this.nextId++}`,type:e,effect:l,priority:h,enabled:!0};return this.effects.set(g.id,g),g}catch(l){return console.error(`Error creating effect '${e}' from Python data:`,l),null}}createEffectsFromList(e,t,i){const o=[],h=e.sort((a,l)=>(a.priority||0)-(l.priority||0));for(const a of h){const l=this.createEffect(a.type,a.params,t,i,a.priority);l&&(l.enabled=a.enabled!==!1,o.push(l))}return o}createEffectsFromPythonPlanetData(e,t,i,o,h){const a=[];try{const l=C(e);if(h?this.layerSystem=h:this.layerSystem=new Ke(i,l),e.surface_elements){const r=e.surface_elements;if(r.effects_3d&&Array.isArray(r.effects_3d))for(const p of r.effects_3d){if(p.type==="atmospheric_streaks"){const S=he(t,p.params,e.seeds?.shape_seed+3e3),b={id:`effect_${this.nextId++}`,type:"atmospheric_streaks",effect:S,priority:p.priority||0,enabled:!0,name:"Atmospheric Streaks"};this.effects.set(b.id,b),a.push(b),S.addToScene(o,i.position);continue}const y=this.createEffect(p.type,p.params,t,i,p.priority||0);y?(y.name=p.type.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()),a.push(y),y.effect.apply&&y.effect.apply(i),y.effect.addToScene&&y.effect.addToScene(o,i.position)):console.error("❌ FALLO AL CREAR EFECTO:",p.type)}switch(r.type.toLowerCase()){case"gas_giant":if(this.layerSystem){const s=fe(this.layerSystem,{...r,base_color:l,turbulence:e.turbulence||r.turbulence},e.seeds?.shape_seed||e.seeds?.planet_seed||e.seeds?.planet_seed),c=de(this.layerSystem,{...r,base_color:l,storm_intensity:e.storm_intensity||r.storm_intensity},(e.seeds?.shape_seed||e.seeds?.planet_seed)+1e3),n={id:`effect_${this.nextId++}`,type:"cloud_bands_layer",effect:s,priority:0,enabled:!0};this.effects.set(n.id,n),a.push(n);const d={id:`effect_${this.nextId++}`,type:"cloud_gyros_layer",effect:c,priority:1,enabled:!0};if(this.effects.set(d.id,d),a.push(d),r.polar_hexagon&&r.polar_hexagon.enabled){const f=e.timing?.elapsed_time?e.timing.elapsed_time/31557600:0,m=new se({planetColor:l,hexagonData:r.polar_hexagon,planetRadius:t,currentTime:f}),E={id:`effect_${this.nextId++}`,type:"polar_hexagon",effect:m,priority:10,enabled:!0};this.effects.set(E.id,E),a.push(E),o&&m.addToScene(o)}}else console.error("❌ PlanetLayerSystem not initialized!");break;case"frozen_gas_giant":if(this.layerSystem){const s=fe(this.layerSystem,{...r,base_color:l,turbulence:e.turbulence||r.turbulence,icy_tint:!0},e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"cloud_bands_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),a.push(c),r.polar_hexagon&&r.polar_hexagon.enabled){const n=e.timing?.elapsed_time?e.timing.elapsed_time/31557600:0,d=new se({planetColor:l,hexagonData:r.polar_hexagon,planetRadius:t,currentTime:n}),f={id:`effect_${this.nextId++}`,type:"polar_hexagon",effect:d,priority:10,enabled:!0};this.effects.set(f.id,f),a.push(f),o&&d.addToScene(o)}}break;case"aquifer":const p=ye(this.layerSystem,e);if(p){const s={id:`effect_${this.nextId++}`,type:"aquifer_water",effect:p,priority:2,enabled:!0,name:"Aquifer Water Surface"};this.effects.set(s.id,s),a.push(s)}const y=Ee(this.layerSystem,e);if(y){const s={id:`effect_${this.nextId++}`,type:"ocean_currents",effect:y,priority:1,enabled:!0,name:"Ocean Currents"};this.effects.set(s.id,s),a.push(s)}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}if(r.land_masses&&r.land_masses.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:3,enabled:!0,name:"Emergent Land Masses"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.atmosphere_clouds&&r.atmosphere_clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+8e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:4,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}break;case"nebulous":if(this.layerSystem){const s=de(this.layerSystem,{...r,base_color:l,storm_intensity:r.nebula_density||.6,color_variance:r.color_variance||.2},(e.seeds?.shape_seed||e.seeds?.planet_seed)+2e3),c={id:`effect_${this.nextId++}`,type:"cloud_gyros_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),a.push(c),r.polar_hexagon&&r.polar_hexagon.enabled){const n=e.timing?.elapsed_time?e.timing.elapsed_time/31557600:0,d=new se({planetColor:l,hexagonData:r.polar_hexagon,planetRadius:t,currentTime:n}),f={id:`effect_${this.nextId++}`,type:"polar_hexagon",effect:d,priority:10,enabled:!0};this.effects.set(f.id,f),a.push(f),o&&d.addToScene(o)}}break;case"metallic":case"metallic_3d":if(this.layerSystem){const s=Xe(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"metallic_surface_layer",effect:s,priority:0,enabled:!0};this.effects.set(c.id,c),a.push(c)}break;case"diamond":if(this.layerSystem){const s=Ze(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"diamond_surface_layer",effect:s,priority:0,enabled:!0};this.effects.set(c.id,c),a.push(c);const n=ee(e,t,e.seeds?.shape_seed||e.seeds?.planet_seed),d={id:`effect_${this.nextId++}`,type:"terrain_cracks",effect:n,priority:1,enabled:!0};if(this.effects.set(d.id,d),a.push(d),n.addToScene(o,i.position),r.clouds&&r.clouds.length>0){const f=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),m={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:f,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(m.id,m),a.push(m),f.addToScene(o,i.position)}}break;case"rocky":if(this.layerSystem){const s=le(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"ROCKY"),c={id:`effect_${this.nextId++}`,type:"rocky_terrain_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),a.push(c),r.clouds&&r.clouds.length>0){const n=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),d={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:n,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(d.id,d),a.push(d),n.addToScene(o,i.position)}}break;case"icy":if(this.layerSystem){const s=Qe(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"icy_terrain_layer",effect:s,priority:0,enabled:!0};this.effects.set(c.id,c),a.push(c);const n=Ge(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+8e3);if(n){const f={id:`effect_${this.nextId++}`,type:"transparent_land_masses",effect:n,priority:1,enabled:!0,name:"Ice Formations"};this.effects.set(f.id,f),a.push(f),n.addToScene(o,i.position)}else console.warn("❄️ Failed to create transparent LandMasses for Icy planet");if(r.clouds&&r.clouds.length>0){const f=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),m={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:f,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(m.id,m),a.push(m),f.addToScene(o,i.position)}const d=ae(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+9e3);if(d){const f={id:`effect_${this.nextId++}`,type:"icy_features",effect:d,priority:2,enabled:!0,name:"Ice Crystals & Features"};this.effects.set(f.id,f),a.push(f),d.addToScene(o,i.position)}}break;case"oceanic":const S=ge(t,e);if(S){const s={id:`effect_${this.nextId++}`,type:"fluid_layers",effect:S,priority:3,enabled:!0,name:"Fluid Ocean Layers"};this.effects.set(s.id,s),a.push(s),S.addToScene(o,i.position)}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Land Masses (Islands)"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}break;case"tundra":if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Tundra Terrain"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}const b=ae(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+9e3);if(b){const s={id:`effect_${this.nextId++}`,type:"icy_features",effect:b,priority:6,enabled:!0,name:"Snow Patches & Ice"};this.effects.set(s.id,s),a.push(s),b.addToScene(o,i.position)}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}const L=oe(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+15e3);if(L){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:L,priority:20,enabled:!0,name:"Snowflakes"};this.effects.set(s.id,s),a.push(s),L.addToScene(o,i.position)}break;case"arid":let x;if(r.clouds&&r.clouds.length>0?x=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time):x=new Z(t,{color:new te(.9,.8,.7),cloudCount:20,size:4.2,opacity:.7,density:1.2,seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,rotationSpeed:.004,movementAmplitude:.012,puffiness:1.3,timeSpeed:1}),x){const s={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:x,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(s.id,s),a.push(s),x.addToScene(o,i.position)}let P;if(r.green_patches&&r.green_patches.length>0){const s={...r,green_patches:r.green_patches.map(c=>({...c,color:[.5,0,0,c.color?.[3]||1]}))};P=u(t,s,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3)}else P=new R(t,{seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3,greenPatches:Array.from({length:25},(s,c)=>{const n=(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3+c*100,d=Math.sin(n)*.5+.5,f=Math.acos(1-2*(c+d)/25),m=2*Math.PI*(c*2.399%1);let E;return c<8?E=.25+d*.25:c<16?E=.15+d*.15:E=.08+d*.12,{position_3d:[Math.sin(f)*Math.cos(m),Math.sin(f)*Math.sin(m),Math.cos(f)],size:E,sides:12+Math.floor(d*16),color:[.5,0,0,.7+d*.2]}})});if(P){const s={id:`effect_${this.nextId++}`,type:"land_masses",effect:P,priority:5,enabled:!0,name:"Arid Terrain"};this.effects.set(s.id,s),a.push(s),P.addToScene(o,i.position)}const M=D(t,r,e.seeds?.shape_seed||e.seeds?.planet_seed);if(M){const s={id:`effect_${this.nextId++}`,type:"river_lines",effect:M,priority:6,enabled:!0,name:"Dried River Channels"};this.effects.set(s.id,s),a.push(s),M.addToScene(o,i.position)}break;case"savannah":if(this.layerSystem){const s=Je(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"SAVANNAH"),c={id:`effect_${this.nextId++}`,type:"savannah_terrain_layer",effect:s,priority:2,enabled:!0,name:"Savannah Terrain Layer"};this.effects.set(c.id,c),a.push(c)}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Savannah Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Savannah Terrain"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}break;case"desert":if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Desert Dust Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Desert Oases"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}const $=Ie(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3,"desert");if($){const s={id:`effect_${this.nextId++}`,type:"super_earth_water_features",effect:$,priority:6,enabled:!0,name:"Desert Rare Water Mass"};this.effects.set(s.id,s),a.push(s),$.addToScene(o,i.position)}const k=qe(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+15e3);if(k){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:k,priority:20,enabled:!0,name:"Desert Sandstorms"};this.effects.set(s.id,s),a.push(s),k.addToScene(o,i.position)}break;case"molten_core":case"molten core":const re=be(this.layerSystem,e);if(re){const s={id:`effect_${this.nextId++}`,type:"molten_lava",effect:re,priority:2,enabled:!0,name:"Molten Lava Surface"};this.effects.set(s.id,s),a.push(s)}const A=Se(t,r,(e.seeds?.planet_seed||e.seeds?.shape_seed)+9e3);if(A){const s={id:`effect_${this.nextId++}`,type:"lava_flows",effect:A,priority:4,enabled:!0,name:"Lava Flows & Fire Whips"};this.effects.set(s.id,s),a.push(s),A.addToScene(o,i.position)}const W=this.createEffectFromPythonData("fire_eruption",e,t,i)?.effect;if(W){const s={id:`effect_${this.nextId++}`,type:"fire_eruption",effect:W,priority:15,enabled:!0,name:"Fire Eruptions"};this.effects.set(s.id,s),a.push(s),W.addToScene(o,i.position)}if(r.green_patches&&r.green_patches.length>0){const s={...r,green_patches:r.green_patches.map(n=>({...n,color:[1,.55,0,n.color?.[3]||.9]}))},c=u(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+1e4);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:3,enabled:!0,name:"Incandescent Land Masses"};this.effects.set(n.id,n),a.push(n),c.addToScene(o,i.position)}}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.planet_seed||e.seeds?.shape_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Molten Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}break;case"lava":const G=ee(e,t,e.seeds?.shape_seed||e.seeds?.planet_seed);if(G){const s={id:`effect_${this.nextId++}`,type:"terrain_cracks",effect:G,priority:1,enabled:!0,name:"Lava Terrain Cracks"};this.effects.set(s.id,s),a.push(s),G.addToScene(o,i.position)}const z=this.createEffectFromPythonData("lava_rivers",e,t,i)?.effect;if(z){const s={id:`effect_${this.nextId++}`,type:"lava_rivers",effect:z,priority:8,enabled:!0,name:"Lava Rivers"};this.effects.set(s.id,s),a.push(s),z.addToScene(o,i.position)}const O=this.createEffectFromPythonData("fire_eruption",e,t,i)?.effect;if(O){const s={id:`effect_${this.nextId++}`,type:"fire_eruption",effect:O,priority:12,enabled:!0,name:"Lava Planet Fire Eruptions"};this.effects.set(s.id,s),a.push(s),O.addToScene(o,i.position)}if(r.green_patches&&r.green_patches.length>0){const s={...r,green_patches:r.green_patches.map(n=>({...n,color:[.8,.3,0,n.color?.[3]||.7]}))},c=u(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+11e3);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:3,enabled:!0,name:"Lava Land Masses"};this.effects.set(n.id,n),a.push(n),c.addToScene(o,i.position)}}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:16,enabled:!0,name:"Volcanic Ash Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}break;case"exotic":if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Exotic Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}const V=me(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3,l);if(V){const s={id:`effect_${this.nextId++}`,type:"exotic_geometric_shapes",effect:V,priority:10,enabled:!0,name:"Exotic Geometric Shapes"};this.effects.set(s.id,s),a.push(s),V.addToScene(o,i.position)}const q=_e(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3,e);if(q){const s={id:`effect_${this.nextId++}`,type:"exotic_doodles",effect:q,priority:12,enabled:!0,name:"Exotic Doodles"};this.effects.set(s.id,s),a.push(s),q.addToScene(o,i.position)}break;case"cave":let T;if(r.atmosphere_clouds&&r.atmosphere_clouds.clouds&&r.atmosphere_clouds.clouds.length>0?T=_(t,r.atmosphere_clouds,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time):T=new Z(t,{color:new te(.75,.75,.75),cloudCount:12,size:3.5,opacity:.65,density:.8,seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,rotationSpeed:.003,movementAmplitude:.008,puffiness:1.1,timeSpeed:.8}),T){const s={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:T,priority:15,enabled:!0,name:"Cave Atmospheric Clouds"};this.effects.set(s.id,s),a.push(s),T.addToScene(o,i.position)}let v;if(r.green_patches&&r.green_patches.length>0)v=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3);else{const s=new Le((e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3),c=[];for(let n=0;n<10;n++){const d=s.random()*2*Math.PI,f=Math.acos(s.random()*2-1);let m;n<3?m=.2+s.random()*.2:n<7?m=.12+s.random()*.13:m=.08+s.random()*.07,c.push({position_3d:[Math.sin(f)*Math.cos(d),Math.sin(f)*Math.sin(d),Math.cos(f)],size:m,sides:12+Math.floor(s.random()*8),color:[.29,.25,.21,.75+s.random()*.15]})}v=new R(t,{greenPatches:c,seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3})}if(v){const s={id:`effect_${this.nextId++}`,type:"land_masses",effect:v,priority:5,enabled:!0,name:"Cave Land Masses"};this.effects.set(s.id,s),a.push(s),v.addToScene(o,i.position)}if(this.layerSystem){const s=le(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"CAVE"),c={id:`effect_${this.nextId++}`,type:"rocky_terrain_layer",effect:s,priority:1,enabled:!0,name:"Cave Rocky Terrain"};this.effects.set(c.id,c),a.push(c)}const w=pe(t,e,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(w){const s={id:`effect_${this.nextId++}`,type:"cave_surface_holes",effect:w,priority:10,enabled:!0,name:"Cave Surface Holes"};if(this.effects.set(s.id,s),a.push(s),w.addToScene(o,i.position),this.layerSystem){const c=this.layerSystem.baseMaterial?.uniforms?.baseColor?.value||new te(9127187);w.applyToPlanetSystem(this.layerSystem,c)}}const N=D(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3);if(N){const s={id:`effect_${this.nextId++}`,type:"river_lines",effect:N,priority:8,enabled:!0,name:"Cave Drainage Channels"};this.effects.set(s.id,s),a.push(s),N.addToScene(o,i.position)}break;case"anomaly":const ce=["anomaly_phase_matter","pulsating_cube","planet_rays"],Te=e.seeds?.planet_seed||Math.floor(Math.random()*1e6),ve=ce.length;for(let s=0;s<ve;s++){const c=ce[s],n=Te+s*1e4,d=this.createEffectFromPythonData(c,{...e,seeds:{...e.seeds,planet_seed:n}},t,i,10+s);d&&(d.name=c.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase()),a.push(d),d.effect.addToScene&&d.effect.addToScene(o,i.position))}if(e.atmosphere&&e.atmosphere.type!=="None"){const s=this.createEffectFromPythonData("atmosphere",e.atmosphere,t,i,5);s&&(a.push(s),s.effect.addToScene(o,i.position))}break;case"carbon":if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.planet_seed||e.seeds?.shape_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Carbon Atmospheric Dust"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}if(r.green_patches&&r.green_patches.length>0){const s={...r,green_patches:r.green_patches.map(n=>({...n,color:[.1,.07,.06,n.color?.[3]||.9],size:(n.size||.1)*1.5}))},c=u(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+6e3);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:5,enabled:!0,name:"Carbon Formations"};this.effects.set(n.id,n),a.push(n),c.addToScene(o,i.position)}}const B=Ve(t,r,(e.seeds?.planet_seed||e.seeds?.shape_seed)+15e3);if(B){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:B,priority:20,enabled:!0,name:"Carbon Dust Particles"};this.effects.set(s.id,s),a.push(s),B.addToScene(o,i.position)}const H=this.createEffectFromPythonData("carbon_trails",e,t,i);if(H){const s={id:`effect_${this.nextId++}`,type:"carbon_trails",effect:H.effect,priority:25,enabled:!0,name:"Carbon Gas Trails"};this.effects.set(s.id,s),a.push(s),H.effect.addToScene(o,i.position)}break;case"forest":const U=this.createEffectFromPythonData("vegetation",e,t,i);if(U){const s={id:`effect_${this.nextId++}`,type:"vegetation",effect:U.effect,priority:10,enabled:!0,name:"Forest Vegetation"};this.effects.set(s.id,s),a.push(s),U.effect.addToScene(o,i.position)}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Forest Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.green_patches&&r.green_patches.length>0){const s={...r,green_patches:r.green_patches.map(n=>({...n,size:(n.size||.1)*1.5,color:n.color||[.2,.4,.1,1]}))},c=u(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+6e3);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:5,enabled:!0,name:"Forest Land Masses"};this.effects.set(n.id,n),a.push(n),c.addToScene(o,i.position)}}break;case"magma":const j=this.createEffectFromPythonData("magma_flows",e,t,i);if(j){const s={id:`effect_${this.nextId++}`,type:"magma_flows",effect:j.effect,priority:12,enabled:!0,name:"Magma Flows & Lakes"};this.effects.set(s.id,s),a.push(s),j.effect.addToScene(o,i.position)}const Y=this.createEffectFromPythonData("magma_eruptions",e,t,i);if(Y){const s={id:`effect_${this.nextId++}`,type:"magma_eruptions",effect:Y.effect,priority:13,enabled:!0,name:"Magma Eruptions & Arcs"};this.effects.set(s.id,s),a.push(s),Y.effect.addToScene(o,i.position)}if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Magma Atmospheric Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.planet_seed||e.seeds?.shape_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Magmatic Land Masses"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}break;case"toxic":if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Toxic Purple Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4500);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:10,enabled:!0,name:"Toxic Contaminated Areas"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}const K=Oe(t,r,(e.seeds?.planet_seed||e.seeds?.shape_seed)+15e3);if(K){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:K,priority:20,enabled:!0,name:"Toxic Particles"};this.effects.set(s.id,s),a.push(s),K.addToScene(o,i.position)}const J=ne(t,r,e.seeds?.planet_seed);if(J){const s={id:`effect_${this.nextId++}`,type:"toxic_waste_render",effect:J,priority:25,enabled:!0,name:"Toxic Waste Polygonal Spots"};this.effects.set(s.id,s),a.push(s),J.addToScene(o,i.position)}break;case"radioactive":if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Radioactive Toxic Clouds"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:10,enabled:!0,name:"Radioactive Contaminated Areas"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}const Q=this.createEffectFromPythonData("radiation_rings",e,t,i);if(Q){const s={id:`effect_${this.nextId++}`,type:"radiation_rings",effect:Q.effect,priority:21,enabled:!0,name:"Radioactive Surface Rings"};this.effects.set(s.id,s),a.push(s),Q.effect.addToScene(o,i.position)}break;case"super_earth":if(r.clouds&&r.clouds.length>0){const s=_(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+8e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Super Earth Dense Atmosphere"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}if(r.green_patches&&r.green_patches.length>0){const s=u(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+9e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Super Earth Massive Continents"};this.effects.set(c.id,c),a.push(c),s.addToScene(o,i.position)}}const X=Ie(t,r,(e.seeds?.shape_seed||e.seeds?.planet_seed)+11e3);if(X){const s={id:`effect_${this.nextId++}`,type:"super_earth_water_features",effect:X,priority:6,enabled:!0,name:"Super Earth Water Features"};this.effects.set(s.id,s),a.push(s),X.addToScene(o,i.position)}break;default:if(e.planet_info?.type?.toLowerCase()==="anomaly"){const c=["anomaly_phase_matter","pulsating_cube","planet_rays"],n=e.seeds?.planet_seed||Math.floor(Math.random()*1e6),d=c.length;for(let f=0;f<d;f++){const m=c[f],E=n+f*1e4,F=this.createEffectFromPythonData(m,{...e,seeds:{...e.seeds,planet_seed:E}},t,i,10+f);F&&(F.name=m.replace(/_/g," ").replace(/\b\w/g,Fe=>Fe.toUpperCase()),a.push(F),F.effect.addToScene&&F.effect.addToScene(o,i.position))}if(e.atmosphere&&e.atmosphere.type!=="None"){const f=this.createEffectFromPythonData("atmosphere",e.atmosphere,t,i,5);f&&(a.push(f),f.effect.addToScene(o,i.position))}}else if(i.material instanceof xe){const s=C(e);i.material.color.copy(s)}break}}else if(i.material instanceof xe){const r=C(e);i.material.color.copy(r)}const g=e.planet_info?.type?.toLowerCase()||e.surface_elements?.type?.toLowerCase(),Pe=g==="anomaly"||e.surface_elements?.type==="anomaly";if(e.atmosphere&&!Pe){if(e.atmosphere.streaks||["Gas Giant","Frozen Gas Giant"].includes(e.planet_info?.type)){const r=ie(t,e.atmosphere||{},e.seeds?.shape_seed+2e3);if(r){const p={id:`effect_${this.nextId++}`,type:"atmosphere_glow",effect:r,priority:20,enabled:!0};this.effects.set(p.id,p),a.push(p),r.addToScene(o,i.position)}}if(e.atmosphere.type&&e.atmosphere.type!=="None"){const r={...e.atmosphere};g==="oceanic"&&(r.opacity=Math.min(r.opacity||.3,.15),r.width=Math.min(r.width||15,8));const p=this.createEffectFromPythonData("atmosphere",r,t,i,5);p&&(a.push(p),p.effect.addToScene(o,i.position))}}if(e.rings&&e.rings.has_rings||["Gas Giant","Frozen Gas Giant","Super Earth"].includes(e.planet_info?.type)){const r=this.createEffectFromPythonData("ring_system",e,t,i,1);r?(a.push(r),r.effect.addToScene(o,i.position)):console.warn("⚠️ Failed to create ring effect")}if(e.surface_elements?.has_fragmentation_zones){const r=this.createEffectFromPythonData("fragmentation",e,t,i,5);r&&(a.push(r),r.effect.addToScene(o,i.position))}this.layerSystem&&this.layerSystem.addToScene(o);try{const r=this.createEffectFromPythonData("star_field",e,t,i,-100);r&&r.effect&&(r.effect.addToScene(o,i.position),a.push(r))}catch(r){console.warn("Could not create StarField:",r)}return a.forEach((r,p)=>{}),a.length===0&&console.warn("⚠️ NO EFFECTS WERE CREATED! Check the data structure and conditions."),a}catch(l){throw console.error("Error in EffectRegistry.createEffectsFromPythonPlanetData:",l),l}}getEffect(e){return this.effects.get(e)||null}getEffectsByType(e){return Array.from(this.effects.values()).filter(t=>t.type===e)}getAllEffects(){return Array.from(this.effects.values())}toggleEffect(e,t){const i=this.effects.get(e);if(i){i.enabled=t!==void 0?t:!i.enabled;const o=i.effect;if(o&&o.getObject3D){const h=o.getObject3D();h&&(h.visible=i.enabled)}if(this.layerSystem){const h=this.layerSystem.getLayerMeshes(),l={cloud_bands_layer:"cloudBands",cloud_gyros_layer:"cloudGyros",metallic_surface_layer:"metallicSurface",diamond_surface_layer:"diamondSurface",rocky_terrain_layer:"rockyTerrain",savannah_terrain_layer:"savannahTerrain",icy_terrain_layer:"icyTerrain",aquifer_water:"aquiferWater",ocean_currents:"oceanCurrents",molten_lava:"moltenLava"}[i.type];l&&h[l]&&(h[l].visible=i.enabled)}}else console.warn(`⚠️ Effect not found: ${e}`)}updateAllEffects(e,t,i){this.layerSystem&&this.layerSystem.update(e,t);for(const o of this.effects.values())if(o.enabled&&o.effect.update)try{o.type==="star_field"&&i&&"updateWithCamera"in o.effect?o.effect.updateWithCamera(e,i):o.effect.update(e,t)}catch(h){console.error(`Error updating effect ${o.type}:`,h)}}updateLightForAllEffects(e){this.layerSystem&&this.layerSystem.updateFromThreeLight(e);for(const t of this.effects.values())if(t.enabled&&t.effect.updateFromThreeLight)try{t.effect.updateFromThreeLight(e)}catch(i){console.error(`Error updating light for effect ${t.type}:`,i)}}removeEffect(e){const t=this.effects.get(e);t&&(t.effect.dispose&&t.effect.dispose(),this.effects.delete(e))}clearAllEffects(){this.layerSystem&&(this.layerSystem.dispose(),this.layerSystem=void 0);for(const e of this.effects.values())e.effect.dispose&&e.effect.dispose();this.effects.clear(),this.nextId=1}getStats(){const e=Array.from(this.effects.values());return{registeredTypes:this.creators.size,activeEffects:e.length,enabledEffects:e.filter(t=>t.enabled).length}}getAvailableEffectTypes(){return Array.from(this.creators.keys())}}const yt=I.getInstance();export{yt as e};
