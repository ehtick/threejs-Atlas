import{r as a,j as e,V as Ke,c as Je,R as Ze}from"./atlas_bDOTfl6YifhEgi64OZoGp.js";import{H as Ue}from"./atlas_DAPSgiEQDbHKEp53GoVrV.js";import{r as Qe,S as et,U as tt,b as st,m as at,c as Ce,a as nt}from"./atlas_HOF5V4Y7Q3DW-IYNsZLlc.js";import{S as Re,C as Le,P as De,W as Ae,G as Pe,c as re,M as ie,d as le,V as ye,e as ze,L as Ie,g as Te,A as Ge,k as Ve,h as Ye,i as Oe,j as We,l as ke}from"./atlas_ZgUbUwm-J4U4iRNwqY-vk.js";const ot=({planets:s,stars:r,systemName:N,cosmicOriginTime:b,currentTime:y,onTimeOffsetChange:o})=>{const R=a.useRef(null),p=a.useRef(null),S=a.useRef(null),P=a.useRef(null),C=a.useRef([]),O=a.useRef([]),i=a.useRef([]),I=a.useRef(0),q=(E,W="#ffffff")=>{const k=document.createElement("canvas"),l=k.getContext("2d");if(!l)return null;k.width=768,k.height=192,l.fillStyle="rgba(0, 0, 0, 0.8)",l.fillRect(0,0,k.width,k.height),l.strokeStyle="#ffffff",l.lineWidth=3,l.strokeRect(3,3,k.width-6,k.height-6),l.fillStyle=W,l.font="bold 48px Arial",l.textAlign="center",l.textBaseline="middle",l.fillText(E,384,96);const c=new Ye(k),v=new Oe({map:c,transparent:!0,alphaTest:.1}),z=new We(v);return z.scale.set(30,7.5,1),z};return I.current=y,a.useEffect(()=>{if(!R.current)return;const E=R.current,W=E.clientWidth,k=E.clientHeight,l=new Re;l.background=new Le(17),p.current=l;const c=new De(60,W/k,.1,1e4);c.position.set(0,120,180),c.lookAt(0,0,0);const v=new Ae({antialias:!0,alpha:!0});v.setSize(W,k),v.setClearColor(17,1),S.current=v,E.appendChild(v.domElement);const z={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},ne={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},T=new Pe;r.forEach((t,f)=>{const x=parseFloat(t.Size)*4,g=new re(x,32,32),X=ne[t.Color]||"#FFFF44",$=new ie({color:X,transparent:!0,opacity:.9}),D=new le(g,$);r.length===1?D.position.set(0,0,0):r.length===2?D.position.set(f===0?-x*2:x*2,0,0):f===0?D.position.set(-x*2,0,0):f===1?D.position.set(x*2,0,0):D.position.set(0,x*2,0);const U=new re(x*1.5,32,32),ae=new ie({color:X,transparent:!0,opacity:.3}),te=new le(U,ae);D.add(te),T.add(D)}),l.add(T);const me=Math.max(...s.map(t=>t.orbital_radius)),M=150;s.forEach((t,f)=>{const g=30+t.orbital_radius/me*M,X=t.eccentricity_factor,$=g,D=$*Math.sqrt(1-X*X),U=360,ae=2,te=4;for(let H=0;H<U;H+=ae+te){const V=[];for(let Y=H;Y<Math.min(H+ae,U-1);Y++){const Q=Y/U*2*Math.PI,se=$*Math.cos(Q),be=D*Math.sin(Q);V.push(new ye(se,0,be))}if(V.length>1){const Y=new ze().setFromPoints(V),Q=new Ie({color:7372944,transparent:!0,opacity:.8,linewidth:2}),se=new Te(Y,Q);l.add(se),O.current.push(se)}}const ue=t.diameter/8e3,A=Math.max(Math.min(ue,8),2.5),je=new re(A,32,32),ge=z[t.planet_type]||"#FFFFFF",n=new ie({color:ge,transparent:!0,opacity:.9}),m=new le(je,n),F=new le(new re(A*1.5,32,32),new ie({color:ge,transparent:!0,opacity:.2}));m.add(F),l.add(m),C.current.push(m),m.planetData=t,m.orbitRadius=g,m.semiMajorAxis=$,m.semiMinorAxis=D;const G=t.name.replace(/_/g," "),B=q(G,"#ffffff");B&&(B.position.copy(m.position),B.position.y+=A+10,B.planetData=t,l.add(B),i.current.push(B))});const ee=new Ge(4210752,.4);l.add(ee);const ce=new Ve(16777215,1,2e3);ce.position.set(0,0,0),l.add(ce);let K=!1,J=0,Z=0,de=0;const xe=t=>{K=!0,J=t.clientX,Z=t.clientY},pe=t=>{if(!K)return;const f=t.clientX-J,x=t.clientY-Z,g=new ke;g.setFromVector3(c.position),g.theta-=f*.01,g.phi+=x*.01,g.phi=Math.max(.1,Math.min(Math.PI-.1,g.phi)),c.position.setFromSpherical(g),c.lookAt(0,0,0),J=t.clientX,Z=t.clientY},u=()=>{K=!1,setTimeout(()=>{},3e3)},j=t=>{if(t.ctrlKey)t.preventDefault(),t.deltaY>0?o(604800):o(-604800);else{t.preventDefault();const f=.1,x=c.position.distanceTo(new ye(0,0,0));t.deltaY>0&&x<800?c.position.multiplyScalar(1+f):t.deltaY<0&&x>50&&c.position.multiplyScalar(1-f)}},h=t=>{t.key==="Escape"&&document.dispatchEvent(new CustomEvent("solar-system-close-fullscreen"))},d=t=>{if(t.preventDefault(),t.touches.length===1)K=!0,J=t.touches[0].clientX,Z=t.touches[0].clientY;else if(t.touches.length===2){const f=t.touches[0].clientX-t.touches[1].clientX,x=t.touches[0].clientY-t.touches[1].clientY;de=Math.sqrt(f*f+x*x)}},_=t=>{if(t.preventDefault(),t.touches.length===1&&K){const f=t.touches[0].clientX-J,x=t.touches[0].clientY-Z,g=new ke;g.setFromVector3(c.position),g.theta-=f*.01,g.phi+=x*.01,g.phi=Math.max(.1,Math.min(Math.PI-.1,g.phi)),c.position.setFromSpherical(g),c.lookAt(0,0,0),J=t.touches[0].clientX,Z=t.touches[0].clientY}else if(t.touches.length===2){const f=t.touches[0].clientX-t.touches[1].clientX,x=t.touches[0].clientY-t.touches[1].clientY,g=Math.sqrt(f*f+x*x);if(de>0){const $=g/de,D=c.position.distanceTo(new ye(0,0,0));$>1&&D>50?c.position.multiplyScalar(1-.01):$<1&&D<800&&c.position.multiplyScalar(1+.01)}de=g}},L=t=>{t.preventDefault(),K=!1,de=0,setTimeout(()=>{},3e3)},w=v.domElement;w.style.cursor="grab",w.addEventListener("mousedown",t=>{w.style.cursor="grabbing",xe(t)}),w.addEventListener("mousemove",pe),w.addEventListener("mouseup",()=>{w.style.cursor="grab",u()}),w.addEventListener("mouseleave",()=>{w.style.cursor="grab",u()}),w.addEventListener("wheel",j),w.addEventListener("touchstart",d,{passive:!1}),w.addEventListener("touchmove",_,{passive:!1}),w.addEventListener("touchend",L,{passive:!1}),document.addEventListener("keydown",h);const ve=()=>{P.current=requestAnimationFrame(ve),C.current.forEach((t,f)=>{const x=t.planetData,g=t.semiMajorAxis,X=t.semiMinorAxis,$=x.orbital_period_seconds,D=2*Math.PI/$,U=(x.initial_orbital_angle+I.current*D)%(2*Math.PI);t.position.x=g*Math.cos(U),t.position.z=X*Math.sin(U),t.position.y=0;const ae=x.rotation_period_seconds,te=2*Math.PI/ae;if(t.rotation.y=I.current*te%(2*Math.PI),i.current[f]){const ue=t.geometry.parameters?.radius||2;i.current[f].position.copy(t.position),i.current[f].position.y+=ue+10}}),v.render(l,c)};ve();const fe=()=>{const t=E.clientWidth,f=E.clientHeight;c.aspect=t/f,c.updateProjectionMatrix(),v.setSize(t,f)};return window.addEventListener("resize",fe),()=>{window.removeEventListener("resize",fe),document.removeEventListener("keydown",h),w.removeEventListener("mousedown",xe),w.removeEventListener("mousemove",pe),w.removeEventListener("mouseup",u),w.removeEventListener("mouseleave",u),w.removeEventListener("wheel",j),w.removeEventListener("touchstart",d),w.removeEventListener("touchmove",_),w.removeEventListener("touchend",L),P.current&&cancelAnimationFrame(P.current),E&&v.domElement&&E.removeChild(v.domElement),v.dispose(),C.current=[],O.current=[],i.current=[]}},[s,r,b]),e.jsx("div",{ref:R,className:"w-full h-full"})},rt=({planets:s,stars:r,systemName:N,cosmicOriginTime:b})=>{const y=a.useRef(null),o=a.useRef(null),R=a.useRef(null),p=a.useRef(null),S=a.useRef([]),P=a.useRef([]),C=a.useRef([]),O=a.useRef(0),i=Math.floor(Date.now()/1e3),[I,q]=a.useState(0),[E,W]=a.useState(!1),[k,l]=a.useState(!1),[c,v]=a.useState(!1),[z,ne]=a.useState(0),[T,me]=a.useState(null),[M,ee]=a.useState(!0),[ce,K]=a.useState(null),J=i-b+I;O.current=J,a.useEffect(()=>{(async()=>{try{ee(!0),K(null),console.log("üöÄ Fetching system data from API...");const j=await fetch("/api/system/rendering-data");if(!j.ok)throw new Error(`HTTP error! status: ${j.status}`);const h=await j.json();if(console.log("‚úÖ API response:",h),h.success){me(h.system_data),console.log("üéØ System data loaded:",{name:h.system_data.name,planets_count:h.system_data.planets.length,timing:h.system_data.timing});const d=s.find(L=>L.name.toLowerCase().includes("tonnir")),_=h.system_data.planets.find(L=>L.name.toLowerCase().includes("tonnir"));d&&_&&console.log("üîç TONNIR COMPARISON DOM vs API:",{dom:{initial_orbital_angle:d.initial_orbital_angle,orbital_radius:d.orbital_radius,orbital_period_seconds:d.orbital_period_seconds},api:{initial_orbital_angle:_.initial_orbital_angle,orbital_radius:_.orbital_radius,orbital_period_seconds:_.orbital_period_seconds},cosmicOriginTime:b,apiCosmicOriginTime:h.system_data.timing.cosmic_origin_time})}else throw new Error(h.error||"Failed to fetch system data")}catch(j){console.error("‚ùå Error fetching system data:",j),K(j instanceof Error?j.message:"Unknown error")}finally{ee(!1)}})()},[]);const Z=()=>{l(!0),setTimeout(()=>{W(!1),l(!1)},300)},de=(u,j="#ffffff")=>{const h=document.createElement("canvas"),d=h.getContext("2d");if(!d)return null;h.width=512,h.height=128,d.fillStyle="rgba(0, 0, 0, 0.7)",d.fillRect(0,0,h.width,h.height),d.strokeStyle="#ffffff",d.lineWidth=2,d.strokeRect(2,2,h.width-4,h.height-4),d.fillStyle=j,d.font="bold 32px Arial",d.textAlign="center",d.textBaseline="middle",d.fillText(u,256,64);const _=new Ye(h),L=new Oe({map:_,transparent:!0,alphaTest:.1}),w=new We(L);return w.scale.set(20,5,1),w};a.useEffect(()=>{const u=j=>{j.key==="Escape"&&E&&Z()};return E&&ne(I),document.addEventListener("solar-system-close-fullscreen",Z),document.addEventListener("keydown",u),()=>{document.removeEventListener("solar-system-close-fullscreen",Z),document.removeEventListener("keydown",u)}},[E,I]),a.useEffect(()=>{if(E&&c){const u=setTimeout(()=>{v(!1)},50);return()=>clearTimeout(u)}},[E,c]),a.useEffect(()=>{if(M||!T){console.log("‚è≥ Waiting for system data...",{loadingAPI:M,hasSystemData:!!T});return}if(console.log("üöÄ Initializing 3D scene with API data..."),window.tonnirLoggedInSystem=!1,!y.current)return;const u=y.current,j=u.clientWidth,h=j<640,d=new Re;d.background=new Le(17),o.current=d;const _=new De(45,j/(h?120:140),.1,1e4);_.position.set(0,80,120),_.lookAt(0,0,0);const L=new Ae({antialias:!0,alpha:!0});L.setSize(j,h?120:140),L.setClearColor(17,1),R.current=L,u.appendChild(L.domElement);const w={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},ve={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},fe=new Pe;T.stars.forEach((n,m)=>{const F=parseFloat(n.Size)*3,G=new re(F,16,16),B=ve[n.Color]||"#FFFF44",H=new ie({color:B,transparent:!0,opacity:.9}),V=new le(G,H);T.stars.length===1?V.position.set(0,0,0):T.stars.length===2?V.position.set(m===0?-F*2:F*2,0,0):m===0?V.position.set(-F*2,0,0):m===1?V.position.set(F*2,0,0):V.position.set(0,F*2,0);const Y=new re(F*1.5,16,16),Q=new ie({color:B,transparent:!0,opacity:.3}),se=new le(Y,Q);V.add(se),fe.add(V)}),d.add(fe);const t=T.timing.max_orbital_radius,f=80;window.systemMaxOrbitalRadius=t,T.planets.forEach((n,m)=>{const G=20+n.orbital_radius/t*f,B=n.eccentricity_factor,H=G,V=H*Math.sqrt(1-B*B),Y=360,Q=2,se=4;for(let Fe=0;Fe<Y;Fe+=Q+se){const Me=[];for(let we=Fe;we<Math.min(Fe+Q,Y-1);we++){const Ne=we/Y*2*Math.PI,Se=H*Math.cos(Ne),qe=V*Math.sin(Ne);Me.push(new ye(Se,0,qe))}if(Me.length>1){const we=new ze().setFromPoints(Me),Ne=new Ie({color:7372944,transparent:!0,opacity:.8,linewidth:2}),Se=new Te(we,Ne);d.add(Se),P.current.push(Se)}}const be=n.diameter/15e3,Ee=Math.max(Math.min(be,4),1.5),$e=new re(Ee,16,16),_e=w[n.planet_type]||"#FFFFFF",Be=new ie({color:_e,transparent:!0,opacity:.9}),oe=new le($e,Be),Xe=new le(new re(Ee*1.5,16,16),new ie({color:_e,transparent:!0,opacity:.2}));oe.add(Xe),d.add(oe),S.current.push(oe),oe.planetData=n,oe.orbitRadius=G,oe.semiMajorAxis=H,oe.semiMinorAxis=V;const He=n.name.replace(/_/g," "),he=de(He,"#ffffff");he&&(he.position.copy(oe.position),he.position.y+=Ee+6,he.planetData=n,d.add(he),C.current.push(he))});const x=new Ge(4210752,.4);d.add(x);const g=new Ve(16777215,1,1e3);g.position.set(0,0,0),d.add(g);let X=!1,$=0,D=0;const U=n=>{X=!0,$=n.clientX,D=n.clientY},ae=n=>{if(!X)return;const m=n.clientX-$,F=n.clientY-D,G=new ke;G.setFromVector3(_.position),G.theta-=m*.01,G.phi+=F*.01,G.phi=Math.max(.1,Math.min(Math.PI-.1,G.phi)),_.position.setFromSpherical(G),_.lookAt(0,0,0),$=n.clientX,D=n.clientY},te=()=>{X=!1,setTimeout(()=>{},3e3)},ue=n=>{if(n.ctrlKey)n.preventDefault(),n.deltaY>0?q(m=>m+604800):q(m=>m-604800);else{n.preventDefault();const m=.1,F=_.position.distanceTo(new ye(0,0,0));n.deltaY>0&&F<500?_.position.multiplyScalar(1+m):n.deltaY<0&&F>20&&_.position.multiplyScalar(1-m)}},A=L.domElement;A.style.cursor="grab",A.style.borderRadius="8px",A.addEventListener("mousedown",n=>{A.style.cursor="grabbing",U(n)}),A.addEventListener("mousemove",ae),A.addEventListener("mouseup",()=>{A.style.cursor="grab",te()}),A.addEventListener("mouseleave",()=>{A.style.cursor="grab",te()}),A.addEventListener("wheel",ue);const je=()=>{p.current=requestAnimationFrame(je),S.current.forEach((n,m)=>{const F=n.planetData,G=n.semiMajorAxis,B=n.semiMinorAxis,H=F.orbital_period_seconds,V=2*Math.PI/H,Y=(F.initial_orbital_angle+O.current*V)%(2*Math.PI);n.position.x=G*Math.cos(Y),n.position.z=B*Math.sin(Y),n.position.y=0,F.name.toLowerCase().includes("tonnir_md-1420")&&(window.tonnirLoggedInSystem||(console.log("üåê SYSTEM - Tonnir_MD-1420:",{name:F.name,orbital_radius:F.orbital_radius,maxOrbitalRadius:window.systemMaxOrbitalRadius,orbitRadius:G,currentTime:O.current,initial_orbital_angle:F.initial_orbital_angle,angleOrbit:Y,angleOrbitDegrees:(Y*180/Math.PI).toFixed(2),position:{x:n.position.x.toFixed(2),z:n.position.z.toFixed(2)},cosmicOriginTime:b,realTime:Math.floor(Date.now()/1e3)}),window.tonnirLoggedInSystem=!0));const Q=F.rotation_period_seconds,se=2*Math.PI/Q;if(n.rotation.y=O.current*se%(2*Math.PI),C.current[m]){const be=n.geometry.parameters?.radius||2;C.current[m].position.copy(n.position),C.current[m].position.y+=be+6}}),L.render(d,_)};je();const ge=()=>{const n=u.clientWidth,m=n<640?120:140;_.aspect=n/m,_.updateProjectionMatrix(),L.setSize(n,m)};return window.addEventListener("resize",ge),()=>{window.removeEventListener("resize",ge),A.removeEventListener("mousedown",U),A.removeEventListener("mousemove",ae),A.removeEventListener("mouseup",te),A.removeEventListener("mouseleave",te),A.removeEventListener("wheel",ue),p.current&&cancelAnimationFrame(p.current),u&&L.domElement&&u.removeChild(L.domElement),L.dispose(),S.current=[],P.current=[],C.current=[]}},[s,r,b,T]);const xe=u=>{const j=Math.floor(u/31557600),h=Math.floor(u%(365.25*24*3600)/(24*3600)),d=Math.floor(u%(24*3600)/3600);return j>0?`${j}y ${h}d ${d}h`:h>0?`${h}d ${d}h`:`${d}h`},pe=u=>u.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Solar System Simulation"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:y,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsxs("button",{onClick:()=>{W(!0),v(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 flex items-center gap-1 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:[e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),e.jsx("span",{className:"text-xs text-white hidden sm:inline",children:"Expand"})]})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-[10px]",children:[T?.planets?.length||s.length," Planets"]})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Time: ",xe(J)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom ‚Ä¢ Ctrl+Scroll: +1week/-1week ‚Ä¢ Drag: Rotate View"})]})]}),E&&Qe.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${k||c?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${k||c?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:pe(N)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:pe(N)}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[T?.planets?.length||s.length," Planets"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Time: ",xe(i-b+z)]})]})]}),e.jsx("button",{onClick:Z,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2 sm:mb-4 px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"-15y"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"range",min:-15*365.25*24*3600,max:15*365.25*24*3600,step:604800,value:z,onChange:u=>ne(Number(u.target.value)),className:`w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer 
                               [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 
                               [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-400 
                               [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-600
                               [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg`}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-2 bg-yellow-400 rounded"})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"+15y"}),e.jsx("button",{onClick:()=>ne(0),className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors duration-200",title:"Reset to current time",children:"Now"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-1",children:["Time Travel: ",z===0?"Present":z>0?`+${Math.abs(z/(365.25*24*3600)).toFixed(1)} years`:`-${Math.abs(z/(365.25*24*3600)).toFixed(1)} years`," ‚Ä¢ Range: 30 years"]})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(ot,{planets:s,stars:r,systemName:N,cosmicOriginTime:b,currentTime:i-b+z,onTimeOffsetChange:u=>ne(j=>j+u)})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom ‚Ä¢ Ctrl+Scroll: +1week/-1week ‚Ä¢ Drag: Rotate View ‚Ä¢ ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom ‚Ä¢ Drag: Rotate ‚Ä¢ ESC: Close"})]})]})}),document.body)]})},it=({system:s,galaxy:r,systemIndex:N,cosmicOriginTime:b})=>{const y=o=>o.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}),e.jsxs("div",{className:"flex items-center justify-between mb-3 pr-16",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"System Information"}),e.jsx(et,{type:"system",name:s.name,coordinates:r.coordinates.join(","),systemIndex:N,className:"text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"System Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300 capitalize",children:s.star_system_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Planets"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:s.num_planets})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-orange-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Stars"}),e.jsx("div",{className:"text-sm font-bold text-orange-300",children:s.stars.length})]})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-3",children:[(()=>{if(!window.domDataLogged){const o=s.planets.find(R=>R.name.toLowerCase().includes("tonnir"));o&&console.log("üìÑ DOM DATA - Tonnir_MD-1420:",{name:o.name,planet_type:o.planet_type,orbital_radius:o.orbital_radius,initial_orbital_angle:o.initial_orbital_angle,orbital_period_seconds:o.orbital_period_seconds,rotation_period_seconds:o.rotation_period_seconds,eccentricity_factor:o.eccentricity_factor,axial_tilt:o.axial_tilt,cosmicOriginTime:b}),window.domDataLogged=!0}return null})(),e.jsx(rt,{planets:s.planets,stars:s.stars,systemName:s.name,cosmicOriginTime:b})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-yellow-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Stellar Composition"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1",children:s.stars.map((o,R)=>e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-yellow-500/20",children:[e.jsxs("div",{className:"text-xs text-gray-300",children:["Star ",R+1]}),e.jsx("div",{className:"text-xs font-bold text-yellow-300",children:o.Type}),e.jsxs("div",{className:"text-xs text-gray-300",children:[o.Color," ‚Ä¢ ",o.Size]})]},R))})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"System:"}),e.jsx("div",{className:"text-white truncate font-medium",children:y(s.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"System ID:"}),e.jsxs("div",{className:"text-white font-medium",children:["#",N+1]})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:y(r.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded p-2",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:r.coordinates.join(", ")})]})]})]})]})},lt=({systemUrl:s,imageUrl:r})=>{const N=a.useRef(null),b=a.useRef(null),[y,o]=a.useState("Aligning Stargate..."),[R,p]=a.useState(!1),[S,P]=a.useState(!1),[C,O]=a.useState(!1);return a.useEffect(()=>{const i=document.createElement("style");return i.textContent=`
      [data-rmiz-modal-overlay="visible"] {
        background-color: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(20px) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
      
      [data-rmiz-modal-img] {
        border-radius: 1rem !important;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;
      }
      
      [data-rmiz-modal-overlay="hidden"] {
        backdrop-filter: blur(0px) !important;
        -webkit-backdrop-filter: blur(0px) !important;
        transition: backdrop-filter 0.3s ease-in-out !important;
      }
    `,document.head.appendChild(i),()=>{document.head.removeChild(i)}},[]),a.useEffect(()=>{const i=N.current;if(!i)return;const I=i.getContext("2d");if(!I)return;let q=[];const E=800;let W,k;const l=800;let c,v=.5;function z(){const M=i?.parentElement;if(!M||!i)return;const ee=M.clientWidth,ce=M.clientHeight;i.width=Math.min(ee,l),i.height=Math.min(ce,l),W=i.width/2,k=i.height/2}function ne(){z(),q=[];for(let M=0;M<E;M++)q.push({x:Math.random()*(i?.width||800),y:Math.random()*(i?.height||800),z:Math.random()*(i?.width||800),o:Math.random()});T()}function T(){!i||!I||(I.clearRect(0,0,i.width,i.height),q.forEach(M=>{M.z-=v,M.z<=0&&(M.z=i.width,M.x=Math.random()*i.width,M.y=Math.random()*i.height,M.o=Math.random());const ee=i.width/M.z,ce=(M.x-W)*ee+W,K=(M.y-k)*ee+k,J=2*ee;I.beginPath(),I.fillStyle=`rgba(255, 255, 255, ${M.o})`,I.arc(ce,K,J,0,2*Math.PI),I.fill()}),v<60&&(v+=1),c=requestAnimationFrame(T))}ne();const me=()=>z();return window.addEventListener("resize",me),()=>{window.removeEventListener("resize",me),c&&cancelAnimationFrame(c)}},[]),a.useEffect(()=>{if(r){const i=new Image;i.onload=()=>{b.current&&(b.current.src=r,P(!0),O(!0))},i.onerror=()=>{console.error("Failed to load system image:",r),setTimeout(()=>{P(!0),O(!0)},1500)},i.src=r}else setTimeout(()=>{P(!0),O(!0)},1500)},[r]),a.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){o("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),p(!0);const I=(l,c)=>Array.from({length:c},()=>l[Math.floor(Math.random()*l.length)]).join(""),q=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:30},{chars:"0123456789ABCDEF",duration:20,iterations:40},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:\\'\",.<>?/`~",duration:10,iterations:100}];let E=0,W=0;const k=()=>{if(E>=q.length){const c="Stargate system aligned";let v=0;o("");const z=()=>{v<c.length?(o(c.substring(0,v+1)),v++,setTimeout(z,30)):p(!1)};z();return}const l=q[E];o(I(l.chars,32)),W++,W>=l.iterations&&(E++,W=0),setTimeout(k,l.duration)};k()},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white mb-3",children:"System Visualization"}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black/50 flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx("canvas",{ref:N,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${C?"opacity-0":"opacity-100"}`,style:{filter:C?"blur(50px)":"none"}}),e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${S?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:S&&r?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(tt,{zoomMargin:20,classDialog:"backdrop-blur-3xl",children:e.jsx("img",{ref:b,className:"max-w-full max-h-full object-contain rounded-xl shadow-2xl shadow-blue-500/20",src:r,alt:"System visualization",style:{width:"100%",height:"100%",objectFit:"contain",backgroundColor:"transparent"}})})}):e.jsx("img",{ref:b,className:"w-full h-full object-cover",src:"/static/images/placeholder-min.jpg",alt:"System visualization"})})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:s,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${R?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),y]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},ct=({planets:s,coordinates:r,systemIndex:N})=>{const[b,y]=a.useState(new Set);a.useEffect(()=>{(()=>{try{const S=st(r,N,s),P=new Set;S.forEach(C=>{P.add(C.toLowerCase())}),y(P)}catch(S){console.error("Error loading historical data:",S)}})()},[r,N,s]);const o=p=>p.replace(/_/g," "),R=p=>{try{at(r,N,p,s)}catch(S){console.error("Error marking planet as visited:",S)}window.location.href=`/planet/${p.toLowerCase()}`};return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:s.map(p=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[b.has(p.name.toLowerCase())&&e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}),e.jsxs("button",{onClick:()=>R(p.name),className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Planet"}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:o(p.name)})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},p.name))}),s.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No planets found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This system appears to be empty"})]})]})},dt=({currentSystem:s,galaxy:r})=>{const[N,b]=a.useState(!1),[y,o]=a.useState(!1),[R,p]=a.useState(!0);a.useEffect(()=>{b(s.index>0),o(!0),p(!1)},[s.index]);const S=async()=>{if(s.index>0){const C=r.coordinates.join(",");Ce(C,s.index-1),window.location.href=`/system/${s.index-1}`}},P=async()=>{const C=r.coordinates.join(",");Ce(C,s.index+1),window.location.href=`/system/${s.index+1}`};return R?null:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:S,disabled:!N,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${N?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:P,disabled:!y,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${y?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},mt=({system:s,galaxy:r,system_url:N,version:b,system_index:y,image_url:o,page:R,cosmic_origin_time:p})=>{const[S]=a.useState(r.coordinates.join(","));a.useEffect(()=>{document.body.setAttribute("data-coordinates",S),document.body.setAttribute("data-system-index",y.toString()),Ce(S,y)},[S,y]);const P=O=>O.replace(/_/g," "),C=O=>O.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Ue,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["System '",P(s.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Galaxy '",C(r.name),"' - Coordinates ",r.coordinates.join(", ")]})]}),e.jsx(dt,{currentSystem:{name:s.name,index:y},galaxy:r}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(lt,{systemUrl:N,imageUrl:o})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(it,{system:s,galaxy:r,systemIndex:y,cosmicOriginTime:p})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Planets in '",P(s.name),"'"]}),e.jsx(ct,{planets:s.planets,coordinates:S,systemIndex:y})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${R}`,className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsxs("span",{className:"text-base sm:text-lg",children:["‚Üê Back to Galaxy '",C(r.name),"'"]})})})]}),e.jsx(Ke,{version:b})]}),e.jsx(nt,{currentLocation:{type:"system",name:s.name,coordinates:r.coordinates.join(","),systemIndex:s.index}})]})};document.addEventListener("DOMContentLoaded",async()=>{try{const s=document.getElementById("system-data"),r=document.getElementById("galaxy-data"),N=document.getElementById("meta-data");if(!s||!r||!N){console.error("Missing required data elements");return}const b=JSON.parse(s.textContent||"{}"),y=JSON.parse(r.textContent||"{}"),o=JSON.parse(N.textContent||"{}"),R={system:b,galaxy:y,system_url:o.system_url,version:o.version,system_index:o.system_index,image_url:o.image_url,page:o.page||1,cosmic_origin_time:o.cosmic_origin_time},p=document.getElementById("atlas-react-root");p&&Je.createRoot(p).render(Ze.createElement(mt,R))}catch(s){console.error("Error initializing System React app:",s)}});
