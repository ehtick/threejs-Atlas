import{r as s,j as e,a as qe,c as et,R as tt}from"./atlas_BiACxVxc6cO5okV5F68Rd.js";import{R as st,L as nt,c as at,d as rt,S as Ee,e as Pe,F as ot,H as it,a as lt}from"./atlas_DV2TxjXVLZiB7z8gZlLyQ.js";import{W as Ie}from"./atlas_CpfeS5VhE5H57rIqo09CI.js";import{W as _e,C as Ge,X as Oe,G as $e,b as me,z as ue,M as he,V as Fe,B as Ve,x as Ye,n as Be,a0 as We,cH as He,v as Ue,cD as Ke,cE as Ze,a4 as ze}from"./atlas_Bng76Ipsc6y2pOae0EuhP.js";import{R as ct,S as dt,M as mt,a as Te,b as Xe,T as ut}from"./atlas_CucbVO37Kcy0bEJq4UQQ7.js";import{O as ht}from"./atlas_sLbA9m1UOHQtiV0wkxe1n.js";import{V as xt}from"./atlas_c-mX1IzYsquxm9YzhFAN0.js";import"./atlas_5StMBQg7EZ_DcUhMgqODi.js";const Je=({planets:n,stars:o,systemName:y,cosmicOriginTime:M,currentTime:w,onTimeOffsetChange:E})=>{const B=s.useRef(null),i=s.useRef(null),v=s.useRef(null),$=s.useRef(null),k=s.useRef([]),T=s.useRef([]),l=s.useRef([]),I=s.useRef(0),H=(C,P="#ffffff")=>{const R=document.createElement("canvas"),d=R.getContext("2d");if(!d)return null;R.width=768,R.height=192,d.fillStyle="rgba(0, 0, 0, 0.8)",d.fillRect(0,0,R.width,R.height),d.strokeStyle="#ffffff",d.lineWidth=3,d.strokeRect(3,3,R.width-6,R.height-6),d.fillStyle=P,d.font="bold 48px Arial",d.textAlign="center",d.textBaseline="middle",d.fillText(C,384,96);const c=new Ue(R),N=new Ke({map:c,transparent:!0,alphaTest:.1}),V=new Ze(N);return V.scale.set(30,7.5,1),V};return I.current=w,s.useEffect(()=>{if(!B.current)return;const C=B.current,P=C.clientWidth,R=C.clientHeight,d=new _e;d.background=new Ge(17),i.current=d;const c=new Oe(60,P/R,.1,1e4);c.position.set(0,120,180),c.lookAt(0,0,0);const N=new Ie({antialias:!0,alpha:!0});N.setSize(P,R),N.setClearColor(17,1),v.current=N,C.appendChild(N.domElement);const V={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},Z={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},G=new $e;o.forEach((t,F)=>{const j=parseFloat(t.Size)*4,S=new me(j,32,32),J=Z[t.Color]||"#FFFF44",A=new ue({color:J,transparent:!0,opacity:.9}),O=new he(S,A);o.length===1?O.position.set(0,0,0):o.length===2?O.position.set(F===0?-j*2:j*2,0,0):F===0?O.position.set(-j*2,0,0):F===1?O.position.set(j*2,0,0):O.position.set(0,j*2,0);const Q=new me(j*1.5,32,32),ce=new ue({color:J,transparent:!0,opacity:.3}),ne=new he(Q,ce);O.add(ne),G.add(O)}),d.add(G);const U=Math.max(...n.map(t=>t.orbital_radius)),_=150;n.forEach((t,F)=>{const S=30+t.orbital_radius/U*_,J=t.eccentricity_factor,A=S,O=A*Math.sqrt(1-J*J),Q=360,ce=2,ne=4;for(let X=0;X<Q;X+=ce+ne){const q=[];for(let K=X;K<Math.min(X+ce,Q-1);K++){const ae=K/Q*2*Math.PI,re=A*Math.cos(ae),ve=O*Math.sin(ae);q.push(new Fe(re,0,ve))}if(q.length>1){const K=new Ve().setFromPoints(q),ae=new Ye({color:7372944,transparent:!0,opacity:.8,linewidth:2}),re=new Be(K,ae);d.add(re),T.current.push(re)}}const f=t.diameter/8e3,p=Math.max(Math.min(f,8),2.5),W=new me(p,32,32),de=V[t.planet_type]||"#FFFFFF",a=new ue({color:de,transparent:!0,opacity:.9}),h=new he(W,a),b=new he(new me(p*1.5,32,32),new ue({color:de,transparent:!0,opacity:.2}));h.add(b),d.add(h),k.current.push(h),h.planetData=t,h.orbitRadius=S,h.semiMajorAxis=A,h.semiMinorAxis=O;const z=t.name.replace(/_/g," "),Y=H(z,"#ffffff");Y&&(Y.position.copy(h.position),Y.position.y+=p+10,Y.planetData=t,d.add(Y),l.current.push(Y))});const oe=new We(4210752,.4);d.add(oe);const pe=new He(16777215,1,2e3);pe.position.set(0,0,0),d.add(pe);let ie=!1,ee=0,se=0,le=0;const be=t=>{ie=!0,ee=t.clientX,se=t.clientY},fe=t=>{if(!ie)return;const F=t.clientX-ee,j=t.clientY-se,S=new ze;S.setFromVector3(c.position),S.theta-=F*.01,S.phi+=j*.01,S.phi=Math.max(.1,Math.min(Math.PI-.1,S.phi)),c.position.setFromSpherical(S),c.lookAt(0,0,0),ee=t.clientX,se=t.clientY},r=()=>{ie=!1,setTimeout(()=>{},3e3)},m=t=>{if(t.ctrlKey)t.preventDefault(),t.deltaY>0?E(604800):E(-604800);else{t.preventDefault();const F=.1,j=c.position.distanceTo(new Fe(0,0,0));t.deltaY>0&&j<800?c.position.multiplyScalar(1+F):t.deltaY<0&&j>50&&c.position.multiplyScalar(1-F)}},g=t=>{t.key==="Escape"&&document.dispatchEvent(new CustomEvent("solar-system-close-fullscreen"))},x=t=>{if(t.preventDefault(),t.touches.length===1)ie=!0,ee=t.touches[0].clientX,se=t.touches[0].clientY;else if(t.touches.length===2){const F=t.touches[0].clientX-t.touches[1].clientX,j=t.touches[0].clientY-t.touches[1].clientY;le=Math.sqrt(F*F+j*j)}},L=t=>{if(t.preventDefault(),t.touches.length===1&&ie){const F=t.touches[0].clientX-ee,j=t.touches[0].clientY-se,S=new ze;S.setFromVector3(c.position),S.theta-=F*.01,S.phi+=j*.01,S.phi=Math.max(.1,Math.min(Math.PI-.1,S.phi)),c.position.setFromSpherical(S),c.lookAt(0,0,0),ee=t.touches[0].clientX,se=t.touches[0].clientY}else if(t.touches.length===2){const F=t.touches[0].clientX-t.touches[1].clientX,j=t.touches[0].clientY-t.touches[1].clientY,S=Math.sqrt(F*F+j*j);if(le>0){const A=S/le,O=c.position.distanceTo(new Fe(0,0,0));A>1&&O>50?c.position.multiplyScalar(1-.01):A<1&&O<800&&c.position.multiplyScalar(1+.01)}le=S}},D=t=>{t.preventDefault(),ie=!1,le=0,setTimeout(()=>{},3e3)},u=N.domElement;u.style.cursor="grab",u.addEventListener("mousedown",t=>{u.style.cursor="grabbing",be(t)}),u.addEventListener("mousemove",fe),u.addEventListener("mouseup",()=>{u.style.cursor="grab",r()}),u.addEventListener("mouseleave",()=>{u.style.cursor="grab",r()}),u.addEventListener("wheel",m),u.addEventListener("touchstart",x,{passive:!1}),u.addEventListener("touchmove",L,{passive:!1}),u.addEventListener("touchend",D,{passive:!1}),document.addEventListener("keydown",g);const je=()=>{$.current=requestAnimationFrame(je),k.current.forEach((t,F)=>{const j=t.planetData,S=t.semiMajorAxis,J=t.semiMinorAxis,A=j.orbital_period_seconds,O=2*Math.PI/A,Q=(j.initial_orbital_angle+I.current*O)%(2*Math.PI);t.position.x=S*Math.cos(Q),t.position.z=J*Math.sin(Q),t.position.y=0;const ce=j.rotation_period_seconds,ne=2*Math.PI/ce;if(t.rotation.y=I.current*ne%(2*Math.PI),l.current[F]){const f=t.geometry.parameters?.radius||2;l.current[F].position.copy(t.position),l.current[F].position.y+=f+10}}),N.render(d,c)};je();const we=()=>{const t=C.clientWidth,F=C.clientHeight;c.aspect=t/F,c.updateProjectionMatrix(),N.setSize(t,F)};return window.addEventListener("resize",we),()=>{window.removeEventListener("resize",we),document.removeEventListener("keydown",g),u.removeEventListener("mousedown",be),u.removeEventListener("mousemove",fe),u.removeEventListener("mouseup",r),u.removeEventListener("mouseleave",r),u.removeEventListener("wheel",m),u.removeEventListener("touchstart",x),u.removeEventListener("touchmove",L),u.removeEventListener("touchend",D),$.current&&cancelAnimationFrame($.current),C&&N.domElement&&C.removeChild(N.domElement),N.dispose(),k.current=[],T.current=[],l.current=[]}},[n,o,M]),e.jsx("div",{ref:B,className:"w-full h-full"})},pt=({planets:n,stars:o,systemName:y,cosmicOriginTime:M})=>{const w=s.useRef(null),E=s.useRef(null),B=s.useRef(null),i=s.useRef(null),v=s.useRef([]),$=s.useRef([]),k=s.useRef([]),T=s.useRef(0),l=Math.floor(Date.now()/1e3),[I,H]=s.useState(0),[C,P]=s.useState(!1),[R,d]=s.useState(!1),[c,N]=s.useState(!1),[V,Z]=s.useState(0),[G,U]=s.useState(null),[_,oe]=s.useState(!0),[pe,ie]=s.useState(null),ee=l-M+I;T.current=ee,s.useEffect(()=>{(async()=>{try{oe(!0),ie(null);const m=await fetch("/api/system/rendering-data");if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const g=await m.json();if(g.success)U(g.system_data);else throw new Error(g.error||"Failed to fetch system data")}catch(m){ie(m instanceof Error?m.message:"Unknown error")}finally{oe(!1)}})()},[]);const se=()=>{d(!0),setTimeout(()=>{P(!1),d(!1)},300)},le=(r,m="#ffffff")=>{const g=document.createElement("canvas"),x=g.getContext("2d");if(!x)return null;g.width=512,g.height=128,x.fillStyle="rgba(0, 0, 0, 0.7)",x.fillRect(0,0,g.width,g.height),x.strokeStyle="#ffffff",x.lineWidth=2,x.strokeRect(2,2,g.width-4,g.height-4),x.fillStyle=m,x.font="bold 32px Arial",x.textAlign="center",x.textBaseline="middle",x.fillText(r,256,64);const L=new Ue(g),D=new Ke({map:L,transparent:!0,alphaTest:.1}),u=new Ze(D);return u.scale.set(20,5,1),u};s.useEffect(()=>{const r=m=>{m.key==="Escape"&&C&&se()};return C&&Z(I),document.addEventListener("solar-system-close-fullscreen",se),document.addEventListener("keydown",r),()=>{document.removeEventListener("solar-system-close-fullscreen",se),document.removeEventListener("keydown",r)}},[C,I]),s.useEffect(()=>{if(C&&c){const r=setTimeout(()=>{N(!1)},50);return()=>clearTimeout(r)}},[C,c]),s.useEffect(()=>{if(_||!G||(window.tonnirLoggedInSystem=!1,!w.current))return;const r=w.current,m=r.clientWidth,g=m<640,x=new _e;x.background=new Ge(17),E.current=x;const L=new Oe(45,m/(g?120:140),.1,1e4);L.position.set(0,80,120),L.lookAt(0,0,0);const D=new Ie({antialias:!0,alpha:!0});D.setSize(m,g?120:140),D.setClearColor(17,1),B.current=D,r.appendChild(D.domElement);const u={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},je={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},we=new $e;G.stars.forEach((a,h)=>{const b=parseFloat(a.Size)*3,z=new me(b,16,16),Y=je[a.Color]||"#FFFF44",X=new ue({color:Y,transparent:!0,opacity:.9}),q=new he(z,X);G.stars.length===1?q.position.set(0,0,0):G.stars.length===2?q.position.set(h===0?-b*2:b*2,0,0):h===0?q.position.set(-b*2,0,0):h===1?q.position.set(b*2,0,0):q.position.set(0,b*2,0);const K=new me(b*1.5,16,16),ae=new ue({color:Y,transparent:!0,opacity:.3}),re=new he(K,ae);q.add(re),we.add(q)}),x.add(we);const t=G.timing.max_orbital_radius,F=80;window.systemMaxOrbitalRadius=t,G.planets.forEach((a,h)=>{const z=20+a.orbital_radius/t*F,Y=a.eccentricity_factor,X=z,q=X*Math.sqrt(1-Y*Y),K=360,ae=2,re=4;for(let ke=0;ke<K;ke+=ae+re){const Ae=[];for(let Me=ke;Me<Math.min(ke+ae,K-1);Me++){const Re=Me/K*2*Math.PI,Le=X*Math.cos(Re),Qe=q*Math.sin(Re);Ae.push(new Fe(Le,0,Qe))}if(Ae.length>1){const Me=new Ve().setFromPoints(Ae),Re=new Ye({color:7372944,transparent:!0,opacity:.8,linewidth:2}),Le=new Be(Me,Re);x.add(Le),$.current.push(Le)}}const ve=a.diameter/15e3,xe=Math.max(Math.min(ve,4),1.5),De=new me(xe,16,16),ye=u[a.planet_type]||"#FFFFFF",Ce=new ue({color:ye,transparent:!0,opacity:.9}),te=new he(De,Ce),Ne=new he(new me(xe*1.5,16,16),new ue({color:ye,transparent:!0,opacity:.2}));te.add(Ne),x.add(te),v.current.push(te),te.planetData=a,te.orbitRadius=z,te.semiMajorAxis=X,te.semiMinorAxis=q;const Se=a.name.replace(/_/g," "),ge=le(Se,"#ffffff");ge&&(ge.position.copy(te.position),ge.position.y+=xe+6,ge.planetData=a,x.add(ge),k.current.push(ge))});const j=new We(4210752,.4);x.add(j);const S=new He(16777215,1,1e3);S.position.set(0,0,0),x.add(S);let J=!1,A=0,O=0;const Q=a=>{J=!0,A=a.clientX,O=a.clientY},ce=a=>{if(!J)return;const h=a.clientX-A,b=a.clientY-O,z=new ze;z.setFromVector3(L.position),z.theta-=h*.01,z.phi+=b*.01,z.phi=Math.max(.1,Math.min(Math.PI-.1,z.phi)),L.position.setFromSpherical(z),L.lookAt(0,0,0),A=a.clientX,O=a.clientY},ne=()=>{J=!1,setTimeout(()=>{},3e3)},f=a=>{if(a.ctrlKey)a.preventDefault(),a.deltaY>0?H(h=>h+604800):H(h=>h-604800);else{a.preventDefault();const h=.1,b=L.position.distanceTo(new Fe(0,0,0));a.deltaY>0&&b<500?L.position.multiplyScalar(1+h):a.deltaY<0&&b>20&&L.position.multiplyScalar(1-h)}},p=D.domElement;p.style.cursor="grab",p.style.borderRadius="8px",p.addEventListener("mousedown",a=>{p.style.cursor="grabbing",Q(a)}),p.addEventListener("mousemove",ce),p.addEventListener("mouseup",()=>{p.style.cursor="grab",ne()}),p.addEventListener("mouseleave",()=>{p.style.cursor="grab",ne()}),p.addEventListener("wheel",f);const W=()=>{i.current=requestAnimationFrame(W),v.current.forEach((a,h)=>{const b=a.planetData,z=a.semiMajorAxis,Y=a.semiMinorAxis,X=b.orbital_period_seconds,q=2*Math.PI/X,K=(b.initial_orbital_angle+T.current*q)%(2*Math.PI);a.position.x=z*Math.cos(K),a.position.z=Y*Math.sin(K),a.position.y=0;const ae=b.rotation_period_seconds,re=2*Math.PI/ae;if(a.rotation.y=T.current*re%(2*Math.PI),k.current[h]){const ve=a.geometry.parameters?.radius||2;k.current[h].position.copy(a.position),k.current[h].position.y+=ve+6}}),D.render(x,L)};W();const de=()=>{const a=r.clientWidth,h=a<640?120:140;L.aspect=a/h,L.updateProjectionMatrix(),D.setSize(a,h)};return window.addEventListener("resize",de),()=>{window.removeEventListener("resize",de),p.removeEventListener("mousedown",Q),p.removeEventListener("mousemove",ce),p.removeEventListener("mouseup",ne),p.removeEventListener("mouseleave",ne),p.removeEventListener("wheel",f),i.current&&cancelAnimationFrame(i.current),r&&D.domElement&&r.removeChild(D.domElement),D.dispose(),v.current=[],$.current=[],k.current=[]}},[n,o,M,G]);const be=r=>{const m=Math.floor(r/31557600),g=Math.floor(r%(365.25*24*3600)/(24*3600)),x=Math.floor(r%(24*3600)/3600);return m>0?`${m}y ${g}d ${x}h`:g>0?`${g}d ${x}h`:`${x}h`},fe=r=>r.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2",children:"Solar System Perspective"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{ref:w,className:"w-full border border-white/20 rounded bg-black/20",style:{height:"auto"}}),e.jsx("button",{onClick:()=>{P(!0),N(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-[10px]",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-[10px]",children:[G?.planets?.length||n.length," Planets"]})]})]}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Time: ",be(ee)]})]}),e.jsx("div",{className:"text-center text-[10px] text-gray-500",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View"})]})]}),C&&qe.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${R||c?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${R||c?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:fe(y)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:fe(y)}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[G?.planets?.length||n.length," Planets"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Time: ",be(l-M+V)]})]})]}),e.jsx("button",{onClick:se,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2 sm:mb-4 px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"-15y"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"range",min:-15*365.25*24*3600,max:15*365.25*24*3600,step:604800,value:V,onChange:r=>Z(Number(r.target.value)),className:`w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer 
                               [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 
                               [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-400 
                               [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-600
                               [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg`}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-2 bg-yellow-400 rounded"})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"+15y"}),e.jsx("button",{onClick:()=>Z(0),className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors duration-200",title:"Reset to current time",children:"Now"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-1",children:["Time Travel: ",V===0?"Present":V>0?`+${Math.abs(V/(365.25*24*3600)).toFixed(1)} years`:`-${Math.abs(V/(365.25*24*3600)).toFixed(1)} years`," • Range: 30 years"]})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Je,{planets:G?.planets||n,stars:G?.stars||o,systemName:y,cosmicOriginTime:M,currentTime:l-M+V,onTimeOffsetChange:r=>Z(m=>m+r)})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},ft=({system:n,galaxy:o,systemIndex:y,cosmicOriginTime:M})=>{const[w,E]=s.useState({isOnCooldown:!1,isSaved:!1,isCollecting:!1,timeUntilNext:0});s.useEffect(()=>{let i;const v=()=>{const l=Te.generateLocationId("system",o.coordinates.join(","),y,void 0),I=Te.canCollectFromLocation(l),H=Te.getTimeUntilNextCollection(l),C=o.coordinates,P=Xe.generateSystemUrl(C,y,Xe.getCurrentPage()),d=nt.getLocations().some(c=>c.stargateUrl===P);E(c=>({isOnCooldown:!I&&H>0,isSaved:d,isCollecting:c.isCollecting,timeUntilNext:H}))},$=()=>{E(l=>({...l,isCollecting:!0})),i=setTimeout(()=>{E(l=>({...l,isCollecting:!1}))},1e3)};v();const k=setInterval(v,1e3),T=st.subscribe("mining_completed",$);return()=>{clearInterval(k),i&&clearTimeout(i),T()}},[n.name,y,o.coordinates]);const B=i=>i.replace(/_/g," ");return e.jsxs("div",{className:"h-full flex flex-col relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 flex gap-2 z-10",children:[e.jsx(ct,{locationType:"system",locationId:n.name,coordinates:o.coordinates.join(","),systemIndex:y,className:"text-xs"}),e.jsx(dt,{type:"system",name:n.name,coordinates:o.coordinates.join(","),systemIndex:y,className:"text-xs"}),e.jsx("div",{className:"inline-flex items-center bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] font-medium px-1.5 py-0.5 rounded h-[21px] box-border",children:"VISITED"})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(mt,{isOnCooldown:w.isOnCooldown,isSaved:w.isSaved,isCollecting:w.isCollecting}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white",children:"Details"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-blue-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"System Type"}),e.jsx("div",{className:"text-sm font-bold text-blue-300 capitalize",children:n.star_system_type})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Planets"}),e.jsx("div",{className:"text-sm font-bold text-purple-300",children:n.num_planets})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-orange-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200",children:"Stars"}),e.jsx("div",{className:"text-sm font-bold text-orange-300",children:n.stars.length})]})]}),e.jsx("div",{className:"bg-white/10 rounded-lg p-3 border border-gray-500/30 mb-3 col-span-3",children:e.jsx(pt,{planets:n.planets,stars:n.stars,systemName:n.name,cosmicOriginTime:M})}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 border border-yellow-500/30",children:[e.jsx("div",{className:"text-xs text-gray-200 mb-2",children:"Stellar Composition"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1",children:n.stars.map((i,v)=>e.jsxs("div",{className:"bg-white/5 rounded p-1.5 border border-yellow-500/20",children:[e.jsxs("div",{className:"text-xs text-gray-300",children:["Star ",v+1]}),e.jsx("div",{className:"text-xs font-bold text-yellow-300",children:i.Type}),e.jsxs("div",{className:"text-xs text-gray-300",children:[i.Color," • ",i.Size]})]},v))})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Technical Data"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("div",{className:"text-green-400 font-medium",children:"Visited"})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"System:"}),e.jsx("div",{className:"text-white truncate font-medium",children:B(n.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"System ID:"}),e.jsxs("div",{className:"text-white font-medium",children:["#",y+1]})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Galaxy:"}),e.jsx("div",{className:"text-white truncate font-medium",children:B(o.name)})]}),e.jsxs("div",{className:"bg-white/5 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:"text-gray-400",children:"Coordinates:"}),e.jsx("div",{className:"text-white font-medium",children:o.coordinates.join(", ")})]})]})]})]})},gt=({planets:n,stars:o,systemName:y,cosmicOriginTime:M})=>{const w=s.useRef(null),E=s.useRef(null),B=s.useRef(null),i=s.useRef(null),v=s.useRef([]),$=s.useRef([]),k=s.useRef([]),T=s.useRef(null),l=s.useRef(0),I=Math.floor(Date.now()/1e3),[H,C]=s.useState(0),[P,R]=s.useState(!1),[d,c]=s.useState(!1),[N,V]=s.useState(!1),[Z,G]=s.useState(0),[U,_]=s.useState(null),[oe,pe]=s.useState(!0),[ie,ee]=s.useState(null),se=I-M+H;l.current=se,s.useEffect(()=>{(async()=>{try{pe(!0),ee(null);const m=await fetch("/api/system/rendering-data");if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const g=await m.json();if(g.success)_(g.system_data);else throw new Error(g.error||"Failed to fetch system data")}catch(m){ee(m instanceof Error?m.message:"Unknown error")}finally{pe(!1)}})()},[]);const le=()=>{c(!0),setTimeout(()=>{R(!1),c(!1)},300)};s.useEffect(()=>{const r=m=>{m.key==="Escape"&&P&&le()};return P&&G(H),document.addEventListener("solar-system-close-fullscreen",le),document.addEventListener("keydown",r),()=>{document.removeEventListener("solar-system-close-fullscreen",le),document.removeEventListener("keydown",r)}},[P,H]),s.useEffect(()=>{if(P&&N){const r=setTimeout(()=>{V(!1)},50);return()=>clearTimeout(r)}},[P,N]),s.useEffect(()=>{if(oe||!U||(window.tonnirLoggedInSystem=!1,!w.current))return;const r=w.current,m=r.clientWidth,g=r.clientHeight,x=Math.min(m,g),L=new _e;L.background=new Ge(17),E.current=L;const D=new Oe(45,1,.1,1e4);D.position.set(0,300,0),D.lookAt(0,0,0);const u=new Ie({antialias:!0,alpha:!0});u.setSize(x,x),u.setClearColor(17,1),B.current=u,r.appendChild(u.domElement);const je={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"},we={red:"#FF4444",orange:"#FF8844",yellow:"#FFFF44",white:"#FFFFFF",blue:"#4488FF",purple:"#8844FF"},t=new $e;U.stars.forEach((f,p)=>{const W=parseFloat(f.Size)*3,de=new me(W,16,16),a=we[f.Color]||"#FFFF44",h=new ue({color:a,transparent:!0,opacity:.9}),b=new he(de,h);U.stars.length===1?b.position.set(0,0,0):U.stars.length===2?b.position.set(p===0?-W*2:W*2,0,0):p===0?b.position.set(-W*2,0,0):p===1?b.position.set(W*2,0,0):b.position.set(0,W*2,0);const z=new me(W*1.5,16,16),Y=new ue({color:a,transparent:!0,opacity:.3}),X=new he(z,Y);b.add(X),t.add(b)}),L.add(t);const F=U.timing.max_orbital_radius,j=80;window.systemMaxOrbitalRadius=F,U.planets.forEach((f,p)=>{const de=20+f.orbital_radius/F*j,a=f.eccentricity_factor,h=de,b=h*Math.sqrt(1-a*a),z=360,Y=2,X=4;for(let ye=0;ye<z;ye+=Y+X){const Ce=[];for(let te=ye;te<Math.min(ye+Y,z-1);te++){const Ne=te/z*2*Math.PI,Se=h*Math.cos(Ne),ge=b*Math.sin(Ne);Ce.push(new Fe(Se,0,ge))}if(Ce.length>1){const te=new Ve().setFromPoints(Ce),Ne=new Ye({color:7372944,transparent:!0,opacity:.8,linewidth:2}),Se=new Be(te,Ne);L.add(Se),$.current.push(Se)}}const q=f.diameter/15e3,K=Math.max(Math.min(q,4),1.5),ae=new me(K,16,16),re=je[f.planet_type]||"#FFFFFF",ve=new ue({color:re,transparent:!0,opacity:.9}),xe=new he(ae,ve),De=new he(new me(K*1.5,16,16),new ue({color:re,transparent:!0,opacity:.2}));xe.add(De),L.add(xe),v.current.push(xe),xe.planetData=f,xe.orbitRadius=de,xe.semiMajorAxis=h,xe.semiMinorAxis=b,k.current.push(null)});const S=new We(4210752,.4);L.add(S);const J=new He(16777215,1,1e3);J.position.set(0,0,0),L.add(J);const A=new ht(D,u.domElement);A.enableDamping=!0,A.dampingFactor=.05,A.minDistance=50,A.maxDistance=800,A.autoRotate=!1,A.autoRotateSpeed=.5,A.enablePan=!0,A.enableZoom=!0,A.target.set(0,0,0),T.current=A;const O=f=>{if(f.ctrlKey)f.preventDefault(),f.deltaY>0?C(p=>p+604800):C(p=>p-604800);else{f.preventDefault();const p=.1,W=D.position.distanceTo(new Fe(0,0,0));f.deltaY>0&&W<500?D.position.multiplyScalar(1+p):f.deltaY<0&&W>20&&D.position.multiplyScalar(1-p)}},Q=u.domElement;Q.style.borderRadius="8px",Q.addEventListener("wheel",O);const ce=()=>{i.current=requestAnimationFrame(ce),v.current.forEach((f,p)=>{const W=f.planetData,de=f.semiMajorAxis,a=f.semiMinorAxis,h=W.orbital_period_seconds,b=2*Math.PI/h,z=(W.initial_orbital_angle+l.current*b)%(2*Math.PI);f.position.x=de*Math.cos(z),f.position.z=a*Math.sin(z),f.position.y=0;const Y=W.rotation_period_seconds,X=2*Math.PI/Y;f.rotation.y=l.current*X%(2*Math.PI)}),T.current&&T.current.update(),u.render(L,D)};ce();const ne=()=>{if(!w.current||!u)return;const f=w.current,p=Math.min(f.clientWidth,f.clientHeight);u.setSize(p,p),D.aspect=1,D.updateProjectionMatrix()};return window.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),Q.removeEventListener("wheel",O),T.current&&T.current.dispose(),i.current&&cancelAnimationFrame(i.current),r&&u.domElement&&r.removeChild(u.domElement),u.dispose(),v.current=[],$.current=[],k.current=[]}},[n,o,M,U,H]);const be=r=>{const m=Math.floor(r/31557600),g=Math.floor(r%(365.25*24*3600)/(24*3600)),x=Math.floor(r%(24*3600)/3600);return m>0?`${m}y ${g}d ${x}h`:g>0?`${g}d ${x}h`:`${x}h`},fe=r=>r.replace(/_/g," ");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col items-center w-full h-full",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{ref:w,className:"w-full h-full border border-white/20 rounded bg-black/20"}),e.jsx("button",{onClick:()=>{R(!0),V(!0)},className:"absolute top-2 right-2 p-2 bg-black/60 hover:bg-black/80 border border-white/30 rounded-lg transition-all duration-200 backdrop-blur-sm shadow-lg z-10",title:"Expand to fullscreen",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]})}),P&&qe.createPortal(e.jsx("div",{className:`fixed inset-0 z-50 bg-black/95 backdrop-blur-xl transition-all duration-300 ${d||N?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:e.jsxs("div",{className:`w-full h-full flex flex-col p-1 sm:p-2 transition-all duration-300 delay-75 ${d||N?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-4",children:[e.jsx("div",{className:"block sm:hidden",children:e.jsx("h2",{className:"text-xs font-medium text-white",children:fe(y)})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-4 flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:fe(y)}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Star(s)"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-300",children:[U?.planets?.length||n.length," Planets"]})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Time: ",be(I-M+Z)]})]})]}),e.jsx("button",{onClick:le,className:"p-0.5 sm:p-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 rounded transition-colors duration-200 text-red-400 hover:text-red-300",title:"Close",children:e.jsx("svg",{className:"w-3 h-3 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-2 sm:mb-4 px-2 sm:px-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"-15y"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"range",min:-15*365.25*24*3600,max:15*365.25*24*3600,step:604800,value:Z,onChange:r=>G(Number(r.target.value)),className:`w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer 
                               [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-5 [&::-webkit-slider-thumb]:h-5 
                               [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-400 
                               [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-600
                               [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-lg`}),e.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-2 bg-yellow-400 rounded"})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-400 min-w-fit",children:"+15y"}),e.jsx("button",{onClick:()=>G(0),className:"px-2 py-1 text-xs bg-gray-600 hover:bg-gray-500 text-white rounded transition-colors duration-200",title:"Reset to current time",children:"Now"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-1",children:["Time Travel: ",Z===0?"Present":Z>0?`+${Math.abs(Z/(365.25*24*3600)).toFixed(1)} years`:`-${Math.abs(Z/(365.25*24*3600)).toFixed(1)} years`," • Range: 30 years"]})]}),e.jsx("div",{className:"flex-1 border border-white/20 rounded-lg bg-black/20 overflow-hidden min-h-0",children:e.jsx(Je,{planets:U?.planets||n,stars:U?.stars||o,systemName:y,cosmicOriginTime:M,currentTime:I-M+Z,onTimeOffsetChange:r=>G(m=>m+r)})}),e.jsxs("div",{className:"mt-2 sm:mt-4 text-center text-xs sm:text-sm text-gray-400",children:[e.jsx("div",{className:"hidden sm:block",children:"Scroll: Zoom • Ctrl+Scroll: +1week/-1week • Drag: Rotate View • ESC: Close"}),e.jsx("div",{className:"sm:hidden",children:"Pinch: Zoom • Drag: Rotate • ESC: Close"})]})]})}),document.body)]})},bt=({systemUrl:n,system:o,cosmicOriginTime:y})=>{const M=s.useRef(null),[w,E]=s.useState("Aligning Stargate..."),[B,i]=s.useState(!1),[v,$]=s.useState(!1),[k,T]=s.useState(!1);return s.useEffect(()=>{const l=M.current;if(!l)return;const I=l.getContext("2d");if(!I)return;let H=[];const C=800;let P,R;const d=800;let c,N=.5;function V(){const _=l?.parentElement;if(!_||!l)return;const oe=_.clientWidth,pe=_.clientHeight;l.width=Math.min(oe,d),l.height=Math.min(pe,d),P=l.width/2,R=l.height/2}function Z(){V(),H=[];for(let _=0;_<C;_++)H.push({x:Math.random()*(l?.width||800),y:Math.random()*(l?.height||800),z:Math.random()*(l?.width||800),o:Math.random()});G()}function G(){!l||!I||(I.clearRect(0,0,l.width,l.height),H.forEach(_=>{_.z-=N,_.z<=0&&(_.z=l.width,_.x=Math.random()*l.width,_.y=Math.random()*l.height,_.o=Math.random());const oe=l.width/_.z,pe=(_.x-P)*oe+P,ie=(_.y-R)*oe+R,ee=2*oe;I.beginPath(),I.fillStyle=`rgba(255, 255, 255, ${_.o})`,I.arc(pe,ie,ee,0,2*Math.PI),I.fill()}),N<60&&(N+=1),c=requestAnimationFrame(G))}Z();const U=()=>V();return window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U),c&&cancelAnimationFrame(c)}},[]),s.useEffect(()=>{$(!0),setTimeout(()=>{T(!0)},800)},[]),s.useEffect(()=>{if(sessionStorage.getItem("stargateAnimationShown")){E("Stargate system aligned");return}sessionStorage.setItem("stargateAnimationShown","true"),i(!0);const I=(d,c)=>Array.from({length:c},()=>d[Math.floor(Math.random()*d.length)]).join(""),H=[{chars:"01",duration:40,iterations:20},{chars:"0123456789",duration:25,iterations:30},{chars:"0123456789ABCDEF",duration:20,iterations:40},{chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-_=+[]{}|;:\\'\",.<>?/`~",duration:10,iterations:100}];let C=0,P=0;const R=()=>{if(C>=H.length){const c="Stargate system aligned";let N=0;E("");const V=()=>{N<c.length?(E(c.substring(0,N+1)),N++,setTimeout(V,30)):i(!1)};V();return}const d=H[C];E(I(d.chars,32)),P++,P>=d.iterations&&(C++,P=0),setTimeout(R,d.duration)};R()},[]),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-medium text-white",children:o?.name||"System"})}),e.jsxs("div",{className:"relative w-full max-w-80 sm:max-w-96 aspect-square mx-auto bg-black flex justify-center items-center rounded-xl overflow-hidden border-2 border-blue-400/30 mb-4",children:[e.jsx("canvas",{ref:M,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-[2500ms] ${k?"opacity-0":"opacity-100"}`,style:{filter:k?"blur(50px)":"none"}}),v&&o&&e.jsx("div",{className:`absolute inset-0 w-full h-full transition-all duration-500 ${v&&k?"opacity-100 blur-0":"opacity-0 blur-[25px]"}`,children:e.jsx(gt,{planets:o.planets,stars:o.stars,systemName:o.name,cosmicOriginTime:y||0})})]}),e.jsxs("div",{className:"text-center mt-auto",children:[e.jsxs("a",{href:n,className:`inline-block px-4 py-2 bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 text-gray-200 font-medium text-sm rounded-lg border border-slate-600 hover:border-slate-500 shadow-md hover:shadow-lg transition-all duration-300 relative overflow-hidden group ${B?"animate-pulse":""}`,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:[e.jsxs("span",{className:"relative z-10 font-mono flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6s.792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95a1 1 0 001.715 1.029zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM10 14c-.304 0-.792-.193-1.264-.979a1 1 0 00-1.715 1.029C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 00-1.715-1.029C10.792 13.807 10.304 14 10 14z",clipRule:"evenodd"})}),w]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-slate-600/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500 text-center",children:"Gateway to the stars"})]})]})},wt=({planets:n,coordinates:o,systemIndex:y})=>{const[M,w]=s.useState(new Set);s.useEffect(()=>{(()=>{try{const v=at(o,y,n),$=new Set;v.forEach(k=>{$.add(k.toLowerCase())}),w($)}catch{}})()},[o,y,n]);const E=i=>i.replace(/_/g," "),B=i=>{try{rt(o,y,i,n)}catch{}window.location.href=`/planet/${i.toLowerCase()}`};return e.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 shadow-2xl p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:n.map(i=>e.jsxs("div",{className:"relative bg-white/10 rounded-lg border border-white/20 hover:bg-white/20 hover:border-white/40 transition-all duration-300 group",children:[M.has(i.name.toLowerCase())&&e.jsx("div",{className:"absolute top-1 right-1 bg-green-500/20 border border-green-500/50 text-green-400 text-[10px] px-1.5 py-0.5 rounded z-10",children:"VISITED"}),e.jsxs("button",{onClick:()=>B(i.name),className:"w-full text-left block p-2 sm:p-3 text-gray-200 hover:text-white transition-colors duration-300 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Planet"}),e.jsx("div",{className:"text-sm font-semibold text-white truncate group-hover:text-blue-300 transition-colors duration-300",children:E(i.name)})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})]},i.name))}),n.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-lg mb-2",children:"No planets found"}),e.jsx("div",{className:"text-gray-500 text-sm",children:"This system appears to be empty"})]})]})},vt=({currentSystem:n,galaxy:o})=>{const[y,M]=s.useState(!1),[w,E]=s.useState(!1),[B,i]=s.useState(!0);s.useEffect(()=>{M(n.index>0),E(!0),i(!1)},[n.index]);const v=async()=>{if(n.index>0){if(!Ee.canAffordTravel("system",1)){Ee.executeTravel("system",1);return}if(!Ee.executeTravel("system",1))return;const T=o.coordinates.join(",");Pe(T,n.index-1),window.location.href=`/system/${n.index-1}`}},$=async()=>{if(!Ee.canAffordTravel("system",1)){Ee.executeTravel("system",1);return}if(!Ee.executeTravel("system",1))return;const T=o.coordinates.join(",");Pe(T,n.index+1),window.location.href=`/system/${n.index+1}`};return B?null:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:v,disabled:!y,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${y?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:$,disabled:!w,className:`flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 ${w?"bg-white/10 hover:bg-white/20 border border-white/20 text-white hover:text-blue-300":"bg-white/5 border border-white/10 text-gray-600 cursor-not-allowed"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})},yt=({system:n,galaxy:o,system_url:y,version:M,system_index:w,image_url:E,page:B,cosmic_origin_time:i})=>{const[v]=s.useState(o.coordinates.join(","));s.useEffect(()=>{document.body.setAttribute("data-coordinates",v),document.body.setAttribute("data-system-index",w.toString()),Pe(v,w)},[v,w]);const $=T=>T.replace(/_/g," "),k=T=>T.replace(/_/g," ");return e.jsxs("div",{className:"w-full h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='1'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),e.jsx(ot,{}),e.jsxs("div",{className:"relative z-10 pt-1",children:[e.jsx(it,{}),e.jsxs("div",{className:"w-full px-2 sm:px-4 lg:px-6 py-4 sm:py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent mb-2",children:["System '",$(n.name),"'"]}),e.jsxs("p",{className:"text-lg sm:text-xl text-gray-300",children:["at Galaxy '",k(o.name),"' - Coordinates ",o.coordinates.join(", ")]})]}),e.jsx(vt,{currentSystem:{name:n.name,index:w},galaxy:o}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-[400px_1fr] gap-6 lg:gap-8 relative",children:[e.jsx("div",{className:"order-1 lg:order-1",children:e.jsx(bt,{systemUrl:y,system:n,cosmicOriginTime:i})}),e.jsx("div",{className:"hidden lg:block absolute left-[416px] top-0 bottom-0 w-1 rounded-full bg-white/10 -translate-x-1.5"}),e.jsx("div",{className:"order-2 lg:order-2",children:e.jsx(ft,{system:n,galaxy:o,systemIndex:w,cosmicOriginTime:i})})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:["Planets in '",$(n.name),"'"]}),e.jsx(wt,{planets:n.planets,coordinates:v,systemIndex:w})]}),e.jsx("div",{className:"bg-white/5 backdrop-blur-lg rounded-2xl border border-white/10 mb-8 shadow-2xl p-4 sm:p-6 text-center",children:e.jsx("button",{onClick:()=>window.location.href=`/galaxy/${B}`,className:"w-full sm:w-auto px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-gray-600 via-gray-700 to-gray-600 hover:from-gray-700 hover:via-gray-800 hover:to-gray-700 text-white font-bold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg backdrop-blur-sm",children:e.jsxs("span",{className:"text-base sm:text-lg",children:["← Back to Galaxy '",k(o.name),"'"]})})})]}),e.jsx(xt,{version:M})]}),e.jsx(ut,{}),e.jsx(lt,{currentLocation:{type:"system",name:n.name,coordinates:o.coordinates.join(","),systemIndex:n.index}})]})};document.addEventListener("DOMContentLoaded",async()=>{try{const n=document.getElementById("system-data"),o=document.getElementById("galaxy-data"),y=document.getElementById("meta-data");if(!n||!o||!y)return;const M=JSON.parse(n.textContent||"{}"),w=JSON.parse(o.textContent||"{}"),E=JSON.parse(y.textContent||"{}"),B={system:M,galaxy:w,system_url:E.system_url,version:E.version,system_index:E.system_index,image_url:E.image_url,page:E.page||1,cosmic_origin_time:E.cosmic_origin_time},i=document.getElementById("atlas-react-root");i&&et.createRoot(i).render(tt.createElement(yt,B))}catch{}});
