import{c as Le,A as we,S as $e}from"./atlas_D5TkNrZ-UIh1OV1m_7qMi.js";import{c as Ae,R as ke}from"./atlas_h1YJrWIHJ8GIijiANgDab.js";import{c as fe,A as Ge,a as u,b as D,d as We,e as Ne}from"./atlas_CjYZLswrAeQ6o35MTpGmn.js";import{c as h}from"./atlas_HbWinxsYJykT4bAyTbY8I.js";import{c as y,L as ee,a as Oe}from"./atlas_DeDF8aLbVQNoQGifdv_s_.js";import{c as ne}from"./atlas_BArexBkuWQYyRkQof9gKO.js";import{c as ae,T as ze,a as Be,b as Ve,d as He}from"./atlas_D8HnRHg-T3829cT32vrpr.js";import{c as de,T as qe}from"./atlas_B1O444XwqLMfTlgIH8CCo.js";import{c as se,R as Ue}from"./atlas_BZHXJLIP5MemxI14IcYe9.js";import{P as je,c as Ye}from"./atlas_BLj9txaC9WkCe-yDdtyas.js";import{g as C,c as Ke,P as Je}from"./atlas_DKx8078aWX3rJjjGj5Axe.js";import{P as Qe}from"./atlas_B2-pJMNWYXxyj-B-RssSJ.js";import{c as le}from"./atlas_BXbcwSx6fzBvbs3eGmSfk.js";import{c as _e}from"./atlas_CZCzHQxzVm3Wx1WCYhNaI.js";import{c as me}from"./atlas_Dcasksb0GWEjH1uRFF86v.js";import{c as F}from"./atlas_DbRTf8R4bLgIQwcwinLe1.js";import{c as Xe}from"./atlas_CXo_uPIQMEoZfbuWEe4yJ.js";import{c as Ze}from"./atlas_BxR8EK1lUkfM1bhn6B5WF.js";import{c as Re}from"./atlas_dTjkx2eOeyibkJ3kbr7FP.js";import{c as te,T as De}from"./atlas_BssYco3rxuKH59tsmgzgR.js";import{E as es,c as ue}from"./atlas_B6vR9JHEJE1N9BaFfu-46.js";import{c as he,E as ss}from"./atlas_DR1L1QhM3B-GjY2M1yNBl.js";import{c as pe,C as ts}from"./atlas_Crz0A88G1BDMv-7lj1KO6.js";import{c as is,V as cs}from"./atlas_B4wiSb2oeBvKoxoqy1f7w.js";import{c as rs,M as os}from"./atlas_BA2agnhlUJ2nxZYMhIaMm.js";import{c as fs,M as ns}from"./atlas_CmHXsxrEu4vc-ZwffDBFw.js";import{C as as,c as ds}from"./atlas_CcxlL7GoKEbb7f6SMK3yb.js";import{c as ls,T as _s}from"./atlas_hkcQqnUQmbUPJtyV97BSo.js";import{c as ye,A as ms}from"./atlas_CNrkG-0gPvzDXk6IOIjAn.js";import{c as us,S as hs}from"./atlas_D1UuTausyRSrA9v8uuSaI.js";import{P as ie}from"./atlas_B7IullEdKWbqELG_4ujzy.js";import{F as ge}from"./atlas_CMWmquRsZlZEqR2vAiJlU.js";import{c as ps,O as ys}from"./atlas_BEyIEMT2j0j5-esqVO4U2.js";import{c as Ee,F as gs}from"./atlas_B85T-P50c_in1Wnp_8HxC.js";import{c as Se,A as Es}from"./atlas_Bu2VgJv3sCWZGqWlP3y0h.js";import{c as be,O as Ss}from"./atlas_DxcFU0mT9_b0HlKXFN5wv.js";import{c as Ie,L as bs}from"./atlas_DC69cYYG0vadLYoYhM77y.js";import{c as Is,L as Cs}from"./atlas_wMmwftNKnoVgFFp7PaKIW.js";import{c as Ce,M as xs}from"./atlas_BK0_EU3vJESuw7Gksm7xY.js";import{c as Ts,F as Ps}from"./atlas_nw3XvAywbGH6CbuSkVo0L.js";import{c as vs,C as Ms}from"./atlas_A5cqO8LVz3jZ7aQzuympI.js";import{c as Fs,R as Ls}from"./atlas_0Q7ZTau1DuZY2NtQggBqG.js";import{c as xe}from"./atlas_YWP1D0MIvR25XCvuvhbHT.js";import{c as ws,L as $s}from"./atlas_CCiLCpGPElUDBfPAxK3kY.js";import{c as As,L as ks}from"./atlas_xC7GHqs1VGh6F2sCRTUUD.js";import{c as Gs,L as Ws}from"./atlas_4K-jkKCoCp2H9jneMtIEs.js";import{c as Ns,L as Os}from"./atlas_79rl8tzgmmjQNzGiyyJWi.js";import{c as zs,L as Bs}from"./atlas_Um4vVhXkf6-PvYBKpJe19.js";import{c as Vs,L as Hs}from"./atlas_DxyEAomS066Akv_FnLGNj.js";import{c as qs,V as Us}from"./atlas_DrrZP6yBy2gGjX3LbulUM.js";import{m as Te,C as ce}from"./atlas_Bd-08EnGHvuA4jxvJ1T-8.js";const js=!1;class jt{creators=new Map;effects=new Map;nextId=1;layerSystem;baseColor;constructor(){this.registerDefaultEffects()}registerDefaultEffects(){this.registerEffect("atmosphere_glow",{create:(e,t)=>new Ge(t,e),fromPythonData:(e,t)=>fe(t,e.atmosphere||{})}),this.registerEffect("atmosphere_clouds",{create:(e,t)=>new D(t,e),fromPythonData:(e,t)=>u(t,e.surface_elements||{},void 0,e.timing?.cosmic_origin_time)}),this.registerEffect("atmospheric_streaks",{create:(e,t)=>new ms(t,e),fromPythonData:(e,t)=>ye(t,e.atmosphere||{})}),this.registerEffect("atmosphere",{create:(e,t)=>new Ne(t,e),fromPythonData:(e,t)=>We(t,e)}),this.registerEffect("ring_system",{create:(e,t)=>new ke(t,e),fromPythonData:(e,t)=>Ae(e.rings||{},t)}),this.registerEffect("fragmentation",{create:(e,t)=>new ge(t,e),fromPythonData:(e,t)=>new ge(t,{color:e.surface?.fragment_color||[.3,.3,.3],fragmentCount:e.surface?.fragment_count||20})}),this.registerEffect("land_masses",{create:(e,t)=>new ee(t,e),fromPythonData:(e,t)=>y(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("ocean_waves",{create:(e,t)=>new ys(e),fromPythonData:(e,t)=>ps(e)}),this.registerEffect("aquifer_water",{create:(e,t,r)=>new Es(r,e),fromPythonData:(e,t,r)=>Se(r,e)}),this.registerEffect("ocean_currents",{create:(e,t,r)=>new Ss(r,e),fromPythonData:(e,t,r)=>be(r,e)}),this.registerEffect("fluid_layers",{create:(e,t)=>new gs(t,e),fromPythonData:(e,t)=>Ee(t,e)}),this.registerEffect("lava_flows",{create:(e,t)=>new bs(t,e),fromPythonData:(e,t)=>Ie(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("lava_rivers",{create:(e,t,r)=>new Cs(t,e),fromPythonData:(e,t,r)=>Is(e,t)}),this.registerEffect("molten_lava",{create:(e,t,r)=>new xs(r,e),fromPythonData:(e,t,r)=>Ce(r,e,e.seeds?.planet_seed)}),this.registerEffect("fire_eruption",{create:(e,t)=>new Ps(t,e),fromPythonData:(e,t,r)=>Ts(e,t)}),this.registerEffect("carbon_trails",{create:(e,t)=>new Ms(t,e),fromPythonData:(e,t,r)=>vs(e,t)}),this.registerEffect("radiation_rings",{create:(e,t)=>new Ls(t,e),fromPythonData:(e,t)=>Fs(t,e,e.seeds?.planet_seed)}),this.registerEffect("life_form_intelligent_life",{create:(e,t)=>new $s(t,e),fromPythonData:(e,t)=>ws(t,e,e.seeds?.planet_seed)}),this.registerEffect("life_form_silicon_based_life",{create:(e,t)=>new ks(t,e),fromPythonData:(e,t)=>As(t,e,e.seeds?.planet_seed)}),this.registerEffect("life_form_non_physical_entity",{create:(e,t)=>new Ws(t,e),fromPythonData:(e,t)=>Gs(t,e,e.seeds?.planet_seed)}),this.registerEffect("life_form_conscious_gas",{create:(e,t)=>new Os(t,e),fromPythonData:(e,t)=>Ns(t,e,e.seeds?.planet_seed)}),this.registerEffect("life_form_robotic_entities",{create:(e,t)=>new Bs(t,e),fromPythonData:(e,t)=>zs(t,e,e.seeds?.planet_seed)}),this.registerEffect("life_form_god",{create:(e,t)=>new Hs(t,e),fromPythonData:(e,t)=>Vs(t,e,e.seeds?.planet_seed)}),this.registerEffect("crystal_formations",{create:(e,t)=>null}),this.registerEffect("star_field",{create:(e,t)=>new hs(t,e),fromPythonData:(e,t)=>us(t,e.seeds?.planet_seed||e.planet_seed)}),this.registerEffect("tundra_snowflakes",{create:(e,t)=>new ze(t,e),fromPythonData:(e,t)=>ae(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("toxic_post_processing",{create:(e,t)=>null,fromPythonData:(e,t)=>null}),this.registerEffect("toxic_waste_render",{create:(e,t)=>new qe(t,e),fromPythonData:(e,t)=>de(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("river_lines",{create:(e,t)=>new Ue(t,e),fromPythonData:(e,t)=>se(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("anomaly_phase_matter",{create:(e,t)=>new we(t,e),fromPythonData:(e,t)=>Le(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("pulsating_cube",{create:(e,t)=>new je(t,e),fromPythonData:(e,t)=>{const r=C(e);return Ye(t,e.surface_elements||{},e.seeds?.planet_seed,r,e)}}),this.registerEffect("planet_rays",{create:(e,t)=>new Je(t,e),fromPythonData:(e,t)=>Ke(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("visual_debug_3d",{create:(e,t)=>new Us(t,e),fromPythonData:(e,t)=>qs(e,t)}),this.registerEffect("terrain_cracks",{create:(e,t)=>new De({...e,radius:t}),fromPythonData:(e,t)=>te(e,t,e.seeds?.shape_seed||e.seeds?.planet_seed)}),this.registerEffect("exotic_geometric_shapes",{create:(e,t)=>new es(t,e),fromPythonData:(e,t)=>{const r=C(e);return ue(t,e.surface_elements||{},e.seeds?.planet_seed,r)}}),this.registerEffect("exotic_doodles",{create:(e,t)=>new ss(t,e),fromPythonData:(e,t)=>he(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("cave_surface_holes",{create:(e,t,r)=>new ts(t,e),fromPythonData:(e,t,r)=>pe(t,e,e.seeds?.planet_seed)}),this.registerEffect("vegetation",{create:(e,t,r)=>new cs(t,e),fromPythonData:(e,t,r)=>is(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time)}),this.registerEffect("crystalline_surface",{create:(e,t,r)=>new as(t,e),fromPythonData:(e,t,r)=>{const o=C(e);return ds(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time,void 0,o)}}),this.registerEffect("toxic_swamp_bubbles",{create:(e,t)=>new _s(t,e),fromPythonData:(e,t)=>ls(t,e.surface_elements||{},e.seeds?.planet_seed)}),this.registerEffect("magma_flows",{create:(e,t,r)=>new os(t,e),fromPythonData:(e,t,r)=>rs(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time)}),this.registerEffect("magma_eruptions",{create:(e,t,r)=>new ns(t,e),fromPythonData:(e,t,r)=>fs(t,e.surface_elements||{},e.seeds?.planet_seed,e.timing?.cosmic_origin_time)})}registerEffect(e,t){this.creators.set(e,t)}createEffect(e,t,r,o,m=0){const f=this.creators.get(e);if(!f)return null;try{const l=f.create(t,r,this.layerSystem);if(!l)return null;const g={id:`effect_${this.nextId++}`,type:e,effect:l,priority:m,enabled:!0};return this.effects.set(g.id,g),g}catch{return null}}createEffectFromPythonData(e,t,r,o,m=0){const f=this.creators.get(e);if(!f||!f.fromPythonData)return this.createEffect(e,t,r,o,m);try{const l=f.fromPythonData(t,r,this.layerSystem);if(!l)return null;const g={id:`effect_${this.nextId++}`,type:e,effect:l,priority:m,enabled:!0};return this.effects.set(g.id,g),g}catch{return null}}createEffectsFromList(e,t,r){const o=[],m=e.sort((f,l)=>(f.priority||0)-(l.priority||0));for(const f of m){const l=this.createEffect(f.type,f.params,t,r,f.priority);l&&(l.enabled=f.enabled!==!1,o.push(l))}return o}createEffectsFromPythonPlanetData(e,t,r,o,m){const f=[];try{const l=C(e);if(this.baseColor=l,m?this.layerSystem=m:this.layerSystem=new Qe(r,l),e.surface_elements){const i=e.surface_elements;if(i.effects_3d&&Array.isArray(i.effects_3d))for(const p of i.effects_3d){if(p.type==="atmospheric_streaks"){const b=ye(t,p.params,e.seeds?.shape_seed+3e3),I={id:`effect_${this.nextId++}`,type:"atmospheric_streaks",effect:b,priority:p.priority||0,enabled:!0,name:"Atmospheric Streaks"};this.effects.set(I.id,I),f.push(I),b.addToScene(o,r.position);continue}const E=this.createEffect(p.type,p.params,t,r,p.priority||0);E&&(E.name=p.type.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase()),f.push(E),E.effect.apply&&E.effect.apply(r),E.effect.addToScene&&E.effect.addToScene(o,r.position))}switch(i.type.toLowerCase()){case"gas_giant":if(this.layerSystem){const s=le(this.layerSystem,{...i,base_color:l,turbulence:e.turbulence||i.turbulence},e.seeds?.shape_seed||e.seeds?.planet_seed||e.seeds?.planet_seed),c=_e(this.layerSystem,{...i,base_color:l,storm_intensity:e.storm_intensity||i.storm_intensity},(e.seeds?.shape_seed||e.seeds?.planet_seed)+1e3),n={id:`effect_${this.nextId++}`,type:"cloud_bands_layer",effect:s,priority:0,enabled:!0};this.effects.set(n.id,n),f.push(n);const a={id:`effect_${this.nextId++}`,type:"cloud_gyros_layer",effect:c,priority:1,enabled:!0};if(this.effects.set(a.id,a),f.push(a),i.polar_hexagon&&i.polar_hexagon.enabled){const d=e.timing?.elapsed_time?e.timing.elapsed_time/31557600:0,_=new ie({planetColor:l,hexagonData:i.polar_hexagon,planetRadius:t,currentTime:d}),S={id:`effect_${this.nextId++}`,type:"polar_hexagon",effect:_,priority:10,enabled:!0};this.effects.set(S.id,S),f.push(S),o&&_.addToScene(o)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const d=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),_={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:d,priority:12,enabled:!0};this.effects.set(_.id,_),f.push(_),o&&d.addToScene(o)}if(i.atmosphere_clouds&&i.atmosphere_clouds.clouds&&i.atmosphere_clouds.clouds.length>0){const d=u(t,i.atmosphere_clouds,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(d){const _={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:d,priority:15,enabled:!0,name:"Gas Giant Atmosphere Clouds"};this.effects.set(_.id,_),f.push(_),d.addToScene(o,r.position)}}}break;case"frozen_gas_giant":if(this.layerSystem){const s=le(this.layerSystem,{...i,base_color:l,turbulence:e.turbulence||i.turbulence,icy_tint:!0},e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"cloud_bands_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),f.push(c),i.polar_hexagon&&i.polar_hexagon.enabled){const n=e.timing?.elapsed_time?e.timing.elapsed_time/31557600:0,a=new ie({planetColor:l,hexagonData:i.polar_hexagon,planetRadius:t,currentTime:n}),d={id:`effect_${this.nextId++}`,type:"polar_hexagon",effect:a,priority:10,enabled:!0};this.effects.set(d.id,d),f.push(d),o&&a.addToScene(o)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const n=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),a={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:n,priority:12,enabled:!0};this.effects.set(a.id,a),f.push(a),o&&n.addToScene(o)}if(i.atmosphere_clouds&&i.atmosphere_clouds.clouds&&i.atmosphere_clouds.clouds.length>0){const n=u(t,i.atmosphere_clouds,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(n){const a={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:n,priority:15,enabled:!0,name:"Frozen Gas Giant Atmosphere Clouds"};this.effects.set(a.id,a),f.push(a),n.addToScene(o,r.position)}}}break;case"aquifer":const p=Se(this.layerSystem,e);if(p){const s={id:`effect_${this.nextId++}`,type:"aquifer_water",effect:p,priority:2,enabled:!0,name:"Aquifer Water Surface"};this.effects.set(s.id,s),f.push(s)}const E=be(this.layerSystem,e);if(E){const s={id:`effect_${this.nextId++}`,type:"ocean_currents",effect:E,priority:1,enabled:!0,name:"Ocean Currents"};this.effects.set(s.id,s),f.push(s)}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}if(i.land_masses&&i.land_masses.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:3,enabled:!0,name:"Emergent Land Masses"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.atmosphere_clouds&&i.atmosphere_clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+8e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:4,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Aquifer Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"nebulous":if(this.layerSystem){const s=_e(this.layerSystem,{...i,base_color:l,storm_intensity:i.nebula_density||.6,color_variance:i.color_variance||.2},(e.seeds?.shape_seed||e.seeds?.planet_seed)+2e3),c={id:`effect_${this.nextId++}`,type:"cloud_gyros_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),f.push(c),i.polar_hexagon&&i.polar_hexagon.enabled){const n=e.timing?.elapsed_time?e.timing.elapsed_time/31557600:0,a=new ie({planetColor:l,hexagonData:i.polar_hexagon,planetRadius:t,currentTime:n}),d={id:`effect_${this.nextId++}`,type:"polar_hexagon",effect:a,priority:10,enabled:!0};this.effects.set(d.id,d),f.push(d),o&&a.addToScene(o)}if(i.clouds&&i.clouds.length>0){const n=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),a={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:n,priority:15,enabled:!0,name:"Nebulous Atmospheric Clouds"};this.effects.set(a.id,a),f.push(a),n.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const n=h(t,i,l,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3,e.timing?.cosmic_origin_time),a={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:n,priority:12,enabled:!0,name:"Nebulous Secondary Clouds"};this.effects.set(a.id,a),f.push(a),n.addToScene(o,r.position)}}break;case"metallic":case"metallic_3d":if(this.layerSystem){const s=Ze(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"metallic_surface_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),f.push(c),i.secondary_clouds&&i.secondary_clouds.length>0){const n=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),a={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:n,priority:12,enabled:!0,name:"Metallic Secondary Clouds"};this.effects.set(a.id,a),f.push(a),o&&n.addToScene(o)}}break;case"diamond":if(this.layerSystem){const s=Re(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"diamond_surface_layer",effect:s,priority:0,enabled:!0};this.effects.set(c.id,c),f.push(c);const n=te(e,t,e.seeds?.shape_seed||e.seeds?.planet_seed),a={id:`effect_${this.nextId++}`,type:"terrain_cracks",effect:n,priority:1,enabled:!0};if(this.effects.set(a.id,a),f.push(a),n.addToScene(o,r.position),i.clouds&&i.clouds.length>0){const d=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),_={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:d,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(_.id,_),f.push(_),d.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const d=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),_={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:d,priority:12,enabled:!0,name:"Diamond Secondary Clouds"};this.effects.set(_.id,_),f.push(_),o&&d.addToScene(o)}}break;case"rocky":if(this.layerSystem){const s=me(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"ROCKY"),c={id:`effect_${this.nextId++}`,type:"rocky_terrain_layer",effect:s,priority:0,enabled:!0};if(this.effects.set(c.id,c),f.push(c),i.clouds&&i.clouds.length>0){const n=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),a={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:n,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(a.id,a),f.push(a),n.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const n=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),a={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:n,priority:12,enabled:!0,name:"Rocky Secondary Clouds"};this.effects.set(a.id,a),f.push(a),o&&n.addToScene(o)}}break;case"icy":if(this.layerSystem){const s=Xe(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed),c={id:`effect_${this.nextId++}`,type:"icy_terrain_layer",effect:s,priority:0,enabled:!0};this.effects.set(c.id,c),f.push(c);const n=Oe(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+8e3);if(n){const d={id:`effect_${this.nextId++}`,type:"transparent_land_masses",effect:n,priority:1,enabled:!0,name:"Ice Formations"};this.effects.set(d.id,d),f.push(d),n.addToScene(o,r.position)}if(i.clouds&&i.clouds.length>0){const d=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),_={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:d,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(_.id,_),f.push(_),d.addToScene(o,r.position)}const a=ne(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+9e3);if(a){const d={id:`effect_${this.nextId++}`,type:"icy_features",effect:a,priority:2,enabled:!0,name:"Ice Crystals & Features"};this.effects.set(d.id,d),f.push(d),a.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const d=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),_={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:d,priority:12,enabled:!0,name:"Icy Secondary Clouds"};this.effects.set(_.id,_),f.push(_),o&&d.addToScene(o)}}break;case"oceanic":const b=Ee(t,e);if(b){const s={id:`effect_${this.nextId++}`,type:"fluid_layers",effect:b,priority:3,enabled:!0,name:"Fluid Ocean Layers"};this.effects.set(s.id,s),f.push(s),b.addToScene(o,r.position)}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Land Masses (Islands)"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Oceanic Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"tundra":if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Tundra Terrain"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}const I=ne(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+9e3);if(I){const s={id:`effect_${this.nextId++}`,type:"icy_features",effect:I,priority:6,enabled:!0,name:"Snow Patches & Ice"};this.effects.set(s.id,s),f.push(s),I.addToScene(o,r.position)}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}const w=ae(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+15e3);if(w){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:w,priority:20,enabled:!0,name:"Snowflakes"};this.effects.set(s.id,s),f.push(s),w.addToScene(o,r.position)}break;case"arid":let x;if(i.clouds&&i.clouds.length>0?x=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time):x=new D(t,{color:new ce(.9,.8,.7),cloudCount:20,size:4.2,opacity:.7,density:1.2,seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,rotationSpeed:.004,movementAmplitude:.012,puffiness:1.3,timeSpeed:1}),x){const s={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:x,priority:15,enabled:!0,name:"Atmospheric Clouds"};this.effects.set(s.id,s),f.push(s),x.addToScene(o,r.position)}let T;if(i.green_patches&&i.green_patches.length>0){const s={...i,green_patches:i.green_patches.map(c=>({...c,color:[.5,0,0,c.color?.[3]||1]}))};T=y(t,s,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3)}else T=new ee(t,{seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3,greenPatches:Array.from({length:25},(s,c)=>{const n=(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3+c*100,a=Math.sin(n)*.5+.5,d=Math.acos(1-2*(c+a)/25),_=2*Math.PI*(c*2.399%1);let S;return c<8?S=.25+a*.25:c<16?S=.15+a*.15:S=.08+a*.12,{position_3d:[Math.sin(d)*Math.cos(_),Math.sin(d)*Math.sin(_),Math.cos(d)],size:S,sides:12+Math.floor(a*16),color:[.5,0,0,.7+a*.2]}})});if(T){const s={id:`effect_${this.nextId++}`,type:"land_masses",effect:T,priority:5,enabled:!0,name:"Arid Terrain"};this.effects.set(s.id,s),f.push(s),T.addToScene(o,r.position)}const $=se(t,i,e.seeds?.shape_seed||e.seeds?.planet_seed);if($){const s={id:`effect_${this.nextId++}`,type:"river_lines",effect:$,priority:6,enabled:!0,name:"Dried River Channels"};this.effects.set(s.id,s),f.push(s),$.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Arid Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"savannah":if(this.layerSystem){const s=F(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"SAVANNAH"),c={id:`effect_${this.nextId++}`,type:"savannah_terrain_layer",effect:s,priority:2,enabled:!0,name:"Savannah Terrain Layer"};this.effects.set(c.id,c),f.push(c)}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Savannah Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Savannah Terrain"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Savannah Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"desert":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Desert Dust Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Desert Oases"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}const A=xe(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3,"desert");if(A){const s={id:`effect_${this.nextId++}`,type:"super_earth_water_features",effect:A,priority:6,enabled:!0,name:"Desert Rare Water Mass"};this.effects.set(s.id,s),f.push(s),A.addToScene(o,r.position)}const k=He(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+15e3);if(k){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:k,priority:20,enabled:!0,name:"Desert Sandstorms"};this.effects.set(s.id,s),f.push(s),k.addToScene(o,r.position)}if(i.savannah_terrain_layer&&this.layerSystem){const s=F(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"SAVANNAH"),c={id:`effect_${this.nextId++}`,type:"savannah_terrain_layer",effect:s,priority:2,enabled:!0,name:"Desert Savannah Terrain"};this.effects.set(c.id,c),f.push(c)}break;case"molten_core":case"molten core":const re=Ce(this.layerSystem,e);if(re){const s={id:`effect_${this.nextId++}`,type:"molten_lava",effect:re,priority:2,enabled:!0,name:"Molten Lava Surface"};this.effects.set(s.id,s),f.push(s)}const G=Ie(t,i,(e.seeds?.planet_seed||e.seeds?.shape_seed)+9e3);if(G){const s={id:`effect_${this.nextId++}`,type:"lava_flows",effect:G,priority:4,enabled:!0,name:"Lava Flows & Fire Whips"};this.effects.set(s.id,s),f.push(s),G.addToScene(o,r.position)}const W=this.createEffectFromPythonData("fire_eruption",e,t,r)?.effect;if(W){const s={id:`effect_${this.nextId++}`,type:"fire_eruption",effect:W,priority:15,enabled:!0,name:"Fire Eruptions"};this.effects.set(s.id,s),f.push(s),W.addToScene(o,r.position)}if(i.green_patches&&i.green_patches.length>0){const s={...i,green_patches:i.green_patches.map(n=>({...n,color:[1,.55,0,n.color?.[3]||.9]}))},c=y(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+1e4);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:3,enabled:!0,name:"Incandescent Land Masses"};this.effects.set(n.id,n),f.push(n),c.addToScene(o,r.position)}}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.planet_seed||e.seeds?.shape_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Molten Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Molten Core Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"lava":const N=te(e,t,e.seeds?.shape_seed||e.seeds?.planet_seed);if(N){const s={id:`effect_${this.nextId++}`,type:"terrain_cracks",effect:N,priority:1,enabled:!0,name:"Lava Terrain Cracks"};this.effects.set(s.id,s),f.push(s),N.addToScene(o,r.position)}const O=this.createEffectFromPythonData("lava_rivers",e,t,r)?.effect;if(O){const s={id:`effect_${this.nextId++}`,type:"lava_rivers",effect:O,priority:8,enabled:!0,name:"Lava Rivers"};this.effects.set(s.id,s),f.push(s),O.addToScene(o,r.position)}const z=this.createEffectFromPythonData("fire_eruption",e,t,r)?.effect;if(z){const s={id:`effect_${this.nextId++}`,type:"fire_eruption",effect:z,priority:12,enabled:!0,name:"Lava Planet Fire Eruptions"};this.effects.set(s.id,s),f.push(s),z.addToScene(o,r.position)}if(i.green_patches&&i.green_patches.length>0){const s={...i,green_patches:i.green_patches.map(n=>({...n,color:[.8,.3,0,n.color?.[3]||.7]}))},c=y(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+11e3);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:3,enabled:!0,name:"Lava Land Masses"};this.effects.set(n.id,n),f.push(n),c.addToScene(o,r.position)}}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:16,enabled:!0,name:"Volcanic Ash Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Lava Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"exotic":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Exotic Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}const B=ue(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3,l);if(B){const s={id:`effect_${this.nextId++}`,type:"exotic_geometric_shapes",effect:B,priority:10,enabled:!0,name:"Exotic Geometric Shapes"};this.effects.set(s.id,s),f.push(s),B.addToScene(o,r.position)}const V=he(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3,e);if(V){const s={id:`effect_${this.nextId++}`,type:"exotic_doodles",effect:V,priority:12,enabled:!0,name:"Exotic Doodles"};this.effects.set(s.id,s),f.push(s),V.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Exotic Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"cave":let P;if(i.atmosphere_clouds&&i.atmosphere_clouds.clouds&&i.atmosphere_clouds.clouds.length>0?P=u(t,i.atmosphere_clouds,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time):P=new D(t,{color:new ce(.75,.75,.75),cloudCount:12,size:3.5,opacity:.65,density:.8,seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,rotationSpeed:.003,movementAmplitude:.008,puffiness:1.1,timeSpeed:.8}),P){const s={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:P,priority:15,enabled:!0,name:"Cave Atmospheric Clouds"};this.effects.set(s.id,s),f.push(s),P.addToScene(o,r.position)}let v;if(i.green_patches&&i.green_patches.length>0)v=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3);else{const s=new $e((e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3),c=[];for(let n=0;n<10;n++){const a=s.random()*2*Math.PI,d=Math.acos(s.random()*2-1);let _;n<3?_=.2+s.random()*.2:n<7?_=.12+s.random()*.13:_=.08+s.random()*.07,c.push({position_3d:[Math.sin(d)*Math.cos(a),Math.sin(d)*Math.sin(a),Math.cos(d)],size:_,sides:12+Math.floor(s.random()*8),color:[.29,.25,.21,.75+s.random()*.15]})}v=new ee(t,{greenPatches:c,seed:(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3})}if(v){const s={id:`effect_${this.nextId++}`,type:"land_masses",effect:v,priority:5,enabled:!0,name:"Cave Land Masses"};this.effects.set(s.id,s),f.push(s),v.addToScene(o,r.position)}if(this.layerSystem){const s=me(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"CAVE"),c={id:`effect_${this.nextId++}`,type:"rocky_terrain_layer",effect:s,priority:1,enabled:!0,name:"Cave Rocky Terrain"};this.effects.set(c.id,c),f.push(c)}const L=pe(t,e,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(L){const s={id:`effect_${this.nextId++}`,type:"cave_surface_holes",effect:L,priority:10,enabled:!0,name:"Cave Surface Holes"};this.effects.set(s.id,s),f.push(s),L.addToScene(o,r.position),this.layerSystem&&L.applyToPlanetSystem(this.layerSystem,l)}const H=se(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3);if(H){const s={id:`effect_${this.nextId++}`,type:"river_lines",effect:H,priority:8,enabled:!0,name:"Cave Drainage Channels"};this.effects.set(s.id,s),f.push(s),H.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Cave Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"anomaly":const oe=["anomaly_phase_matter","pulsating_cube","planet_rays"],ve=e.seeds?.planet_seed||Math.floor(Math.random()*1e6),Me=oe.length;for(let s=0;s<Me;s++){const c=oe[s],n=ve+s*1e4,a=this.createEffectFromPythonData(c,{...e,seeds:{...e.seeds,planet_seed:n}},t,r,10+s);a&&(a.name=c.replace(/_/g," ").replace(/\b\w/g,d=>d.toUpperCase()),f.push(a),a.effect.addToScene&&a.effect.addToScene(o,r.position))}if(e.atmosphere&&e.atmosphere.type!=="None"){const s=this.createEffectFromPythonData("atmosphere",e.atmosphere,t,r,5);s&&(f.push(s),s.effect.addToScene(o,r.position))}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Anomaly Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"carbon":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.planet_seed||e.seeds?.shape_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Carbon Atmospheric Dust"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}if(i.green_patches&&i.green_patches.length>0){const s={...i,green_patches:i.green_patches.map(n=>({...n,color:[.1,.07,.06,n.color?.[3]||.9],size:(n.size||.1)*1.5}))},c=y(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+6e3);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:5,enabled:!0,name:"Carbon Formations"};this.effects.set(n.id,n),f.push(n),c.addToScene(o,r.position)}}const q=Ve(t,i,(e.seeds?.planet_seed||e.seeds?.shape_seed)+15e3);if(q){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:q,priority:20,enabled:!0,name:"Carbon Dust Particles"};this.effects.set(s.id,s),f.push(s),q.addToScene(o,r.position)}const U=this.createEffectFromPythonData("carbon_trails",e,t,r);if(U){const s={id:`effect_${this.nextId++}`,type:"carbon_trails",effect:U.effect,priority:25,enabled:!0,name:"Carbon Gas Trails"};this.effects.set(s.id,s),f.push(s),U.effect.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Carbon Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"forest":const j=this.createEffectFromPythonData("vegetation",e,t,r);if(j){const s={id:`effect_${this.nextId++}`,type:"vegetation",effect:j.effect,priority:10,enabled:!0,name:"Forest Vegetation"};this.effects.set(s.id,s),f.push(s),j.effect.addToScene(o,r.position)}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Forest Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s={...i,green_patches:i.green_patches.map(n=>({...n,size:(n.size||.1)*1.5,color:n.color||[.2,.4,.1,1]}))},c=y(t,s,(e.seeds?.planet_seed||e.seeds?.shape_seed)+6e3);if(c){const n={id:`effect_${this.nextId++}`,type:"land_masses",effect:c,priority:5,enabled:!0,name:"Forest Land Masses"};this.effects.set(n.id,n),f.push(n),c.addToScene(o,r.position)}}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Forest Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"magma":const Y=this.createEffectFromPythonData("magma_flows",e,t,r);if(Y){const s={id:`effect_${this.nextId++}`,type:"magma_flows",effect:Y.effect,priority:12,enabled:!0,name:"Magma Flows & Lakes"};this.effects.set(s.id,s),f.push(s),Y.effect.addToScene(o,r.position)}const K=this.createEffectFromPythonData("magma_eruptions",e,t,r);if(K){const s={id:`effect_${this.nextId++}`,type:"magma_eruptions",effect:K.effect,priority:13,enabled:!0,name:"Magma Eruptions & Arcs"};this.effects.set(s.id,s),f.push(s),K.effect.addToScene(o,r.position)}if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Magma Atmospheric Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.planet_seed||e.seeds?.shape_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Magmatic Land Masses"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Magma Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"crystalline":const J=this.createEffectFromPythonData("crystalline_surface",e,t,r);if(J){const s={id:`effect_${this.nextId++}`,type:"crystalline_surface",effect:J.effect,priority:3,enabled:!0,name:"Advanced Crystalline Surface"};this.effects.set(s.id,s),f.push(s),J.effect.addToScene(o,r.position)}break;case"toxic":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Toxic Purple Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4500);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:10,enabled:!0,name:"Toxic Contaminated Areas"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}const Q=Be(t,i,(e.seeds?.planet_seed||e.seeds?.shape_seed)+15e3);if(Q){const s={id:`effect_${this.nextId++}`,type:"tundra_snowflakes",effect:Q,priority:20,enabled:!0,name:"Toxic Particles"};this.effects.set(s.id,s),f.push(s),Q.addToScene(o,r.position)}const X=de(t,i,e.seeds?.planet_seed);if(X){const s={id:`effect_${this.nextId++}`,type:"toxic_waste_render",effect:X,priority:25,enabled:!0,name:"Toxic Waste Polygonal Spots"};this.effects.set(s.id,s),f.push(s),X.addToScene(o,r.position)}break;case"radioactive":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+5e3,e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Radioactive Toxic Clouds"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:10,enabled:!0,name:"Radioactive Contaminated Areas"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}const Z=this.createEffectFromPythonData("radiation_rings",e,t,r);if(Z){const s={id:`effect_${this.nextId++}`,type:"radiation_rings",effect:Z.effect,priority:21,enabled:!0,name:"Radioactive Surface Rings"};this.effects.set(s.id,s),f.push(s),Z.effect.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Radioactive Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"super_earth":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+8e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Super Earth Dense Atmosphere"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+9e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Super Earth Massive Continents"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(this.layerSystem){const s=F(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"SAVANNAH"),c={id:`effect_${this.nextId++}`,type:"savannah_terrain_layer",effect:s,priority:3,enabled:!0,name:"Super Earth Savannah Terrain"};this.effects.set(c.id,c),f.push(c)}const R=xe(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+11e3);if(R){const s={id:`effect_${this.nextId++}`,type:"super_earth_water_features",effect:R,priority:6,enabled:!0,name:"Super Earth Water Features"};this.effects.set(s.id,s),f.push(s),R.addToScene(o,r.position)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Super Earth Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"sub_earth":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Sub Earth Thin Atmosphere"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+7500);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Sub Earth Small Continents"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.savannah_terrain_layer&&this.layerSystem){const s=F(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"SAVANNAH"),c={id:`effect_${this.nextId++}`,type:"savannah_terrain_layer",effect:s,priority:2,enabled:!0,name:"Sub Earth Savannah Terrain"};this.effects.set(c.id,c),f.push(c)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Sub Earth Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}break;case"swamp":if(i.clouds&&i.clouds.length>0){const s=u(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+4e3,e.timing?.cosmic_origin_time);if(s){const c={id:`effect_${this.nextId++}`,type:"atmosphere_clouds",effect:s,priority:15,enabled:!0,name:"Swamp Humid Atmosphere"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(i.green_patches&&i.green_patches.length>0){const s=y(t,i,(e.seeds?.shape_seed||e.seeds?.planet_seed)+6e3);if(s){const c={id:`effect_${this.nextId++}`,type:"land_masses",effect:s,priority:5,enabled:!0,name:"Swamp Land Masses"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}if(this.layerSystem){const s=F(this.layerSystem,e,e.seeds?.shape_seed||e.seeds?.planet_seed,"SAVANNAH"),c={id:`effect_${this.nextId++}`,type:"savannah_terrain_layer",effect:s,priority:3,enabled:!0,name:"Swamp Savannah Terrain"};this.effects.set(c.id,c),f.push(c)}if(i.secondary_clouds&&i.secondary_clouds.length>0){const s=h(t,i,l,e.seeds?.planet_seed||Math.floor(Math.random()*1e6),e.timing?.cosmic_origin_time),c={id:`effect_${this.nextId++}`,type:"secondary_clouds",effect:s,priority:12,enabled:!0,name:"Swamp Secondary Clouds"};this.effects.set(c.id,c),f.push(c),o&&s.addToScene(o)}if(i.toxic_bubbles){const s=this.createEffectFromPythonData("toxic_swamp_bubbles",e,t,r)?.effect;if(s){const c={id:`effect_${this.nextId++}`,type:"toxic_swamp_bubbles",effect:s,priority:25,enabled:!0,name:"Toxic Swamp Bubbles"};this.effects.set(c.id,c),f.push(c),s.addToScene(o,r.position)}}break;default:if(e.planet_info?.type?.toLowerCase()==="anomaly"){const c=["anomaly_phase_matter","pulsating_cube","planet_rays"],n=e.seeds?.planet_seed||Math.floor(Math.random()*1e6),a=c.length;for(let d=0;d<a;d++){const _=c[d],S=n+d*1e4,M=this.createEffectFromPythonData(_,{...e,seeds:{...e.seeds,planet_seed:S}},t,r,10+d);M&&(M.name=_.replace(/_/g," ").replace(/\b\w/g,Fe=>Fe.toUpperCase()),f.push(M),M.effect.addToScene&&M.effect.addToScene(o,r.position))}if(e.atmosphere&&e.atmosphere.type!=="None"){const d=this.createEffectFromPythonData("atmosphere",e.atmosphere,t,r,5);d&&(f.push(d),d.effect.addToScene(o,r.position))}}else if(r.material instanceof Te){const s=C(e);r.material.color.copy(s)}break}}else if(r.material instanceof Te){const i=C(e);r.material.color.copy(i)}const g=e.planet_info?.type?.toLowerCase()||e.surface_elements?.type?.toLowerCase(),Pe=g==="anomaly"||e.surface_elements?.type==="anomaly";if(e.atmosphere&&!Pe){if(e.atmosphere.streaks||["Gas Giant","Frozen Gas Giant"].includes(e.planet_info?.type)){const i=fe(t,e.atmosphere||{},e.seeds?.shape_seed+2e3);if(i){const p={id:`effect_${this.nextId++}`,type:"atmosphere_glow",effect:i,priority:20,enabled:!0};this.effects.set(p.id,p),f.push(p),i.addToScene(o,r.position)}}if(e.atmosphere.type&&e.atmosphere.type!=="None"){const i={...e.atmosphere};g==="oceanic"&&(i.opacity=Math.min(i.opacity||.3,.15),i.width=Math.min(i.width||15,8));const p=this.createEffectFromPythonData("atmosphere",i,t,r,5);p&&(f.push(p),p.effect.addToScene(o,r.position))}}if(e.rings&&e.rings.has_rings||["Gas Giant","Frozen Gas Giant","Super Earth"].includes(e.planet_info?.type)){const i=this.createEffectFromPythonData("ring_system",e,t,r,1);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.surface_elements?.has_fragmentation_zones){const i=this.createEffectFromPythonData("fragmentation",e,t,r,5);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.original_planet_data&&e.original_planet_data.life_forms==="Intelligent Life"){const i=this.createEffectFromPythonData("life_form_intelligent_life",e,t,r,10);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.original_planet_data&&e.original_planet_data.life_forms==="Silicon-Based Life"){const i=this.createEffectFromPythonData("life_form_silicon_based_life",e,t,r,10);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.original_planet_data&&e.original_planet_data.life_forms==="Non-Physical Entity"){const i=this.createEffectFromPythonData("life_form_non_physical_entity",e,t,r,10);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.original_planet_data&&e.original_planet_data.life_forms==="Conscious Gas"){const i=this.createEffectFromPythonData("life_form_conscious_gas",e,t,r,10);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.original_planet_data&&e.original_planet_data.life_forms==="Robotic Entities"){const i=this.createEffectFromPythonData("life_form_robotic_entities",e,t,r,10);i&&(f.push(i),i.effect.addToScene(o,r.position))}if(e.original_planet_data&&e.original_planet_data.life_forms==="Have I just found God?"){const i=this.createEffectFromPythonData("life_form_god",e,t,r,10);i&&(f.push(i),i.effect.addToScene(o,r.position))}this.layerSystem&&this.layerSystem.addToScene(o);try{const i=this.createEffectFromPythonData("star_field",e,t,r,-100);i&&i.effect&&(i.effect.addToScene(o,r.position),f.push(i))}catch{}return f.forEach((i,p)=>{}),f.length,f}catch(l){throw l}}getEffect(e){return this.effects.get(e)||null}getEffectsByType(e){return Array.from(this.effects.values()).filter(t=>t.type===e)}getAllEffects(){return Array.from(this.effects.values())}toggleEffect(e,t){const r=this.effects.get(e);if(r){r.enabled=t!==void 0?t:!r.enabled;const o=r.effect;if(o&&o.getObject3D){const m=o.getObject3D();m&&(m.visible=r.enabled)}if(r.type==="cave_surface_holes"&&o)if(r.enabled){if(o.applyToPlanetSystem&&this.layerSystem){const m=this.baseColor||new ce(13750737);o.applyToPlanetSystem(this.layerSystem,m)}}else o.planetSystem&&o.planetSystem.restoreOriginalMaterial&&o.planetSystem.restoreOriginalMaterial();if(this.layerSystem){const m=this.layerSystem.getLayerMeshes(),l={cloud_bands_layer:"cloudBands",cloud_gyros_layer:"cloudGyros",metallic_surface_layer:"metallicSurface",diamond_surface_layer:"diamondSurface",rocky_terrain_layer:"rockyTerrain",savannah_terrain_layer:"savannahTerrain",icy_terrain_layer:"icyTerrain",aquifer_water:"aquiferWater",ocean_currents:"oceanCurrents",molten_lava:"moltenLava"}[r.type];l&&m[l]&&(m[l].visible=r.enabled)}}}updateAllEffects(e,t,r,o){this.layerSystem&&this.layerSystem.update(e,t);for(const m of this.effects.values())if(m.enabled&&m.effect.update)try{m.type==="star_field"&&r&&"updateWithCamera"in m.effect?m.effect.updateWithCamera(e,r):(o!==void 0&&"setCosmicTime"in m.effect&&m.effect.setCosmicTime(o),m.effect.update(e,t))}catch{}}updateLightForAllEffects(e){this.layerSystem&&this.layerSystem.updateFromThreeLight(e);for(const t of this.effects.values())if(t.enabled&&t.effect.updateFromThreeLight)try{t.effect.updateFromThreeLight(e)}catch{}}updateOrbitalPositionForAllEffects(e){for(const t of this.effects.values())if(t.enabled&&t.effect.updateOrbitalPosition)try{t.effect.updateOrbitalPosition(e)}catch{}}removeEffect(e){const t=this.effects.get(e);t&&(t.effect.dispose&&t.effect.dispose(),this.effects.delete(e))}clearAllEffects(){this.layerSystem&&(this.layerSystem.dispose(),this.layerSystem=void 0);for(const e of this.effects.values())e.effect.dispose&&e.effect.dispose();this.effects.clear(),this.nextId=1}getStats(){const e=Array.from(this.effects.values());return{registeredTypes:this.creators.size,activeEffects:e.length,enabledEffects:e.filter(t=>t.enabled).length}}getAvailableEffectTypes(){return Array.from(this.creators.keys())}}export{jt as E};
