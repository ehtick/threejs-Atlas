import{S as U,g as k,D as q}from"./atlas_DkjWl6DBdcRHoaQOD3LxM.js";import{G as z,V as F,n as L,T as Y,C as R,z as g,D as v,A as G,M as H}from"./atlas_Dr7FhitegIaVfnn-NnCom.js";const s={RAY_COUNT:{min:8,max:33},RAY_INTENSITY:{min:.5,max:2},PULSE_SPEED:{min:1,max:6},RAY_LENGTH:{min:.5,max:2.5},RAY_THICKNESS:{min:.02,max:.15},TIME_SPEED:{min:.8,max:1.5},COLOR_VARIATION:{min:.2,max:.6}};class B{rays;group;params;startTime;rayMaterials;rayData;stormFreq1;stormFreq2;stormThreshold;constructor(e,t={}){const r=t.seed||Math.floor(Math.random()*1e6),n=new U(r);this.startTime=t.startTime||r%1e4/1e3,this.params={rayCount:t.rayCount||Math.floor(n.uniform(s.RAY_COUNT.min,s.RAY_COUNT.max)),rayIntensity:t.rayIntensity||n.uniform(s.RAY_INTENSITY.min,s.RAY_INTENSITY.max),pulseSpeed:t.pulseSpeed||n.uniform(s.PULSE_SPEED.min,s.PULSE_SPEED.max),rayLength:t.rayLength||n.uniform(s.RAY_LENGTH.min,s.RAY_LENGTH.max),rayThickness:t.rayThickness||n.uniform(s.RAY_THICKNESS.min,s.RAY_THICKNESS.max),timeSpeed:t.timeSpeed||n.uniform(s.TIME_SPEED.min,s.TIME_SPEED.max),colorVariation:t.colorVariation||n.uniform(s.COLOR_VARIATION.min,s.COLOR_VARIATION.max),seed:r,startTime:this.startTime};const i=r%1e3/1e3;this.stormFreq1=.01+i*.005,this.stormFreq2=.003+i*.002,this.stormThreshold=.75+i*.15,this.group=new z,this.rays=[],this.rayMaterials=[],this.rayData=[],this.generateRays(e,n)}generateRays(e,t){const r=this.params.rayCount;for(let i=0;i<r;i++){const l=[],a=t.spherePosition(e*1.05),f=new F(a.x,a.y,a.z),P=e*(2+this.params.rayLength*t.uniform(.8,1.2)),T=f.clone().normalize().multiplyScalar(P),h=8+Math.floor(t.uniform(0,5));for(let y=0;y<=h;y++){const I=y/h,_=new F().lerpVectors(f,T,I);if(y>0&&y<h){const A=t.spherePosition(e*.05*(1-I)),b=new F(A.x,A.y,A.z);_.add(b)}l.push(_)}const C=new L(l),E=e*this.params.rayThickness*.08,S=new Y(C,h*2,E,8,!1),d=200+t.uniform(-30,30),N=.8+t.uniform(-.2,.2),O=.6+t.uniform(-.1,.1),m=new R;m.setHSL(d/360,N,O);const p=this.params.colorVariation;m.r=Math.min(1,m.r+t.uniform(-p,p)),m.g=Math.min(1,m.g+t.uniform(-p,p)),m.b=Math.min(1,m.b+t.uniform(-p,p));const c=new g({color:m,transparent:!0,opacity:0,blending:G,side:v}),u=new H(S,c);this.rayData.push({startPos:f,endPos:T,phase:t.uniform(0,Math.PI*2),frequency:this.params.pulseSpeed*t.uniform(.8,1.2),color:m,activationOffset:t.uniform(0,100)}),this.rays.push(u),this.rayMaterials.push(c),this.group.add(u)}const n=Math.floor(r*.5);for(let i=0;i<n;i++){const l=[],a=t.spherePosition(e*1.02),f=new F(a.x,a.y,a.z),P=e*(1.5+this.params.rayLength*.5*t.uniform(.6,1)),M=f.clone().normalize(),T=t.spherePosition(.2),h=new F(T.x,T.y,T.z);M.add(h).normalize();const C=M.multiplyScalar(P),E=4+Math.floor(t.uniform(0,3));for(let _=0;_<=E;_++){const A=_/E,b=new F().lerpVectors(f,C,A);if(_>0&&_<E){const D=t.spherePosition(e*.02*(1-A)),V=new F(D.x,D.y,D.z);b.add(V)}l.push(b)}const S=new L(l),d=e*this.params.rayThickness*.03,N=new Y(S,E*2,d,6,!1),O=200+t.uniform(-30,30),m=.6+t.uniform(-.2,.2),p=.4+t.uniform(-.1,.1),c=new R;c.setHSL(O/360,m,p);const u=this.params.colorVariation*.7;c.r=Math.min(1,c.r+t.uniform(-u,u)),c.g=Math.min(1,c.g+t.uniform(-u,u)),c.b=Math.min(1,c.b+t.uniform(-u,u));const y=new g({color:c,transparent:!0,opacity:0,blending:G,side:v}),I=new H(N,y);this.rayData.push({startPos:f,endPos:C,phase:t.uniform(0,Math.PI*2),frequency:this.params.pulseSpeed*t.uniform(1.5,2.5),color:c,activationOffset:t.uniform(0,150)}),this.rays.push(I),this.rayMaterials.push(y),this.group.add(I)}}addToScene(e,t){t&&this.group.position.copy(t),e.add(this.group)}update(){const t=k(q,this.params.timeSpeed,this.startTime);this.rayMaterials.forEach((r,n)=>{const i=this.rayData[n],l=t*i.frequency+i.phase,a=(t+i.activationOffset)*.1,f=Math.sin(a)*Math.sin(a*.3)*Math.sin(a*.7);if(f>.2){const M=Math.max(0,(f-.2)/.8),T=Math.sin(l)*.3+.7,h=Math.sin(l*12)>.9?1.5:1,S=Math.sin(t*this.stormFreq1)*Math.sin(t*this.stormFreq2)>this.stormThreshold?1.5:1;let d=M*T*h*S*this.params.rayIntensity;d=Math.min(1,d),r.opacity=d,h>1.2||S>1.2?r.color.setRGB(Math.min(1,i.color.r+.3),Math.min(1,i.color.g+.3),Math.min(1,i.color.b+.3)):r.color.copy(i.color)}else r.opacity=0}),this.group.rotation.y=t*.005,this.group.rotation.x=Math.sin(t*.002)*.1}getObject3D(){return this.group}dispose(){this.rays.forEach(e=>{e.geometry.dispose(),e.material.dispose()})}}function Q(o,e,t){const r=t||Math.floor(Math.random()*1e6),n=new U(r+7777),i=n.uniform(s.TIME_SPEED.min,s.TIME_SPEED.max),l=r%1e4/1e3,a={rayCount:Math.floor(n.uniform(s.RAY_COUNT.min,s.RAY_COUNT.max)),rayIntensity:n.uniform(s.RAY_INTENSITY.min,s.RAY_INTENSITY.max),pulseSpeed:n.uniform(s.PULSE_SPEED.min,s.PULSE_SPEED.max),rayLength:n.uniform(s.RAY_LENGTH.min,s.RAY_LENGTH.max),rayThickness:n.uniform(s.RAY_THICKNESS.min,s.RAY_THICKNESS.max),timeSpeed:i,colorVariation:n.uniform(s.COLOR_VARIATION.min,s.COLOR_VARIATION.max),seed:r,startTime:l};return new B(o,a)}function x(o){const e=o.replace("#",""),t=parseInt(e.substr(0,2),16)/255,r=parseInt(e.substr(2,2),16)/255,n=parseInt(e.substr(4,2),16)/255;return new R(t,r,n)}function w(o){return o.length>=3?new R(o[0],o[1],o[2]):new R(.5,.5,.5)}function W(o){if(o.ocean_color){if(typeof o.ocean_color=="string")return x(o.ocean_color);if(Array.isArray(o.ocean_color))return w(o.ocean_color)}if(o.planet_info?.base_color){if(typeof o.planet_info.base_color=="string")return x(o.planet_info.base_color);if(Array.isArray(o.planet_info.base_color))return w(o.planet_info.base_color)}if(o.base_color){if(typeof o.base_color=="string")return x(o.base_color);if(Array.isArray(o.base_color))return w(o.base_color)}const e=o.planet_info?.type||o.type||"Unknown";return K(e)}function K(o){const t={"Gas Giant":"#FFA500",Anomaly:"#FFFFFF",Rocky:"#808080",Icy:"#ADD8E6",Oceanic:"#0000FF",Desert:"#FFD700",Lava:"#FF0000",Arid:"#800000",Swamp:"#008000",Tundra:"#F0F8FF",Forest:"#006400",Savannah:"#F4A460",Cave:"#D1D1D1",Crystalline:"#00FFFF",Metallic:"#C0C0C0",Toxic:"#800080",Radioactive:"#00FF00",Magma:"#FF4500","Molten Core":"#FF8C00",Carbon:"#090909",Diamond:"#87CEFA","Super Earth":"#90EE90","Sub Earth":"#006400","Frozen Gas Giant":"#ADD8E6",Nebulous:"#FFC0CB",Aquifer:"#00FFFF",Exotic:"#FF00FF"}[o]||"#FFFFFF";return x(t)}export{B as P,Q as c,W as g};
